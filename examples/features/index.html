<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="OpenCypher to Databricks SQL Transpiler - Convert graph queries to SQL"><meta name=author content="gsql2rsql Contributors"><link href=https://devmessias.github.io/gsql2rsql/examples/features/ rel=canonical><link href=../credit/ rel=prev><link href=../../contributing/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>All Features - gsql2rsql Documentation</title><link rel=stylesheet href=../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent=teal> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#features-queries class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="gsql2rsql Documentation" class="md-header__button md-logo" aria-label="gsql2rsql Documentation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> gsql2rsql Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> All Features </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent=teal aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=teal data-md-color-accent=teal aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/devmessias/gsql2rsql title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> devmessias/gsql2rsql </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../table-design/ class=md-tabs__link> Making delta tables graph-friendly </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../user-guide/ class=md-tabs__link> User Guide </a> </li> <li class=md-tabs__item> <a href=../../contributing/ class=md-tabs__link> Contributing </a> </li> <li class=md-tabs__item> <a href=../../about/ class=md-tabs__link> About </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="gsql2rsql Documentation" class="md-nav__button md-logo" aria-label="gsql2rsql Documentation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> gsql2rsql Documentation </label> <div class=md-nav__source> <a href=https://github.com/devmessias/gsql2rsql title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> devmessias/gsql2rsql </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../table-design/ class=md-nav__link> <span class=md-ellipsis> Making delta tables graph-friendly </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> User Guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> User Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/ class=md-nav__link> <span class=md-ellipsis> Getting Started </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> Examples </span> </a> <label class="md-nav__link " for=__nav_3_2 id=__nav_3_2_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=true> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../fraud/ class=md-nav__link> <span class=md-ellipsis> Fraud Detection </span> </a> </li> <li class=md-nav__item> <a href=../credit/ class=md-nav__link> <span class=md-ellipsis> Credit Analysis </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> All Features </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> All Features </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#1-simple-node-lookup-retrieve-all-nodes-of-a-type class=md-nav__link> <span class=md-ellipsis> 1. Simple node lookup - retrieve all nodes of a type </span> </a> </li> <li class=md-nav__item> <a href=#2-property-filter-with-where-clause class=md-nav__link> <span class=md-ellipsis> 2. Property filter with WHERE clause </span> </a> </li> <li class=md-nav__item> <a href=#3-property-projection-with-aliases class=md-nav__link> <span class=md-ellipsis> 3. Property projection with aliases </span> </a> </li> <li class=md-nav__item> <a href=#4-pagination-with-order-by-skip-and-limit class=md-nav__link> <span class=md-ellipsis> 4. Pagination with ORDER BY, SKIP and LIMIT </span> </a> </li> <li class=md-nav__item> <a href=#5-count-aggregation-without-grouping class=md-nav__link> <span class=md-ellipsis> 5. COUNT aggregation without grouping </span> </a> </li> <li class=md-nav__item> <a href=#6-group-by-with-multiple-aggregations class=md-nav__link> <span class=md-ellipsis> 6. GROUP BY with multiple aggregations </span> </a> </li> <li class=md-nav__item> <a href=#7-aggregation-with-order-by-on-aggregated-column class=md-nav__link> <span class=md-ellipsis> 7. Aggregation with ORDER BY on aggregated column </span> </a> </li> <li class=md-nav__item> <a href=#8-having-style-filter-using-withwhere class=md-nav__link> <span class=md-ellipsis> 8. HAVING-style filter using WITH...WHERE </span> </a> </li> <li class=md-nav__item> <a href=#9-collect-aggregation-into-arrays class=md-nav__link> <span class=md-ellipsis> 9. COLLECT aggregation into arrays </span> </a> </li> <li class=md-nav__item> <a href=#10-directed-relationship-traversal class=md-nav__link> <span class=md-ellipsis> 10. Directed relationship traversal </span> </a> </li> <li class=md-nav__item> <a href=#11-relationship-with-property-filter class=md-nav__link> <span class=md-ellipsis> 11. Relationship with property filter </span> </a> </li> <li class=md-nav__item> <a href=#12-undirected-relationship-both-directions class=md-nav__link> <span class=md-ellipsis> 12. Undirected relationship (both directions) </span> </a> </li> <li class=md-nav__item> <a href=#13-undirected-with-source-filter-pushdown class=md-nav__link> <span class=md-ellipsis> 13. Undirected with source filter pushdown </span> </a> </li> <li class=md-nav__item> <a href=#14-undirected-with-target-filter-not-pushed class=md-nav__link> <span class=md-ellipsis> 14. Undirected with target filter (not pushed) </span> </a> </li> <li class=md-nav__item> <a href=#15-undirected-with-mixed-filters-partial-pushdown class=md-nav__link> <span class=md-ellipsis> 15. Undirected with mixed filters (partial pushdown) </span> </a> </li> <li class=md-nav__item> <a href=#16-undirected-multi-hop-with-predicate-pushdown class=md-nav__link> <span class=md-ellipsis> 16. Undirected multi-hop with predicate pushdown </span> </a> </li> <li class=md-nav__item> <a href=#17-undirected-relationship-with-aggregation class=md-nav__link> <span class=md-ellipsis> 17. Undirected relationship with aggregation </span> </a> </li> <li class=md-nav__item> <a href=#18-optional-match-left-join-semantics class=md-nav__link> <span class=md-ellipsis> 18. OPTIONAL MATCH (left join semantics) </span> </a> </li> <li class=md-nav__item> <a href=#19-variable-length-path-traversal-1-to-3-hops class=md-nav__link> <span class=md-ellipsis> 19. Variable-length path traversal (1 to 3 hops) </span> </a> </li> <li class=md-nav__item> <a href=#20-variable-length-path-with-zero-length-includes-self class=md-nav__link> <span class=md-ellipsis> 20. Variable-length path with zero-length (includes self) </span> </a> </li> <li class=md-nav__item> <a href=#21-case-expression-for-conditional-values class=md-nav__link> <span class=md-ellipsis> 21. CASE expression for conditional values </span> </a> </li> <li class=md-nav__item> <a href=#22-coalesce-for-null-safe-default-values class=md-nav__link> <span class=md-ellipsis> 22. COALESCE for null-safe default values </span> </a> </li> <li class=md-nav__item> <a href=#23-distinct-for-deduplication class=md-nav__link> <span class=md-ellipsis> 23. DISTINCT for deduplication </span> </a> </li> <li class=md-nav__item> <a href=#24-union-to-combine-query-results class=md-nav__link> <span class=md-ellipsis> 24. UNION to combine query results </span> </a> </li> <li class=md-nav__item> <a href=#25-multi-hop-path-with-intermediate-filtering class=md-nav__link> <span class=md-ellipsis> 25. Multi-hop path with intermediate filtering </span> </a> </li> <li class=md-nav__item> <a href=#26-chained-with-for-multi-stage-computation class=md-nav__link> <span class=md-ellipsis> 26. Chained WITH for multi-stage computation </span> </a> </li> <li class=md-nav__item> <a href=#27-simplest-sink-filter-pushdown class=md-nav__link> <span class=md-ellipsis> 27. Simplest sink filter pushdown </span> </a> </li> <li class=md-nav__item> <a href=#28-variable-length-path-with-sink-filter-pushdown class=md-nav__link> <span class=md-ellipsis> 28. Variable-length path with sink filter pushdown </span> </a> </li> <li class=md-nav__item> <a href=#29-variable-length-with-source-and-sink-filter-pushdown class=md-nav__link> <span class=md-ellipsis> 29. Variable-length with source AND sink filter pushdown </span> </a> </li> <li class=md-nav__item> <a href=#30-variable-length-with-compound-sink-filter class=md-nav__link> <span class=md-ellipsis> 30. Variable-length with compound sink filter </span> </a> </li> <li class=md-nav__item> <a href=#31-variable-length-with-sink-filter-and-edge-predicate class=md-nav__link> <span class=md-ellipsis> 31. Variable-length with sink filter and edge predicate </span> </a> </li> <li class=md-nav__item> <a href=#32-undirected-both-filters-pushdown-split-and-to-both-sources class=md-nav__link> <span class=md-ellipsis> 32. Undirected both filters pushdown - split AND to both sources </span> </a> </li> <li class=md-nav__item> <a href=#33-undirected-partial-pushdown-one-pushed-one-cross-variable class=md-nav__link> <span class=md-ellipsis> 33. Undirected partial pushdown - one pushed, one cross-variable </span> </a> </li> <li class=md-nav__item> <a href=#34-undirected-multiple-same-variable-predicates-combined class=md-nav__link> <span class=md-ellipsis> 34. Undirected multiple same-variable predicates combined </span> </a> </li> <li class=md-nav__item> <a href=#35-undirected-with-or-predicate-cannot-split class=md-nav__link> <span class=md-ellipsis> 35. Undirected with OR predicate - cannot split </span> </a> </li> <li class=md-nav__item> <a href=#36-undirected-three-way-mixed-filters class=md-nav__link> <span class=md-ellipsis> 36. Undirected three-way mixed filters </span> </a> </li> <li class=md-nav__item> <a href=#37-variable-length-paths-with-multi-hop-traversal-and-aggregation class=md-nav__link> <span class=md-ellipsis> 37. Variable-length paths with multi-hop traversal and aggregation </span> </a> </li> <li class=md-nav__item> <a href=#38-inline-property-filter-on-source-node class=md-nav__link> <span class=md-ellipsis> 38. Inline property filter on source node </span> </a> </li> <li class=md-nav__item> <a href=#39-inline-property-filter-on-target-node class=md-nav__link> <span class=md-ellipsis> 39. Inline property filter on target node </span> </a> </li> <li class=md-nav__item> <a href=#40-inline-property-filter-on-relationship class=md-nav__link> <span class=md-ellipsis> 40. Inline property filter on relationship </span> </a> </li> <li class=md-nav__item> <a href=#41-multiple-inline-property-filters-on-same-element class=md-nav__link> <span class=md-ellipsis> 41. Multiple inline property filters on same element </span> </a> </li> <li class=md-nav__item> <a href=#42-combined-inline-filters-source-target-and-relationship class=md-nav__link> <span class=md-ellipsis> 42. Combined inline filters - source, target, and relationship </span> </a> </li> <li class=md-nav__item> <a href=#43-inline-filter-combined-with-explicit-where-clause class=md-nav__link> <span class=md-ellipsis> 43. Inline filter combined with explicit WHERE clause </span> </a> </li> <li class=md-nav__item> <a href=#44-bfs-with-inline-source-filter-critical-optimization class=md-nav__link> <span class=md-ellipsis> 44. BFS with inline source filter (CRITICAL OPTIMIZATION) </span> </a> </li> <li class=md-nav__item> <a href=#45-bfs-with-inline-filter-on-target-node class=md-nav__link> <span class=md-ellipsis> 45. BFS with inline filter on target node </span> </a> </li> <li class=md-nav__item> <a href=#46-anonymous-node-with-inline-filter class=md-nav__link> <span class=md-ellipsis> 46. Anonymous node with inline filter </span> </a> </li> <li class=md-nav__item> <a href=#47-inline-filter-comparison-with-where-semantics class=md-nav__link> <span class=md-ellipsis> 47. Inline filter comparison with WHERE (semantics) </span> </a> </li> <li class=md-nav__item> <a href=#48-no-label-source-node-without-label class=md-nav__link> <span class=md-ellipsis> 48. NO LABEL: Source node without label </span> </a> </li> <li class=md-nav__item> <a href=#49-no-label-target-node-without-label class=md-nav__link> <span class=md-ellipsis> 49. NO LABEL: Target node without label </span> </a> </li> <li class=md-nav__item> <a href=#50-no-label-both-endpoints-without-labels class=md-nav__link> <span class=md-ellipsis> 50. NO LABEL: Both endpoints without labels </span> </a> </li> <li class=md-nav__item> <a href=#51-no-label-variable-length-path-without-labels class=md-nav__link> <span class=md-ellipsis> 51. NO LABEL: Variable-length path without labels </span> </a> </li> <li class=md-nav__item> <a href=#52-no-label-vlp-with-labeled-source-unlabeled-target class=md-nav__link> <span class=md-ellipsis> 52. NO LABEL: VLP with labeled source, unlabeled target </span> </a> </li> <li class=md-nav__item> <a href=#53-no-label-vlp-with-unlabeled-source-labeled-target class=md-nav__link> <span class=md-ellipsis> 53. NO LABEL: VLP with unlabeled source, labeled target </span> </a> </li> <li class=md-nav__item> <a href=#54-no-label-node-reused-after-with-type-already-bound class=md-nav__link> <span class=md-ellipsis> 54. NO LABEL: Node reused after WITH (type already bound) </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=../../about/ class=md-nav__link> <span class=md-ellipsis> About </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#1-simple-node-lookup-retrieve-all-nodes-of-a-type class=md-nav__link> <span class=md-ellipsis> 1. Simple node lookup - retrieve all nodes of a type </span> </a> </li> <li class=md-nav__item> <a href=#2-property-filter-with-where-clause class=md-nav__link> <span class=md-ellipsis> 2. Property filter with WHERE clause </span> </a> </li> <li class=md-nav__item> <a href=#3-property-projection-with-aliases class=md-nav__link> <span class=md-ellipsis> 3. Property projection with aliases </span> </a> </li> <li class=md-nav__item> <a href=#4-pagination-with-order-by-skip-and-limit class=md-nav__link> <span class=md-ellipsis> 4. Pagination with ORDER BY, SKIP and LIMIT </span> </a> </li> <li class=md-nav__item> <a href=#5-count-aggregation-without-grouping class=md-nav__link> <span class=md-ellipsis> 5. COUNT aggregation without grouping </span> </a> </li> <li class=md-nav__item> <a href=#6-group-by-with-multiple-aggregations class=md-nav__link> <span class=md-ellipsis> 6. GROUP BY with multiple aggregations </span> </a> </li> <li class=md-nav__item> <a href=#7-aggregation-with-order-by-on-aggregated-column class=md-nav__link> <span class=md-ellipsis> 7. Aggregation with ORDER BY on aggregated column </span> </a> </li> <li class=md-nav__item> <a href=#8-having-style-filter-using-withwhere class=md-nav__link> <span class=md-ellipsis> 8. HAVING-style filter using WITH...WHERE </span> </a> </li> <li class=md-nav__item> <a href=#9-collect-aggregation-into-arrays class=md-nav__link> <span class=md-ellipsis> 9. COLLECT aggregation into arrays </span> </a> </li> <li class=md-nav__item> <a href=#10-directed-relationship-traversal class=md-nav__link> <span class=md-ellipsis> 10. Directed relationship traversal </span> </a> </li> <li class=md-nav__item> <a href=#11-relationship-with-property-filter class=md-nav__link> <span class=md-ellipsis> 11. Relationship with property filter </span> </a> </li> <li class=md-nav__item> <a href=#12-undirected-relationship-both-directions class=md-nav__link> <span class=md-ellipsis> 12. Undirected relationship (both directions) </span> </a> </li> <li class=md-nav__item> <a href=#13-undirected-with-source-filter-pushdown class=md-nav__link> <span class=md-ellipsis> 13. Undirected with source filter pushdown </span> </a> </li> <li class=md-nav__item> <a href=#14-undirected-with-target-filter-not-pushed class=md-nav__link> <span class=md-ellipsis> 14. Undirected with target filter (not pushed) </span> </a> </li> <li class=md-nav__item> <a href=#15-undirected-with-mixed-filters-partial-pushdown class=md-nav__link> <span class=md-ellipsis> 15. Undirected with mixed filters (partial pushdown) </span> </a> </li> <li class=md-nav__item> <a href=#16-undirected-multi-hop-with-predicate-pushdown class=md-nav__link> <span class=md-ellipsis> 16. Undirected multi-hop with predicate pushdown </span> </a> </li> <li class=md-nav__item> <a href=#17-undirected-relationship-with-aggregation class=md-nav__link> <span class=md-ellipsis> 17. Undirected relationship with aggregation </span> </a> </li> <li class=md-nav__item> <a href=#18-optional-match-left-join-semantics class=md-nav__link> <span class=md-ellipsis> 18. OPTIONAL MATCH (left join semantics) </span> </a> </li> <li class=md-nav__item> <a href=#19-variable-length-path-traversal-1-to-3-hops class=md-nav__link> <span class=md-ellipsis> 19. Variable-length path traversal (1 to 3 hops) </span> </a> </li> <li class=md-nav__item> <a href=#20-variable-length-path-with-zero-length-includes-self class=md-nav__link> <span class=md-ellipsis> 20. Variable-length path with zero-length (includes self) </span> </a> </li> <li class=md-nav__item> <a href=#21-case-expression-for-conditional-values class=md-nav__link> <span class=md-ellipsis> 21. CASE expression for conditional values </span> </a> </li> <li class=md-nav__item> <a href=#22-coalesce-for-null-safe-default-values class=md-nav__link> <span class=md-ellipsis> 22. COALESCE for null-safe default values </span> </a> </li> <li class=md-nav__item> <a href=#23-distinct-for-deduplication class=md-nav__link> <span class=md-ellipsis> 23. DISTINCT for deduplication </span> </a> </li> <li class=md-nav__item> <a href=#24-union-to-combine-query-results class=md-nav__link> <span class=md-ellipsis> 24. UNION to combine query results </span> </a> </li> <li class=md-nav__item> <a href=#25-multi-hop-path-with-intermediate-filtering class=md-nav__link> <span class=md-ellipsis> 25. Multi-hop path with intermediate filtering </span> </a> </li> <li class=md-nav__item> <a href=#26-chained-with-for-multi-stage-computation class=md-nav__link> <span class=md-ellipsis> 26. Chained WITH for multi-stage computation </span> </a> </li> <li class=md-nav__item> <a href=#27-simplest-sink-filter-pushdown class=md-nav__link> <span class=md-ellipsis> 27. Simplest sink filter pushdown </span> </a> </li> <li class=md-nav__item> <a href=#28-variable-length-path-with-sink-filter-pushdown class=md-nav__link> <span class=md-ellipsis> 28. Variable-length path with sink filter pushdown </span> </a> </li> <li class=md-nav__item> <a href=#29-variable-length-with-source-and-sink-filter-pushdown class=md-nav__link> <span class=md-ellipsis> 29. Variable-length with source AND sink filter pushdown </span> </a> </li> <li class=md-nav__item> <a href=#30-variable-length-with-compound-sink-filter class=md-nav__link> <span class=md-ellipsis> 30. Variable-length with compound sink filter </span> </a> </li> <li class=md-nav__item> <a href=#31-variable-length-with-sink-filter-and-edge-predicate class=md-nav__link> <span class=md-ellipsis> 31. Variable-length with sink filter and edge predicate </span> </a> </li> <li class=md-nav__item> <a href=#32-undirected-both-filters-pushdown-split-and-to-both-sources class=md-nav__link> <span class=md-ellipsis> 32. Undirected both filters pushdown - split AND to both sources </span> </a> </li> <li class=md-nav__item> <a href=#33-undirected-partial-pushdown-one-pushed-one-cross-variable class=md-nav__link> <span class=md-ellipsis> 33. Undirected partial pushdown - one pushed, one cross-variable </span> </a> </li> <li class=md-nav__item> <a href=#34-undirected-multiple-same-variable-predicates-combined class=md-nav__link> <span class=md-ellipsis> 34. Undirected multiple same-variable predicates combined </span> </a> </li> <li class=md-nav__item> <a href=#35-undirected-with-or-predicate-cannot-split class=md-nav__link> <span class=md-ellipsis> 35. Undirected with OR predicate - cannot split </span> </a> </li> <li class=md-nav__item> <a href=#36-undirected-three-way-mixed-filters class=md-nav__link> <span class=md-ellipsis> 36. Undirected three-way mixed filters </span> </a> </li> <li class=md-nav__item> <a href=#37-variable-length-paths-with-multi-hop-traversal-and-aggregation class=md-nav__link> <span class=md-ellipsis> 37. Variable-length paths with multi-hop traversal and aggregation </span> </a> </li> <li class=md-nav__item> <a href=#38-inline-property-filter-on-source-node class=md-nav__link> <span class=md-ellipsis> 38. Inline property filter on source node </span> </a> </li> <li class=md-nav__item> <a href=#39-inline-property-filter-on-target-node class=md-nav__link> <span class=md-ellipsis> 39. Inline property filter on target node </span> </a> </li> <li class=md-nav__item> <a href=#40-inline-property-filter-on-relationship class=md-nav__link> <span class=md-ellipsis> 40. Inline property filter on relationship </span> </a> </li> <li class=md-nav__item> <a href=#41-multiple-inline-property-filters-on-same-element class=md-nav__link> <span class=md-ellipsis> 41. Multiple inline property filters on same element </span> </a> </li> <li class=md-nav__item> <a href=#42-combined-inline-filters-source-target-and-relationship class=md-nav__link> <span class=md-ellipsis> 42. Combined inline filters - source, target, and relationship </span> </a> </li> <li class=md-nav__item> <a href=#43-inline-filter-combined-with-explicit-where-clause class=md-nav__link> <span class=md-ellipsis> 43. Inline filter combined with explicit WHERE clause </span> </a> </li> <li class=md-nav__item> <a href=#44-bfs-with-inline-source-filter-critical-optimization class=md-nav__link> <span class=md-ellipsis> 44. BFS with inline source filter (CRITICAL OPTIMIZATION) </span> </a> </li> <li class=md-nav__item> <a href=#45-bfs-with-inline-filter-on-target-node class=md-nav__link> <span class=md-ellipsis> 45. BFS with inline filter on target node </span> </a> </li> <li class=md-nav__item> <a href=#46-anonymous-node-with-inline-filter class=md-nav__link> <span class=md-ellipsis> 46. Anonymous node with inline filter </span> </a> </li> <li class=md-nav__item> <a href=#47-inline-filter-comparison-with-where-semantics class=md-nav__link> <span class=md-ellipsis> 47. Inline filter comparison with WHERE (semantics) </span> </a> </li> <li class=md-nav__item> <a href=#48-no-label-source-node-without-label class=md-nav__link> <span class=md-ellipsis> 48. NO LABEL: Source node without label </span> </a> </li> <li class=md-nav__item> <a href=#49-no-label-target-node-without-label class=md-nav__link> <span class=md-ellipsis> 49. NO LABEL: Target node without label </span> </a> </li> <li class=md-nav__item> <a href=#50-no-label-both-endpoints-without-labels class=md-nav__link> <span class=md-ellipsis> 50. NO LABEL: Both endpoints without labels </span> </a> </li> <li class=md-nav__item> <a href=#51-no-label-variable-length-path-without-labels class=md-nav__link> <span class=md-ellipsis> 51. NO LABEL: Variable-length path without labels </span> </a> </li> <li class=md-nav__item> <a href=#52-no-label-vlp-with-labeled-source-unlabeled-target class=md-nav__link> <span class=md-ellipsis> 52. NO LABEL: VLP with labeled source, unlabeled target </span> </a> </li> <li class=md-nav__item> <a href=#53-no-label-vlp-with-unlabeled-source-labeled-target class=md-nav__link> <span class=md-ellipsis> 53. NO LABEL: VLP with unlabeled source, labeled target </span> </a> </li> <li class=md-nav__item> <a href=#54-no-label-node-reused-after-with-type-already-bound class=md-nav__link> <span class=md-ellipsis> 54. NO LABEL: Node reused after WITH (type already bound) </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=features-queries>Features Queries<a class=headerlink href=#features-queries title="Link to this section">&para;</a></h1> <p>This page contains transpiled examples for <strong>features queries</strong> queries.</p> <div class="admonition warning"> <p class=admonition-title>Disclaimer</p> <p>These examples were generated by Claude, and I believe Claude was overconfident about the usefulness of these queries. Therefore, these examples require further curation and validation, including the transpilation results. if you spot any issues, please open an issue or contribute at <a href=https://github.com/devmessias/gsql2rsql/issues>gsql2rsql/issues</a></p> </div> <p>Each example shows the original OpenCypher query and its corresponding Databricks SQL translation.</p> <hr> <h2 id=1-simple-node-lookup-retrieve-all-nodes-of-a-type>1. Simple node lookup - retrieve all nodes of a type<a class=headerlink href=#1-simple-node-lookup-retrieve-all-nodes-of-a-type title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Basic MATCH</p> <details class=note> <summary>Notes</summary> <p>The simplest query pattern - retrieves all nodes with a label.</p> <p>WHY USEFUL: Foundation of all graph queries. Start here to explore data.</p> <p>DATABRICKS COMPLEXITY: O(n) - single table scan COST: Very low. Maps to: SELECT name, age FROM Person Optimizations: Partition pruning if table is partitioned.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>age</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1></a><a href=#__codelineno-1-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2></a><a href=#__codelineno-1-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3></a><a href=#__codelineno-1-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_p_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>age</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4></a><a href=#__codelineno-1-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5></a><a href=#__codelineno-1-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6></a><a href=#__codelineno-1-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7></a><a href=#__codelineno-1-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8></a><a href=#__codelineno-1-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9></a><a href=#__codelineno-1-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>  </span><span class=k>FROM</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10></a><a href=#__codelineno-1-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11></a><a href=#__codelineno-1-11><span class=linenos data-linenos="11 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1></a><a href=#__codelineno-2-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2></a><a href=#__codelineno-2-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3></a><a href=#__codelineno-2-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=2;
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4></a><a href=#__codelineno-2-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5></a><a href=#__codelineno-2-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6></a><a href=#__codelineno-2-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7></a><a href=#__codelineno-2-7><span class=linenos data-linenos=" 7 "></span></a>----------------------------------------------------------------------
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8></a><a href=#__codelineno-2-8><span class=linenos data-linenos=" 8 "></span></a>Level 1:
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9></a><a href=#__codelineno-2-9><span class=linenos data-linenos=" 9 "></span></a>----------------------------------------------------------------------
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10></a><a href=#__codelineno-2-10><span class=linenos data-linenos="10 "></span></a>OpId=2 Op=ProjectionOperator; InOpIds=1; OutOpIds=;
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11></a><a href=#__codelineno-2-11><span class=linenos data-linenos="11 "></span></a>  ProjectionOperator(id=2)
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12></a><a href=#__codelineno-2-12><span class=linenos data-linenos="12 "></span></a>    Projections: name=p.name, age=p.age
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13></a><a href=#__codelineno-2-13><span class=linenos data-linenos="13 "></span></a>*
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14></a><a href=#__codelineno-2-14><span class=linenos data-linenos="14 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=2-property-filter-with-where-clause>2. Property filter with WHERE clause<a class=headerlink href=#2-property-filter-with-where-clause title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: WHERE filtering</p> <details class=note> <summary>Notes</summary> <p>Filters nodes by property values using boolean conditions.</p> <p>WHY USEFUL: Essential for narrowing results. Supports =, &lt;&gt;, &lt;, &gt;, &lt;=, &gt;=, AND, OR, NOT.</p> <p>DATABRICKS COMPLEXITY: O(n) without index, O(log n) with Delta index COST: Low. WHERE pushdown to storage layer in Delta Lake. TIP: Create Z-ORDER on frequently filtered columns.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1></a><a href=#__codelineno-3-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2></a><a href=#__codelineno-3-2><span class=linenos data-linenos="2 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>30</span><span class=w> </span><span class=n>AND</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=k>true</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3></a><a href=#__codelineno-3-3><span class=linenos data-linenos="3 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>age</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1></a><a href=#__codelineno-4-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2></a><a href=#__codelineno-4-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3></a><a href=#__codelineno-4-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_p_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>age</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4></a><a href=#__codelineno-4-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5></a><a href=#__codelineno-4-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6></a><a href=#__codelineno-4-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7></a><a href=#__codelineno-4-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8></a><a href=#__codelineno-4-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9></a><a href=#__codelineno-4-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_active</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10></a><a href=#__codelineno-4-10><span class=linenos data-linenos="10 "></span></a><span class=w>  </span><span class=k>FROM</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11></a><a href=#__codelineno-4-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12></a><a href=#__codelineno-4-12><span class=linenos data-linenos="12 "></span></a><span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=p>(((</span><span class=n>age</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>30</span><span class=p>))</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=p>((</span><span class=n>active</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=k>TRUE</span><span class=p>)))</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13></a><a href=#__codelineno-4-13><span class=linenos data-linenos="13 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1></a><a href=#__codelineno-5-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2></a><a href=#__codelineno-5-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3></a><a href=#__codelineno-5-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=3;
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4></a><a href=#__codelineno-5-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5></a><a href=#__codelineno-5-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6></a><a href=#__codelineno-5-6><span class=linenos data-linenos=" 6 "></span></a>    Filter: ((p.age GT 30) AND (p.active EQ true))
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7></a><a href=#__codelineno-5-7><span class=linenos data-linenos=" 7 "></span></a>*
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8></a><a href=#__codelineno-5-8><span class=linenos data-linenos=" 8 "></span></a>----------------------------------------------------------------------
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9></a><a href=#__codelineno-5-9><span class=linenos data-linenos=" 9 "></span></a>Level 1:
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10></a><a href=#__codelineno-5-10><span class=linenos data-linenos="10 "></span></a>----------------------------------------------------------------------
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11></a><a href=#__codelineno-5-11><span class=linenos data-linenos="11 "></span></a>OpId=3 Op=ProjectionOperator; InOpIds=1; OutOpIds=;
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12></a><a href=#__codelineno-5-12><span class=linenos data-linenos="12 "></span></a>  ProjectionOperator(id=3)
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13></a><a href=#__codelineno-5-13><span class=linenos data-linenos="13 "></span></a>    Projections: name=p.name, age=p.age
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14></a><a href=#__codelineno-5-14><span class=linenos data-linenos="14 "></span></a>*
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15></a><a href=#__codelineno-5-15><span class=linenos data-linenos="15 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=3-property-projection-with-aliases>3. Property projection with aliases<a class=headerlink href=#3-property-projection-with-aliases title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: SELECT aliases</p> <details class=note> <summary>Notes</summary> <p>Projects specific properties with custom column names.</p> <p>WHY USEFUL: Control output schema, rename for clarity, reduce data transfer.</p> <p>DATABRICKS COMPLEXITY: O(n) - projection happens after scan COST: Very low. Column pruning reduces I/O. Note: Only requested columns are read from Delta Lake.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1></a><a href=#__codelineno-6-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2></a><a href=#__codelineno-6-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>personName</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>personAge</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>income</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1></a><a href=#__codelineno-7-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2></a><a href=#__codelineno-7-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>personName</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3></a><a href=#__codelineno-7-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_p_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>personAge</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4></a><a href=#__codelineno-7-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_p_salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>income</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5></a><a href=#__codelineno-7-5><span class=linenos data-linenos=" 5 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6></a><a href=#__codelineno-7-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7></a><a href=#__codelineno-7-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>     </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8></a><a href=#__codelineno-7-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9></a><a href=#__codelineno-7-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10></a><a href=#__codelineno-7-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_salary</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11></a><a href=#__codelineno-7-11><span class=linenos data-linenos="11 "></span></a><span class=w>  </span><span class=k>FROM</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12></a><a href=#__codelineno-7-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13></a><a href=#__codelineno-7-13><span class=linenos data-linenos="13 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1></a><a href=#__codelineno-8-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2></a><a href=#__codelineno-8-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3></a><a href=#__codelineno-8-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=2;
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4></a><a href=#__codelineno-8-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5></a><a href=#__codelineno-8-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6></a><a href=#__codelineno-8-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7></a><a href=#__codelineno-8-7><span class=linenos data-linenos=" 7 "></span></a>----------------------------------------------------------------------
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8></a><a href=#__codelineno-8-8><span class=linenos data-linenos=" 8 "></span></a>Level 1:
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9></a><a href=#__codelineno-8-9><span class=linenos data-linenos=" 9 "></span></a>----------------------------------------------------------------------
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10></a><a href=#__codelineno-8-10><span class=linenos data-linenos="10 "></span></a>OpId=2 Op=ProjectionOperator; InOpIds=1; OutOpIds=;
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11></a><a href=#__codelineno-8-11><span class=linenos data-linenos="11 "></span></a>  ProjectionOperator(id=2)
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12></a><a href=#__codelineno-8-12><span class=linenos data-linenos="12 "></span></a>    Projections: personName=p.name, personAge=p.age, income=p.salary
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13></a><a href=#__codelineno-8-13><span class=linenos data-linenos="13 "></span></a>*
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14></a><a href=#__codelineno-8-14><span class=linenos data-linenos="14 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=4-pagination-with-order-by-skip-and-limit>4. Pagination with ORDER BY, SKIP and LIMIT<a class=headerlink href=#4-pagination-with-order-by-skip-and-limit title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Pagination</p> <details class=note> <summary>Notes</summary> <p>Orders results and returns a specific page of data.</p> <p>WHY USEFUL: Implement pagination in APIs, get top-N results.</p> <p>DATABRICKS COMPLEXITY: O(n log n) for sorting COST: Medium. Full sort before SKIP/LIMIT. WARNING: SKIP without ORDER BY gives non-deterministic results. TIP: For large offsets, consider keyset pagination instead.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1></a><a href=#__codelineno-9-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2></a><a href=#__codelineno-9-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>age</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3></a><a href=#__codelineno-9-3><span class=linenos data-linenos="3 "></span></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>DESC</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4></a><a href=#__codelineno-9-4><span class=linenos data-linenos="4 "></span></a><span class=k>SKIP</span><span class=w> </span><span class=m>10</span><span class=w> </span><span class=k>LIMIT</span><span class=w> </span><span class=m>5</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1></a><a href=#__codelineno-10-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2></a><a href=#__codelineno-10-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3></a><a href=#__codelineno-10-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_p_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>age</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4></a><a href=#__codelineno-10-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5></a><a href=#__codelineno-10-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6></a><a href=#__codelineno-10-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7></a><a href=#__codelineno-10-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8></a><a href=#__codelineno-10-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9></a><a href=#__codelineno-10-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>  </span><span class=k>FROM</span>
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10></a><a href=#__codelineno-10-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-10-11><a id=__codelineno-10-11 name=__codelineno-10-11></a><a href=#__codelineno-10-11><span class=linenos data-linenos="11 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-10-12><a id=__codelineno-10-12 name=__codelineno-10-12></a><a href=#__codelineno-10-12><span class=linenos data-linenos="12 "></span></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span><span class=w> </span><span class=k>DESC</span>
</span><span id=__span-10-13><a id=__codelineno-10-13 name=__codelineno-10-13></a><a href=#__codelineno-10-13><span class=linenos data-linenos="13 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=mi>5</span>
</span><span id=__span-10-14><a id=__codelineno-10-14 name=__codelineno-10-14></a><a href=#__codelineno-10-14><span class=linenos data-linenos="14 "></span></a><span class=k>OFFSET</span><span class=w> </span><span class=mi>10</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1></a><a href=#__codelineno-11-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2></a><a href=#__codelineno-11-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3></a><a href=#__codelineno-11-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=2;
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4></a><a href=#__codelineno-11-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5></a><a href=#__codelineno-11-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6></a><a href=#__codelineno-11-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7></a><a href=#__codelineno-11-7><span class=linenos data-linenos=" 7 "></span></a>----------------------------------------------------------------------
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8></a><a href=#__codelineno-11-8><span class=linenos data-linenos=" 8 "></span></a>Level 1:
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9></a><a href=#__codelineno-11-9><span class=linenos data-linenos=" 9 "></span></a>----------------------------------------------------------------------
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10></a><a href=#__codelineno-11-10><span class=linenos data-linenos="10 "></span></a>OpId=2 Op=ProjectionOperator; InOpIds=1; OutOpIds=;
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11></a><a href=#__codelineno-11-11><span class=linenos data-linenos="11 "></span></a>  ProjectionOperator(id=2)
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12></a><a href=#__codelineno-11-12><span class=linenos data-linenos="12 "></span></a>    Projections: name=p.name, age=p.age
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13></a><a href=#__codelineno-11-13><span class=linenos data-linenos="13 "></span></a>*
</span><span id=__span-11-14><a id=__codelineno-11-14 name=__codelineno-11-14></a><a href=#__codelineno-11-14><span class=linenos data-linenos="14 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=5-count-aggregation-without-grouping>5. COUNT aggregation without grouping<a class=headerlink href=#5-count-aggregation-without-grouping title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: COUNT</p> <details class=note> <summary>Notes</summary> <p>Counts all nodes matching the pattern.</p> <p>WHY USEFUL: Get cardinality metrics, validate data.</p> <p>DATABRICKS COMPLEXITY: O(n) - single pass COST: Very low. COUNT(*) is highly optimized in Delta Lake. Returns single row. NULL values are counted.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1></a><a href=#__codelineno-12-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2></a><a href=#__codelineno-12-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>COUNT</span><span class=p>(</span><span class=n>p</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>totalPeople</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1></a><a href=#__codelineno-13-1><span class=linenos data-linenos="1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2></a><a href=#__codelineno-13-2><span class=linenos data-linenos="2 "></span></a><span class=w>   </span><span class=k>COUNT</span><span class=p>(</span><span class=n>_gsql2rsql_p_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>totalPeople</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3></a><a href=#__codelineno-13-3><span class=linenos data-linenos="3 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4></a><a href=#__codelineno-13-4><span class=linenos data-linenos="4 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5></a><a href=#__codelineno-13-5><span class=linenos data-linenos="5 "></span></a><span class=w>     </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6></a><a href=#__codelineno-13-6><span class=linenos data-linenos="6 "></span></a><span class=w>  </span><span class=k>FROM</span>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7></a><a href=#__codelineno-13-7><span class=linenos data-linenos="7 "></span></a><span class=w>    </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8></a><a href=#__codelineno-13-8><span class=linenos data-linenos="8 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1></a><a href=#__codelineno-14-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2></a><a href=#__codelineno-14-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3></a><a href=#__codelineno-14-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=2;
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4></a><a href=#__codelineno-14-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5></a><a href=#__codelineno-14-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6></a><a href=#__codelineno-14-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-14-7><a id=__codelineno-14-7 name=__codelineno-14-7></a><a href=#__codelineno-14-7><span class=linenos data-linenos=" 7 "></span></a>----------------------------------------------------------------------
</span><span id=__span-14-8><a id=__codelineno-14-8 name=__codelineno-14-8></a><a href=#__codelineno-14-8><span class=linenos data-linenos=" 8 "></span></a>Level 1:
</span><span id=__span-14-9><a id=__codelineno-14-9 name=__codelineno-14-9></a><a href=#__codelineno-14-9><span class=linenos data-linenos=" 9 "></span></a>----------------------------------------------------------------------
</span><span id=__span-14-10><a id=__codelineno-14-10 name=__codelineno-14-10></a><a href=#__codelineno-14-10><span class=linenos data-linenos="10 "></span></a>OpId=2 Op=ProjectionOperator; InOpIds=1; OutOpIds=;
</span><span id=__span-14-11><a id=__codelineno-14-11 name=__codelineno-14-11></a><a href=#__codelineno-14-11><span class=linenos data-linenos="11 "></span></a>  ProjectionOperator(id=2)
</span><span id=__span-14-12><a id=__codelineno-14-12 name=__codelineno-14-12></a><a href=#__codelineno-14-12><span class=linenos data-linenos="12 "></span></a>    Projections: totalPeople=COUNT(p)
</span><span id=__span-14-13><a id=__codelineno-14-13 name=__codelineno-14-13></a><a href=#__codelineno-14-13><span class=linenos data-linenos="13 "></span></a>*
</span><span id=__span-14-14><a id=__codelineno-14-14 name=__codelineno-14-14></a><a href=#__codelineno-14-14><span class=linenos data-linenos="14 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=6-group-by-with-multiple-aggregations>6. GROUP BY with multiple aggregations<a class=headerlink href=#6-group-by-with-multiple-aggregations title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: GROUP BY</p> <details class=note> <summary>Notes</summary> <p>Groups by non-aggregated columns, computes multiple metrics per group.</p> <p>WHY USEFUL: Analytics dashboards, summary reports, KPIs.</p> <p>DATABRICKS COMPLEXITY: O(n) with hash aggregation COST: Medium. Memory for hash table proportional to group count. Cypher implicit GROUP BY: all non-aggregated RETURN columns become keys.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1></a><a href=#__codelineno-15-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>LIVES_IN</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>c</span><span class=p>:</span><span class=n>City</span><span class=p>)</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2></a><a href=#__codelineno-15-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>c</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>city</span><span class=p>,</span>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3></a><a href=#__codelineno-15-3><span class=linenos data-linenos="3 "></span></a><span class=w>       </span><span class=n>COUNT</span><span class=p>(</span><span class=n>p</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>population</span><span class=p>,</span>
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4></a><a href=#__codelineno-15-4><span class=linenos data-linenos="4 "></span></a><span class=w>       </span><span class=n>AVG</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>age</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avgAge</span><span class=p>,</span>
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5></a><a href=#__codelineno-15-5><span class=linenos data-linenos="5 "></span></a><span class=w>       </span><span class=n>MIN</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>salary</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>minSalary</span><span class=p>,</span>
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6></a><a href=#__codelineno-15-6><span class=linenos data-linenos="6 "></span></a><span class=w>       </span><span class=n>MAX</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>salary</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>maxSalary</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1></a><a href=#__codelineno-16-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2></a><a href=#__codelineno-16-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_c_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>city</span>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3></a><a href=#__codelineno-16-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=k>COUNT</span><span class=p>(</span><span class=n>_gsql2rsql_p_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>population</span>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4></a><a href=#__codelineno-16-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>  </span><span class=p>,</span><span class=k>AVG</span><span class=p>(</span><span class=k>CAST</span><span class=p>(</span><span class=n>_gsql2rsql_p_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>DOUBLE</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avgAge</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5></a><a href=#__codelineno-16-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=p>,</span><span class=k>MIN</span><span class=p>(</span><span class=n>_gsql2rsql_p_salary</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>minSalary</span>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6></a><a href=#__codelineno-16-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>  </span><span class=p>,</span><span class=k>MAX</span><span class=p>(</span><span class=n>_gsql2rsql_p_salary</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>maxSalary</span>
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7></a><a href=#__codelineno-16-7><span class=linenos data-linenos=" 7 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8></a><a href=#__codelineno-16-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-16-9><a id=__codelineno-16-9 name=__codelineno-16-9></a><a href=#__codelineno-16-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-16-10><a id=__codelineno-16-10 name=__codelineno-16-10></a><a href=#__codelineno-16-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-16-11><a id=__codelineno-16-11 name=__codelineno-16-11></a><a href=#__codelineno-16-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_salary</span>
</span><span id=__span-16-12><a id=__codelineno-16-12 name=__codelineno-16-12></a><a href=#__codelineno-16-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-16-13><a id=__codelineno-16-13 name=__codelineno-16-13></a><a href=#__codelineno-16-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_city_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-16-14><a id=__codelineno-16-14 name=__codelineno-16-14></a><a href=#__codelineno-16-14><span class=linenos data-linenos="14 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-16-15><a id=__codelineno-16-15 name=__codelineno-16-15></a><a href=#__codelineno-16-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span><span id=__span-16-16><a id=__codelineno-16-16 name=__codelineno-16-16></a><a href=#__codelineno-16-16><span class=linenos data-linenos="16 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-16-17><a id=__codelineno-16-17 name=__codelineno-16-17></a><a href=#__codelineno-16-17><span class=linenos data-linenos="17 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-16-18><a id=__codelineno-16-18 name=__codelineno-16-18></a><a href=#__codelineno-16-18><span class=linenos data-linenos="18 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-16-19><a id=__codelineno-16-19 name=__codelineno-16-19></a><a href=#__codelineno-16-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-16-20><a id=__codelineno-16-20 name=__codelineno-16-20></a><a href=#__codelineno-16-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_salary</span>
</span><span id=__span-16-21><a id=__codelineno-16-21 name=__codelineno-16-21></a><a href=#__codelineno-16-21><span class=linenos data-linenos="21 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-16-22><a id=__codelineno-16-22 name=__codelineno-16-22></a><a href=#__codelineno-16-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_city_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-16-23><a id=__codelineno-16-23 name=__codelineno-16-23></a><a href=#__codelineno-16-23><span class=linenos data-linenos="23 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-16-24><a id=__codelineno-16-24 name=__codelineno-16-24></a><a href=#__codelineno-16-24><span class=linenos data-linenos="24 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-16-25><a id=__codelineno-16-25 name=__codelineno-16-25></a><a href=#__codelineno-16-25><span class=linenos data-linenos="25 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-16-26><a id=__codelineno-16-26 name=__codelineno-16-26></a><a href=#__codelineno-16-26><span class=linenos data-linenos="26 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-16-27><a id=__codelineno-16-27 name=__codelineno-16-27></a><a href=#__codelineno-16-27><span class=linenos data-linenos="27 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_salary</span>
</span><span id=__span-16-28><a id=__codelineno-16-28 name=__codelineno-16-28></a><a href=#__codelineno-16-28><span class=linenos data-linenos="28 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-16-29><a id=__codelineno-16-29 name=__codelineno-16-29></a><a href=#__codelineno-16-29><span class=linenos data-linenos="29 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-16-30><a id=__codelineno-16-30 name=__codelineno-16-30></a><a href=#__codelineno-16-30><span class=linenos data-linenos="30 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-16-31><a id=__codelineno-16-31 name=__codelineno-16-31></a><a href=#__codelineno-16-31><span class=linenos data-linenos="31 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-16-32><a id=__codelineno-16-32 name=__codelineno-16-32></a><a href=#__codelineno-16-32><span class=linenos data-linenos="32 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-16-33><a id=__codelineno-16-33 name=__codelineno-16-33></a><a href=#__codelineno-16-33><span class=linenos data-linenos="33 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-16-34><a id=__codelineno-16-34 name=__codelineno-16-34></a><a href=#__codelineno-16-34><span class=linenos data-linenos="34 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>city_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-16-35><a id=__codelineno-16-35 name=__codelineno-16-35></a><a href=#__codelineno-16-35><span class=linenos data-linenos="35 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-16-36><a id=__codelineno-16-36 name=__codelineno-16-36></a><a href=#__codelineno-16-36><span class=linenos data-linenos="36 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>LivesIn</span>
</span><span id=__span-16-37><a id=__codelineno-16-37 name=__codelineno-16-37></a><a href=#__codelineno-16-37><span class=linenos data-linenos="37 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-16-38><a id=__codelineno-16-38 name=__codelineno-16-38></a><a href=#__codelineno-16-38><span class=linenos data-linenos="38 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-16-39><a id=__codelineno-16-39 name=__codelineno-16-39></a><a href=#__codelineno-16-39><span class=linenos data-linenos="39 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-16-40><a id=__codelineno-16-40 name=__codelineno-16-40></a><a href=#__codelineno-16-40><span class=linenos data-linenos="40 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-16-41><a id=__codelineno-16-41 name=__codelineno-16-41></a><a href=#__codelineno-16-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-16-42><a id=__codelineno-16-42 name=__codelineno-16-42></a><a href=#__codelineno-16-42><span class=linenos data-linenos="42 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-16-43><a id=__codelineno-16-43 name=__codelineno-16-43></a><a href=#__codelineno-16-43><span class=linenos data-linenos="43 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span><span id=__span-16-44><a id=__codelineno-16-44 name=__codelineno-16-44></a><a href=#__codelineno-16-44><span class=linenos data-linenos="44 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-16-45><a id=__codelineno-16-45 name=__codelineno-16-45></a><a href=#__codelineno-16-45><span class=linenos data-linenos="45 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>City</span>
</span><span id=__span-16-46><a id=__codelineno-16-46 name=__codelineno-16-46></a><a href=#__codelineno-16-46><span class=linenos data-linenos="46 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-16-47><a id=__codelineno-16-47 name=__codelineno-16-47></a><a href=#__codelineno-16-47><span class=linenos data-linenos="47 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-16-48><a id=__codelineno-16-48 name=__codelineno-16-48></a><a href=#__codelineno-16-48><span class=linenos data-linenos="48 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-16-49><a id=__codelineno-16-49 name=__codelineno-16-49></a><a href=#__codelineno-16-49><span class=linenos data-linenos="49 "></span></a><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1></a><a href=#__codelineno-17-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2></a><a href=#__codelineno-17-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3></a><a href=#__codelineno-17-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4></a><a href=#__codelineno-17-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5></a><a href=#__codelineno-17-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6></a><a href=#__codelineno-17-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7></a><a href=#__codelineno-17-7><span class=linenos data-linenos=" 7 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-17-8><a id=__codelineno-17-8 name=__codelineno-17-8></a><a href=#__codelineno-17-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-17-9><a id=__codelineno-17-9 name=__codelineno-17-9></a><a href=#__codelineno-17-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: [_anon1:LIVES_IN]-&gt;
</span><span id=__span-17-10><a id=__codelineno-17-10 name=__codelineno-17-10></a><a href=#__codelineno-17-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-17-11><a id=__codelineno-17-11 name=__codelineno-17-11></a><a href=#__codelineno-17-11><span class=linenos data-linenos="11 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-17-12><a id=__codelineno-17-12 name=__codelineno-17-12></a><a href=#__codelineno-17-12><span class=linenos data-linenos="12 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-17-13><a id=__codelineno-17-13 name=__codelineno-17-13></a><a href=#__codelineno-17-13><span class=linenos data-linenos="13 "></span></a>    DataSource: c:City
</span><span id=__span-17-14><a id=__codelineno-17-14 name=__codelineno-17-14></a><a href=#__codelineno-17-14><span class=linenos data-linenos="14 "></span></a>*
</span><span id=__span-17-15><a id=__codelineno-17-15 name=__codelineno-17-15></a><a href=#__codelineno-17-15><span class=linenos data-linenos="15 "></span></a>----------------------------------------------------------------------
</span><span id=__span-17-16><a id=__codelineno-17-16 name=__codelineno-17-16></a><a href=#__codelineno-17-16><span class=linenos data-linenos="16 "></span></a>Level 1:
</span><span id=__span-17-17><a id=__codelineno-17-17 name=__codelineno-17-17></a><a href=#__codelineno-17-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-17-18><a id=__codelineno-17-18 name=__codelineno-17-18></a><a href=#__codelineno-17-18><span class=linenos data-linenos="18 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-17-19><a id=__codelineno-17-19 name=__codelineno-17-19></a><a href=#__codelineno-17-19><span class=linenos data-linenos="19 "></span></a>  JoinOperator(id=4)
</span><span id=__span-17-20><a id=__codelineno-17-20 name=__codelineno-17-20></a><a href=#__codelineno-17-20><span class=linenos data-linenos="20 "></span></a>    JoinType: INNER
</span><span id=__span-17-21><a id=__codelineno-17-21 name=__codelineno-17-21></a><a href=#__codelineno-17-21><span class=linenos data-linenos="21 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-17-22><a id=__codelineno-17-22 name=__codelineno-17-22></a><a href=#__codelineno-17-22><span class=linenos data-linenos="22 "></span></a>*
</span><span id=__span-17-23><a id=__codelineno-17-23 name=__codelineno-17-23></a><a href=#__codelineno-17-23><span class=linenos data-linenos="23 "></span></a>----------------------------------------------------------------------
</span><span id=__span-17-24><a id=__codelineno-17-24 name=__codelineno-17-24></a><a href=#__codelineno-17-24><span class=linenos data-linenos="24 "></span></a>Level 2:
</span><span id=__span-17-25><a id=__codelineno-17-25 name=__codelineno-17-25></a><a href=#__codelineno-17-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-17-26><a id=__codelineno-17-26 name=__codelineno-17-26></a><a href=#__codelineno-17-26><span class=linenos data-linenos="26 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=6;
</span><span id=__span-17-27><a id=__codelineno-17-27 name=__codelineno-17-27></a><a href=#__codelineno-17-27><span class=linenos data-linenos="27 "></span></a>  JoinOperator(id=5)
</span><span id=__span-17-28><a id=__codelineno-17-28 name=__codelineno-17-28></a><a href=#__codelineno-17-28><span class=linenos data-linenos="28 "></span></a>    JoinType: INNER
</span><span id=__span-17-29><a id=__codelineno-17-29 name=__codelineno-17-29></a><a href=#__codelineno-17-29><span class=linenos data-linenos="29 "></span></a>    Joins: JoinPair: Node=c RelOrNode=_anon1 Type=SINK
</span><span id=__span-17-30><a id=__codelineno-17-30 name=__codelineno-17-30></a><a href=#__codelineno-17-30><span class=linenos data-linenos="30 "></span></a>*
</span><span id=__span-17-31><a id=__codelineno-17-31 name=__codelineno-17-31></a><a href=#__codelineno-17-31><span class=linenos data-linenos="31 "></span></a>----------------------------------------------------------------------
</span><span id=__span-17-32><a id=__codelineno-17-32 name=__codelineno-17-32></a><a href=#__codelineno-17-32><span class=linenos data-linenos="32 "></span></a>Level 3:
</span><span id=__span-17-33><a id=__codelineno-17-33 name=__codelineno-17-33></a><a href=#__codelineno-17-33><span class=linenos data-linenos="33 "></span></a>----------------------------------------------------------------------
</span><span id=__span-17-34><a id=__codelineno-17-34 name=__codelineno-17-34></a><a href=#__codelineno-17-34><span class=linenos data-linenos="34 "></span></a>OpId=6 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-17-35><a id=__codelineno-17-35 name=__codelineno-17-35></a><a href=#__codelineno-17-35><span class=linenos data-linenos="35 "></span></a>  ProjectionOperator(id=6)
</span><span id=__span-17-36><a id=__codelineno-17-36 name=__codelineno-17-36></a><a href=#__codelineno-17-36><span class=linenos data-linenos="36 "></span></a>    Projections: city=c.name, population=COUNT(p), avgAge=AVG(p.age), minSalary=MIN(p.salary), maxSalary=MAX(p.salary)
</span><span id=__span-17-37><a id=__codelineno-17-37 name=__codelineno-17-37></a><a href=#__codelineno-17-37><span class=linenos data-linenos="37 "></span></a>*
</span><span id=__span-17-38><a id=__codelineno-17-38 name=__codelineno-17-38></a><a href=#__codelineno-17-38><span class=linenos data-linenos="38 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=7-aggregation-with-order-by-on-aggregated-column>7. Aggregation with ORDER BY on aggregated column<a class=headerlink href=#7-aggregation-with-order-by-on-aggregated-column title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: ORDER BY aggregates</p> <details class=note> <summary>Notes</summary> <p>Orders grouped results by aggregated values.</p> <p>WHY USEFUL: Find top cities, worst performers, outliers.</p> <p>DATABRICKS COMPLEXITY: O(n) aggregate + O(g log g) sort where g = groups COST: Medium. Sort happens after aggregation. TIP: LIMIT reduces sort cost significantly.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1></a><a href=#__codelineno-18-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>LIVES_IN</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>c</span><span class=p>:</span><span class=n>City</span><span class=p>)</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2></a><a href=#__codelineno-18-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>c</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>city</span><span class=p>,</span><span class=w> </span><span class=n>COUNT</span><span class=p>(</span><span class=n>p</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>population</span>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3></a><a href=#__codelineno-18-3><span class=linenos data-linenos="3 "></span></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>population</span><span class=w> </span><span class=k>DESC</span>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4></a><a href=#__codelineno-18-4><span class=linenos data-linenos="4 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=m>10</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1></a><a href=#__codelineno-19-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2></a><a href=#__codelineno-19-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_c_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>city</span>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3></a><a href=#__codelineno-19-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=k>COUNT</span><span class=p>(</span><span class=n>_gsql2rsql_p_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>population</span>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4></a><a href=#__codelineno-19-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5></a><a href=#__codelineno-19-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6></a><a href=#__codelineno-19-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-19-7><a id=__codelineno-19-7 name=__codelineno-19-7></a><a href=#__codelineno-19-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-19-8><a id=__codelineno-19-8 name=__codelineno-19-8></a><a href=#__codelineno-19-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_city_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-19-9><a id=__codelineno-19-9 name=__codelineno-19-9></a><a href=#__codelineno-19-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-19-10><a id=__codelineno-19-10 name=__codelineno-19-10></a><a href=#__codelineno-19-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span><span id=__span-19-11><a id=__codelineno-19-11 name=__codelineno-19-11></a><a href=#__codelineno-19-11><span class=linenos data-linenos="11 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-19-12><a id=__codelineno-19-12 name=__codelineno-19-12></a><a href=#__codelineno-19-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-19-13><a id=__codelineno-19-13 name=__codelineno-19-13></a><a href=#__codelineno-19-13><span class=linenos data-linenos="13 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-19-14><a id=__codelineno-19-14 name=__codelineno-19-14></a><a href=#__codelineno-19-14><span class=linenos data-linenos="14 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-19-15><a id=__codelineno-19-15 name=__codelineno-19-15></a><a href=#__codelineno-19-15><span class=linenos data-linenos="15 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_city_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-19-16><a id=__codelineno-19-16 name=__codelineno-19-16></a><a href=#__codelineno-19-16><span class=linenos data-linenos="16 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-19-17><a id=__codelineno-19-17 name=__codelineno-19-17></a><a href=#__codelineno-19-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-19-18><a id=__codelineno-19-18 name=__codelineno-19-18></a><a href=#__codelineno-19-18><span class=linenos data-linenos="18 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-19-19><a id=__codelineno-19-19 name=__codelineno-19-19></a><a href=#__codelineno-19-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-19-20><a id=__codelineno-19-20 name=__codelineno-19-20></a><a href=#__codelineno-19-20><span class=linenos data-linenos="20 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-19-21><a id=__codelineno-19-21 name=__codelineno-19-21></a><a href=#__codelineno-19-21><span class=linenos data-linenos="21 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-19-22><a id=__codelineno-19-22 name=__codelineno-19-22></a><a href=#__codelineno-19-22><span class=linenos data-linenos="22 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-19-23><a id=__codelineno-19-23 name=__codelineno-19-23></a><a href=#__codelineno-19-23><span class=linenos data-linenos="23 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-19-24><a id=__codelineno-19-24 name=__codelineno-19-24></a><a href=#__codelineno-19-24><span class=linenos data-linenos="24 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-19-25><a id=__codelineno-19-25 name=__codelineno-19-25></a><a href=#__codelineno-19-25><span class=linenos data-linenos="25 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>city_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-19-26><a id=__codelineno-19-26 name=__codelineno-19-26></a><a href=#__codelineno-19-26><span class=linenos data-linenos="26 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-19-27><a id=__codelineno-19-27 name=__codelineno-19-27></a><a href=#__codelineno-19-27><span class=linenos data-linenos="27 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>LivesIn</span>
</span><span id=__span-19-28><a id=__codelineno-19-28 name=__codelineno-19-28></a><a href=#__codelineno-19-28><span class=linenos data-linenos="28 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-19-29><a id=__codelineno-19-29 name=__codelineno-19-29></a><a href=#__codelineno-19-29><span class=linenos data-linenos="29 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-19-30><a id=__codelineno-19-30 name=__codelineno-19-30></a><a href=#__codelineno-19-30><span class=linenos data-linenos="30 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-19-31><a id=__codelineno-19-31 name=__codelineno-19-31></a><a href=#__codelineno-19-31><span class=linenos data-linenos="31 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-19-32><a id=__codelineno-19-32 name=__codelineno-19-32></a><a href=#__codelineno-19-32><span class=linenos data-linenos="32 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-19-33><a id=__codelineno-19-33 name=__codelineno-19-33></a><a href=#__codelineno-19-33><span class=linenos data-linenos="33 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-19-34><a id=__codelineno-19-34 name=__codelineno-19-34></a><a href=#__codelineno-19-34><span class=linenos data-linenos="34 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span><span id=__span-19-35><a id=__codelineno-19-35 name=__codelineno-19-35></a><a href=#__codelineno-19-35><span class=linenos data-linenos="35 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-19-36><a id=__codelineno-19-36 name=__codelineno-19-36></a><a href=#__codelineno-19-36><span class=linenos data-linenos="36 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>City</span>
</span><span id=__span-19-37><a id=__codelineno-19-37 name=__codelineno-19-37></a><a href=#__codelineno-19-37><span class=linenos data-linenos="37 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-19-38><a id=__codelineno-19-38 name=__codelineno-19-38></a><a href=#__codelineno-19-38><span class=linenos data-linenos="38 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-19-39><a id=__codelineno-19-39 name=__codelineno-19-39></a><a href=#__codelineno-19-39><span class=linenos data-linenos="39 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-19-40><a id=__codelineno-19-40 name=__codelineno-19-40></a><a href=#__codelineno-19-40><span class=linenos data-linenos="40 "></span></a><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span><span id=__span-19-41><a id=__codelineno-19-41 name=__codelineno-19-41></a><a href=#__codelineno-19-41><span class=linenos data-linenos="41 "></span></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>population</span><span class=w> </span><span class=k>DESC</span>
</span><span id=__span-19-42><a id=__codelineno-19-42 name=__codelineno-19-42></a><a href=#__codelineno-19-42><span class=linenos data-linenos="42 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=mi>10</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1></a><a href=#__codelineno-20-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2></a><a href=#__codelineno-20-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3></a><a href=#__codelineno-20-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4></a><a href=#__codelineno-20-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5></a><a href=#__codelineno-20-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-20-6><a id=__codelineno-20-6 name=__codelineno-20-6></a><a href=#__codelineno-20-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-20-7><a id=__codelineno-20-7 name=__codelineno-20-7></a><a href=#__codelineno-20-7><span class=linenos data-linenos=" 7 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-20-8><a id=__codelineno-20-8 name=__codelineno-20-8></a><a href=#__codelineno-20-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-20-9><a id=__codelineno-20-9 name=__codelineno-20-9></a><a href=#__codelineno-20-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: [_anon1:LIVES_IN]-&gt;
</span><span id=__span-20-10><a id=__codelineno-20-10 name=__codelineno-20-10></a><a href=#__codelineno-20-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-20-11><a id=__codelineno-20-11 name=__codelineno-20-11></a><a href=#__codelineno-20-11><span class=linenos data-linenos="11 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-20-12><a id=__codelineno-20-12 name=__codelineno-20-12></a><a href=#__codelineno-20-12><span class=linenos data-linenos="12 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-20-13><a id=__codelineno-20-13 name=__codelineno-20-13></a><a href=#__codelineno-20-13><span class=linenos data-linenos="13 "></span></a>    DataSource: c:City
</span><span id=__span-20-14><a id=__codelineno-20-14 name=__codelineno-20-14></a><a href=#__codelineno-20-14><span class=linenos data-linenos="14 "></span></a>*
</span><span id=__span-20-15><a id=__codelineno-20-15 name=__codelineno-20-15></a><a href=#__codelineno-20-15><span class=linenos data-linenos="15 "></span></a>----------------------------------------------------------------------
</span><span id=__span-20-16><a id=__codelineno-20-16 name=__codelineno-20-16></a><a href=#__codelineno-20-16><span class=linenos data-linenos="16 "></span></a>Level 1:
</span><span id=__span-20-17><a id=__codelineno-20-17 name=__codelineno-20-17></a><a href=#__codelineno-20-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-20-18><a id=__codelineno-20-18 name=__codelineno-20-18></a><a href=#__codelineno-20-18><span class=linenos data-linenos="18 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-20-19><a id=__codelineno-20-19 name=__codelineno-20-19></a><a href=#__codelineno-20-19><span class=linenos data-linenos="19 "></span></a>  JoinOperator(id=4)
</span><span id=__span-20-20><a id=__codelineno-20-20 name=__codelineno-20-20></a><a href=#__codelineno-20-20><span class=linenos data-linenos="20 "></span></a>    JoinType: INNER
</span><span id=__span-20-21><a id=__codelineno-20-21 name=__codelineno-20-21></a><a href=#__codelineno-20-21><span class=linenos data-linenos="21 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-20-22><a id=__codelineno-20-22 name=__codelineno-20-22></a><a href=#__codelineno-20-22><span class=linenos data-linenos="22 "></span></a>*
</span><span id=__span-20-23><a id=__codelineno-20-23 name=__codelineno-20-23></a><a href=#__codelineno-20-23><span class=linenos data-linenos="23 "></span></a>----------------------------------------------------------------------
</span><span id=__span-20-24><a id=__codelineno-20-24 name=__codelineno-20-24></a><a href=#__codelineno-20-24><span class=linenos data-linenos="24 "></span></a>Level 2:
</span><span id=__span-20-25><a id=__codelineno-20-25 name=__codelineno-20-25></a><a href=#__codelineno-20-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-20-26><a id=__codelineno-20-26 name=__codelineno-20-26></a><a href=#__codelineno-20-26><span class=linenos data-linenos="26 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=6;
</span><span id=__span-20-27><a id=__codelineno-20-27 name=__codelineno-20-27></a><a href=#__codelineno-20-27><span class=linenos data-linenos="27 "></span></a>  JoinOperator(id=5)
</span><span id=__span-20-28><a id=__codelineno-20-28 name=__codelineno-20-28></a><a href=#__codelineno-20-28><span class=linenos data-linenos="28 "></span></a>    JoinType: INNER
</span><span id=__span-20-29><a id=__codelineno-20-29 name=__codelineno-20-29></a><a href=#__codelineno-20-29><span class=linenos data-linenos="29 "></span></a>    Joins: JoinPair: Node=c RelOrNode=_anon1 Type=SINK
</span><span id=__span-20-30><a id=__codelineno-20-30 name=__codelineno-20-30></a><a href=#__codelineno-20-30><span class=linenos data-linenos="30 "></span></a>*
</span><span id=__span-20-31><a id=__codelineno-20-31 name=__codelineno-20-31></a><a href=#__codelineno-20-31><span class=linenos data-linenos="31 "></span></a>----------------------------------------------------------------------
</span><span id=__span-20-32><a id=__codelineno-20-32 name=__codelineno-20-32></a><a href=#__codelineno-20-32><span class=linenos data-linenos="32 "></span></a>Level 3:
</span><span id=__span-20-33><a id=__codelineno-20-33 name=__codelineno-20-33></a><a href=#__codelineno-20-33><span class=linenos data-linenos="33 "></span></a>----------------------------------------------------------------------
</span><span id=__span-20-34><a id=__codelineno-20-34 name=__codelineno-20-34></a><a href=#__codelineno-20-34><span class=linenos data-linenos="34 "></span></a>OpId=6 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-20-35><a id=__codelineno-20-35 name=__codelineno-20-35></a><a href=#__codelineno-20-35><span class=linenos data-linenos="35 "></span></a>  ProjectionOperator(id=6)
</span><span id=__span-20-36><a id=__codelineno-20-36 name=__codelineno-20-36></a><a href=#__codelineno-20-36><span class=linenos data-linenos="36 "></span></a>    Projections: city=c.name, population=COUNT(p)
</span><span id=__span-20-37><a id=__codelineno-20-37 name=__codelineno-20-37></a><a href=#__codelineno-20-37><span class=linenos data-linenos="37 "></span></a>*
</span><span id=__span-20-38><a id=__codelineno-20-38 name=__codelineno-20-38></a><a href=#__codelineno-20-38><span class=linenos data-linenos="38 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=8-having-style-filter-using-withwhere>8. HAVING-style filter using WITH...WHERE<a class=headerlink href=#8-having-style-filter-using-withwhere title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: HAVING filter</p> <details class=note> <summary>Notes</summary> <p>Filters aggregated results (SQL HAVING equivalent).</p> <p>WHY USEFUL: Filter groups by computed values. Find "cities with &gt; 1000 people".</p> <p>DATABRICKS COMPLEXITY: O(n) aggregate + O(g) filter COST: Low. Filter applied after aggregation, before final output. Pattern: WITH creates intermediate result, WHERE filters it.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1></a><a href=#__codelineno-21-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>LIVES_IN</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>c</span><span class=p>:</span><span class=n>City</span><span class=p>)</span>
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2></a><a href=#__codelineno-21-2><span class=linenos data-linenos="2 "></span></a><span class=k>WITH</span><span class=w> </span><span class=n>c</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>city</span><span class=p>,</span><span class=w> </span><span class=n>COUNT</span><span class=p>(</span><span class=n>p</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>population</span>
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3></a><a href=#__codelineno-21-3><span class=linenos data-linenos="3 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>population</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>1000</span>
</span><span id=__span-21-4><a id=__codelineno-21-4 name=__codelineno-21-4></a><a href=#__codelineno-21-4><span class=linenos data-linenos="4 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>city</span><span class=p>,</span><span class=w> </span><span class=n>population</span>
</span><span id=__span-21-5><a id=__codelineno-21-5 name=__codelineno-21-5></a><a href=#__codelineno-21-5><span class=linenos data-linenos="5 "></span></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>population</span><span class=w> </span><span class=k>DESC</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1></a><a href=#__codelineno-22-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2></a><a href=#__codelineno-22-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>city</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>city</span>
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3></a><a href=#__codelineno-22-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>population</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>population</span>
</span><span id=__span-22-4><a id=__codelineno-22-4 name=__codelineno-22-4></a><a href=#__codelineno-22-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-22-5><a id=__codelineno-22-5 name=__codelineno-22-5></a><a href=#__codelineno-22-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-22-6><a id=__codelineno-22-6 name=__codelineno-22-6></a><a href=#__codelineno-22-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>_gsql2rsql_c_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>city</span>
</span><span id=__span-22-7><a id=__codelineno-22-7 name=__codelineno-22-7></a><a href=#__codelineno-22-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>COUNT</span><span class=p>(</span><span class=n>_gsql2rsql_p_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>population</span>
</span><span id=__span-22-8><a id=__codelineno-22-8 name=__codelineno-22-8></a><a href=#__codelineno-22-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-22-9><a id=__codelineno-22-9 name=__codelineno-22-9></a><a href=#__codelineno-22-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-22-10><a id=__codelineno-22-10 name=__codelineno-22-10></a><a href=#__codelineno-22-10><span class=linenos data-linenos="10 "></span></a><span class=w>       </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-22-11><a id=__codelineno-22-11 name=__codelineno-22-11></a><a href=#__codelineno-22-11><span class=linenos data-linenos="11 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-22-12><a id=__codelineno-22-12 name=__codelineno-22-12></a><a href=#__codelineno-22-12><span class=linenos data-linenos="12 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_city_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-22-13><a id=__codelineno-22-13 name=__codelineno-22-13></a><a href=#__codelineno-22-13><span class=linenos data-linenos="13 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-22-14><a id=__codelineno-22-14 name=__codelineno-22-14></a><a href=#__codelineno-22-14><span class=linenos data-linenos="14 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span><span id=__span-22-15><a id=__codelineno-22-15 name=__codelineno-22-15></a><a href=#__codelineno-22-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-22-16><a id=__codelineno-22-16 name=__codelineno-22-16></a><a href=#__codelineno-22-16><span class=linenos data-linenos="16 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-22-17><a id=__codelineno-22-17 name=__codelineno-22-17></a><a href=#__codelineno-22-17><span class=linenos data-linenos="17 "></span></a><span class=w>         </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-22-18><a id=__codelineno-22-18 name=__codelineno-22-18></a><a href=#__codelineno-22-18><span class=linenos data-linenos="18 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-22-19><a id=__codelineno-22-19 name=__codelineno-22-19></a><a href=#__codelineno-22-19><span class=linenos data-linenos="19 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_city_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-22-20><a id=__codelineno-22-20 name=__codelineno-22-20></a><a href=#__codelineno-22-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-22-21><a id=__codelineno-22-21 name=__codelineno-22-21></a><a href=#__codelineno-22-21><span class=linenos data-linenos="21 "></span></a><span class=w>        </span><span class=k>SELECT</span>
</span><span id=__span-22-22><a id=__codelineno-22-22 name=__codelineno-22-22></a><a href=#__codelineno-22-22><span class=linenos data-linenos="22 "></span></a><span class=w>           </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-22-23><a id=__codelineno-22-23 name=__codelineno-22-23></a><a href=#__codelineno-22-23><span class=linenos data-linenos="23 "></span></a><span class=w>        </span><span class=k>FROM</span>
</span><span id=__span-22-24><a id=__codelineno-22-24 name=__codelineno-22-24></a><a href=#__codelineno-22-24><span class=linenos data-linenos="24 "></span></a><span class=w>          </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-22-25><a id=__codelineno-22-25 name=__codelineno-22-25></a><a href=#__codelineno-22-25><span class=linenos data-linenos="25 "></span></a><span class=w>      </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-22-26><a id=__codelineno-22-26 name=__codelineno-22-26></a><a href=#__codelineno-22-26><span class=linenos data-linenos="26 "></span></a><span class=w>      </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-22-27><a id=__codelineno-22-27 name=__codelineno-22-27></a><a href=#__codelineno-22-27><span class=linenos data-linenos="27 "></span></a><span class=w>        </span><span class=k>SELECT</span>
</span><span id=__span-22-28><a id=__codelineno-22-28 name=__codelineno-22-28></a><a href=#__codelineno-22-28><span class=linenos data-linenos="28 "></span></a><span class=w>           </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-22-29><a id=__codelineno-22-29 name=__codelineno-22-29></a><a href=#__codelineno-22-29><span class=linenos data-linenos="29 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>city_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-22-30><a id=__codelineno-22-30 name=__codelineno-22-30></a><a href=#__codelineno-22-30><span class=linenos data-linenos="30 "></span></a><span class=w>        </span><span class=k>FROM</span>
</span><span id=__span-22-31><a id=__codelineno-22-31 name=__codelineno-22-31></a><a href=#__codelineno-22-31><span class=linenos data-linenos="31 "></span></a><span class=w>          </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>LivesIn</span>
</span><span id=__span-22-32><a id=__codelineno-22-32 name=__codelineno-22-32></a><a href=#__codelineno-22-32><span class=linenos data-linenos="32 "></span></a><span class=w>      </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-22-33><a id=__codelineno-22-33 name=__codelineno-22-33></a><a href=#__codelineno-22-33><span class=linenos data-linenos="33 "></span></a><span class=w>        </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-22-34><a id=__codelineno-22-34 name=__codelineno-22-34></a><a href=#__codelineno-22-34><span class=linenos data-linenos="34 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-22-35><a id=__codelineno-22-35 name=__codelineno-22-35></a><a href=#__codelineno-22-35><span class=linenos data-linenos="35 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-22-36><a id=__codelineno-22-36 name=__codelineno-22-36></a><a href=#__codelineno-22-36><span class=linenos data-linenos="36 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-22-37><a id=__codelineno-22-37 name=__codelineno-22-37></a><a href=#__codelineno-22-37><span class=linenos data-linenos="37 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-22-38><a id=__codelineno-22-38 name=__codelineno-22-38></a><a href=#__codelineno-22-38><span class=linenos data-linenos="38 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span><span id=__span-22-39><a id=__codelineno-22-39 name=__codelineno-22-39></a><a href=#__codelineno-22-39><span class=linenos data-linenos="39 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-22-40><a id=__codelineno-22-40 name=__codelineno-22-40></a><a href=#__codelineno-22-40><span class=linenos data-linenos="40 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>City</span>
</span><span id=__span-22-41><a id=__codelineno-22-41 name=__codelineno-22-41></a><a href=#__codelineno-22-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-22-42><a id=__codelineno-22-42 name=__codelineno-22-42></a><a href=#__codelineno-22-42><span class=linenos data-linenos="42 "></span></a><span class=w>      </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-22-43><a id=__codelineno-22-43 name=__codelineno-22-43></a><a href=#__codelineno-22-43><span class=linenos data-linenos="43 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-22-44><a id=__codelineno-22-44 name=__codelineno-22-44></a><a href=#__codelineno-22-44><span class=linenos data-linenos="44 "></span></a><span class=w>  </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span><span id=__span-22-45><a id=__codelineno-22-45 name=__codelineno-22-45></a><a href=#__codelineno-22-45><span class=linenos data-linenos="45 "></span></a><span class=w>  </span><span class=k>HAVING</span><span class=w> </span><span class=p>(</span><span class=n>population</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>1000</span><span class=p>)</span>
</span><span id=__span-22-46><a id=__codelineno-22-46 name=__codelineno-22-46></a><a href=#__codelineno-22-46><span class=linenos data-linenos="46 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-22-47><a id=__codelineno-22-47 name=__codelineno-22-47></a><a href=#__codelineno-22-47><span class=linenos data-linenos="47 "></span></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>population</span><span class=w> </span><span class=k>DESC</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1></a><a href=#__codelineno-23-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2></a><a href=#__codelineno-23-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3></a><a href=#__codelineno-23-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4></a><a href=#__codelineno-23-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5></a><a href=#__codelineno-23-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-23-6><a id=__codelineno-23-6 name=__codelineno-23-6></a><a href=#__codelineno-23-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-23-7><a id=__codelineno-23-7 name=__codelineno-23-7></a><a href=#__codelineno-23-7><span class=linenos data-linenos=" 7 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-23-8><a id=__codelineno-23-8 name=__codelineno-23-8></a><a href=#__codelineno-23-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-23-9><a id=__codelineno-23-9 name=__codelineno-23-9></a><a href=#__codelineno-23-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: [_anon1:LIVES_IN]-&gt;
</span><span id=__span-23-10><a id=__codelineno-23-10 name=__codelineno-23-10></a><a href=#__codelineno-23-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-23-11><a id=__codelineno-23-11 name=__codelineno-23-11></a><a href=#__codelineno-23-11><span class=linenos data-linenos="11 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-23-12><a id=__codelineno-23-12 name=__codelineno-23-12></a><a href=#__codelineno-23-12><span class=linenos data-linenos="12 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-23-13><a id=__codelineno-23-13 name=__codelineno-23-13></a><a href=#__codelineno-23-13><span class=linenos data-linenos="13 "></span></a>    DataSource: c:City
</span><span id=__span-23-14><a id=__codelineno-23-14 name=__codelineno-23-14></a><a href=#__codelineno-23-14><span class=linenos data-linenos="14 "></span></a>*
</span><span id=__span-23-15><a id=__codelineno-23-15 name=__codelineno-23-15></a><a href=#__codelineno-23-15><span class=linenos data-linenos="15 "></span></a>----------------------------------------------------------------------
</span><span id=__span-23-16><a id=__codelineno-23-16 name=__codelineno-23-16></a><a href=#__codelineno-23-16><span class=linenos data-linenos="16 "></span></a>Level 1:
</span><span id=__span-23-17><a id=__codelineno-23-17 name=__codelineno-23-17></a><a href=#__codelineno-23-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-23-18><a id=__codelineno-23-18 name=__codelineno-23-18></a><a href=#__codelineno-23-18><span class=linenos data-linenos="18 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-23-19><a id=__codelineno-23-19 name=__codelineno-23-19></a><a href=#__codelineno-23-19><span class=linenos data-linenos="19 "></span></a>  JoinOperator(id=4)
</span><span id=__span-23-20><a id=__codelineno-23-20 name=__codelineno-23-20></a><a href=#__codelineno-23-20><span class=linenos data-linenos="20 "></span></a>    JoinType: INNER
</span><span id=__span-23-21><a id=__codelineno-23-21 name=__codelineno-23-21></a><a href=#__codelineno-23-21><span class=linenos data-linenos="21 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-23-22><a id=__codelineno-23-22 name=__codelineno-23-22></a><a href=#__codelineno-23-22><span class=linenos data-linenos="22 "></span></a>*
</span><span id=__span-23-23><a id=__codelineno-23-23 name=__codelineno-23-23></a><a href=#__codelineno-23-23><span class=linenos data-linenos="23 "></span></a>----------------------------------------------------------------------
</span><span id=__span-23-24><a id=__codelineno-23-24 name=__codelineno-23-24></a><a href=#__codelineno-23-24><span class=linenos data-linenos="24 "></span></a>Level 2:
</span><span id=__span-23-25><a id=__codelineno-23-25 name=__codelineno-23-25></a><a href=#__codelineno-23-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-23-26><a id=__codelineno-23-26 name=__codelineno-23-26></a><a href=#__codelineno-23-26><span class=linenos data-linenos="26 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=6;
</span><span id=__span-23-27><a id=__codelineno-23-27 name=__codelineno-23-27></a><a href=#__codelineno-23-27><span class=linenos data-linenos="27 "></span></a>  JoinOperator(id=5)
</span><span id=__span-23-28><a id=__codelineno-23-28 name=__codelineno-23-28></a><a href=#__codelineno-23-28><span class=linenos data-linenos="28 "></span></a>    JoinType: INNER
</span><span id=__span-23-29><a id=__codelineno-23-29 name=__codelineno-23-29></a><a href=#__codelineno-23-29><span class=linenos data-linenos="29 "></span></a>    Joins: JoinPair: Node=c RelOrNode=_anon1 Type=SINK
</span><span id=__span-23-30><a id=__codelineno-23-30 name=__codelineno-23-30></a><a href=#__codelineno-23-30><span class=linenos data-linenos="30 "></span></a>*
</span><span id=__span-23-31><a id=__codelineno-23-31 name=__codelineno-23-31></a><a href=#__codelineno-23-31><span class=linenos data-linenos="31 "></span></a>----------------------------------------------------------------------
</span><span id=__span-23-32><a id=__codelineno-23-32 name=__codelineno-23-32></a><a href=#__codelineno-23-32><span class=linenos data-linenos="32 "></span></a>Level 3:
</span><span id=__span-23-33><a id=__codelineno-23-33 name=__codelineno-23-33></a><a href=#__codelineno-23-33><span class=linenos data-linenos="33 "></span></a>----------------------------------------------------------------------
</span><span id=__span-23-34><a id=__codelineno-23-34 name=__codelineno-23-34></a><a href=#__codelineno-23-34><span class=linenos data-linenos="34 "></span></a>OpId=6 Op=ProjectionOperator; InOpIds=5; OutOpIds=7;
</span><span id=__span-23-35><a id=__codelineno-23-35 name=__codelineno-23-35></a><a href=#__codelineno-23-35><span class=linenos data-linenos="35 "></span></a>  ProjectionOperator(id=6)
</span><span id=__span-23-36><a id=__codelineno-23-36 name=__codelineno-23-36></a><a href=#__codelineno-23-36><span class=linenos data-linenos="36 "></span></a>    Projections: city=c.name, population=COUNT(p)
</span><span id=__span-23-37><a id=__codelineno-23-37 name=__codelineno-23-37></a><a href=#__codelineno-23-37><span class=linenos data-linenos="37 "></span></a>    Having: (population GT 1000)
</span><span id=__span-23-38><a id=__codelineno-23-38 name=__codelineno-23-38></a><a href=#__codelineno-23-38><span class=linenos data-linenos="38 "></span></a>*
</span><span id=__span-23-39><a id=__codelineno-23-39 name=__codelineno-23-39></a><a href=#__codelineno-23-39><span class=linenos data-linenos="39 "></span></a>----------------------------------------------------------------------
</span><span id=__span-23-40><a id=__codelineno-23-40 name=__codelineno-23-40></a><a href=#__codelineno-23-40><span class=linenos data-linenos="40 "></span></a>Level 4:
</span><span id=__span-23-41><a id=__codelineno-23-41 name=__codelineno-23-41></a><a href=#__codelineno-23-41><span class=linenos data-linenos="41 "></span></a>----------------------------------------------------------------------
</span><span id=__span-23-42><a id=__codelineno-23-42 name=__codelineno-23-42></a><a href=#__codelineno-23-42><span class=linenos data-linenos="42 "></span></a>OpId=7 Op=ProjectionOperator; InOpIds=6; OutOpIds=;
</span><span id=__span-23-43><a id=__codelineno-23-43 name=__codelineno-23-43></a><a href=#__codelineno-23-43><span class=linenos data-linenos="43 "></span></a>  ProjectionOperator(id=7)
</span><span id=__span-23-44><a id=__codelineno-23-44 name=__codelineno-23-44></a><a href=#__codelineno-23-44><span class=linenos data-linenos="44 "></span></a>    Projections: city=city, population=population
</span><span id=__span-23-45><a id=__codelineno-23-45 name=__codelineno-23-45></a><a href=#__codelineno-23-45><span class=linenos data-linenos="45 "></span></a>*
</span><span id=__span-23-46><a id=__codelineno-23-46 name=__codelineno-23-46></a><a href=#__codelineno-23-46><span class=linenos data-linenos="46 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=9-collect-aggregation-into-arrays>9. COLLECT aggregation into arrays<a class=headerlink href=#9-collect-aggregation-into-arrays title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: COLLECT_LIST</p> <details class=note> <summary>Notes</summary> <p>Collects values into an array per group.</p> <p>WHY USEFUL: Denormalize data, create nested structures for JSON APIs.</p> <p>DATABRICKS COMPLEXITY: O(n) - single pass COST: Medium-High. Memory for array construction. Maps to COLLECT_LIST() in Databricks SQL. WARNING: Large arrays can cause OOM. Consider LIMIT inside COLLECT.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1></a><a href=#__codelineno-24-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>c</span><span class=p>:</span><span class=n>City</span><span class=p>)</span><span class=o>&lt;-[</span><span class=p>:</span><span class=n>LIVES_IN</span><span class=o>]-</span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2></a><a href=#__codelineno-24-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>c</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>city</span><span class=p>,</span><span class=w> </span><span class=k>COLLECT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>residents</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1></a><a href=#__codelineno-25-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2></a><a href=#__codelineno-25-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_c_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>city</span>
</span><span id=__span-25-3><a id=__codelineno-25-3 name=__codelineno-25-3></a><a href=#__codelineno-25-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>COLLECT_LIST</span><span class=p>(</span><span class=n>_gsql2rsql_p_name</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>residents</span>
</span><span id=__span-25-4><a id=__codelineno-25-4 name=__codelineno-25-4></a><a href=#__codelineno-25-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-25-5><a id=__codelineno-25-5 name=__codelineno-25-5></a><a href=#__codelineno-25-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-25-6><a id=__codelineno-25-6 name=__codelineno-25-6></a><a href=#__codelineno-25-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-25-7><a id=__codelineno-25-7 name=__codelineno-25-7></a><a href=#__codelineno-25-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span><span id=__span-25-8><a id=__codelineno-25-8 name=__codelineno-25-8></a><a href=#__codelineno-25-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-25-9><a id=__codelineno-25-9 name=__codelineno-25-9></a><a href=#__codelineno-25-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_city_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-25-10><a id=__codelineno-25-10 name=__codelineno-25-10></a><a href=#__codelineno-25-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-25-11><a id=__codelineno-25-11 name=__codelineno-25-11></a><a href=#__codelineno-25-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-25-12><a id=__codelineno-25-12 name=__codelineno-25-12></a><a href=#__codelineno-25-12><span class=linenos data-linenos="12 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-25-13><a id=__codelineno-25-13 name=__codelineno-25-13></a><a href=#__codelineno-25-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-25-14><a id=__codelineno-25-14 name=__codelineno-25-14></a><a href=#__codelineno-25-14><span class=linenos data-linenos="14 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-25-15><a id=__codelineno-25-15 name=__codelineno-25-15></a><a href=#__codelineno-25-15><span class=linenos data-linenos="15 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_c_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span><span id=__span-25-16><a id=__codelineno-25-16 name=__codelineno-25-16></a><a href=#__codelineno-25-16><span class=linenos data-linenos="16 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-25-17><a id=__codelineno-25-17 name=__codelineno-25-17></a><a href=#__codelineno-25-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_city_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-25-18><a id=__codelineno-25-18 name=__codelineno-25-18></a><a href=#__codelineno-25-18><span class=linenos data-linenos="18 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-25-19><a id=__codelineno-25-19 name=__codelineno-25-19></a><a href=#__codelineno-25-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-25-20><a id=__codelineno-25-20 name=__codelineno-25-20></a><a href=#__codelineno-25-20><span class=linenos data-linenos="20 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-25-21><a id=__codelineno-25-21 name=__codelineno-25-21></a><a href=#__codelineno-25-21><span class=linenos data-linenos="21 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span><span id=__span-25-22><a id=__codelineno-25-22 name=__codelineno-25-22></a><a href=#__codelineno-25-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-25-23><a id=__codelineno-25-23 name=__codelineno-25-23></a><a href=#__codelineno-25-23><span class=linenos data-linenos="23 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>City</span>
</span><span id=__span-25-24><a id=__codelineno-25-24 name=__codelineno-25-24></a><a href=#__codelineno-25-24><span class=linenos data-linenos="24 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-25-25><a id=__codelineno-25-25 name=__codelineno-25-25></a><a href=#__codelineno-25-25><span class=linenos data-linenos="25 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-25-26><a id=__codelineno-25-26 name=__codelineno-25-26></a><a href=#__codelineno-25-26><span class=linenos data-linenos="26 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-25-27><a id=__codelineno-25-27 name=__codelineno-25-27></a><a href=#__codelineno-25-27><span class=linenos data-linenos="27 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-25-28><a id=__codelineno-25-28 name=__codelineno-25-28></a><a href=#__codelineno-25-28><span class=linenos data-linenos="28 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>city_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-25-29><a id=__codelineno-25-29 name=__codelineno-25-29></a><a href=#__codelineno-25-29><span class=linenos data-linenos="29 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-25-30><a id=__codelineno-25-30 name=__codelineno-25-30></a><a href=#__codelineno-25-30><span class=linenos data-linenos="30 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>LivesIn</span>
</span><span id=__span-25-31><a id=__codelineno-25-31 name=__codelineno-25-31></a><a href=#__codelineno-25-31><span class=linenos data-linenos="31 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-25-32><a id=__codelineno-25-32 name=__codelineno-25-32></a><a href=#__codelineno-25-32><span class=linenos data-linenos="32 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-25-33><a id=__codelineno-25-33 name=__codelineno-25-33></a><a href=#__codelineno-25-33><span class=linenos data-linenos="33 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-25-34><a id=__codelineno-25-34 name=__codelineno-25-34></a><a href=#__codelineno-25-34><span class=linenos data-linenos="34 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-25-35><a id=__codelineno-25-35 name=__codelineno-25-35></a><a href=#__codelineno-25-35><span class=linenos data-linenos="35 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-25-36><a id=__codelineno-25-36 name=__codelineno-25-36></a><a href=#__codelineno-25-36><span class=linenos data-linenos="36 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-25-37><a id=__codelineno-25-37 name=__codelineno-25-37></a><a href=#__codelineno-25-37><span class=linenos data-linenos="37 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-25-38><a id=__codelineno-25-38 name=__codelineno-25-38></a><a href=#__codelineno-25-38><span class=linenos data-linenos="38 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-25-39><a id=__codelineno-25-39 name=__codelineno-25-39></a><a href=#__codelineno-25-39><span class=linenos data-linenos="39 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-25-40><a id=__codelineno-25-40 name=__codelineno-25-40></a><a href=#__codelineno-25-40><span class=linenos data-linenos="40 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-25-41><a id=__codelineno-25-41 name=__codelineno-25-41></a><a href=#__codelineno-25-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-25-42><a id=__codelineno-25-42 name=__codelineno-25-42></a><a href=#__codelineno-25-42><span class=linenos data-linenos="42 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-25-43><a id=__codelineno-25-43 name=__codelineno-25-43></a><a href=#__codelineno-25-43><span class=linenos data-linenos="43 "></span></a><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1></a><a href=#__codelineno-26-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2></a><a href=#__codelineno-26-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3></a><a href=#__codelineno-26-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4></a><a href=#__codelineno-26-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-26-5><a id=__codelineno-26-5 name=__codelineno-26-5></a><a href=#__codelineno-26-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: c:City
</span><span id=__span-26-6><a id=__codelineno-26-6 name=__codelineno-26-6></a><a href=#__codelineno-26-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-26-7><a id=__codelineno-26-7 name=__codelineno-26-7></a><a href=#__codelineno-26-7><span class=linenos data-linenos=" 7 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-26-8><a id=__codelineno-26-8 name=__codelineno-26-8></a><a href=#__codelineno-26-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-26-9><a id=__codelineno-26-9 name=__codelineno-26-9></a><a href=#__codelineno-26-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: [_anon1:LIVES_IN]&lt;-
</span><span id=__span-26-10><a id=__codelineno-26-10 name=__codelineno-26-10></a><a href=#__codelineno-26-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-26-11><a id=__codelineno-26-11 name=__codelineno-26-11></a><a href=#__codelineno-26-11><span class=linenos data-linenos="11 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-26-12><a id=__codelineno-26-12 name=__codelineno-26-12></a><a href=#__codelineno-26-12><span class=linenos data-linenos="12 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-26-13><a id=__codelineno-26-13 name=__codelineno-26-13></a><a href=#__codelineno-26-13><span class=linenos data-linenos="13 "></span></a>    DataSource: p:Person
</span><span id=__span-26-14><a id=__codelineno-26-14 name=__codelineno-26-14></a><a href=#__codelineno-26-14><span class=linenos data-linenos="14 "></span></a>*
</span><span id=__span-26-15><a id=__codelineno-26-15 name=__codelineno-26-15></a><a href=#__codelineno-26-15><span class=linenos data-linenos="15 "></span></a>----------------------------------------------------------------------
</span><span id=__span-26-16><a id=__codelineno-26-16 name=__codelineno-26-16></a><a href=#__codelineno-26-16><span class=linenos data-linenos="16 "></span></a>Level 1:
</span><span id=__span-26-17><a id=__codelineno-26-17 name=__codelineno-26-17></a><a href=#__codelineno-26-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-26-18><a id=__codelineno-26-18 name=__codelineno-26-18></a><a href=#__codelineno-26-18><span class=linenos data-linenos="18 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-26-19><a id=__codelineno-26-19 name=__codelineno-26-19></a><a href=#__codelineno-26-19><span class=linenos data-linenos="19 "></span></a>  JoinOperator(id=4)
</span><span id=__span-26-20><a id=__codelineno-26-20 name=__codelineno-26-20></a><a href=#__codelineno-26-20><span class=linenos data-linenos="20 "></span></a>    JoinType: INNER
</span><span id=__span-26-21><a id=__codelineno-26-21 name=__codelineno-26-21></a><a href=#__codelineno-26-21><span class=linenos data-linenos="21 "></span></a>    Joins: JoinPair: Node=c RelOrNode=_anon1 Type=SINK
</span><span id=__span-26-22><a id=__codelineno-26-22 name=__codelineno-26-22></a><a href=#__codelineno-26-22><span class=linenos data-linenos="22 "></span></a>*
</span><span id=__span-26-23><a id=__codelineno-26-23 name=__codelineno-26-23></a><a href=#__codelineno-26-23><span class=linenos data-linenos="23 "></span></a>----------------------------------------------------------------------
</span><span id=__span-26-24><a id=__codelineno-26-24 name=__codelineno-26-24></a><a href=#__codelineno-26-24><span class=linenos data-linenos="24 "></span></a>Level 2:
</span><span id=__span-26-25><a id=__codelineno-26-25 name=__codelineno-26-25></a><a href=#__codelineno-26-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-26-26><a id=__codelineno-26-26 name=__codelineno-26-26></a><a href=#__codelineno-26-26><span class=linenos data-linenos="26 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=6;
</span><span id=__span-26-27><a id=__codelineno-26-27 name=__codelineno-26-27></a><a href=#__codelineno-26-27><span class=linenos data-linenos="27 "></span></a>  JoinOperator(id=5)
</span><span id=__span-26-28><a id=__codelineno-26-28 name=__codelineno-26-28></a><a href=#__codelineno-26-28><span class=linenos data-linenos="28 "></span></a>    JoinType: INNER
</span><span id=__span-26-29><a id=__codelineno-26-29 name=__codelineno-26-29></a><a href=#__codelineno-26-29><span class=linenos data-linenos="29 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-26-30><a id=__codelineno-26-30 name=__codelineno-26-30></a><a href=#__codelineno-26-30><span class=linenos data-linenos="30 "></span></a>*
</span><span id=__span-26-31><a id=__codelineno-26-31 name=__codelineno-26-31></a><a href=#__codelineno-26-31><span class=linenos data-linenos="31 "></span></a>----------------------------------------------------------------------
</span><span id=__span-26-32><a id=__codelineno-26-32 name=__codelineno-26-32></a><a href=#__codelineno-26-32><span class=linenos data-linenos="32 "></span></a>Level 3:
</span><span id=__span-26-33><a id=__codelineno-26-33 name=__codelineno-26-33></a><a href=#__codelineno-26-33><span class=linenos data-linenos="33 "></span></a>----------------------------------------------------------------------
</span><span id=__span-26-34><a id=__codelineno-26-34 name=__codelineno-26-34></a><a href=#__codelineno-26-34><span class=linenos data-linenos="34 "></span></a>OpId=6 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-26-35><a id=__codelineno-26-35 name=__codelineno-26-35></a><a href=#__codelineno-26-35><span class=linenos data-linenos="35 "></span></a>  ProjectionOperator(id=6)
</span><span id=__span-26-36><a id=__codelineno-26-36 name=__codelineno-26-36></a><a href=#__codelineno-26-36><span class=linenos data-linenos="36 "></span></a>    Projections: city=c.name, residents=COLLECT(p.name)
</span><span id=__span-26-37><a id=__codelineno-26-37 name=__codelineno-26-37></a><a href=#__codelineno-26-37><span class=linenos data-linenos="37 "></span></a>*
</span><span id=__span-26-38><a id=__codelineno-26-38 name=__codelineno-26-38></a><a href=#__codelineno-26-38><span class=linenos data-linenos="38 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=10-directed-relationship-traversal>10. Directed relationship traversal<a class=headerlink href=#10-directed-relationship-traversal title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Directed edges</p> <details class=note> <summary>Notes</summary> <p>Matches directed relationships from source to target.</p> <p>WHY USEFUL: Traverse graph edges in specific direction.</p> <p>DATABRICKS COMPLEXITY: O(n * m) worst case, O(n + e) with proper joins COST: Medium. Translates to INNER JOIN. TIP: Ensure foreign keys have indexes/Z-ORDER.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1></a><a href=#__codelineno-27-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>ACTED_IN</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>m</span><span class=p>:</span><span class=n>Movie</span><span class=p>)</span>
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2></a><a href=#__codelineno-27-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>actor</span><span class=p>,</span><span class=w> </span><span class=n>m</span><span class=p>.</span><span class=n>title</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>movie</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1></a><a href=#__codelineno-28-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2></a><a href=#__codelineno-28-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>actor</span>
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3></a><a href=#__codelineno-28-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_m_title</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>movie</span>
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4></a><a href=#__codelineno-28-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-28-5><a id=__codelineno-28-5 name=__codelineno-28-5></a><a href=#__codelineno-28-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-28-6><a id=__codelineno-28-6 name=__codelineno-28-6></a><a href=#__codelineno-28-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-28-7><a id=__codelineno-28-7 name=__codelineno-28-7></a><a href=#__codelineno-28-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-28-8><a id=__codelineno-28-8 name=__codelineno-28-8></a><a href=#__codelineno-28-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-28-9><a id=__codelineno-28-9 name=__codelineno-28-9></a><a href=#__codelineno-28-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_movie_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_movie_id</span>
</span><span id=__span-28-10><a id=__codelineno-28-10 name=__codelineno-28-10></a><a href=#__codelineno-28-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_m_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_m_id</span>
</span><span id=__span-28-11><a id=__codelineno-28-11 name=__codelineno-28-11></a><a href=#__codelineno-28-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_m_title</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_m_title</span>
</span><span id=__span-28-12><a id=__codelineno-28-12 name=__codelineno-28-12></a><a href=#__codelineno-28-12><span class=linenos data-linenos="12 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-28-13><a id=__codelineno-28-13 name=__codelineno-28-13></a><a href=#__codelineno-28-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-28-14><a id=__codelineno-28-14 name=__codelineno-28-14></a><a href=#__codelineno-28-14><span class=linenos data-linenos="14 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-28-15><a id=__codelineno-28-15 name=__codelineno-28-15></a><a href=#__codelineno-28-15><span class=linenos data-linenos="15 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-28-16><a id=__codelineno-28-16 name=__codelineno-28-16></a><a href=#__codelineno-28-16><span class=linenos data-linenos="16 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-28-17><a id=__codelineno-28-17 name=__codelineno-28-17></a><a href=#__codelineno-28-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_movie_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_movie_id</span>
</span><span id=__span-28-18><a id=__codelineno-28-18 name=__codelineno-28-18></a><a href=#__codelineno-28-18><span class=linenos data-linenos="18 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-28-19><a id=__codelineno-28-19 name=__codelineno-28-19></a><a href=#__codelineno-28-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-28-20><a id=__codelineno-28-20 name=__codelineno-28-20></a><a href=#__codelineno-28-20><span class=linenos data-linenos="20 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-28-21><a id=__codelineno-28-21 name=__codelineno-28-21></a><a href=#__codelineno-28-21><span class=linenos data-linenos="21 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-28-22><a id=__codelineno-28-22 name=__codelineno-28-22></a><a href=#__codelineno-28-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-28-23><a id=__codelineno-28-23 name=__codelineno-28-23></a><a href=#__codelineno-28-23><span class=linenos data-linenos="23 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-28-24><a id=__codelineno-28-24 name=__codelineno-28-24></a><a href=#__codelineno-28-24><span class=linenos data-linenos="24 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-28-25><a id=__codelineno-28-25 name=__codelineno-28-25></a><a href=#__codelineno-28-25><span class=linenos data-linenos="25 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-28-26><a id=__codelineno-28-26 name=__codelineno-28-26></a><a href=#__codelineno-28-26><span class=linenos data-linenos="26 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-28-27><a id=__codelineno-28-27 name=__codelineno-28-27></a><a href=#__codelineno-28-27><span class=linenos data-linenos="27 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-28-28><a id=__codelineno-28-28 name=__codelineno-28-28></a><a href=#__codelineno-28-28><span class=linenos data-linenos="28 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>movie_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_movie_id</span>
</span><span id=__span-28-29><a id=__codelineno-28-29 name=__codelineno-28-29></a><a href=#__codelineno-28-29><span class=linenos data-linenos="29 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-28-30><a id=__codelineno-28-30 name=__codelineno-28-30></a><a href=#__codelineno-28-30><span class=linenos data-linenos="30 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>ActedIn</span>
</span><span id=__span-28-31><a id=__codelineno-28-31 name=__codelineno-28-31></a><a href=#__codelineno-28-31><span class=linenos data-linenos="31 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-28-32><a id=__codelineno-28-32 name=__codelineno-28-32></a><a href=#__codelineno-28-32><span class=linenos data-linenos="32 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-28-33><a id=__codelineno-28-33 name=__codelineno-28-33></a><a href=#__codelineno-28-33><span class=linenos data-linenos="33 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-28-34><a id=__codelineno-28-34 name=__codelineno-28-34></a><a href=#__codelineno-28-34><span class=linenos data-linenos="34 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-28-35><a id=__codelineno-28-35 name=__codelineno-28-35></a><a href=#__codelineno-28-35><span class=linenos data-linenos="35 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-28-36><a id=__codelineno-28-36 name=__codelineno-28-36></a><a href=#__codelineno-28-36><span class=linenos data-linenos="36 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_m_id</span>
</span><span id=__span-28-37><a id=__codelineno-28-37 name=__codelineno-28-37></a><a href=#__codelineno-28-37><span class=linenos data-linenos="37 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>title</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_m_title</span>
</span><span id=__span-28-38><a id=__codelineno-28-38 name=__codelineno-28-38></a><a href=#__codelineno-28-38><span class=linenos data-linenos="38 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-28-39><a id=__codelineno-28-39 name=__codelineno-28-39></a><a href=#__codelineno-28-39><span class=linenos data-linenos="39 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Movie</span>
</span><span id=__span-28-40><a id=__codelineno-28-40 name=__codelineno-28-40></a><a href=#__codelineno-28-40><span class=linenos data-linenos="40 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-28-41><a id=__codelineno-28-41 name=__codelineno-28-41></a><a href=#__codelineno-28-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_m_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_movie_id</span>
</span><span id=__span-28-42><a id=__codelineno-28-42 name=__codelineno-28-42></a><a href=#__codelineno-28-42><span class=linenos data-linenos="42 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1></a><a href=#__codelineno-29-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-29-2><a id=__codelineno-29-2 name=__codelineno-29-2></a><a href=#__codelineno-29-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-29-3><a id=__codelineno-29-3 name=__codelineno-29-3></a><a href=#__codelineno-29-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-29-4><a id=__codelineno-29-4 name=__codelineno-29-4></a><a href=#__codelineno-29-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-29-5><a id=__codelineno-29-5 name=__codelineno-29-5></a><a href=#__codelineno-29-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-29-6><a id=__codelineno-29-6 name=__codelineno-29-6></a><a href=#__codelineno-29-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-29-7><a id=__codelineno-29-7 name=__codelineno-29-7></a><a href=#__codelineno-29-7><span class=linenos data-linenos=" 7 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-29-8><a id=__codelineno-29-8 name=__codelineno-29-8></a><a href=#__codelineno-29-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-29-9><a id=__codelineno-29-9 name=__codelineno-29-9></a><a href=#__codelineno-29-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: [_anon1:ACTED_IN]-&gt;
</span><span id=__span-29-10><a id=__codelineno-29-10 name=__codelineno-29-10></a><a href=#__codelineno-29-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-29-11><a id=__codelineno-29-11 name=__codelineno-29-11></a><a href=#__codelineno-29-11><span class=linenos data-linenos="11 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-29-12><a id=__codelineno-29-12 name=__codelineno-29-12></a><a href=#__codelineno-29-12><span class=linenos data-linenos="12 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-29-13><a id=__codelineno-29-13 name=__codelineno-29-13></a><a href=#__codelineno-29-13><span class=linenos data-linenos="13 "></span></a>    DataSource: m:Movie
</span><span id=__span-29-14><a id=__codelineno-29-14 name=__codelineno-29-14></a><a href=#__codelineno-29-14><span class=linenos data-linenos="14 "></span></a>*
</span><span id=__span-29-15><a id=__codelineno-29-15 name=__codelineno-29-15></a><a href=#__codelineno-29-15><span class=linenos data-linenos="15 "></span></a>----------------------------------------------------------------------
</span><span id=__span-29-16><a id=__codelineno-29-16 name=__codelineno-29-16></a><a href=#__codelineno-29-16><span class=linenos data-linenos="16 "></span></a>Level 1:
</span><span id=__span-29-17><a id=__codelineno-29-17 name=__codelineno-29-17></a><a href=#__codelineno-29-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-29-18><a id=__codelineno-29-18 name=__codelineno-29-18></a><a href=#__codelineno-29-18><span class=linenos data-linenos="18 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-29-19><a id=__codelineno-29-19 name=__codelineno-29-19></a><a href=#__codelineno-29-19><span class=linenos data-linenos="19 "></span></a>  JoinOperator(id=4)
</span><span id=__span-29-20><a id=__codelineno-29-20 name=__codelineno-29-20></a><a href=#__codelineno-29-20><span class=linenos data-linenos="20 "></span></a>    JoinType: INNER
</span><span id=__span-29-21><a id=__codelineno-29-21 name=__codelineno-29-21></a><a href=#__codelineno-29-21><span class=linenos data-linenos="21 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-29-22><a id=__codelineno-29-22 name=__codelineno-29-22></a><a href=#__codelineno-29-22><span class=linenos data-linenos="22 "></span></a>*
</span><span id=__span-29-23><a id=__codelineno-29-23 name=__codelineno-29-23></a><a href=#__codelineno-29-23><span class=linenos data-linenos="23 "></span></a>----------------------------------------------------------------------
</span><span id=__span-29-24><a id=__codelineno-29-24 name=__codelineno-29-24></a><a href=#__codelineno-29-24><span class=linenos data-linenos="24 "></span></a>Level 2:
</span><span id=__span-29-25><a id=__codelineno-29-25 name=__codelineno-29-25></a><a href=#__codelineno-29-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-29-26><a id=__codelineno-29-26 name=__codelineno-29-26></a><a href=#__codelineno-29-26><span class=linenos data-linenos="26 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=6;
</span><span id=__span-29-27><a id=__codelineno-29-27 name=__codelineno-29-27></a><a href=#__codelineno-29-27><span class=linenos data-linenos="27 "></span></a>  JoinOperator(id=5)
</span><span id=__span-29-28><a id=__codelineno-29-28 name=__codelineno-29-28></a><a href=#__codelineno-29-28><span class=linenos data-linenos="28 "></span></a>    JoinType: INNER
</span><span id=__span-29-29><a id=__codelineno-29-29 name=__codelineno-29-29></a><a href=#__codelineno-29-29><span class=linenos data-linenos="29 "></span></a>    Joins: JoinPair: Node=m RelOrNode=_anon1 Type=SINK
</span><span id=__span-29-30><a id=__codelineno-29-30 name=__codelineno-29-30></a><a href=#__codelineno-29-30><span class=linenos data-linenos="30 "></span></a>*
</span><span id=__span-29-31><a id=__codelineno-29-31 name=__codelineno-29-31></a><a href=#__codelineno-29-31><span class=linenos data-linenos="31 "></span></a>----------------------------------------------------------------------
</span><span id=__span-29-32><a id=__codelineno-29-32 name=__codelineno-29-32></a><a href=#__codelineno-29-32><span class=linenos data-linenos="32 "></span></a>Level 3:
</span><span id=__span-29-33><a id=__codelineno-29-33 name=__codelineno-29-33></a><a href=#__codelineno-29-33><span class=linenos data-linenos="33 "></span></a>----------------------------------------------------------------------
</span><span id=__span-29-34><a id=__codelineno-29-34 name=__codelineno-29-34></a><a href=#__codelineno-29-34><span class=linenos data-linenos="34 "></span></a>OpId=6 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-29-35><a id=__codelineno-29-35 name=__codelineno-29-35></a><a href=#__codelineno-29-35><span class=linenos data-linenos="35 "></span></a>  ProjectionOperator(id=6)
</span><span id=__span-29-36><a id=__codelineno-29-36 name=__codelineno-29-36></a><a href=#__codelineno-29-36><span class=linenos data-linenos="36 "></span></a>    Projections: actor=p.name, movie=m.title
</span><span id=__span-29-37><a id=__codelineno-29-37 name=__codelineno-29-37></a><a href=#__codelineno-29-37><span class=linenos data-linenos="37 "></span></a>*
</span><span id=__span-29-38><a id=__codelineno-29-38 name=__codelineno-29-38></a><a href=#__codelineno-29-38><span class=linenos data-linenos="38 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=11-relationship-with-property-filter>11. Relationship with property filter<a class=headerlink href=#11-relationship-with-property-filter title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Edge properties</p> <details class=note> <summary>Notes</summary> <p>Filters relationships by their properties.</p> <p>WHY USEFUL: Find "strong" relationships, recent connections.</p> <p>DATABRICKS COMPLEXITY: O(e) where e = edges COST: Medium. Filter on edge table reduces join size. Edge properties stored in edge table as columns.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1></a><a href=#__codelineno-30-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=n>r</span><span class=p>:</span><span class=n>KNOWS</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>f</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-30-2><a id=__codelineno-30-2 name=__codelineno-30-2></a><a href=#__codelineno-30-2><span class=linenos data-linenos="2 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>since</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>2020</span><span class=w> </span><span class=n>AND</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>strength</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>0</span><span class=p>.</span><span class=m>8</span>
</span><span id=__span-30-3><a id=__codelineno-30-3 name=__codelineno-30-3></a><a href=#__codelineno-30-3><span class=linenos data-linenos="3 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>person</span><span class=p>,</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>friend</span><span class=p>,</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>since</span><span class=p>,</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>strength</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1></a><a href=#__codelineno-31-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-31-2><a id=__codelineno-31-2 name=__codelineno-31-2></a><a href=#__codelineno-31-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>person</span>
</span><span id=__span-31-3><a id=__codelineno-31-3 name=__codelineno-31-3></a><a href=#__codelineno-31-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>friend</span>
</span><span id=__span-31-4><a id=__codelineno-31-4 name=__codelineno-31-4></a><a href=#__codelineno-31-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_r_since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>since</span>
</span><span id=__span-31-5><a id=__codelineno-31-5 name=__codelineno-31-5></a><a href=#__codelineno-31-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_r_strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>strength</span>
</span><span id=__span-31-6><a id=__codelineno-31-6 name=__codelineno-31-6></a><a href=#__codelineno-31-6><span class=linenos data-linenos=" 6 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-31-7><a id=__codelineno-31-7 name=__codelineno-31-7></a><a href=#__codelineno-31-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-31-8><a id=__codelineno-31-8 name=__codelineno-31-8></a><a href=#__codelineno-31-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-31-9><a id=__codelineno-31-9 name=__codelineno-31-9></a><a href=#__codelineno-31-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-31-10><a id=__codelineno-31-10 name=__codelineno-31-10></a><a href=#__codelineno-31-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_r_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_person_id</span>
</span><span id=__span-31-11><a id=__codelineno-31-11 name=__codelineno-31-11></a><a href=#__codelineno-31-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_r_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_friend_id</span>
</span><span id=__span-31-12><a id=__codelineno-31-12 name=__codelineno-31-12></a><a href=#__codelineno-31-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_r_since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_since</span>
</span><span id=__span-31-13><a id=__codelineno-31-13 name=__codelineno-31-13></a><a href=#__codelineno-31-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_r_strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_strength</span>
</span><span id=__span-31-14><a id=__codelineno-31-14 name=__codelineno-31-14></a><a href=#__codelineno-31-14><span class=linenos data-linenos="14 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-31-15><a id=__codelineno-31-15 name=__codelineno-31-15></a><a href=#__codelineno-31-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-31-16><a id=__codelineno-31-16 name=__codelineno-31-16></a><a href=#__codelineno-31-16><span class=linenos data-linenos="16 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-31-17><a id=__codelineno-31-17 name=__codelineno-31-17></a><a href=#__codelineno-31-17><span class=linenos data-linenos="17 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-31-18><a id=__codelineno-31-18 name=__codelineno-31-18></a><a href=#__codelineno-31-18><span class=linenos data-linenos="18 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-31-19><a id=__codelineno-31-19 name=__codelineno-31-19></a><a href=#__codelineno-31-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-31-20><a id=__codelineno-31-20 name=__codelineno-31-20></a><a href=#__codelineno-31-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql_r_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_person_id</span>
</span><span id=__span-31-21><a id=__codelineno-31-21 name=__codelineno-31-21></a><a href=#__codelineno-31-21><span class=linenos data-linenos="21 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql_r_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_friend_id</span>
</span><span id=__span-31-22><a id=__codelineno-31-22 name=__codelineno-31-22></a><a href=#__codelineno-31-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql_r_since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_since</span>
</span><span id=__span-31-23><a id=__codelineno-31-23 name=__codelineno-31-23></a><a href=#__codelineno-31-23><span class=linenos data-linenos="23 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql_r_strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_strength</span>
</span><span id=__span-31-24><a id=__codelineno-31-24 name=__codelineno-31-24></a><a href=#__codelineno-31-24><span class=linenos data-linenos="24 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-31-25><a id=__codelineno-31-25 name=__codelineno-31-25></a><a href=#__codelineno-31-25><span class=linenos data-linenos="25 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-31-26><a id=__codelineno-31-26 name=__codelineno-31-26></a><a href=#__codelineno-31-26><span class=linenos data-linenos="26 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-31-27><a id=__codelineno-31-27 name=__codelineno-31-27></a><a href=#__codelineno-31-27><span class=linenos data-linenos="27 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-31-28><a id=__codelineno-31-28 name=__codelineno-31-28></a><a href=#__codelineno-31-28><span class=linenos data-linenos="28 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-31-29><a id=__codelineno-31-29 name=__codelineno-31-29></a><a href=#__codelineno-31-29><span class=linenos data-linenos="29 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-31-30><a id=__codelineno-31-30 name=__codelineno-31-30></a><a href=#__codelineno-31-30><span class=linenos data-linenos="30 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-31-31><a id=__codelineno-31-31 name=__codelineno-31-31></a><a href=#__codelineno-31-31><span class=linenos data-linenos="31 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-31-32><a id=__codelineno-31-32 name=__codelineno-31-32></a><a href=#__codelineno-31-32><span class=linenos data-linenos="32 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-31-33><a id=__codelineno-31-33 name=__codelineno-31-33></a><a href=#__codelineno-31-33><span class=linenos data-linenos="33 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_person_id</span>
</span><span id=__span-31-34><a id=__codelineno-31-34 name=__codelineno-31-34></a><a href=#__codelineno-31-34><span class=linenos data-linenos="34 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_friend_id</span>
</span><span id=__span-31-35><a id=__codelineno-31-35 name=__codelineno-31-35></a><a href=#__codelineno-31-35><span class=linenos data-linenos="35 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_since</span>
</span><span id=__span-31-36><a id=__codelineno-31-36 name=__codelineno-31-36></a><a href=#__codelineno-31-36><span class=linenos data-linenos="36 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_strength</span>
</span><span id=__span-31-37><a id=__codelineno-31-37 name=__codelineno-31-37></a><a href=#__codelineno-31-37><span class=linenos data-linenos="37 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-31-38><a id=__codelineno-31-38 name=__codelineno-31-38></a><a href=#__codelineno-31-38><span class=linenos data-linenos="38 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-31-39><a id=__codelineno-31-39 name=__codelineno-31-39></a><a href=#__codelineno-31-39><span class=linenos data-linenos="39 "></span></a><span class=w>      </span><span class=k>WHERE</span><span class=w> </span><span class=p>(((</span><span class=n>since</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>2020</span><span class=p>))</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=p>((</span><span class=n>strength</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>8</span><span class=p>)))</span>
</span><span id=__span-31-40><a id=__codelineno-31-40 name=__codelineno-31-40></a><a href=#__codelineno-31-40><span class=linenos data-linenos="40 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-31-41><a id=__codelineno-31-41 name=__codelineno-31-41></a><a href=#__codelineno-31-41><span class=linenos data-linenos="41 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql_r_person_id</span>
</span><span id=__span-31-42><a id=__codelineno-31-42 name=__codelineno-31-42></a><a href=#__codelineno-31-42><span class=linenos data-linenos="42 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-31-43><a id=__codelineno-31-43 name=__codelineno-31-43></a><a href=#__codelineno-31-43><span class=linenos data-linenos="43 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-31-44><a id=__codelineno-31-44 name=__codelineno-31-44></a><a href=#__codelineno-31-44><span class=linenos data-linenos="44 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-31-45><a id=__codelineno-31-45 name=__codelineno-31-45></a><a href=#__codelineno-31-45><span class=linenos data-linenos="45 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-31-46><a id=__codelineno-31-46 name=__codelineno-31-46></a><a href=#__codelineno-31-46><span class=linenos data-linenos="46 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-31-47><a id=__codelineno-31-47 name=__codelineno-31-47></a><a href=#__codelineno-31-47><span class=linenos data-linenos="47 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-31-48><a id=__codelineno-31-48 name=__codelineno-31-48></a><a href=#__codelineno-31-48><span class=linenos data-linenos="48 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-31-49><a id=__codelineno-31-49 name=__codelineno-31-49></a><a href=#__codelineno-31-49><span class=linenos data-linenos="49 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-31-50><a id=__codelineno-31-50 name=__codelineno-31-50></a><a href=#__codelineno-31-50><span class=linenos data-linenos="50 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_r_friend_id</span>
</span><span id=__span-31-51><a id=__codelineno-31-51 name=__codelineno-31-51></a><a href=#__codelineno-31-51><span class=linenos data-linenos="51 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1></a><a href=#__codelineno-32-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-32-2><a id=__codelineno-32-2 name=__codelineno-32-2></a><a href=#__codelineno-32-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-32-3><a id=__codelineno-32-3 name=__codelineno-32-3></a><a href=#__codelineno-32-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-32-4><a id=__codelineno-32-4 name=__codelineno-32-4></a><a href=#__codelineno-32-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-32-5><a id=__codelineno-32-5 name=__codelineno-32-5></a><a href=#__codelineno-32-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-32-6><a id=__codelineno-32-6 name=__codelineno-32-6></a><a href=#__codelineno-32-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-32-7><a id=__codelineno-32-7 name=__codelineno-32-7></a><a href=#__codelineno-32-7><span class=linenos data-linenos=" 7 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-32-8><a id=__codelineno-32-8 name=__codelineno-32-8></a><a href=#__codelineno-32-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-32-9><a id=__codelineno-32-9 name=__codelineno-32-9></a><a href=#__codelineno-32-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: [r:KNOWS]-&gt;
</span><span id=__span-32-10><a id=__codelineno-32-10 name=__codelineno-32-10></a><a href=#__codelineno-32-10><span class=linenos data-linenos="10 "></span></a>    Filter: ((r.since GT 2020) AND (r.strength GT 0.8))
</span><span id=__span-32-11><a id=__codelineno-32-11 name=__codelineno-32-11></a><a href=#__codelineno-32-11><span class=linenos data-linenos="11 "></span></a>*
</span><span id=__span-32-12><a id=__codelineno-32-12 name=__codelineno-32-12></a><a href=#__codelineno-32-12><span class=linenos data-linenos="12 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-32-13><a id=__codelineno-32-13 name=__codelineno-32-13></a><a href=#__codelineno-32-13><span class=linenos data-linenos="13 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-32-14><a id=__codelineno-32-14 name=__codelineno-32-14></a><a href=#__codelineno-32-14><span class=linenos data-linenos="14 "></span></a>    DataSource: f:Person
</span><span id=__span-32-15><a id=__codelineno-32-15 name=__codelineno-32-15></a><a href=#__codelineno-32-15><span class=linenos data-linenos="15 "></span></a>*
</span><span id=__span-32-16><a id=__codelineno-32-16 name=__codelineno-32-16></a><a href=#__codelineno-32-16><span class=linenos data-linenos="16 "></span></a>----------------------------------------------------------------------
</span><span id=__span-32-17><a id=__codelineno-32-17 name=__codelineno-32-17></a><a href=#__codelineno-32-17><span class=linenos data-linenos="17 "></span></a>Level 1:
</span><span id=__span-32-18><a id=__codelineno-32-18 name=__codelineno-32-18></a><a href=#__codelineno-32-18><span class=linenos data-linenos="18 "></span></a>----------------------------------------------------------------------
</span><span id=__span-32-19><a id=__codelineno-32-19 name=__codelineno-32-19></a><a href=#__codelineno-32-19><span class=linenos data-linenos="19 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-32-20><a id=__codelineno-32-20 name=__codelineno-32-20></a><a href=#__codelineno-32-20><span class=linenos data-linenos="20 "></span></a>  JoinOperator(id=4)
</span><span id=__span-32-21><a id=__codelineno-32-21 name=__codelineno-32-21></a><a href=#__codelineno-32-21><span class=linenos data-linenos="21 "></span></a>    JoinType: INNER
</span><span id=__span-32-22><a id=__codelineno-32-22 name=__codelineno-32-22></a><a href=#__codelineno-32-22><span class=linenos data-linenos="22 "></span></a>    Joins: JoinPair: Node=p RelOrNode=r Type=SOURCE
</span><span id=__span-32-23><a id=__codelineno-32-23 name=__codelineno-32-23></a><a href=#__codelineno-32-23><span class=linenos data-linenos="23 "></span></a>*
</span><span id=__span-32-24><a id=__codelineno-32-24 name=__codelineno-32-24></a><a href=#__codelineno-32-24><span class=linenos data-linenos="24 "></span></a>----------------------------------------------------------------------
</span><span id=__span-32-25><a id=__codelineno-32-25 name=__codelineno-32-25></a><a href=#__codelineno-32-25><span class=linenos data-linenos="25 "></span></a>Level 2:
</span><span id=__span-32-26><a id=__codelineno-32-26 name=__codelineno-32-26></a><a href=#__codelineno-32-26><span class=linenos data-linenos="26 "></span></a>----------------------------------------------------------------------
</span><span id=__span-32-27><a id=__codelineno-32-27 name=__codelineno-32-27></a><a href=#__codelineno-32-27><span class=linenos data-linenos="27 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=7;
</span><span id=__span-32-28><a id=__codelineno-32-28 name=__codelineno-32-28></a><a href=#__codelineno-32-28><span class=linenos data-linenos="28 "></span></a>  JoinOperator(id=5)
</span><span id=__span-32-29><a id=__codelineno-32-29 name=__codelineno-32-29></a><a href=#__codelineno-32-29><span class=linenos data-linenos="29 "></span></a>    JoinType: INNER
</span><span id=__span-32-30><a id=__codelineno-32-30 name=__codelineno-32-30></a><a href=#__codelineno-32-30><span class=linenos data-linenos="30 "></span></a>    Joins: JoinPair: Node=f RelOrNode=r Type=SINK
</span><span id=__span-32-31><a id=__codelineno-32-31 name=__codelineno-32-31></a><a href=#__codelineno-32-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-32-32><a id=__codelineno-32-32 name=__codelineno-32-32></a><a href=#__codelineno-32-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span><span id=__span-32-33><a id=__codelineno-32-33 name=__codelineno-32-33></a><a href=#__codelineno-32-33><span class=linenos data-linenos="33 "></span></a>Level 3:
</span><span id=__span-32-34><a id=__codelineno-32-34 name=__codelineno-32-34></a><a href=#__codelineno-32-34><span class=linenos data-linenos="34 "></span></a>----------------------------------------------------------------------
</span><span id=__span-32-35><a id=__codelineno-32-35 name=__codelineno-32-35></a><a href=#__codelineno-32-35><span class=linenos data-linenos="35 "></span></a>OpId=7 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-32-36><a id=__codelineno-32-36 name=__codelineno-32-36></a><a href=#__codelineno-32-36><span class=linenos data-linenos="36 "></span></a>  ProjectionOperator(id=7)
</span><span id=__span-32-37><a id=__codelineno-32-37 name=__codelineno-32-37></a><a href=#__codelineno-32-37><span class=linenos data-linenos="37 "></span></a>    Projections: person=p.name, friend=f.name, since=r.since, strength=r.strength
</span><span id=__span-32-38><a id=__codelineno-32-38 name=__codelineno-32-38></a><a href=#__codelineno-32-38><span class=linenos data-linenos="38 "></span></a>*
</span><span id=__span-32-39><a id=__codelineno-32-39 name=__codelineno-32-39></a><a href=#__codelineno-32-39><span class=linenos data-linenos="39 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=12-undirected-relationship-both-directions>12. Undirected relationship (both directions)<a class=headerlink href=#12-undirected-relationship-both-directions title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Undirected edges</p> <details class=note> <summary>Notes</summary> <p>Matches relationships in both directions.</p> <p>WHY USEFUL: Social networks where direction doesn't matter.</p> <p>DATABRICKS COMPLEXITY: O(2e) - UNION of both directions COST: Higher. Translates to UNION of forward and reverse joins. May produce duplicates - use DISTINCT if needed.</p> <p>OPTIMIZATION: Predicate pushdown moves WHERE p.name = 'Alice' into the Person table subquery BEFORE the join, dramatically reducing rows.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-33-1><a id=__codelineno-33-1 name=__codelineno-33-1></a><a href=#__codelineno-33-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=o>]-</span><span class=p>(</span><span class=n>f</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-33-2><a id=__codelineno-33-2 name=__codelineno-33-2></a><a href=#__codelineno-33-2><span class=linenos data-linenos="2 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&#39;Alice&#39;</span>
</span><span id=__span-33-3><a id=__codelineno-33-3 name=__codelineno-33-3></a><a href=#__codelineno-33-3><span class=linenos data-linenos="3 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>friend</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-34-1><a id=__codelineno-34-1 name=__codelineno-34-1></a><a href=#__codelineno-34-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span>
</span><span id=__span-34-2><a id=__codelineno-34-2 name=__codelineno-34-2></a><a href=#__codelineno-34-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>friend</span>
</span><span id=__span-34-3><a id=__codelineno-34-3 name=__codelineno-34-3></a><a href=#__codelineno-34-3><span class=linenos data-linenos=" 3 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-34-4><a id=__codelineno-34-4 name=__codelineno-34-4></a><a href=#__codelineno-34-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-34-5><a id=__codelineno-34-5 name=__codelineno-34-5></a><a href=#__codelineno-34-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-34-6><a id=__codelineno-34-6 name=__codelineno-34-6></a><a href=#__codelineno-34-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-34-7><a id=__codelineno-34-7 name=__codelineno-34-7></a><a href=#__codelineno-34-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-34-8><a id=__codelineno-34-8 name=__codelineno-34-8></a><a href=#__codelineno-34-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-34-9><a id=__codelineno-34-9 name=__codelineno-34-9></a><a href=#__codelineno-34-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-34-10><a id=__codelineno-34-10 name=__codelineno-34-10></a><a href=#__codelineno-34-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-34-11><a id=__codelineno-34-11 name=__codelineno-34-11></a><a href=#__codelineno-34-11><span class=linenos data-linenos="11 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-34-12><a id=__codelineno-34-12 name=__codelineno-34-12></a><a href=#__codelineno-34-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-34-13><a id=__codelineno-34-13 name=__codelineno-34-13></a><a href=#__codelineno-34-13><span class=linenos data-linenos="13 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-34-14><a id=__codelineno-34-14 name=__codelineno-34-14></a><a href=#__codelineno-34-14><span class=linenos data-linenos="14 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-34-15><a id=__codelineno-34-15 name=__codelineno-34-15></a><a href=#__codelineno-34-15><span class=linenos data-linenos="15 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-34-16><a id=__codelineno-34-16 name=__codelineno-34-16></a><a href=#__codelineno-34-16><span class=linenos data-linenos="16 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-34-17><a id=__codelineno-34-17 name=__codelineno-34-17></a><a href=#__codelineno-34-17><span class=linenos data-linenos="17 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-34-18><a id=__codelineno-34-18 name=__codelineno-34-18></a><a href=#__codelineno-34-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-34-19><a id=__codelineno-34-19 name=__codelineno-34-19></a><a href=#__codelineno-34-19><span class=linenos data-linenos="19 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-34-20><a id=__codelineno-34-20 name=__codelineno-34-20></a><a href=#__codelineno-34-20><span class=linenos data-linenos="20 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-34-21><a id=__codelineno-34-21 name=__codelineno-34-21></a><a href=#__codelineno-34-21><span class=linenos data-linenos="21 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-34-22><a id=__codelineno-34-22 name=__codelineno-34-22></a><a href=#__codelineno-34-22><span class=linenos data-linenos="22 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-34-23><a id=__codelineno-34-23 name=__codelineno-34-23></a><a href=#__codelineno-34-23><span class=linenos data-linenos="23 "></span></a><span class=w>      </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Alice&#39;</span><span class=p>))</span>
</span><span id=__span-34-24><a id=__codelineno-34-24 name=__codelineno-34-24></a><a href=#__codelineno-34-24><span class=linenos data-linenos="24 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-34-25><a id=__codelineno-34-25 name=__codelineno-34-25></a><a href=#__codelineno-34-25><span class=linenos data-linenos="25 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-34-26><a id=__codelineno-34-26 name=__codelineno-34-26></a><a href=#__codelineno-34-26><span class=linenos data-linenos="26 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-34-27><a id=__codelineno-34-27 name=__codelineno-34-27></a><a href=#__codelineno-34-27><span class=linenos data-linenos="27 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-34-28><a id=__codelineno-34-28 name=__codelineno-34-28></a><a href=#__codelineno-34-28><span class=linenos data-linenos="28 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-34-29><a id=__codelineno-34-29 name=__codelineno-34-29></a><a href=#__codelineno-34-29><span class=linenos data-linenos="29 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-34-30><a id=__codelineno-34-30 name=__codelineno-34-30></a><a href=#__codelineno-34-30><span class=linenos data-linenos="30 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_strength</span>
</span><span id=__span-34-31><a id=__codelineno-34-31 name=__codelineno-34-31></a><a href=#__codelineno-34-31><span class=linenos data-linenos="31 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-34-32><a id=__codelineno-34-32 name=__codelineno-34-32></a><a href=#__codelineno-34-32><span class=linenos data-linenos="32 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-34-33><a id=__codelineno-34-33 name=__codelineno-34-33></a><a href=#__codelineno-34-33><span class=linenos data-linenos="33 "></span></a><span class=w>      </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-34-34><a id=__codelineno-34-34 name=__codelineno-34-34></a><a href=#__codelineno-34-34><span class=linenos data-linenos="34 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-34-35><a id=__codelineno-34-35 name=__codelineno-34-35></a><a href=#__codelineno-34-35><span class=linenos data-linenos="35 "></span></a><span class=w>         </span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-34-36><a id=__codelineno-34-36 name=__codelineno-34-36></a><a href=#__codelineno-34-36><span class=linenos data-linenos="36 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-34-37><a id=__codelineno-34-37 name=__codelineno-34-37></a><a href=#__codelineno-34-37><span class=linenos data-linenos="37 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-34-38><a id=__codelineno-34-38 name=__codelineno-34-38></a><a href=#__codelineno-34-38><span class=linenos data-linenos="38 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_strength</span>
</span><span id=__span-34-39><a id=__codelineno-34-39 name=__codelineno-34-39></a><a href=#__codelineno-34-39><span class=linenos data-linenos="39 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-34-40><a id=__codelineno-34-40 name=__codelineno-34-40></a><a href=#__codelineno-34-40><span class=linenos data-linenos="40 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-34-41><a id=__codelineno-34-41 name=__codelineno-34-41></a><a href=#__codelineno-34-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-34-42><a id=__codelineno-34-42 name=__codelineno-34-42></a><a href=#__codelineno-34-42><span class=linenos data-linenos="42 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-34-43><a id=__codelineno-34-43 name=__codelineno-34-43></a><a href=#__codelineno-34-43><span class=linenos data-linenos="43 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-34-44><a id=__codelineno-34-44 name=__codelineno-34-44></a><a href=#__codelineno-34-44><span class=linenos data-linenos="44 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-34-45><a id=__codelineno-34-45 name=__codelineno-34-45></a><a href=#__codelineno-34-45><span class=linenos data-linenos="45 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-34-46><a id=__codelineno-34-46 name=__codelineno-34-46></a><a href=#__codelineno-34-46><span class=linenos data-linenos="46 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-34-47><a id=__codelineno-34-47 name=__codelineno-34-47></a><a href=#__codelineno-34-47><span class=linenos data-linenos="47 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-34-48><a id=__codelineno-34-48 name=__codelineno-34-48></a><a href=#__codelineno-34-48><span class=linenos data-linenos="48 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-34-49><a id=__codelineno-34-49 name=__codelineno-34-49></a><a href=#__codelineno-34-49><span class=linenos data-linenos="49 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-34-50><a id=__codelineno-34-50 name=__codelineno-34-50></a><a href=#__codelineno-34-50><span class=linenos data-linenos="50 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-34-51><a id=__codelineno-34-51 name=__codelineno-34-51></a><a href=#__codelineno-34-51><span class=linenos data-linenos="51 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-34-52><a id=__codelineno-34-52 name=__codelineno-34-52></a><a href=#__codelineno-34-52><span class=linenos data-linenos="52 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-35-1><a id=__codelineno-35-1 name=__codelineno-35-1></a><a href=#__codelineno-35-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-35-2><a id=__codelineno-35-2 name=__codelineno-35-2></a><a href=#__codelineno-35-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-35-3><a id=__codelineno-35-3 name=__codelineno-35-3></a><a href=#__codelineno-35-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-35-4><a id=__codelineno-35-4 name=__codelineno-35-4></a><a href=#__codelineno-35-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-35-5><a id=__codelineno-35-5 name=__codelineno-35-5></a><a href=#__codelineno-35-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-35-6><a id=__codelineno-35-6 name=__codelineno-35-6></a><a href=#__codelineno-35-6><span class=linenos data-linenos=" 6 "></span></a>    Filter: (p.name EQ &#39;Alice&#39;)
</span><span id=__span-35-7><a id=__codelineno-35-7 name=__codelineno-35-7></a><a href=#__codelineno-35-7><span class=linenos data-linenos=" 7 "></span></a>*
</span><span id=__span-35-8><a id=__codelineno-35-8 name=__codelineno-35-8></a><a href=#__codelineno-35-8><span class=linenos data-linenos=" 8 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-35-9><a id=__codelineno-35-9 name=__codelineno-35-9></a><a href=#__codelineno-35-9><span class=linenos data-linenos=" 9 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-35-10><a id=__codelineno-35-10 name=__codelineno-35-10></a><a href=#__codelineno-35-10><span class=linenos data-linenos="10 "></span></a>    DataSource: [_anon1:KNOWS]-
</span><span id=__span-35-11><a id=__codelineno-35-11 name=__codelineno-35-11></a><a href=#__codelineno-35-11><span class=linenos data-linenos="11 "></span></a>*
</span><span id=__span-35-12><a id=__codelineno-35-12 name=__codelineno-35-12></a><a href=#__codelineno-35-12><span class=linenos data-linenos="12 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-35-13><a id=__codelineno-35-13 name=__codelineno-35-13></a><a href=#__codelineno-35-13><span class=linenos data-linenos="13 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-35-14><a id=__codelineno-35-14 name=__codelineno-35-14></a><a href=#__codelineno-35-14><span class=linenos data-linenos="14 "></span></a>    DataSource: f:Person
</span><span id=__span-35-15><a id=__codelineno-35-15 name=__codelineno-35-15></a><a href=#__codelineno-35-15><span class=linenos data-linenos="15 "></span></a>*
</span><span id=__span-35-16><a id=__codelineno-35-16 name=__codelineno-35-16></a><a href=#__codelineno-35-16><span class=linenos data-linenos="16 "></span></a>----------------------------------------------------------------------
</span><span id=__span-35-17><a id=__codelineno-35-17 name=__codelineno-35-17></a><a href=#__codelineno-35-17><span class=linenos data-linenos="17 "></span></a>Level 1:
</span><span id=__span-35-18><a id=__codelineno-35-18 name=__codelineno-35-18></a><a href=#__codelineno-35-18><span class=linenos data-linenos="18 "></span></a>----------------------------------------------------------------------
</span><span id=__span-35-19><a id=__codelineno-35-19 name=__codelineno-35-19></a><a href=#__codelineno-35-19><span class=linenos data-linenos="19 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-35-20><a id=__codelineno-35-20 name=__codelineno-35-20></a><a href=#__codelineno-35-20><span class=linenos data-linenos="20 "></span></a>  JoinOperator(id=4)
</span><span id=__span-35-21><a id=__codelineno-35-21 name=__codelineno-35-21></a><a href=#__codelineno-35-21><span class=linenos data-linenos="21 "></span></a>    JoinType: INNER
</span><span id=__span-35-22><a id=__codelineno-35-22 name=__codelineno-35-22></a><a href=#__codelineno-35-22><span class=linenos data-linenos="22 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=EITHER_AS_SOURCE
</span><span id=__span-35-23><a id=__codelineno-35-23 name=__codelineno-35-23></a><a href=#__codelineno-35-23><span class=linenos data-linenos="23 "></span></a>*
</span><span id=__span-35-24><a id=__codelineno-35-24 name=__codelineno-35-24></a><a href=#__codelineno-35-24><span class=linenos data-linenos="24 "></span></a>----------------------------------------------------------------------
</span><span id=__span-35-25><a id=__codelineno-35-25 name=__codelineno-35-25></a><a href=#__codelineno-35-25><span class=linenos data-linenos="25 "></span></a>Level 2:
</span><span id=__span-35-26><a id=__codelineno-35-26 name=__codelineno-35-26></a><a href=#__codelineno-35-26><span class=linenos data-linenos="26 "></span></a>----------------------------------------------------------------------
</span><span id=__span-35-27><a id=__codelineno-35-27 name=__codelineno-35-27></a><a href=#__codelineno-35-27><span class=linenos data-linenos="27 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=7;
</span><span id=__span-35-28><a id=__codelineno-35-28 name=__codelineno-35-28></a><a href=#__codelineno-35-28><span class=linenos data-linenos="28 "></span></a>  JoinOperator(id=5)
</span><span id=__span-35-29><a id=__codelineno-35-29 name=__codelineno-35-29></a><a href=#__codelineno-35-29><span class=linenos data-linenos="29 "></span></a>    JoinType: INNER
</span><span id=__span-35-30><a id=__codelineno-35-30 name=__codelineno-35-30></a><a href=#__codelineno-35-30><span class=linenos data-linenos="30 "></span></a>    Joins: JoinPair: Node=f RelOrNode=_anon1 Type=EITHER_AS_SINK
</span><span id=__span-35-31><a id=__codelineno-35-31 name=__codelineno-35-31></a><a href=#__codelineno-35-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-35-32><a id=__codelineno-35-32 name=__codelineno-35-32></a><a href=#__codelineno-35-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span><span id=__span-35-33><a id=__codelineno-35-33 name=__codelineno-35-33></a><a href=#__codelineno-35-33><span class=linenos data-linenos="33 "></span></a>Level 3:
</span><span id=__span-35-34><a id=__codelineno-35-34 name=__codelineno-35-34></a><a href=#__codelineno-35-34><span class=linenos data-linenos="34 "></span></a>----------------------------------------------------------------------
</span><span id=__span-35-35><a id=__codelineno-35-35 name=__codelineno-35-35></a><a href=#__codelineno-35-35><span class=linenos data-linenos="35 "></span></a>OpId=7 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-35-36><a id=__codelineno-35-36 name=__codelineno-35-36></a><a href=#__codelineno-35-36><span class=linenos data-linenos="36 "></span></a>  ProjectionOperator(id=7)
</span><span id=__span-35-37><a id=__codelineno-35-37 name=__codelineno-35-37></a><a href=#__codelineno-35-37><span class=linenos data-linenos="37 "></span></a>    Projections: friend=f.name
</span><span id=__span-35-38><a id=__codelineno-35-38 name=__codelineno-35-38></a><a href=#__codelineno-35-38><span class=linenos data-linenos="38 "></span></a>*
</span><span id=__span-35-39><a id=__codelineno-35-39 name=__codelineno-35-39></a><a href=#__codelineno-35-39><span class=linenos data-linenos="39 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=13-undirected-with-source-filter-pushdown>13. Undirected with source filter pushdown<a class=headerlink href=#13-undirected-with-source-filter-pushdown title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Predicate Pushdown</p> <details class=note> <summary>Notes</summary> <p>Compound source-only filter is pushed into the Person subquery.</p> <p>OPTIMIZATION APPLIED: BEFORE: Full Person scan  Full KNOWS scan  Full Person scan  Filter AFTER: Filtered Person (name='Alice' AND age&gt;25)  KNOWS  Person</p> <p>WHY IT MATTERS: If Person table has 1M rows but only 1 Alice over 25, we process 1 row instead of 1M in the initial joins.</p> <p>SQL Pattern (optimized): FROM (SELECT ... FROM Person WHERE name='Alice' AND age&gt;25) AS p JOIN Knows ON (p.id = source_id OR p.id = target_id) JOIN Person AS f ON ...</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-36-1><a id=__codelineno-36-1 name=__codelineno-36-1></a><a href=#__codelineno-36-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=o>]-</span><span class=p>(</span><span class=n>f</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-36-2><a id=__codelineno-36-2 name=__codelineno-36-2></a><a href=#__codelineno-36-2><span class=linenos data-linenos="2 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&#39;Alice&#39;</span><span class=w> </span><span class=n>AND</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>25</span>
</span><span id=__span-36-3><a id=__codelineno-36-3 name=__codelineno-36-3></a><a href=#__codelineno-36-3><span class=linenos data-linenos="3 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>friend</span><span class=p>,</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>friendAge</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-37-1><a id=__codelineno-37-1 name=__codelineno-37-1></a><a href=#__codelineno-37-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-37-2><a id=__codelineno-37-2 name=__codelineno-37-2></a><a href=#__codelineno-37-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>friend</span>
</span><span id=__span-37-3><a id=__codelineno-37-3 name=__codelineno-37-3></a><a href=#__codelineno-37-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_f_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>friendAge</span>
</span><span id=__span-37-4><a id=__codelineno-37-4 name=__codelineno-37-4></a><a href=#__codelineno-37-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-37-5><a id=__codelineno-37-5 name=__codelineno-37-5></a><a href=#__codelineno-37-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-37-6><a id=__codelineno-37-6 name=__codelineno-37-6></a><a href=#__codelineno-37-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-37-7><a id=__codelineno-37-7 name=__codelineno-37-7></a><a href=#__codelineno-37-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-37-8><a id=__codelineno-37-8 name=__codelineno-37-8></a><a href=#__codelineno-37-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-37-9><a id=__codelineno-37-9 name=__codelineno-37-9></a><a href=#__codelineno-37-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-37-10><a id=__codelineno-37-10 name=__codelineno-37-10></a><a href=#__codelineno-37-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-37-11><a id=__codelineno-37-11 name=__codelineno-37-11></a><a href=#__codelineno-37-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-37-12><a id=__codelineno-37-12 name=__codelineno-37-12></a><a href=#__codelineno-37-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-37-13><a id=__codelineno-37-13 name=__codelineno-37-13></a><a href=#__codelineno-37-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_age</span>
</span><span id=__span-37-14><a id=__codelineno-37-14 name=__codelineno-37-14></a><a href=#__codelineno-37-14><span class=linenos data-linenos="14 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-37-15><a id=__codelineno-37-15 name=__codelineno-37-15></a><a href=#__codelineno-37-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-37-16><a id=__codelineno-37-16 name=__codelineno-37-16></a><a href=#__codelineno-37-16><span class=linenos data-linenos="16 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-37-17><a id=__codelineno-37-17 name=__codelineno-37-17></a><a href=#__codelineno-37-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-37-18><a id=__codelineno-37-18 name=__codelineno-37-18></a><a href=#__codelineno-37-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-37-19><a id=__codelineno-37-19 name=__codelineno-37-19></a><a href=#__codelineno-37-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-37-20><a id=__codelineno-37-20 name=__codelineno-37-20></a><a href=#__codelineno-37-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-37-21><a id=__codelineno-37-21 name=__codelineno-37-21></a><a href=#__codelineno-37-21><span class=linenos data-linenos="21 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-37-22><a id=__codelineno-37-22 name=__codelineno-37-22></a><a href=#__codelineno-37-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-37-23><a id=__codelineno-37-23 name=__codelineno-37-23></a><a href=#__codelineno-37-23><span class=linenos data-linenos="23 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-37-24><a id=__codelineno-37-24 name=__codelineno-37-24></a><a href=#__codelineno-37-24><span class=linenos data-linenos="24 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-37-25><a id=__codelineno-37-25 name=__codelineno-37-25></a><a href=#__codelineno-37-25><span class=linenos data-linenos="25 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-37-26><a id=__codelineno-37-26 name=__codelineno-37-26></a><a href=#__codelineno-37-26><span class=linenos data-linenos="26 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-37-27><a id=__codelineno-37-27 name=__codelineno-37-27></a><a href=#__codelineno-37-27><span class=linenos data-linenos="27 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-37-28><a id=__codelineno-37-28 name=__codelineno-37-28></a><a href=#__codelineno-37-28><span class=linenos data-linenos="28 "></span></a><span class=w>      </span><span class=k>WHERE</span><span class=w> </span><span class=p>(((</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Alice&#39;</span><span class=p>))</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=p>((</span><span class=n>age</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>25</span><span class=p>)))</span>
</span><span id=__span-37-29><a id=__codelineno-37-29 name=__codelineno-37-29></a><a href=#__codelineno-37-29><span class=linenos data-linenos="29 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-37-30><a id=__codelineno-37-30 name=__codelineno-37-30></a><a href=#__codelineno-37-30><span class=linenos data-linenos="30 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-37-31><a id=__codelineno-37-31 name=__codelineno-37-31></a><a href=#__codelineno-37-31><span class=linenos data-linenos="31 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-37-32><a id=__codelineno-37-32 name=__codelineno-37-32></a><a href=#__codelineno-37-32><span class=linenos data-linenos="32 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-37-33><a id=__codelineno-37-33 name=__codelineno-37-33></a><a href=#__codelineno-37-33><span class=linenos data-linenos="33 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-37-34><a id=__codelineno-37-34 name=__codelineno-37-34></a><a href=#__codelineno-37-34><span class=linenos data-linenos="34 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-37-35><a id=__codelineno-37-35 name=__codelineno-37-35></a><a href=#__codelineno-37-35><span class=linenos data-linenos="35 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_strength</span>
</span><span id=__span-37-36><a id=__codelineno-37-36 name=__codelineno-37-36></a><a href=#__codelineno-37-36><span class=linenos data-linenos="36 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-37-37><a id=__codelineno-37-37 name=__codelineno-37-37></a><a href=#__codelineno-37-37><span class=linenos data-linenos="37 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-37-38><a id=__codelineno-37-38 name=__codelineno-37-38></a><a href=#__codelineno-37-38><span class=linenos data-linenos="38 "></span></a><span class=w>      </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-37-39><a id=__codelineno-37-39 name=__codelineno-37-39></a><a href=#__codelineno-37-39><span class=linenos data-linenos="39 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-37-40><a id=__codelineno-37-40 name=__codelineno-37-40></a><a href=#__codelineno-37-40><span class=linenos data-linenos="40 "></span></a><span class=w>         </span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-37-41><a id=__codelineno-37-41 name=__codelineno-37-41></a><a href=#__codelineno-37-41><span class=linenos data-linenos="41 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-37-42><a id=__codelineno-37-42 name=__codelineno-37-42></a><a href=#__codelineno-37-42><span class=linenos data-linenos="42 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-37-43><a id=__codelineno-37-43 name=__codelineno-37-43></a><a href=#__codelineno-37-43><span class=linenos data-linenos="43 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_strength</span>
</span><span id=__span-37-44><a id=__codelineno-37-44 name=__codelineno-37-44></a><a href=#__codelineno-37-44><span class=linenos data-linenos="44 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-37-45><a id=__codelineno-37-45 name=__codelineno-37-45></a><a href=#__codelineno-37-45><span class=linenos data-linenos="45 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-37-46><a id=__codelineno-37-46 name=__codelineno-37-46></a><a href=#__codelineno-37-46><span class=linenos data-linenos="46 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-37-47><a id=__codelineno-37-47 name=__codelineno-37-47></a><a href=#__codelineno-37-47><span class=linenos data-linenos="47 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-37-48><a id=__codelineno-37-48 name=__codelineno-37-48></a><a href=#__codelineno-37-48><span class=linenos data-linenos="48 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-37-49><a id=__codelineno-37-49 name=__codelineno-37-49></a><a href=#__codelineno-37-49><span class=linenos data-linenos="49 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-37-50><a id=__codelineno-37-50 name=__codelineno-37-50></a><a href=#__codelineno-37-50><span class=linenos data-linenos="50 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-37-51><a id=__codelineno-37-51 name=__codelineno-37-51></a><a href=#__codelineno-37-51><span class=linenos data-linenos="51 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-37-52><a id=__codelineno-37-52 name=__codelineno-37-52></a><a href=#__codelineno-37-52><span class=linenos data-linenos="52 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-37-53><a id=__codelineno-37-53 name=__codelineno-37-53></a><a href=#__codelineno-37-53><span class=linenos data-linenos="53 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_age</span>
</span><span id=__span-37-54><a id=__codelineno-37-54 name=__codelineno-37-54></a><a href=#__codelineno-37-54><span class=linenos data-linenos="54 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-37-55><a id=__codelineno-37-55 name=__codelineno-37-55></a><a href=#__codelineno-37-55><span class=linenos data-linenos="55 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-37-56><a id=__codelineno-37-56 name=__codelineno-37-56></a><a href=#__codelineno-37-56><span class=linenos data-linenos="56 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-37-57><a id=__codelineno-37-57 name=__codelineno-37-57></a><a href=#__codelineno-37-57><span class=linenos data-linenos="57 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-37-58><a id=__codelineno-37-58 name=__codelineno-37-58></a><a href=#__codelineno-37-58><span class=linenos data-linenos="58 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-38-1><a id=__codelineno-38-1 name=__codelineno-38-1></a><a href=#__codelineno-38-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-38-2><a id=__codelineno-38-2 name=__codelineno-38-2></a><a href=#__codelineno-38-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-38-3><a id=__codelineno-38-3 name=__codelineno-38-3></a><a href=#__codelineno-38-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-38-4><a id=__codelineno-38-4 name=__codelineno-38-4></a><a href=#__codelineno-38-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-38-5><a id=__codelineno-38-5 name=__codelineno-38-5></a><a href=#__codelineno-38-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-38-6><a id=__codelineno-38-6 name=__codelineno-38-6></a><a href=#__codelineno-38-6><span class=linenos data-linenos=" 6 "></span></a>    Filter: ((p.name EQ &#39;Alice&#39;) AND (p.age GT 25))
</span><span id=__span-38-7><a id=__codelineno-38-7 name=__codelineno-38-7></a><a href=#__codelineno-38-7><span class=linenos data-linenos=" 7 "></span></a>*
</span><span id=__span-38-8><a id=__codelineno-38-8 name=__codelineno-38-8></a><a href=#__codelineno-38-8><span class=linenos data-linenos=" 8 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-38-9><a id=__codelineno-38-9 name=__codelineno-38-9></a><a href=#__codelineno-38-9><span class=linenos data-linenos=" 9 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-38-10><a id=__codelineno-38-10 name=__codelineno-38-10></a><a href=#__codelineno-38-10><span class=linenos data-linenos="10 "></span></a>    DataSource: [_anon1:KNOWS]-
</span><span id=__span-38-11><a id=__codelineno-38-11 name=__codelineno-38-11></a><a href=#__codelineno-38-11><span class=linenos data-linenos="11 "></span></a>*
</span><span id=__span-38-12><a id=__codelineno-38-12 name=__codelineno-38-12></a><a href=#__codelineno-38-12><span class=linenos data-linenos="12 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-38-13><a id=__codelineno-38-13 name=__codelineno-38-13></a><a href=#__codelineno-38-13><span class=linenos data-linenos="13 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-38-14><a id=__codelineno-38-14 name=__codelineno-38-14></a><a href=#__codelineno-38-14><span class=linenos data-linenos="14 "></span></a>    DataSource: f:Person
</span><span id=__span-38-15><a id=__codelineno-38-15 name=__codelineno-38-15></a><a href=#__codelineno-38-15><span class=linenos data-linenos="15 "></span></a>*
</span><span id=__span-38-16><a id=__codelineno-38-16 name=__codelineno-38-16></a><a href=#__codelineno-38-16><span class=linenos data-linenos="16 "></span></a>----------------------------------------------------------------------
</span><span id=__span-38-17><a id=__codelineno-38-17 name=__codelineno-38-17></a><a href=#__codelineno-38-17><span class=linenos data-linenos="17 "></span></a>Level 1:
</span><span id=__span-38-18><a id=__codelineno-38-18 name=__codelineno-38-18></a><a href=#__codelineno-38-18><span class=linenos data-linenos="18 "></span></a>----------------------------------------------------------------------
</span><span id=__span-38-19><a id=__codelineno-38-19 name=__codelineno-38-19></a><a href=#__codelineno-38-19><span class=linenos data-linenos="19 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-38-20><a id=__codelineno-38-20 name=__codelineno-38-20></a><a href=#__codelineno-38-20><span class=linenos data-linenos="20 "></span></a>  JoinOperator(id=4)
</span><span id=__span-38-21><a id=__codelineno-38-21 name=__codelineno-38-21></a><a href=#__codelineno-38-21><span class=linenos data-linenos="21 "></span></a>    JoinType: INNER
</span><span id=__span-38-22><a id=__codelineno-38-22 name=__codelineno-38-22></a><a href=#__codelineno-38-22><span class=linenos data-linenos="22 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=EITHER_AS_SOURCE
</span><span id=__span-38-23><a id=__codelineno-38-23 name=__codelineno-38-23></a><a href=#__codelineno-38-23><span class=linenos data-linenos="23 "></span></a>*
</span><span id=__span-38-24><a id=__codelineno-38-24 name=__codelineno-38-24></a><a href=#__codelineno-38-24><span class=linenos data-linenos="24 "></span></a>----------------------------------------------------------------------
</span><span id=__span-38-25><a id=__codelineno-38-25 name=__codelineno-38-25></a><a href=#__codelineno-38-25><span class=linenos data-linenos="25 "></span></a>Level 2:
</span><span id=__span-38-26><a id=__codelineno-38-26 name=__codelineno-38-26></a><a href=#__codelineno-38-26><span class=linenos data-linenos="26 "></span></a>----------------------------------------------------------------------
</span><span id=__span-38-27><a id=__codelineno-38-27 name=__codelineno-38-27></a><a href=#__codelineno-38-27><span class=linenos data-linenos="27 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=7;
</span><span id=__span-38-28><a id=__codelineno-38-28 name=__codelineno-38-28></a><a href=#__codelineno-38-28><span class=linenos data-linenos="28 "></span></a>  JoinOperator(id=5)
</span><span id=__span-38-29><a id=__codelineno-38-29 name=__codelineno-38-29></a><a href=#__codelineno-38-29><span class=linenos data-linenos="29 "></span></a>    JoinType: INNER
</span><span id=__span-38-30><a id=__codelineno-38-30 name=__codelineno-38-30></a><a href=#__codelineno-38-30><span class=linenos data-linenos="30 "></span></a>    Joins: JoinPair: Node=f RelOrNode=_anon1 Type=EITHER_AS_SINK
</span><span id=__span-38-31><a id=__codelineno-38-31 name=__codelineno-38-31></a><a href=#__codelineno-38-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-38-32><a id=__codelineno-38-32 name=__codelineno-38-32></a><a href=#__codelineno-38-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span><span id=__span-38-33><a id=__codelineno-38-33 name=__codelineno-38-33></a><a href=#__codelineno-38-33><span class=linenos data-linenos="33 "></span></a>Level 3:
</span><span id=__span-38-34><a id=__codelineno-38-34 name=__codelineno-38-34></a><a href=#__codelineno-38-34><span class=linenos data-linenos="34 "></span></a>----------------------------------------------------------------------
</span><span id=__span-38-35><a id=__codelineno-38-35 name=__codelineno-38-35></a><a href=#__codelineno-38-35><span class=linenos data-linenos="35 "></span></a>OpId=7 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-38-36><a id=__codelineno-38-36 name=__codelineno-38-36></a><a href=#__codelineno-38-36><span class=linenos data-linenos="36 "></span></a>  ProjectionOperator(id=7)
</span><span id=__span-38-37><a id=__codelineno-38-37 name=__codelineno-38-37></a><a href=#__codelineno-38-37><span class=linenos data-linenos="37 "></span></a>    Projections: friend=f.name, friendAge=f.age
</span><span id=__span-38-38><a id=__codelineno-38-38 name=__codelineno-38-38></a><a href=#__codelineno-38-38><span class=linenos data-linenos="38 "></span></a>*
</span><span id=__span-38-39><a id=__codelineno-38-39 name=__codelineno-38-39></a><a href=#__codelineno-38-39><span class=linenos data-linenos="39 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=14-undirected-with-target-filter-not-pushed>14. Undirected with target filter (not pushed)<a class=headerlink href=#14-undirected-with-target-filter-not-pushed title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Filter Semantics</p> <details class=note> <summary>Notes</summary> <p>Target node filter cannot be pushed to source - stays after join.</p> <p>WHY NOT PUSHED: The filter references 'f' (target), which is only known after traversing the relationship. The filter must remain after the join to correctly filter matching targets.</p> <p>SQL Pattern: FROM Person AS p JOIN Knows ON ... JOIN Person AS f ON ... WHERE f.age &gt; 30 -- Applied after all joins</p> <p>COST: Higher than source pushdown - full initial scans required.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-39-1><a id=__codelineno-39-1 name=__codelineno-39-1></a><a href=#__codelineno-39-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=o>]-</span><span class=p>(</span><span class=n>f</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-39-2><a id=__codelineno-39-2 name=__codelineno-39-2></a><a href=#__codelineno-39-2><span class=linenos data-linenos="2 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>30</span>
</span><span id=__span-39-3><a id=__codelineno-39-3 name=__codelineno-39-3></a><a href=#__codelineno-39-3><span class=linenos data-linenos="3 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>person</span><span class=p>,</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>olderFriend</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-40-1><a id=__codelineno-40-1 name=__codelineno-40-1></a><a href=#__codelineno-40-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-40-2><a id=__codelineno-40-2 name=__codelineno-40-2></a><a href=#__codelineno-40-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>person</span>
</span><span id=__span-40-3><a id=__codelineno-40-3 name=__codelineno-40-3></a><a href=#__codelineno-40-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>olderFriend</span>
</span><span id=__span-40-4><a id=__codelineno-40-4 name=__codelineno-40-4></a><a href=#__codelineno-40-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-40-5><a id=__codelineno-40-5 name=__codelineno-40-5></a><a href=#__codelineno-40-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-40-6><a id=__codelineno-40-6 name=__codelineno-40-6></a><a href=#__codelineno-40-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-40-7><a id=__codelineno-40-7 name=__codelineno-40-7></a><a href=#__codelineno-40-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-40-8><a id=__codelineno-40-8 name=__codelineno-40-8></a><a href=#__codelineno-40-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-40-9><a id=__codelineno-40-9 name=__codelineno-40-9></a><a href=#__codelineno-40-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-40-10><a id=__codelineno-40-10 name=__codelineno-40-10></a><a href=#__codelineno-40-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-40-11><a id=__codelineno-40-11 name=__codelineno-40-11></a><a href=#__codelineno-40-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-40-12><a id=__codelineno-40-12 name=__codelineno-40-12></a><a href=#__codelineno-40-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_age</span>
</span><span id=__span-40-13><a id=__codelineno-40-13 name=__codelineno-40-13></a><a href=#__codelineno-40-13><span class=linenos data-linenos="13 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-40-14><a id=__codelineno-40-14 name=__codelineno-40-14></a><a href=#__codelineno-40-14><span class=linenos data-linenos="14 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-40-15><a id=__codelineno-40-15 name=__codelineno-40-15></a><a href=#__codelineno-40-15><span class=linenos data-linenos="15 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-40-16><a id=__codelineno-40-16 name=__codelineno-40-16></a><a href=#__codelineno-40-16><span class=linenos data-linenos="16 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-40-17><a id=__codelineno-40-17 name=__codelineno-40-17></a><a href=#__codelineno-40-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-40-18><a id=__codelineno-40-18 name=__codelineno-40-18></a><a href=#__codelineno-40-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-40-19><a id=__codelineno-40-19 name=__codelineno-40-19></a><a href=#__codelineno-40-19><span class=linenos data-linenos="19 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-40-20><a id=__codelineno-40-20 name=__codelineno-40-20></a><a href=#__codelineno-40-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-40-21><a id=__codelineno-40-21 name=__codelineno-40-21></a><a href=#__codelineno-40-21><span class=linenos data-linenos="21 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-40-22><a id=__codelineno-40-22 name=__codelineno-40-22></a><a href=#__codelineno-40-22><span class=linenos data-linenos="22 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-40-23><a id=__codelineno-40-23 name=__codelineno-40-23></a><a href=#__codelineno-40-23><span class=linenos data-linenos="23 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-40-24><a id=__codelineno-40-24 name=__codelineno-40-24></a><a href=#__codelineno-40-24><span class=linenos data-linenos="24 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-40-25><a id=__codelineno-40-25 name=__codelineno-40-25></a><a href=#__codelineno-40-25><span class=linenos data-linenos="25 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-40-26><a id=__codelineno-40-26 name=__codelineno-40-26></a><a href=#__codelineno-40-26><span class=linenos data-linenos="26 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-40-27><a id=__codelineno-40-27 name=__codelineno-40-27></a><a href=#__codelineno-40-27><span class=linenos data-linenos="27 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-40-28><a id=__codelineno-40-28 name=__codelineno-40-28></a><a href=#__codelineno-40-28><span class=linenos data-linenos="28 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-40-29><a id=__codelineno-40-29 name=__codelineno-40-29></a><a href=#__codelineno-40-29><span class=linenos data-linenos="29 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-40-30><a id=__codelineno-40-30 name=__codelineno-40-30></a><a href=#__codelineno-40-30><span class=linenos data-linenos="30 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-40-31><a id=__codelineno-40-31 name=__codelineno-40-31></a><a href=#__codelineno-40-31><span class=linenos data-linenos="31 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_strength</span>
</span><span id=__span-40-32><a id=__codelineno-40-32 name=__codelineno-40-32></a><a href=#__codelineno-40-32><span class=linenos data-linenos="32 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-40-33><a id=__codelineno-40-33 name=__codelineno-40-33></a><a href=#__codelineno-40-33><span class=linenos data-linenos="33 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-40-34><a id=__codelineno-40-34 name=__codelineno-40-34></a><a href=#__codelineno-40-34><span class=linenos data-linenos="34 "></span></a><span class=w>      </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-40-35><a id=__codelineno-40-35 name=__codelineno-40-35></a><a href=#__codelineno-40-35><span class=linenos data-linenos="35 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-40-36><a id=__codelineno-40-36 name=__codelineno-40-36></a><a href=#__codelineno-40-36><span class=linenos data-linenos="36 "></span></a><span class=w>         </span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-40-37><a id=__codelineno-40-37 name=__codelineno-40-37></a><a href=#__codelineno-40-37><span class=linenos data-linenos="37 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-40-38><a id=__codelineno-40-38 name=__codelineno-40-38></a><a href=#__codelineno-40-38><span class=linenos data-linenos="38 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-40-39><a id=__codelineno-40-39 name=__codelineno-40-39></a><a href=#__codelineno-40-39><span class=linenos data-linenos="39 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_strength</span>
</span><span id=__span-40-40><a id=__codelineno-40-40 name=__codelineno-40-40></a><a href=#__codelineno-40-40><span class=linenos data-linenos="40 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-40-41><a id=__codelineno-40-41 name=__codelineno-40-41></a><a href=#__codelineno-40-41><span class=linenos data-linenos="41 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-40-42><a id=__codelineno-40-42 name=__codelineno-40-42></a><a href=#__codelineno-40-42><span class=linenos data-linenos="42 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-40-43><a id=__codelineno-40-43 name=__codelineno-40-43></a><a href=#__codelineno-40-43><span class=linenos data-linenos="43 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-40-44><a id=__codelineno-40-44 name=__codelineno-40-44></a><a href=#__codelineno-40-44><span class=linenos data-linenos="44 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-40-45><a id=__codelineno-40-45 name=__codelineno-40-45></a><a href=#__codelineno-40-45><span class=linenos data-linenos="45 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-40-46><a id=__codelineno-40-46 name=__codelineno-40-46></a><a href=#__codelineno-40-46><span class=linenos data-linenos="46 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-40-47><a id=__codelineno-40-47 name=__codelineno-40-47></a><a href=#__codelineno-40-47><span class=linenos data-linenos="47 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-40-48><a id=__codelineno-40-48 name=__codelineno-40-48></a><a href=#__codelineno-40-48><span class=linenos data-linenos="48 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-40-49><a id=__codelineno-40-49 name=__codelineno-40-49></a><a href=#__codelineno-40-49><span class=linenos data-linenos="49 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_age</span>
</span><span id=__span-40-50><a id=__codelineno-40-50 name=__codelineno-40-50></a><a href=#__codelineno-40-50><span class=linenos data-linenos="50 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-40-51><a id=__codelineno-40-51 name=__codelineno-40-51></a><a href=#__codelineno-40-51><span class=linenos data-linenos="51 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-40-52><a id=__codelineno-40-52 name=__codelineno-40-52></a><a href=#__codelineno-40-52><span class=linenos data-linenos="52 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>age</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>30</span><span class=p>))</span>
</span><span id=__span-40-53><a id=__codelineno-40-53 name=__codelineno-40-53></a><a href=#__codelineno-40-53><span class=linenos data-linenos="53 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-40-54><a id=__codelineno-40-54 name=__codelineno-40-54></a><a href=#__codelineno-40-54><span class=linenos data-linenos="54 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-40-55><a id=__codelineno-40-55 name=__codelineno-40-55></a><a href=#__codelineno-40-55><span class=linenos data-linenos="55 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-41-1><a id=__codelineno-41-1 name=__codelineno-41-1></a><a href=#__codelineno-41-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-41-2><a id=__codelineno-41-2 name=__codelineno-41-2></a><a href=#__codelineno-41-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-41-3><a id=__codelineno-41-3 name=__codelineno-41-3></a><a href=#__codelineno-41-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-41-4><a id=__codelineno-41-4 name=__codelineno-41-4></a><a href=#__codelineno-41-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-41-5><a id=__codelineno-41-5 name=__codelineno-41-5></a><a href=#__codelineno-41-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-41-6><a id=__codelineno-41-6 name=__codelineno-41-6></a><a href=#__codelineno-41-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-41-7><a id=__codelineno-41-7 name=__codelineno-41-7></a><a href=#__codelineno-41-7><span class=linenos data-linenos=" 7 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-41-8><a id=__codelineno-41-8 name=__codelineno-41-8></a><a href=#__codelineno-41-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-41-9><a id=__codelineno-41-9 name=__codelineno-41-9></a><a href=#__codelineno-41-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: [_anon1:KNOWS]-
</span><span id=__span-41-10><a id=__codelineno-41-10 name=__codelineno-41-10></a><a href=#__codelineno-41-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-41-11><a id=__codelineno-41-11 name=__codelineno-41-11></a><a href=#__codelineno-41-11><span class=linenos data-linenos="11 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-41-12><a id=__codelineno-41-12 name=__codelineno-41-12></a><a href=#__codelineno-41-12><span class=linenos data-linenos="12 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-41-13><a id=__codelineno-41-13 name=__codelineno-41-13></a><a href=#__codelineno-41-13><span class=linenos data-linenos="13 "></span></a>    DataSource: f:Person
</span><span id=__span-41-14><a id=__codelineno-41-14 name=__codelineno-41-14></a><a href=#__codelineno-41-14><span class=linenos data-linenos="14 "></span></a>    Filter: (f.age GT 30)
</span><span id=__span-41-15><a id=__codelineno-41-15 name=__codelineno-41-15></a><a href=#__codelineno-41-15><span class=linenos data-linenos="15 "></span></a>*
</span><span id=__span-41-16><a id=__codelineno-41-16 name=__codelineno-41-16></a><a href=#__codelineno-41-16><span class=linenos data-linenos="16 "></span></a>----------------------------------------------------------------------
</span><span id=__span-41-17><a id=__codelineno-41-17 name=__codelineno-41-17></a><a href=#__codelineno-41-17><span class=linenos data-linenos="17 "></span></a>Level 1:
</span><span id=__span-41-18><a id=__codelineno-41-18 name=__codelineno-41-18></a><a href=#__codelineno-41-18><span class=linenos data-linenos="18 "></span></a>----------------------------------------------------------------------
</span><span id=__span-41-19><a id=__codelineno-41-19 name=__codelineno-41-19></a><a href=#__codelineno-41-19><span class=linenos data-linenos="19 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-41-20><a id=__codelineno-41-20 name=__codelineno-41-20></a><a href=#__codelineno-41-20><span class=linenos data-linenos="20 "></span></a>  JoinOperator(id=4)
</span><span id=__span-41-21><a id=__codelineno-41-21 name=__codelineno-41-21></a><a href=#__codelineno-41-21><span class=linenos data-linenos="21 "></span></a>    JoinType: INNER
</span><span id=__span-41-22><a id=__codelineno-41-22 name=__codelineno-41-22></a><a href=#__codelineno-41-22><span class=linenos data-linenos="22 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=EITHER_AS_SOURCE
</span><span id=__span-41-23><a id=__codelineno-41-23 name=__codelineno-41-23></a><a href=#__codelineno-41-23><span class=linenos data-linenos="23 "></span></a>*
</span><span id=__span-41-24><a id=__codelineno-41-24 name=__codelineno-41-24></a><a href=#__codelineno-41-24><span class=linenos data-linenos="24 "></span></a>----------------------------------------------------------------------
</span><span id=__span-41-25><a id=__codelineno-41-25 name=__codelineno-41-25></a><a href=#__codelineno-41-25><span class=linenos data-linenos="25 "></span></a>Level 2:
</span><span id=__span-41-26><a id=__codelineno-41-26 name=__codelineno-41-26></a><a href=#__codelineno-41-26><span class=linenos data-linenos="26 "></span></a>----------------------------------------------------------------------
</span><span id=__span-41-27><a id=__codelineno-41-27 name=__codelineno-41-27></a><a href=#__codelineno-41-27><span class=linenos data-linenos="27 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=7;
</span><span id=__span-41-28><a id=__codelineno-41-28 name=__codelineno-41-28></a><a href=#__codelineno-41-28><span class=linenos data-linenos="28 "></span></a>  JoinOperator(id=5)
</span><span id=__span-41-29><a id=__codelineno-41-29 name=__codelineno-41-29></a><a href=#__codelineno-41-29><span class=linenos data-linenos="29 "></span></a>    JoinType: INNER
</span><span id=__span-41-30><a id=__codelineno-41-30 name=__codelineno-41-30></a><a href=#__codelineno-41-30><span class=linenos data-linenos="30 "></span></a>    Joins: JoinPair: Node=f RelOrNode=_anon1 Type=EITHER_AS_SINK
</span><span id=__span-41-31><a id=__codelineno-41-31 name=__codelineno-41-31></a><a href=#__codelineno-41-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-41-32><a id=__codelineno-41-32 name=__codelineno-41-32></a><a href=#__codelineno-41-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span><span id=__span-41-33><a id=__codelineno-41-33 name=__codelineno-41-33></a><a href=#__codelineno-41-33><span class=linenos data-linenos="33 "></span></a>Level 3:
</span><span id=__span-41-34><a id=__codelineno-41-34 name=__codelineno-41-34></a><a href=#__codelineno-41-34><span class=linenos data-linenos="34 "></span></a>----------------------------------------------------------------------
</span><span id=__span-41-35><a id=__codelineno-41-35 name=__codelineno-41-35></a><a href=#__codelineno-41-35><span class=linenos data-linenos="35 "></span></a>OpId=7 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-41-36><a id=__codelineno-41-36 name=__codelineno-41-36></a><a href=#__codelineno-41-36><span class=linenos data-linenos="36 "></span></a>  ProjectionOperator(id=7)
</span><span id=__span-41-37><a id=__codelineno-41-37 name=__codelineno-41-37></a><a href=#__codelineno-41-37><span class=linenos data-linenos="37 "></span></a>    Projections: person=p.name, olderFriend=f.name
</span><span id=__span-41-38><a id=__codelineno-41-38 name=__codelineno-41-38></a><a href=#__codelineno-41-38><span class=linenos data-linenos="38 "></span></a>*
</span><span id=__span-41-39><a id=__codelineno-41-39 name=__codelineno-41-39></a><a href=#__codelineno-41-39><span class=linenos data-linenos="39 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=15-undirected-with-mixed-filters-partial-pushdown>15. Undirected with mixed filters (partial pushdown)<a class=headerlink href=#15-undirected-with-mixed-filters-partial-pushdown title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Filter Splitting</p> <details class=note> <summary>Notes</summary> <p>Source filters are pushed, target filter remains after join.</p> <p>FILTER ANALYSIS: p.name = 'Alice'  PUSHED (references only 'p') p.active = true  PUSHED (references only 'p') f.age &gt; 30  NOT PUSHED (references 'f')</p> <p>SQL Pattern (optimized): FROM (SELECT ... FROM Person WHERE name='Alice' AND active=true) AS p JOIN Knows ON ... JOIN Person AS f ON ... WHERE f.age &gt; 30 -- Target filter stays here</p> <p>BENEFIT: Source node filtering happens early, reducing join size. Target filtering still required but on smaller intermediate result.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-42-1><a id=__codelineno-42-1 name=__codelineno-42-1></a><a href=#__codelineno-42-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=o>]-</span><span class=p>(</span><span class=n>f</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-42-2><a id=__codelineno-42-2 name=__codelineno-42-2></a><a href=#__codelineno-42-2><span class=linenos data-linenos="2 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&#39;Alice&#39;</span><span class=w> </span><span class=n>AND</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>30</span><span class=w> </span><span class=n>AND</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=k>true</span>
</span><span id=__span-42-3><a id=__codelineno-42-3 name=__codelineno-42-3></a><a href=#__codelineno-42-3><span class=linenos data-linenos="3 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>friend</span><span class=p>,</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>friendAge</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-43-1><a id=__codelineno-43-1 name=__codelineno-43-1></a><a href=#__codelineno-43-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-43-2><a id=__codelineno-43-2 name=__codelineno-43-2></a><a href=#__codelineno-43-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>friend</span>
</span><span id=__span-43-3><a id=__codelineno-43-3 name=__codelineno-43-3></a><a href=#__codelineno-43-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_f_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>friendAge</span>
</span><span id=__span-43-4><a id=__codelineno-43-4 name=__codelineno-43-4></a><a href=#__codelineno-43-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-43-5><a id=__codelineno-43-5 name=__codelineno-43-5></a><a href=#__codelineno-43-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-43-6><a id=__codelineno-43-6 name=__codelineno-43-6></a><a href=#__codelineno-43-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-43-7><a id=__codelineno-43-7 name=__codelineno-43-7></a><a href=#__codelineno-43-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-43-8><a id=__codelineno-43-8 name=__codelineno-43-8></a><a href=#__codelineno-43-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_active</span>
</span><span id=__span-43-9><a id=__codelineno-43-9 name=__codelineno-43-9></a><a href=#__codelineno-43-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-43-10><a id=__codelineno-43-10 name=__codelineno-43-10></a><a href=#__codelineno-43-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-43-11><a id=__codelineno-43-11 name=__codelineno-43-11></a><a href=#__codelineno-43-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-43-12><a id=__codelineno-43-12 name=__codelineno-43-12></a><a href=#__codelineno-43-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-43-13><a id=__codelineno-43-13 name=__codelineno-43-13></a><a href=#__codelineno-43-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_age</span>
</span><span id=__span-43-14><a id=__codelineno-43-14 name=__codelineno-43-14></a><a href=#__codelineno-43-14><span class=linenos data-linenos="14 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-43-15><a id=__codelineno-43-15 name=__codelineno-43-15></a><a href=#__codelineno-43-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-43-16><a id=__codelineno-43-16 name=__codelineno-43-16></a><a href=#__codelineno-43-16><span class=linenos data-linenos="16 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-43-17><a id=__codelineno-43-17 name=__codelineno-43-17></a><a href=#__codelineno-43-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-43-18><a id=__codelineno-43-18 name=__codelineno-43-18></a><a href=#__codelineno-43-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_active</span>
</span><span id=__span-43-19><a id=__codelineno-43-19 name=__codelineno-43-19></a><a href=#__codelineno-43-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-43-20><a id=__codelineno-43-20 name=__codelineno-43-20></a><a href=#__codelineno-43-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-43-21><a id=__codelineno-43-21 name=__codelineno-43-21></a><a href=#__codelineno-43-21><span class=linenos data-linenos="21 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-43-22><a id=__codelineno-43-22 name=__codelineno-43-22></a><a href=#__codelineno-43-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-43-23><a id=__codelineno-43-23 name=__codelineno-43-23></a><a href=#__codelineno-43-23><span class=linenos data-linenos="23 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-43-24><a id=__codelineno-43-24 name=__codelineno-43-24></a><a href=#__codelineno-43-24><span class=linenos data-linenos="24 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-43-25><a id=__codelineno-43-25 name=__codelineno-43-25></a><a href=#__codelineno-43-25><span class=linenos data-linenos="25 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_active</span>
</span><span id=__span-43-26><a id=__codelineno-43-26 name=__codelineno-43-26></a><a href=#__codelineno-43-26><span class=linenos data-linenos="26 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-43-27><a id=__codelineno-43-27 name=__codelineno-43-27></a><a href=#__codelineno-43-27><span class=linenos data-linenos="27 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-43-28><a id=__codelineno-43-28 name=__codelineno-43-28></a><a href=#__codelineno-43-28><span class=linenos data-linenos="28 "></span></a><span class=w>      </span><span class=k>WHERE</span><span class=w> </span><span class=p>(((</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Alice&#39;</span><span class=p>))</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=p>((</span><span class=n>active</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=k>TRUE</span><span class=p>)))</span>
</span><span id=__span-43-29><a id=__codelineno-43-29 name=__codelineno-43-29></a><a href=#__codelineno-43-29><span class=linenos data-linenos="29 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-43-30><a id=__codelineno-43-30 name=__codelineno-43-30></a><a href=#__codelineno-43-30><span class=linenos data-linenos="30 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-43-31><a id=__codelineno-43-31 name=__codelineno-43-31></a><a href=#__codelineno-43-31><span class=linenos data-linenos="31 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-43-32><a id=__codelineno-43-32 name=__codelineno-43-32></a><a href=#__codelineno-43-32><span class=linenos data-linenos="32 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-43-33><a id=__codelineno-43-33 name=__codelineno-43-33></a><a href=#__codelineno-43-33><span class=linenos data-linenos="33 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-43-34><a id=__codelineno-43-34 name=__codelineno-43-34></a><a href=#__codelineno-43-34><span class=linenos data-linenos="34 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-43-35><a id=__codelineno-43-35 name=__codelineno-43-35></a><a href=#__codelineno-43-35><span class=linenos data-linenos="35 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_strength</span>
</span><span id=__span-43-36><a id=__codelineno-43-36 name=__codelineno-43-36></a><a href=#__codelineno-43-36><span class=linenos data-linenos="36 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-43-37><a id=__codelineno-43-37 name=__codelineno-43-37></a><a href=#__codelineno-43-37><span class=linenos data-linenos="37 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-43-38><a id=__codelineno-43-38 name=__codelineno-43-38></a><a href=#__codelineno-43-38><span class=linenos data-linenos="38 "></span></a><span class=w>      </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-43-39><a id=__codelineno-43-39 name=__codelineno-43-39></a><a href=#__codelineno-43-39><span class=linenos data-linenos="39 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-43-40><a id=__codelineno-43-40 name=__codelineno-43-40></a><a href=#__codelineno-43-40><span class=linenos data-linenos="40 "></span></a><span class=w>         </span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-43-41><a id=__codelineno-43-41 name=__codelineno-43-41></a><a href=#__codelineno-43-41><span class=linenos data-linenos="41 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-43-42><a id=__codelineno-43-42 name=__codelineno-43-42></a><a href=#__codelineno-43-42><span class=linenos data-linenos="42 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-43-43><a id=__codelineno-43-43 name=__codelineno-43-43></a><a href=#__codelineno-43-43><span class=linenos data-linenos="43 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_strength</span>
</span><span id=__span-43-44><a id=__codelineno-43-44 name=__codelineno-43-44></a><a href=#__codelineno-43-44><span class=linenos data-linenos="44 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-43-45><a id=__codelineno-43-45 name=__codelineno-43-45></a><a href=#__codelineno-43-45><span class=linenos data-linenos="45 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-43-46><a id=__codelineno-43-46 name=__codelineno-43-46></a><a href=#__codelineno-43-46><span class=linenos data-linenos="46 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-43-47><a id=__codelineno-43-47 name=__codelineno-43-47></a><a href=#__codelineno-43-47><span class=linenos data-linenos="47 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-43-48><a id=__codelineno-43-48 name=__codelineno-43-48></a><a href=#__codelineno-43-48><span class=linenos data-linenos="48 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-43-49><a id=__codelineno-43-49 name=__codelineno-43-49></a><a href=#__codelineno-43-49><span class=linenos data-linenos="49 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-43-50><a id=__codelineno-43-50 name=__codelineno-43-50></a><a href=#__codelineno-43-50><span class=linenos data-linenos="50 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-43-51><a id=__codelineno-43-51 name=__codelineno-43-51></a><a href=#__codelineno-43-51><span class=linenos data-linenos="51 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-43-52><a id=__codelineno-43-52 name=__codelineno-43-52></a><a href=#__codelineno-43-52><span class=linenos data-linenos="52 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-43-53><a id=__codelineno-43-53 name=__codelineno-43-53></a><a href=#__codelineno-43-53><span class=linenos data-linenos="53 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_age</span>
</span><span id=__span-43-54><a id=__codelineno-43-54 name=__codelineno-43-54></a><a href=#__codelineno-43-54><span class=linenos data-linenos="54 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-43-55><a id=__codelineno-43-55 name=__codelineno-43-55></a><a href=#__codelineno-43-55><span class=linenos data-linenos="55 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-43-56><a id=__codelineno-43-56 name=__codelineno-43-56></a><a href=#__codelineno-43-56><span class=linenos data-linenos="56 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>age</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>30</span><span class=p>))</span>
</span><span id=__span-43-57><a id=__codelineno-43-57 name=__codelineno-43-57></a><a href=#__codelineno-43-57><span class=linenos data-linenos="57 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-43-58><a id=__codelineno-43-58 name=__codelineno-43-58></a><a href=#__codelineno-43-58><span class=linenos data-linenos="58 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-43-59><a id=__codelineno-43-59 name=__codelineno-43-59></a><a href=#__codelineno-43-59><span class=linenos data-linenos="59 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-44-1><a id=__codelineno-44-1 name=__codelineno-44-1></a><a href=#__codelineno-44-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-44-2><a id=__codelineno-44-2 name=__codelineno-44-2></a><a href=#__codelineno-44-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-44-3><a id=__codelineno-44-3 name=__codelineno-44-3></a><a href=#__codelineno-44-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-44-4><a id=__codelineno-44-4 name=__codelineno-44-4></a><a href=#__codelineno-44-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-44-5><a id=__codelineno-44-5 name=__codelineno-44-5></a><a href=#__codelineno-44-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-44-6><a id=__codelineno-44-6 name=__codelineno-44-6></a><a href=#__codelineno-44-6><span class=linenos data-linenos=" 6 "></span></a>    Filter: ((p.name EQ &#39;Alice&#39;) AND (p.active EQ true))
</span><span id=__span-44-7><a id=__codelineno-44-7 name=__codelineno-44-7></a><a href=#__codelineno-44-7><span class=linenos data-linenos=" 7 "></span></a>*
</span><span id=__span-44-8><a id=__codelineno-44-8 name=__codelineno-44-8></a><a href=#__codelineno-44-8><span class=linenos data-linenos=" 8 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-44-9><a id=__codelineno-44-9 name=__codelineno-44-9></a><a href=#__codelineno-44-9><span class=linenos data-linenos=" 9 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-44-10><a id=__codelineno-44-10 name=__codelineno-44-10></a><a href=#__codelineno-44-10><span class=linenos data-linenos="10 "></span></a>    DataSource: [_anon1:KNOWS]-
</span><span id=__span-44-11><a id=__codelineno-44-11 name=__codelineno-44-11></a><a href=#__codelineno-44-11><span class=linenos data-linenos="11 "></span></a>*
</span><span id=__span-44-12><a id=__codelineno-44-12 name=__codelineno-44-12></a><a href=#__codelineno-44-12><span class=linenos data-linenos="12 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-44-13><a id=__codelineno-44-13 name=__codelineno-44-13></a><a href=#__codelineno-44-13><span class=linenos data-linenos="13 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-44-14><a id=__codelineno-44-14 name=__codelineno-44-14></a><a href=#__codelineno-44-14><span class=linenos data-linenos="14 "></span></a>    DataSource: f:Person
</span><span id=__span-44-15><a id=__codelineno-44-15 name=__codelineno-44-15></a><a href=#__codelineno-44-15><span class=linenos data-linenos="15 "></span></a>    Filter: (f.age GT 30)
</span><span id=__span-44-16><a id=__codelineno-44-16 name=__codelineno-44-16></a><a href=#__codelineno-44-16><span class=linenos data-linenos="16 "></span></a>*
</span><span id=__span-44-17><a id=__codelineno-44-17 name=__codelineno-44-17></a><a href=#__codelineno-44-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-44-18><a id=__codelineno-44-18 name=__codelineno-44-18></a><a href=#__codelineno-44-18><span class=linenos data-linenos="18 "></span></a>Level 1:
</span><span id=__span-44-19><a id=__codelineno-44-19 name=__codelineno-44-19></a><a href=#__codelineno-44-19><span class=linenos data-linenos="19 "></span></a>----------------------------------------------------------------------
</span><span id=__span-44-20><a id=__codelineno-44-20 name=__codelineno-44-20></a><a href=#__codelineno-44-20><span class=linenos data-linenos="20 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-44-21><a id=__codelineno-44-21 name=__codelineno-44-21></a><a href=#__codelineno-44-21><span class=linenos data-linenos="21 "></span></a>  JoinOperator(id=4)
</span><span id=__span-44-22><a id=__codelineno-44-22 name=__codelineno-44-22></a><a href=#__codelineno-44-22><span class=linenos data-linenos="22 "></span></a>    JoinType: INNER
</span><span id=__span-44-23><a id=__codelineno-44-23 name=__codelineno-44-23></a><a href=#__codelineno-44-23><span class=linenos data-linenos="23 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=EITHER_AS_SOURCE
</span><span id=__span-44-24><a id=__codelineno-44-24 name=__codelineno-44-24></a><a href=#__codelineno-44-24><span class=linenos data-linenos="24 "></span></a>*
</span><span id=__span-44-25><a id=__codelineno-44-25 name=__codelineno-44-25></a><a href=#__codelineno-44-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-44-26><a id=__codelineno-44-26 name=__codelineno-44-26></a><a href=#__codelineno-44-26><span class=linenos data-linenos="26 "></span></a>Level 2:
</span><span id=__span-44-27><a id=__codelineno-44-27 name=__codelineno-44-27></a><a href=#__codelineno-44-27><span class=linenos data-linenos="27 "></span></a>----------------------------------------------------------------------
</span><span id=__span-44-28><a id=__codelineno-44-28 name=__codelineno-44-28></a><a href=#__codelineno-44-28><span class=linenos data-linenos="28 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=7;
</span><span id=__span-44-29><a id=__codelineno-44-29 name=__codelineno-44-29></a><a href=#__codelineno-44-29><span class=linenos data-linenos="29 "></span></a>  JoinOperator(id=5)
</span><span id=__span-44-30><a id=__codelineno-44-30 name=__codelineno-44-30></a><a href=#__codelineno-44-30><span class=linenos data-linenos="30 "></span></a>    JoinType: INNER
</span><span id=__span-44-31><a id=__codelineno-44-31 name=__codelineno-44-31></a><a href=#__codelineno-44-31><span class=linenos data-linenos="31 "></span></a>    Joins: JoinPair: Node=f RelOrNode=_anon1 Type=EITHER_AS_SINK
</span><span id=__span-44-32><a id=__codelineno-44-32 name=__codelineno-44-32></a><a href=#__codelineno-44-32><span class=linenos data-linenos="32 "></span></a>*
</span><span id=__span-44-33><a id=__codelineno-44-33 name=__codelineno-44-33></a><a href=#__codelineno-44-33><span class=linenos data-linenos="33 "></span></a>----------------------------------------------------------------------
</span><span id=__span-44-34><a id=__codelineno-44-34 name=__codelineno-44-34></a><a href=#__codelineno-44-34><span class=linenos data-linenos="34 "></span></a>Level 3:
</span><span id=__span-44-35><a id=__codelineno-44-35 name=__codelineno-44-35></a><a href=#__codelineno-44-35><span class=linenos data-linenos="35 "></span></a>----------------------------------------------------------------------
</span><span id=__span-44-36><a id=__codelineno-44-36 name=__codelineno-44-36></a><a href=#__codelineno-44-36><span class=linenos data-linenos="36 "></span></a>OpId=7 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-44-37><a id=__codelineno-44-37 name=__codelineno-44-37></a><a href=#__codelineno-44-37><span class=linenos data-linenos="37 "></span></a>  ProjectionOperator(id=7)
</span><span id=__span-44-38><a id=__codelineno-44-38 name=__codelineno-44-38></a><a href=#__codelineno-44-38><span class=linenos data-linenos="38 "></span></a>    Projections: friend=f.name, friendAge=f.age
</span><span id=__span-44-39><a id=__codelineno-44-39 name=__codelineno-44-39></a><a href=#__codelineno-44-39><span class=linenos data-linenos="39 "></span></a>*
</span><span id=__span-44-40><a id=__codelineno-44-40 name=__codelineno-44-40></a><a href=#__codelineno-44-40><span class=linenos data-linenos="40 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=16-undirected-multi-hop-with-predicate-pushdown>16. Undirected multi-hop with predicate pushdown<a class=headerlink href=#16-undirected-multi-hop-with-predicate-pushdown title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Complex Traversal</p> <details class=note> <summary>Notes</summary> <p>Multi-hop undirected traversal with source filter pushdown.</p> <p>PATTERN: Alice's friends' friends (2-hop undirected)</p> <p>OPTIMIZATION: Filter p.name='Alice' is pushed into first Person scan. Each hop doubles potential paths, so early filtering is critical.</p> <p>SQL Pattern: FROM (SELECT ... FROM Person WHERE name='Alice') AS p JOIN Knows k1 ON (p.id = k1.person_id OR p.id = k1.friend_id) JOIN Person m ON (m.id = k1.person_id OR m.id = k1.friend_id) JOIN Knows k2 ON (m.id = k2.person_id OR m.id = k2.friend_id) JOIN Person f ON (f.id = k2.person_id OR f.id = k2.friend_id)</p> <p>DATABRICKS COMPLEXITY: O(k^2) where k = avg degree COST: High, but pushdown prevents O(n * k^2) explosion.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-45-1><a id=__codelineno-45-1 name=__codelineno-45-1></a><a href=#__codelineno-45-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=o>]-</span><span class=p>(</span><span class=n>m</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=o>]-</span><span class=p>(</span><span class=n>f</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-45-2><a id=__codelineno-45-2 name=__codelineno-45-2></a><a href=#__codelineno-45-2><span class=linenos data-linenos="2 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&#39;Alice&#39;</span>
</span><span id=__span-45-3><a id=__codelineno-45-3 name=__codelineno-45-3></a><a href=#__codelineno-45-3><span class=linenos data-linenos="3 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>friendOfFriend</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-46-1><a id=__codelineno-46-1 name=__codelineno-46-1></a><a href=#__codelineno-46-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span>
</span><span id=__span-46-2><a id=__codelineno-46-2 name=__codelineno-46-2></a><a href=#__codelineno-46-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>friendOfFriend</span>
</span><span id=__span-46-3><a id=__codelineno-46-3 name=__codelineno-46-3></a><a href=#__codelineno-46-3><span class=linenos data-linenos=" 3 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-46-4><a id=__codelineno-46-4 name=__codelineno-46-4></a><a href=#__codelineno-46-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-46-5><a id=__codelineno-46-5 name=__codelineno-46-5></a><a href=#__codelineno-46-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-46-6><a id=__codelineno-46-6 name=__codelineno-46-6></a><a href=#__codelineno-46-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-46-7><a id=__codelineno-46-7 name=__codelineno-46-7></a><a href=#__codelineno-46-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-46-8><a id=__codelineno-46-8 name=__codelineno-46-8></a><a href=#__codelineno-46-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-46-9><a id=__codelineno-46-9 name=__codelineno-46-9></a><a href=#__codelineno-46-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_m_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_m_id</span>
</span><span id=__span-46-10><a id=__codelineno-46-10 name=__codelineno-46-10></a><a href=#__codelineno-46-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_person_id</span>
</span><span id=__span-46-11><a id=__codelineno-46-11 name=__codelineno-46-11></a><a href=#__codelineno-46-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_friend_id</span>
</span><span id=__span-46-12><a id=__codelineno-46-12 name=__codelineno-46-12></a><a href=#__codelineno-46-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-46-13><a id=__codelineno-46-13 name=__codelineno-46-13></a><a href=#__codelineno-46-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-46-14><a id=__codelineno-46-14 name=__codelineno-46-14></a><a href=#__codelineno-46-14><span class=linenos data-linenos="14 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-46-15><a id=__codelineno-46-15 name=__codelineno-46-15></a><a href=#__codelineno-46-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-46-16><a id=__codelineno-46-16 name=__codelineno-46-16></a><a href=#__codelineno-46-16><span class=linenos data-linenos="16 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-46-17><a id=__codelineno-46-17 name=__codelineno-46-17></a><a href=#__codelineno-46-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-46-18><a id=__codelineno-46-18 name=__codelineno-46-18></a><a href=#__codelineno-46-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-46-19><a id=__codelineno-46-19 name=__codelineno-46-19></a><a href=#__codelineno-46-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-46-20><a id=__codelineno-46-20 name=__codelineno-46-20></a><a href=#__codelineno-46-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_m_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_m_id</span>
</span><span id=__span-46-21><a id=__codelineno-46-21 name=__codelineno-46-21></a><a href=#__codelineno-46-21><span class=linenos data-linenos="21 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_person_id</span>
</span><span id=__span-46-22><a id=__codelineno-46-22 name=__codelineno-46-22></a><a href=#__codelineno-46-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_friend_id</span>
</span><span id=__span-46-23><a id=__codelineno-46-23 name=__codelineno-46-23></a><a href=#__codelineno-46-23><span class=linenos data-linenos="23 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-46-24><a id=__codelineno-46-24 name=__codelineno-46-24></a><a href=#__codelineno-46-24><span class=linenos data-linenos="24 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-46-25><a id=__codelineno-46-25 name=__codelineno-46-25></a><a href=#__codelineno-46-25><span class=linenos data-linenos="25 "></span></a><span class=w>         </span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-46-26><a id=__codelineno-46-26 name=__codelineno-46-26></a><a href=#__codelineno-46-26><span class=linenos data-linenos="26 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-46-27><a id=__codelineno-46-27 name=__codelineno-46-27></a><a href=#__codelineno-46-27><span class=linenos data-linenos="27 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-46-28><a id=__codelineno-46-28 name=__codelineno-46-28></a><a href=#__codelineno-46-28><span class=linenos data-linenos="28 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-46-29><a id=__codelineno-46-29 name=__codelineno-46-29></a><a href=#__codelineno-46-29><span class=linenos data-linenos="29 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_right_2</span><span class=p>.</span><span class=n>_gsql2rsql_m_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_m_id</span>
</span><span id=__span-46-30><a id=__codelineno-46-30 name=__codelineno-46-30></a><a href=#__codelineno-46-30><span class=linenos data-linenos="30 "></span></a><span class=w>      </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-46-31><a id=__codelineno-46-31 name=__codelineno-46-31></a><a href=#__codelineno-46-31><span class=linenos data-linenos="31 "></span></a><span class=w>        </span><span class=k>SELECT</span>
</span><span id=__span-46-32><a id=__codelineno-46-32 name=__codelineno-46-32></a><a href=#__codelineno-46-32><span class=linenos data-linenos="32 "></span></a><span class=w>           </span><span class=n>_left_3</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-46-33><a id=__codelineno-46-33 name=__codelineno-46-33></a><a href=#__codelineno-46-33><span class=linenos data-linenos="33 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>_left_3</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-46-34><a id=__codelineno-46-34 name=__codelineno-46-34></a><a href=#__codelineno-46-34><span class=linenos data-linenos="34 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>_right_3</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-46-35><a id=__codelineno-46-35 name=__codelineno-46-35></a><a href=#__codelineno-46-35><span class=linenos data-linenos="35 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>_right_3</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-46-36><a id=__codelineno-46-36 name=__codelineno-46-36></a><a href=#__codelineno-46-36><span class=linenos data-linenos="36 "></span></a><span class=w>        </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-46-37><a id=__codelineno-46-37 name=__codelineno-46-37></a><a href=#__codelineno-46-37><span class=linenos data-linenos="37 "></span></a><span class=w>          </span><span class=k>SELECT</span>
</span><span id=__span-46-38><a id=__codelineno-46-38 name=__codelineno-46-38></a><a href=#__codelineno-46-38><span class=linenos data-linenos="38 "></span></a><span class=w>             </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-46-39><a id=__codelineno-46-39 name=__codelineno-46-39></a><a href=#__codelineno-46-39><span class=linenos data-linenos="39 "></span></a><span class=w>            </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-46-40><a id=__codelineno-46-40 name=__codelineno-46-40></a><a href=#__codelineno-46-40><span class=linenos data-linenos="40 "></span></a><span class=w>          </span><span class=k>FROM</span>
</span><span id=__span-46-41><a id=__codelineno-46-41 name=__codelineno-46-41></a><a href=#__codelineno-46-41><span class=linenos data-linenos="41 "></span></a><span class=w>            </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-46-42><a id=__codelineno-46-42 name=__codelineno-46-42></a><a href=#__codelineno-46-42><span class=linenos data-linenos="42 "></span></a><span class=w>          </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Alice&#39;</span><span class=p>))</span>
</span><span id=__span-46-43><a id=__codelineno-46-43 name=__codelineno-46-43></a><a href=#__codelineno-46-43><span class=linenos data-linenos="43 "></span></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_3</span>
</span><span id=__span-46-44><a id=__codelineno-46-44 name=__codelineno-46-44></a><a href=#__codelineno-46-44><span class=linenos data-linenos="44 "></span></a><span class=w>        </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-46-45><a id=__codelineno-46-45 name=__codelineno-46-45></a><a href=#__codelineno-46-45><span class=linenos data-linenos="45 "></span></a><span class=w>          </span><span class=k>SELECT</span>
</span><span id=__span-46-46><a id=__codelineno-46-46 name=__codelineno-46-46></a><a href=#__codelineno-46-46><span class=linenos data-linenos="46 "></span></a><span class=w>             </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-46-47><a id=__codelineno-46-47 name=__codelineno-46-47></a><a href=#__codelineno-46-47><span class=linenos data-linenos="47 "></span></a><span class=w>            </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-46-48><a id=__codelineno-46-48 name=__codelineno-46-48></a><a href=#__codelineno-46-48><span class=linenos data-linenos="48 "></span></a><span class=w>            </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-46-49><a id=__codelineno-46-49 name=__codelineno-46-49></a><a href=#__codelineno-46-49><span class=linenos data-linenos="49 "></span></a><span class=w>            </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_strength</span>
</span><span id=__span-46-50><a id=__codelineno-46-50 name=__codelineno-46-50></a><a href=#__codelineno-46-50><span class=linenos data-linenos="50 "></span></a><span class=w>          </span><span class=k>FROM</span>
</span><span id=__span-46-51><a id=__codelineno-46-51 name=__codelineno-46-51></a><a href=#__codelineno-46-51><span class=linenos data-linenos="51 "></span></a><span class=w>            </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-46-52><a id=__codelineno-46-52 name=__codelineno-46-52></a><a href=#__codelineno-46-52><span class=linenos data-linenos="52 "></span></a><span class=w>          </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-46-53><a id=__codelineno-46-53 name=__codelineno-46-53></a><a href=#__codelineno-46-53><span class=linenos data-linenos="53 "></span></a><span class=w>          </span><span class=k>SELECT</span>
</span><span id=__span-46-54><a id=__codelineno-46-54 name=__codelineno-46-54></a><a href=#__codelineno-46-54><span class=linenos data-linenos="54 "></span></a><span class=w>             </span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-46-55><a id=__codelineno-46-55 name=__codelineno-46-55></a><a href=#__codelineno-46-55><span class=linenos data-linenos="55 "></span></a><span class=w>            </span><span class=p>,</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-46-56><a id=__codelineno-46-56 name=__codelineno-46-56></a><a href=#__codelineno-46-56><span class=linenos data-linenos="56 "></span></a><span class=w>            </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-46-57><a id=__codelineno-46-57 name=__codelineno-46-57></a><a href=#__codelineno-46-57><span class=linenos data-linenos="57 "></span></a><span class=w>            </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_strength</span>
</span><span id=__span-46-58><a id=__codelineno-46-58 name=__codelineno-46-58></a><a href=#__codelineno-46-58><span class=linenos data-linenos="58 "></span></a><span class=w>          </span><span class=k>FROM</span>
</span><span id=__span-46-59><a id=__codelineno-46-59 name=__codelineno-46-59></a><a href=#__codelineno-46-59><span class=linenos data-linenos="59 "></span></a><span class=w>            </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-46-60><a id=__codelineno-46-60 name=__codelineno-46-60></a><a href=#__codelineno-46-60><span class=linenos data-linenos="60 "></span></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_3</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-46-61><a id=__codelineno-46-61 name=__codelineno-46-61></a><a href=#__codelineno-46-61><span class=linenos data-linenos="61 "></span></a><span class=w>          </span><span class=n>_left_3</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_3</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-46-62><a id=__codelineno-46-62 name=__codelineno-46-62></a><a href=#__codelineno-46-62><span class=linenos data-linenos="62 "></span></a><span class=w>      </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_2</span>
</span><span id=__span-46-63><a id=__codelineno-46-63 name=__codelineno-46-63></a><a href=#__codelineno-46-63><span class=linenos data-linenos="63 "></span></a><span class=w>      </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-46-64><a id=__codelineno-46-64 name=__codelineno-46-64></a><a href=#__codelineno-46-64><span class=linenos data-linenos="64 "></span></a><span class=w>        </span><span class=k>SELECT</span>
</span><span id=__span-46-65><a id=__codelineno-46-65 name=__codelineno-46-65></a><a href=#__codelineno-46-65><span class=linenos data-linenos="65 "></span></a><span class=w>           </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_m_id</span>
</span><span id=__span-46-66><a id=__codelineno-46-66 name=__codelineno-46-66></a><a href=#__codelineno-46-66><span class=linenos data-linenos="66 "></span></a><span class=w>        </span><span class=k>FROM</span>
</span><span id=__span-46-67><a id=__codelineno-46-67 name=__codelineno-46-67></a><a href=#__codelineno-46-67><span class=linenos data-linenos="67 "></span></a><span class=w>          </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-46-68><a id=__codelineno-46-68 name=__codelineno-46-68></a><a href=#__codelineno-46-68><span class=linenos data-linenos="68 "></span></a><span class=w>      </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_2</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-46-69><a id=__codelineno-46-69 name=__codelineno-46-69></a><a href=#__codelineno-46-69><span class=linenos data-linenos="69 "></span></a><span class=w>        </span><span class=n>_right_2</span><span class=p>.</span><span class=n>_gsql2rsql_m_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-46-70><a id=__codelineno-46-70 name=__codelineno-46-70></a><a href=#__codelineno-46-70><span class=linenos data-linenos="70 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-46-71><a id=__codelineno-46-71 name=__codelineno-46-71></a><a href=#__codelineno-46-71><span class=linenos data-linenos="71 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-46-72><a id=__codelineno-46-72 name=__codelineno-46-72></a><a href=#__codelineno-46-72><span class=linenos data-linenos="72 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-46-73><a id=__codelineno-46-73 name=__codelineno-46-73></a><a href=#__codelineno-46-73><span class=linenos data-linenos="73 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_person_id</span>
</span><span id=__span-46-74><a id=__codelineno-46-74 name=__codelineno-46-74></a><a href=#__codelineno-46-74><span class=linenos data-linenos="74 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_friend_id</span>
</span><span id=__span-46-75><a id=__codelineno-46-75 name=__codelineno-46-75></a><a href=#__codelineno-46-75><span class=linenos data-linenos="75 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_since</span>
</span><span id=__span-46-76><a id=__codelineno-46-76 name=__codelineno-46-76></a><a href=#__codelineno-46-76><span class=linenos data-linenos="76 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_strength</span>
</span><span id=__span-46-77><a id=__codelineno-46-77 name=__codelineno-46-77></a><a href=#__codelineno-46-77><span class=linenos data-linenos="77 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-46-78><a id=__codelineno-46-78 name=__codelineno-46-78></a><a href=#__codelineno-46-78><span class=linenos data-linenos="78 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-46-79><a id=__codelineno-46-79 name=__codelineno-46-79></a><a href=#__codelineno-46-79><span class=linenos data-linenos="79 "></span></a><span class=w>      </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-46-80><a id=__codelineno-46-80 name=__codelineno-46-80></a><a href=#__codelineno-46-80><span class=linenos data-linenos="80 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-46-81><a id=__codelineno-46-81 name=__codelineno-46-81></a><a href=#__codelineno-46-81><span class=linenos data-linenos="81 "></span></a><span class=w>         </span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_person_id</span>
</span><span id=__span-46-82><a id=__codelineno-46-82 name=__codelineno-46-82></a><a href=#__codelineno-46-82><span class=linenos data-linenos="82 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_friend_id</span>
</span><span id=__span-46-83><a id=__codelineno-46-83 name=__codelineno-46-83></a><a href=#__codelineno-46-83><span class=linenos data-linenos="83 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_since</span>
</span><span id=__span-46-84><a id=__codelineno-46-84 name=__codelineno-46-84></a><a href=#__codelineno-46-84><span class=linenos data-linenos="84 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_strength</span>
</span><span id=__span-46-85><a id=__codelineno-46-85 name=__codelineno-46-85></a><a href=#__codelineno-46-85><span class=linenos data-linenos="85 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-46-86><a id=__codelineno-46-86 name=__codelineno-46-86></a><a href=#__codelineno-46-86><span class=linenos data-linenos="86 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-46-87><a id=__codelineno-46-87 name=__codelineno-46-87></a><a href=#__codelineno-46-87><span class=linenos data-linenos="87 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-46-88><a id=__codelineno-46-88 name=__codelineno-46-88></a><a href=#__codelineno-46-88><span class=linenos data-linenos="88 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_m_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_person_id</span>
</span><span id=__span-46-89><a id=__codelineno-46-89 name=__codelineno-46-89></a><a href=#__codelineno-46-89><span class=linenos data-linenos="89 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-46-90><a id=__codelineno-46-90 name=__codelineno-46-90></a><a href=#__codelineno-46-90><span class=linenos data-linenos="90 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-46-91><a id=__codelineno-46-91 name=__codelineno-46-91></a><a href=#__codelineno-46-91><span class=linenos data-linenos="91 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-46-92><a id=__codelineno-46-92 name=__codelineno-46-92></a><a href=#__codelineno-46-92><span class=linenos data-linenos="92 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-46-93><a id=__codelineno-46-93 name=__codelineno-46-93></a><a href=#__codelineno-46-93><span class=linenos data-linenos="93 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-46-94><a id=__codelineno-46-94 name=__codelineno-46-94></a><a href=#__codelineno-46-94><span class=linenos data-linenos="94 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-46-95><a id=__codelineno-46-95 name=__codelineno-46-95></a><a href=#__codelineno-46-95><span class=linenos data-linenos="95 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-46-96><a id=__codelineno-46-96 name=__codelineno-46-96></a><a href=#__codelineno-46-96><span class=linenos data-linenos="96 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-46-97><a id=__codelineno-46-97 name=__codelineno-46-97></a><a href=#__codelineno-46-97><span class=linenos data-linenos="97 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_friend_id</span>
</span><span id=__span-46-98><a id=__codelineno-46-98 name=__codelineno-46-98></a><a href=#__codelineno-46-98><span class=linenos data-linenos="98 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-47-1><a id=__codelineno-47-1 name=__codelineno-47-1></a><a href=#__codelineno-47-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-47-2><a id=__codelineno-47-2 name=__codelineno-47-2></a><a href=#__codelineno-47-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-47-3><a id=__codelineno-47-3 name=__codelineno-47-3></a><a href=#__codelineno-47-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=6;
</span><span id=__span-47-4><a id=__codelineno-47-4 name=__codelineno-47-4></a><a href=#__codelineno-47-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-47-5><a id=__codelineno-47-5 name=__codelineno-47-5></a><a href=#__codelineno-47-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-47-6><a id=__codelineno-47-6 name=__codelineno-47-6></a><a href=#__codelineno-47-6><span class=linenos data-linenos=" 6 "></span></a>    Filter: (p.name EQ &#39;Alice&#39;)
</span><span id=__span-47-7><a id=__codelineno-47-7 name=__codelineno-47-7></a><a href=#__codelineno-47-7><span class=linenos data-linenos=" 7 "></span></a>*
</span><span id=__span-47-8><a id=__codelineno-47-8 name=__codelineno-47-8></a><a href=#__codelineno-47-8><span class=linenos data-linenos=" 8 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=6;
</span><span id=__span-47-9><a id=__codelineno-47-9 name=__codelineno-47-9></a><a href=#__codelineno-47-9><span class=linenos data-linenos=" 9 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-47-10><a id=__codelineno-47-10 name=__codelineno-47-10></a><a href=#__codelineno-47-10><span class=linenos data-linenos="10 "></span></a>    DataSource: [_anon1:KNOWS]-
</span><span id=__span-47-11><a id=__codelineno-47-11 name=__codelineno-47-11></a><a href=#__codelineno-47-11><span class=linenos data-linenos="11 "></span></a>*
</span><span id=__span-47-12><a id=__codelineno-47-12 name=__codelineno-47-12></a><a href=#__codelineno-47-12><span class=linenos data-linenos="12 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=7;
</span><span id=__span-47-13><a id=__codelineno-47-13 name=__codelineno-47-13></a><a href=#__codelineno-47-13><span class=linenos data-linenos="13 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-47-14><a id=__codelineno-47-14 name=__codelineno-47-14></a><a href=#__codelineno-47-14><span class=linenos data-linenos="14 "></span></a>    DataSource: m:Person
</span><span id=__span-47-15><a id=__codelineno-47-15 name=__codelineno-47-15></a><a href=#__codelineno-47-15><span class=linenos data-linenos="15 "></span></a>*
</span><span id=__span-47-16><a id=__codelineno-47-16 name=__codelineno-47-16></a><a href=#__codelineno-47-16><span class=linenos data-linenos="16 "></span></a>OpId=4 Op=DataSourceOperator; InOpIds=; OutOpIds=8;
</span><span id=__span-47-17><a id=__codelineno-47-17 name=__codelineno-47-17></a><a href=#__codelineno-47-17><span class=linenos data-linenos="17 "></span></a>  DataSourceOperator(id=4)
</span><span id=__span-47-18><a id=__codelineno-47-18 name=__codelineno-47-18></a><a href=#__codelineno-47-18><span class=linenos data-linenos="18 "></span></a>    DataSource: [_anon2:KNOWS]-
</span><span id=__span-47-19><a id=__codelineno-47-19 name=__codelineno-47-19></a><a href=#__codelineno-47-19><span class=linenos data-linenos="19 "></span></a>*
</span><span id=__span-47-20><a id=__codelineno-47-20 name=__codelineno-47-20></a><a href=#__codelineno-47-20><span class=linenos data-linenos="20 "></span></a>OpId=5 Op=DataSourceOperator; InOpIds=; OutOpIds=9;
</span><span id=__span-47-21><a id=__codelineno-47-21 name=__codelineno-47-21></a><a href=#__codelineno-47-21><span class=linenos data-linenos="21 "></span></a>  DataSourceOperator(id=5)
</span><span id=__span-47-22><a id=__codelineno-47-22 name=__codelineno-47-22></a><a href=#__codelineno-47-22><span class=linenos data-linenos="22 "></span></a>    DataSource: f:Person
</span><span id=__span-47-23><a id=__codelineno-47-23 name=__codelineno-47-23></a><a href=#__codelineno-47-23><span class=linenos data-linenos="23 "></span></a>*
</span><span id=__span-47-24><a id=__codelineno-47-24 name=__codelineno-47-24></a><a href=#__codelineno-47-24><span class=linenos data-linenos="24 "></span></a>----------------------------------------------------------------------
</span><span id=__span-47-25><a id=__codelineno-47-25 name=__codelineno-47-25></a><a href=#__codelineno-47-25><span class=linenos data-linenos="25 "></span></a>Level 1:
</span><span id=__span-47-26><a id=__codelineno-47-26 name=__codelineno-47-26></a><a href=#__codelineno-47-26><span class=linenos data-linenos="26 "></span></a>----------------------------------------------------------------------
</span><span id=__span-47-27><a id=__codelineno-47-27 name=__codelineno-47-27></a><a href=#__codelineno-47-27><span class=linenos data-linenos="27 "></span></a>OpId=6 Op=JoinOperator; InOpIds=1,2; OutOpIds=7;
</span><span id=__span-47-28><a id=__codelineno-47-28 name=__codelineno-47-28></a><a href=#__codelineno-47-28><span class=linenos data-linenos="28 "></span></a>  JoinOperator(id=6)
</span><span id=__span-47-29><a id=__codelineno-47-29 name=__codelineno-47-29></a><a href=#__codelineno-47-29><span class=linenos data-linenos="29 "></span></a>    JoinType: INNER
</span><span id=__span-47-30><a id=__codelineno-47-30 name=__codelineno-47-30></a><a href=#__codelineno-47-30><span class=linenos data-linenos="30 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=EITHER_AS_SOURCE
</span><span id=__span-47-31><a id=__codelineno-47-31 name=__codelineno-47-31></a><a href=#__codelineno-47-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-47-32><a id=__codelineno-47-32 name=__codelineno-47-32></a><a href=#__codelineno-47-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span><span id=__span-47-33><a id=__codelineno-47-33 name=__codelineno-47-33></a><a href=#__codelineno-47-33><span class=linenos data-linenos="33 "></span></a>Level 2:
</span><span id=__span-47-34><a id=__codelineno-47-34 name=__codelineno-47-34></a><a href=#__codelineno-47-34><span class=linenos data-linenos="34 "></span></a>----------------------------------------------------------------------
</span><span id=__span-47-35><a id=__codelineno-47-35 name=__codelineno-47-35></a><a href=#__codelineno-47-35><span class=linenos data-linenos="35 "></span></a>OpId=7 Op=JoinOperator; InOpIds=6,3; OutOpIds=8;
</span><span id=__span-47-36><a id=__codelineno-47-36 name=__codelineno-47-36></a><a href=#__codelineno-47-36><span class=linenos data-linenos="36 "></span></a>  JoinOperator(id=7)
</span><span id=__span-47-37><a id=__codelineno-47-37 name=__codelineno-47-37></a><a href=#__codelineno-47-37><span class=linenos data-linenos="37 "></span></a>    JoinType: INNER
</span><span id=__span-47-38><a id=__codelineno-47-38 name=__codelineno-47-38></a><a href=#__codelineno-47-38><span class=linenos data-linenos="38 "></span></a>    Joins: JoinPair: Node=m RelOrNode=_anon1 Type=EITHER_AS_SINK
</span><span id=__span-47-39><a id=__codelineno-47-39 name=__codelineno-47-39></a><a href=#__codelineno-47-39><span class=linenos data-linenos="39 "></span></a>*
</span><span id=__span-47-40><a id=__codelineno-47-40 name=__codelineno-47-40></a><a href=#__codelineno-47-40><span class=linenos data-linenos="40 "></span></a>----------------------------------------------------------------------
</span><span id=__span-47-41><a id=__codelineno-47-41 name=__codelineno-47-41></a><a href=#__codelineno-47-41><span class=linenos data-linenos="41 "></span></a>Level 3:
</span><span id=__span-47-42><a id=__codelineno-47-42 name=__codelineno-47-42></a><a href=#__codelineno-47-42><span class=linenos data-linenos="42 "></span></a>----------------------------------------------------------------------
</span><span id=__span-47-43><a id=__codelineno-47-43 name=__codelineno-47-43></a><a href=#__codelineno-47-43><span class=linenos data-linenos="43 "></span></a>OpId=8 Op=JoinOperator; InOpIds=7,4; OutOpIds=9;
</span><span id=__span-47-44><a id=__codelineno-47-44 name=__codelineno-47-44></a><a href=#__codelineno-47-44><span class=linenos data-linenos="44 "></span></a>  JoinOperator(id=8)
</span><span id=__span-47-45><a id=__codelineno-47-45 name=__codelineno-47-45></a><a href=#__codelineno-47-45><span class=linenos data-linenos="45 "></span></a>    JoinType: INNER
</span><span id=__span-47-46><a id=__codelineno-47-46 name=__codelineno-47-46></a><a href=#__codelineno-47-46><span class=linenos data-linenos="46 "></span></a>    Joins: JoinPair: Node=m RelOrNode=_anon2 Type=EITHER_AS_SOURCE
</span><span id=__span-47-47><a id=__codelineno-47-47 name=__codelineno-47-47></a><a href=#__codelineno-47-47><span class=linenos data-linenos="47 "></span></a>*
</span><span id=__span-47-48><a id=__codelineno-47-48 name=__codelineno-47-48></a><a href=#__codelineno-47-48><span class=linenos data-linenos="48 "></span></a>----------------------------------------------------------------------
</span><span id=__span-47-49><a id=__codelineno-47-49 name=__codelineno-47-49></a><a href=#__codelineno-47-49><span class=linenos data-linenos="49 "></span></a>Level 4:
</span><span id=__span-47-50><a id=__codelineno-47-50 name=__codelineno-47-50></a><a href=#__codelineno-47-50><span class=linenos data-linenos="50 "></span></a>----------------------------------------------------------------------
</span><span id=__span-47-51><a id=__codelineno-47-51 name=__codelineno-47-51></a><a href=#__codelineno-47-51><span class=linenos data-linenos="51 "></span></a>OpId=9 Op=JoinOperator; InOpIds=8,5; OutOpIds=11;
</span><span id=__span-47-52><a id=__codelineno-47-52 name=__codelineno-47-52></a><a href=#__codelineno-47-52><span class=linenos data-linenos="52 "></span></a>  JoinOperator(id=9)
</span><span id=__span-47-53><a id=__codelineno-47-53 name=__codelineno-47-53></a><a href=#__codelineno-47-53><span class=linenos data-linenos="53 "></span></a>    JoinType: INNER
</span><span id=__span-47-54><a id=__codelineno-47-54 name=__codelineno-47-54></a><a href=#__codelineno-47-54><span class=linenos data-linenos="54 "></span></a>    Joins: JoinPair: Node=f RelOrNode=_anon2 Type=EITHER_AS_SINK
</span><span id=__span-47-55><a id=__codelineno-47-55 name=__codelineno-47-55></a><a href=#__codelineno-47-55><span class=linenos data-linenos="55 "></span></a>*
</span><span id=__span-47-56><a id=__codelineno-47-56 name=__codelineno-47-56></a><a href=#__codelineno-47-56><span class=linenos data-linenos="56 "></span></a>----------------------------------------------------------------------
</span><span id=__span-47-57><a id=__codelineno-47-57 name=__codelineno-47-57></a><a href=#__codelineno-47-57><span class=linenos data-linenos="57 "></span></a>Level 5:
</span><span id=__span-47-58><a id=__codelineno-47-58 name=__codelineno-47-58></a><a href=#__codelineno-47-58><span class=linenos data-linenos="58 "></span></a>----------------------------------------------------------------------
</span><span id=__span-47-59><a id=__codelineno-47-59 name=__codelineno-47-59></a><a href=#__codelineno-47-59><span class=linenos data-linenos="59 "></span></a>OpId=11 Op=ProjectionOperator; InOpIds=9; OutOpIds=;
</span><span id=__span-47-60><a id=__codelineno-47-60 name=__codelineno-47-60></a><a href=#__codelineno-47-60><span class=linenos data-linenos="60 "></span></a>  ProjectionOperator(id=11)
</span><span id=__span-47-61><a id=__codelineno-47-61 name=__codelineno-47-61></a><a href=#__codelineno-47-61><span class=linenos data-linenos="61 "></span></a>    Projections: friendOfFriend=f.name
</span><span id=__span-47-62><a id=__codelineno-47-62 name=__codelineno-47-62></a><a href=#__codelineno-47-62><span class=linenos data-linenos="62 "></span></a>*
</span><span id=__span-47-63><a id=__codelineno-47-63 name=__codelineno-47-63></a><a href=#__codelineno-47-63><span class=linenos data-linenos="63 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=17-undirected-relationship-with-aggregation>17. Undirected relationship with aggregation<a class=headerlink href=#17-undirected-relationship-with-aggregation title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Aggregation + Pushdown</p> <details class=note> <summary>Notes</summary> <p>Aggregation over undirected relationships with source filter.</p> <p>USE CASE: "High earners and their social network metrics"</p> <p>OPTIMIZATION: p.salary &gt; 100000 pushed to Person scan. Only high earners participate in the aggregation joins.</p> <p>SQL Pattern: SELECT p.name, COUNT(f.id), AVG(f.age) FROM (SELECT ... FROM Person WHERE salary &gt; 100000) AS p JOIN Knows ON ... JOIN Person AS f ON ... GROUP BY p.id, p.name</p> <p>COST: Filter before aggregation = fewer GROUP BY operations.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-48-1><a id=__codelineno-48-1 name=__codelineno-48-1></a><a href=#__codelineno-48-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=n>r</span><span class=p>:</span><span class=n>KNOWS</span><span class=o>]-</span><span class=p>(</span><span class=n>f</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-48-2><a id=__codelineno-48-2 name=__codelineno-48-2></a><a href=#__codelineno-48-2><span class=linenos data-linenos="2 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>100000</span>
</span><span id=__span-48-3><a id=__codelineno-48-3 name=__codelineno-48-3></a><a href=#__codelineno-48-3><span class=linenos data-linenos="3 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>highEarner</span><span class=p>,</span>
</span><span id=__span-48-4><a id=__codelineno-48-4 name=__codelineno-48-4></a><a href=#__codelineno-48-4><span class=linenos data-linenos="4 "></span></a><span class=w>       </span><span class=n>COUNT</span><span class=p>(</span><span class=n>f</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>friendCount</span><span class=p>,</span>
</span><span id=__span-48-5><a id=__codelineno-48-5 name=__codelineno-48-5></a><a href=#__codelineno-48-5><span class=linenos data-linenos="5 "></span></a><span class=w>       </span><span class=n>AVG</span><span class=p>(</span><span class=n>f</span><span class=p>.</span><span class=n>age</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avgFriendAge</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-49-1><a id=__codelineno-49-1 name=__codelineno-49-1></a><a href=#__codelineno-49-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-49-2><a id=__codelineno-49-2 name=__codelineno-49-2></a><a href=#__codelineno-49-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>highEarner</span>
</span><span id=__span-49-3><a id=__codelineno-49-3 name=__codelineno-49-3></a><a href=#__codelineno-49-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=k>COUNT</span><span class=p>(</span><span class=n>_gsql2rsql_f_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>friendCount</span>
</span><span id=__span-49-4><a id=__codelineno-49-4 name=__codelineno-49-4></a><a href=#__codelineno-49-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>  </span><span class=p>,</span><span class=k>AVG</span><span class=p>(</span><span class=k>CAST</span><span class=p>(</span><span class=n>_gsql2rsql_f_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>DOUBLE</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avgFriendAge</span>
</span><span id=__span-49-5><a id=__codelineno-49-5 name=__codelineno-49-5></a><a href=#__codelineno-49-5><span class=linenos data-linenos=" 5 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-49-6><a id=__codelineno-49-6 name=__codelineno-49-6></a><a href=#__codelineno-49-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-49-7><a id=__codelineno-49-7 name=__codelineno-49-7></a><a href=#__codelineno-49-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-49-8><a id=__codelineno-49-8 name=__codelineno-49-8></a><a href=#__codelineno-49-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-49-9><a id=__codelineno-49-9 name=__codelineno-49-9></a><a href=#__codelineno-49-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_salary</span>
</span><span id=__span-49-10><a id=__codelineno-49-10 name=__codelineno-49-10></a><a href=#__codelineno-49-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_r_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_person_id</span>
</span><span id=__span-49-11><a id=__codelineno-49-11 name=__codelineno-49-11></a><a href=#__codelineno-49-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_r_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_friend_id</span>
</span><span id=__span-49-12><a id=__codelineno-49-12 name=__codelineno-49-12></a><a href=#__codelineno-49-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-49-13><a id=__codelineno-49-13 name=__codelineno-49-13></a><a href=#__codelineno-49-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_age</span>
</span><span id=__span-49-14><a id=__codelineno-49-14 name=__codelineno-49-14></a><a href=#__codelineno-49-14><span class=linenos data-linenos="14 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-49-15><a id=__codelineno-49-15 name=__codelineno-49-15></a><a href=#__codelineno-49-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-49-16><a id=__codelineno-49-16 name=__codelineno-49-16></a><a href=#__codelineno-49-16><span class=linenos data-linenos="16 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-49-17><a id=__codelineno-49-17 name=__codelineno-49-17></a><a href=#__codelineno-49-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-49-18><a id=__codelineno-49-18 name=__codelineno-49-18></a><a href=#__codelineno-49-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_salary</span>
</span><span id=__span-49-19><a id=__codelineno-49-19 name=__codelineno-49-19></a><a href=#__codelineno-49-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql_r_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_person_id</span>
</span><span id=__span-49-20><a id=__codelineno-49-20 name=__codelineno-49-20></a><a href=#__codelineno-49-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql_r_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_friend_id</span>
</span><span id=__span-49-21><a id=__codelineno-49-21 name=__codelineno-49-21></a><a href=#__codelineno-49-21><span class=linenos data-linenos="21 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-49-22><a id=__codelineno-49-22 name=__codelineno-49-22></a><a href=#__codelineno-49-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-49-23><a id=__codelineno-49-23 name=__codelineno-49-23></a><a href=#__codelineno-49-23><span class=linenos data-linenos="23 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-49-24><a id=__codelineno-49-24 name=__codelineno-49-24></a><a href=#__codelineno-49-24><span class=linenos data-linenos="24 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-49-25><a id=__codelineno-49-25 name=__codelineno-49-25></a><a href=#__codelineno-49-25><span class=linenos data-linenos="25 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_salary</span>
</span><span id=__span-49-26><a id=__codelineno-49-26 name=__codelineno-49-26></a><a href=#__codelineno-49-26><span class=linenos data-linenos="26 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-49-27><a id=__codelineno-49-27 name=__codelineno-49-27></a><a href=#__codelineno-49-27><span class=linenos data-linenos="27 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-49-28><a id=__codelineno-49-28 name=__codelineno-49-28></a><a href=#__codelineno-49-28><span class=linenos data-linenos="28 "></span></a><span class=w>      </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>salary</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>100000</span><span class=p>))</span>
</span><span id=__span-49-29><a id=__codelineno-49-29 name=__codelineno-49-29></a><a href=#__codelineno-49-29><span class=linenos data-linenos="29 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-49-30><a id=__codelineno-49-30 name=__codelineno-49-30></a><a href=#__codelineno-49-30><span class=linenos data-linenos="30 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-49-31><a id=__codelineno-49-31 name=__codelineno-49-31></a><a href=#__codelineno-49-31><span class=linenos data-linenos="31 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-49-32><a id=__codelineno-49-32 name=__codelineno-49-32></a><a href=#__codelineno-49-32><span class=linenos data-linenos="32 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_person_id</span>
</span><span id=__span-49-33><a id=__codelineno-49-33 name=__codelineno-49-33></a><a href=#__codelineno-49-33><span class=linenos data-linenos="33 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_friend_id</span>
</span><span id=__span-49-34><a id=__codelineno-49-34 name=__codelineno-49-34></a><a href=#__codelineno-49-34><span class=linenos data-linenos="34 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_since</span>
</span><span id=__span-49-35><a id=__codelineno-49-35 name=__codelineno-49-35></a><a href=#__codelineno-49-35><span class=linenos data-linenos="35 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_strength</span>
</span><span id=__span-49-36><a id=__codelineno-49-36 name=__codelineno-49-36></a><a href=#__codelineno-49-36><span class=linenos data-linenos="36 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-49-37><a id=__codelineno-49-37 name=__codelineno-49-37></a><a href=#__codelineno-49-37><span class=linenos data-linenos="37 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-49-38><a id=__codelineno-49-38 name=__codelineno-49-38></a><a href=#__codelineno-49-38><span class=linenos data-linenos="38 "></span></a><span class=w>      </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-49-39><a id=__codelineno-49-39 name=__codelineno-49-39></a><a href=#__codelineno-49-39><span class=linenos data-linenos="39 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-49-40><a id=__codelineno-49-40 name=__codelineno-49-40></a><a href=#__codelineno-49-40><span class=linenos data-linenos="40 "></span></a><span class=w>         </span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_person_id</span>
</span><span id=__span-49-41><a id=__codelineno-49-41 name=__codelineno-49-41></a><a href=#__codelineno-49-41><span class=linenos data-linenos="41 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_friend_id</span>
</span><span id=__span-49-42><a id=__codelineno-49-42 name=__codelineno-49-42></a><a href=#__codelineno-49-42><span class=linenos data-linenos="42 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_since</span>
</span><span id=__span-49-43><a id=__codelineno-49-43 name=__codelineno-49-43></a><a href=#__codelineno-49-43><span class=linenos data-linenos="43 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_r_strength</span>
</span><span id=__span-49-44><a id=__codelineno-49-44 name=__codelineno-49-44></a><a href=#__codelineno-49-44><span class=linenos data-linenos="44 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-49-45><a id=__codelineno-49-45 name=__codelineno-49-45></a><a href=#__codelineno-49-45><span class=linenos data-linenos="45 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-49-46><a id=__codelineno-49-46 name=__codelineno-49-46></a><a href=#__codelineno-49-46><span class=linenos data-linenos="46 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-49-47><a id=__codelineno-49-47 name=__codelineno-49-47></a><a href=#__codelineno-49-47><span class=linenos data-linenos="47 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql_r_person_id</span>
</span><span id=__span-49-48><a id=__codelineno-49-48 name=__codelineno-49-48></a><a href=#__codelineno-49-48><span class=linenos data-linenos="48 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-49-49><a id=__codelineno-49-49 name=__codelineno-49-49></a><a href=#__codelineno-49-49><span class=linenos data-linenos="49 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-49-50><a id=__codelineno-49-50 name=__codelineno-49-50></a><a href=#__codelineno-49-50><span class=linenos data-linenos="50 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-49-51><a id=__codelineno-49-51 name=__codelineno-49-51></a><a href=#__codelineno-49-51><span class=linenos data-linenos="51 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-49-52><a id=__codelineno-49-52 name=__codelineno-49-52></a><a href=#__codelineno-49-52><span class=linenos data-linenos="52 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_age</span>
</span><span id=__span-49-53><a id=__codelineno-49-53 name=__codelineno-49-53></a><a href=#__codelineno-49-53><span class=linenos data-linenos="53 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-49-54><a id=__codelineno-49-54 name=__codelineno-49-54></a><a href=#__codelineno-49-54><span class=linenos data-linenos="54 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-49-55><a id=__codelineno-49-55 name=__codelineno-49-55></a><a href=#__codelineno-49-55><span class=linenos data-linenos="55 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-49-56><a id=__codelineno-49-56 name=__codelineno-49-56></a><a href=#__codelineno-49-56><span class=linenos data-linenos="56 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_r_friend_id</span>
</span><span id=__span-49-57><a id=__codelineno-49-57 name=__codelineno-49-57></a><a href=#__codelineno-49-57><span class=linenos data-linenos="57 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-49-58><a id=__codelineno-49-58 name=__codelineno-49-58></a><a href=#__codelineno-49-58><span class=linenos data-linenos="58 "></span></a><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-50-1><a id=__codelineno-50-1 name=__codelineno-50-1></a><a href=#__codelineno-50-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-50-2><a id=__codelineno-50-2 name=__codelineno-50-2></a><a href=#__codelineno-50-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-50-3><a id=__codelineno-50-3 name=__codelineno-50-3></a><a href=#__codelineno-50-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-50-4><a id=__codelineno-50-4 name=__codelineno-50-4></a><a href=#__codelineno-50-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-50-5><a id=__codelineno-50-5 name=__codelineno-50-5></a><a href=#__codelineno-50-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-50-6><a id=__codelineno-50-6 name=__codelineno-50-6></a><a href=#__codelineno-50-6><span class=linenos data-linenos=" 6 "></span></a>    Filter: (p.salary GT 100000)
</span><span id=__span-50-7><a id=__codelineno-50-7 name=__codelineno-50-7></a><a href=#__codelineno-50-7><span class=linenos data-linenos=" 7 "></span></a>*
</span><span id=__span-50-8><a id=__codelineno-50-8 name=__codelineno-50-8></a><a href=#__codelineno-50-8><span class=linenos data-linenos=" 8 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-50-9><a id=__codelineno-50-9 name=__codelineno-50-9></a><a href=#__codelineno-50-9><span class=linenos data-linenos=" 9 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-50-10><a id=__codelineno-50-10 name=__codelineno-50-10></a><a href=#__codelineno-50-10><span class=linenos data-linenos="10 "></span></a>    DataSource: [r:KNOWS]-
</span><span id=__span-50-11><a id=__codelineno-50-11 name=__codelineno-50-11></a><a href=#__codelineno-50-11><span class=linenos data-linenos="11 "></span></a>*
</span><span id=__span-50-12><a id=__codelineno-50-12 name=__codelineno-50-12></a><a href=#__codelineno-50-12><span class=linenos data-linenos="12 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-50-13><a id=__codelineno-50-13 name=__codelineno-50-13></a><a href=#__codelineno-50-13><span class=linenos data-linenos="13 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-50-14><a id=__codelineno-50-14 name=__codelineno-50-14></a><a href=#__codelineno-50-14><span class=linenos data-linenos="14 "></span></a>    DataSource: f:Person
</span><span id=__span-50-15><a id=__codelineno-50-15 name=__codelineno-50-15></a><a href=#__codelineno-50-15><span class=linenos data-linenos="15 "></span></a>*
</span><span id=__span-50-16><a id=__codelineno-50-16 name=__codelineno-50-16></a><a href=#__codelineno-50-16><span class=linenos data-linenos="16 "></span></a>----------------------------------------------------------------------
</span><span id=__span-50-17><a id=__codelineno-50-17 name=__codelineno-50-17></a><a href=#__codelineno-50-17><span class=linenos data-linenos="17 "></span></a>Level 1:
</span><span id=__span-50-18><a id=__codelineno-50-18 name=__codelineno-50-18></a><a href=#__codelineno-50-18><span class=linenos data-linenos="18 "></span></a>----------------------------------------------------------------------
</span><span id=__span-50-19><a id=__codelineno-50-19 name=__codelineno-50-19></a><a href=#__codelineno-50-19><span class=linenos data-linenos="19 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-50-20><a id=__codelineno-50-20 name=__codelineno-50-20></a><a href=#__codelineno-50-20><span class=linenos data-linenos="20 "></span></a>  JoinOperator(id=4)
</span><span id=__span-50-21><a id=__codelineno-50-21 name=__codelineno-50-21></a><a href=#__codelineno-50-21><span class=linenos data-linenos="21 "></span></a>    JoinType: INNER
</span><span id=__span-50-22><a id=__codelineno-50-22 name=__codelineno-50-22></a><a href=#__codelineno-50-22><span class=linenos data-linenos="22 "></span></a>    Joins: JoinPair: Node=p RelOrNode=r Type=EITHER_AS_SOURCE
</span><span id=__span-50-23><a id=__codelineno-50-23 name=__codelineno-50-23></a><a href=#__codelineno-50-23><span class=linenos data-linenos="23 "></span></a>*
</span><span id=__span-50-24><a id=__codelineno-50-24 name=__codelineno-50-24></a><a href=#__codelineno-50-24><span class=linenos data-linenos="24 "></span></a>----------------------------------------------------------------------
</span><span id=__span-50-25><a id=__codelineno-50-25 name=__codelineno-50-25></a><a href=#__codelineno-50-25><span class=linenos data-linenos="25 "></span></a>Level 2:
</span><span id=__span-50-26><a id=__codelineno-50-26 name=__codelineno-50-26></a><a href=#__codelineno-50-26><span class=linenos data-linenos="26 "></span></a>----------------------------------------------------------------------
</span><span id=__span-50-27><a id=__codelineno-50-27 name=__codelineno-50-27></a><a href=#__codelineno-50-27><span class=linenos data-linenos="27 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=7;
</span><span id=__span-50-28><a id=__codelineno-50-28 name=__codelineno-50-28></a><a href=#__codelineno-50-28><span class=linenos data-linenos="28 "></span></a>  JoinOperator(id=5)
</span><span id=__span-50-29><a id=__codelineno-50-29 name=__codelineno-50-29></a><a href=#__codelineno-50-29><span class=linenos data-linenos="29 "></span></a>    JoinType: INNER
</span><span id=__span-50-30><a id=__codelineno-50-30 name=__codelineno-50-30></a><a href=#__codelineno-50-30><span class=linenos data-linenos="30 "></span></a>    Joins: JoinPair: Node=f RelOrNode=r Type=EITHER_AS_SINK
</span><span id=__span-50-31><a id=__codelineno-50-31 name=__codelineno-50-31></a><a href=#__codelineno-50-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-50-32><a id=__codelineno-50-32 name=__codelineno-50-32></a><a href=#__codelineno-50-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span><span id=__span-50-33><a id=__codelineno-50-33 name=__codelineno-50-33></a><a href=#__codelineno-50-33><span class=linenos data-linenos="33 "></span></a>Level 3:
</span><span id=__span-50-34><a id=__codelineno-50-34 name=__codelineno-50-34></a><a href=#__codelineno-50-34><span class=linenos data-linenos="34 "></span></a>----------------------------------------------------------------------
</span><span id=__span-50-35><a id=__codelineno-50-35 name=__codelineno-50-35></a><a href=#__codelineno-50-35><span class=linenos data-linenos="35 "></span></a>OpId=7 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-50-36><a id=__codelineno-50-36 name=__codelineno-50-36></a><a href=#__codelineno-50-36><span class=linenos data-linenos="36 "></span></a>  ProjectionOperator(id=7)
</span><span id=__span-50-37><a id=__codelineno-50-37 name=__codelineno-50-37></a><a href=#__codelineno-50-37><span class=linenos data-linenos="37 "></span></a>    Projections: highEarner=p.name, friendCount=COUNT(f), avgFriendAge=AVG(f.age)
</span><span id=__span-50-38><a id=__codelineno-50-38 name=__codelineno-50-38></a><a href=#__codelineno-50-38><span class=linenos data-linenos="38 "></span></a>*
</span><span id=__span-50-39><a id=__codelineno-50-39 name=__codelineno-50-39></a><a href=#__codelineno-50-39><span class=linenos data-linenos="39 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=18-optional-match-left-join-semantics>18. OPTIONAL MATCH (left join semantics)<a class=headerlink href=#18-optional-match-left-join-semantics title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: OPTIONAL MATCH</p> <details class=note> <summary>Notes</summary> <p>Returns all people, with movies if they exist (NULL otherwise).</p> <p>WHY USEFUL: Include all entities even without relationships.</p> <p>DATABRICKS COMPLEXITY: O(n + e) - LEFT JOIN COST: Medium. LEFT JOIN preserves all left-side rows. CRITICAL: Uses LEFT JOIN, not INNER JOIN. NULL values appear where no relationship exists.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-51-1><a id=__codelineno-51-1 name=__codelineno-51-1></a><a href=#__codelineno-51-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-51-2><a id=__codelineno-51-2 name=__codelineno-51-2></a><a href=#__codelineno-51-2><span class=linenos data-linenos="2 "></span></a><span class=k>OPTIONAL</span><span class=w> </span><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>ACTED_IN</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>m</span><span class=p>:</span><span class=n>Movie</span><span class=p>)</span>
</span><span id=__span-51-3><a id=__codelineno-51-3 name=__codelineno-51-3></a><a href=#__codelineno-51-3><span class=linenos data-linenos="3 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>m</span><span class=p>.</span><span class=n>title</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-52-1><a id=__codelineno-52-1 name=__codelineno-52-1></a><a href=#__codelineno-52-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-52-2><a id=__codelineno-52-2 name=__codelineno-52-2></a><a href=#__codelineno-52-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-52-3><a id=__codelineno-52-3 name=__codelineno-52-3></a><a href=#__codelineno-52-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_m_title</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>title</span>
</span><span id=__span-52-4><a id=__codelineno-52-4 name=__codelineno-52-4></a><a href=#__codelineno-52-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-52-5><a id=__codelineno-52-5 name=__codelineno-52-5></a><a href=#__codelineno-52-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-52-6><a id=__codelineno-52-6 name=__codelineno-52-6></a><a href=#__codelineno-52-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-52-7><a id=__codelineno-52-7 name=__codelineno-52-7></a><a href=#__codelineno-52-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-52-8><a id=__codelineno-52-8 name=__codelineno-52-8></a><a href=#__codelineno-52-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-52-9><a id=__codelineno-52-9 name=__codelineno-52-9></a><a href=#__codelineno-52-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_movie_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_movie_id</span>
</span><span id=__span-52-10><a id=__codelineno-52-10 name=__codelineno-52-10></a><a href=#__codelineno-52-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_m_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_m_id</span>
</span><span id=__span-52-11><a id=__codelineno-52-11 name=__codelineno-52-11></a><a href=#__codelineno-52-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_m_title</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_m_title</span>
</span><span id=__span-52-12><a id=__codelineno-52-12 name=__codelineno-52-12></a><a href=#__codelineno-52-12><span class=linenos data-linenos="12 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-52-13><a id=__codelineno-52-13 name=__codelineno-52-13></a><a href=#__codelineno-52-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-52-14><a id=__codelineno-52-14 name=__codelineno-52-14></a><a href=#__codelineno-52-14><span class=linenos data-linenos="14 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-52-15><a id=__codelineno-52-15 name=__codelineno-52-15></a><a href=#__codelineno-52-15><span class=linenos data-linenos="15 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-52-16><a id=__codelineno-52-16 name=__codelineno-52-16></a><a href=#__codelineno-52-16><span class=linenos data-linenos="16 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-52-17><a id=__codelineno-52-17 name=__codelineno-52-17></a><a href=#__codelineno-52-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-52-18><a id=__codelineno-52-18 name=__codelineno-52-18></a><a href=#__codelineno-52-18><span class=linenos data-linenos="18 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-52-19><a id=__codelineno-52-19 name=__codelineno-52-19></a><a href=#__codelineno-52-19><span class=linenos data-linenos="19 "></span></a><span class=w>  </span><span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-52-20><a id=__codelineno-52-20 name=__codelineno-52-20></a><a href=#__codelineno-52-20><span class=linenos data-linenos="20 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-52-21><a id=__codelineno-52-21 name=__codelineno-52-21></a><a href=#__codelineno-52-21><span class=linenos data-linenos="21 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-52-22><a id=__codelineno-52-22 name=__codelineno-52-22></a><a href=#__codelineno-52-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-52-23><a id=__codelineno-52-23 name=__codelineno-52-23></a><a href=#__codelineno-52-23><span class=linenos data-linenos="23 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-52-24><a id=__codelineno-52-24 name=__codelineno-52-24></a><a href=#__codelineno-52-24><span class=linenos data-linenos="24 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_movie_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_movie_id</span>
</span><span id=__span-52-25><a id=__codelineno-52-25 name=__codelineno-52-25></a><a href=#__codelineno-52-25><span class=linenos data-linenos="25 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql_m_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_m_id</span>
</span><span id=__span-52-26><a id=__codelineno-52-26 name=__codelineno-52-26></a><a href=#__codelineno-52-26><span class=linenos data-linenos="26 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql_m_title</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_m_title</span>
</span><span id=__span-52-27><a id=__codelineno-52-27 name=__codelineno-52-27></a><a href=#__codelineno-52-27><span class=linenos data-linenos="27 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-52-28><a id=__codelineno-52-28 name=__codelineno-52-28></a><a href=#__codelineno-52-28><span class=linenos data-linenos="28 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-52-29><a id=__codelineno-52-29 name=__codelineno-52-29></a><a href=#__codelineno-52-29><span class=linenos data-linenos="29 "></span></a><span class=w>         </span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-52-30><a id=__codelineno-52-30 name=__codelineno-52-30></a><a href=#__codelineno-52-30><span class=linenos data-linenos="30 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-52-31><a id=__codelineno-52-31 name=__codelineno-52-31></a><a href=#__codelineno-52-31><span class=linenos data-linenos="31 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_right_2</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-52-32><a id=__codelineno-52-32 name=__codelineno-52-32></a><a href=#__codelineno-52-32><span class=linenos data-linenos="32 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_right_2</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_movie_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_movie_id</span>
</span><span id=__span-52-33><a id=__codelineno-52-33 name=__codelineno-52-33></a><a href=#__codelineno-52-33><span class=linenos data-linenos="33 "></span></a><span class=w>      </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-52-34><a id=__codelineno-52-34 name=__codelineno-52-34></a><a href=#__codelineno-52-34><span class=linenos data-linenos="34 "></span></a><span class=w>        </span><span class=k>SELECT</span>
</span><span id=__span-52-35><a id=__codelineno-52-35 name=__codelineno-52-35></a><a href=#__codelineno-52-35><span class=linenos data-linenos="35 "></span></a><span class=w>           </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-52-36><a id=__codelineno-52-36 name=__codelineno-52-36></a><a href=#__codelineno-52-36><span class=linenos data-linenos="36 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-52-37><a id=__codelineno-52-37 name=__codelineno-52-37></a><a href=#__codelineno-52-37><span class=linenos data-linenos="37 "></span></a><span class=w>        </span><span class=k>FROM</span>
</span><span id=__span-52-38><a id=__codelineno-52-38 name=__codelineno-52-38></a><a href=#__codelineno-52-38><span class=linenos data-linenos="38 "></span></a><span class=w>          </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-52-39><a id=__codelineno-52-39 name=__codelineno-52-39></a><a href=#__codelineno-52-39><span class=linenos data-linenos="39 "></span></a><span class=w>      </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_2</span>
</span><span id=__span-52-40><a id=__codelineno-52-40 name=__codelineno-52-40></a><a href=#__codelineno-52-40><span class=linenos data-linenos="40 "></span></a><span class=w>      </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-52-41><a id=__codelineno-52-41 name=__codelineno-52-41></a><a href=#__codelineno-52-41><span class=linenos data-linenos="41 "></span></a><span class=w>        </span><span class=k>SELECT</span>
</span><span id=__span-52-42><a id=__codelineno-52-42 name=__codelineno-52-42></a><a href=#__codelineno-52-42><span class=linenos data-linenos="42 "></span></a><span class=w>           </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-52-43><a id=__codelineno-52-43 name=__codelineno-52-43></a><a href=#__codelineno-52-43><span class=linenos data-linenos="43 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>movie_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_movie_id</span>
</span><span id=__span-52-44><a id=__codelineno-52-44 name=__codelineno-52-44></a><a href=#__codelineno-52-44><span class=linenos data-linenos="44 "></span></a><span class=w>        </span><span class=k>FROM</span>
</span><span id=__span-52-45><a id=__codelineno-52-45 name=__codelineno-52-45></a><a href=#__codelineno-52-45><span class=linenos data-linenos="45 "></span></a><span class=w>          </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>ActedIn</span>
</span><span id=__span-52-46><a id=__codelineno-52-46 name=__codelineno-52-46></a><a href=#__codelineno-52-46><span class=linenos data-linenos="46 "></span></a><span class=w>      </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_2</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-52-47><a id=__codelineno-52-47 name=__codelineno-52-47></a><a href=#__codelineno-52-47><span class=linenos data-linenos="47 "></span></a><span class=w>        </span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_2</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-52-48><a id=__codelineno-52-48 name=__codelineno-52-48></a><a href=#__codelineno-52-48><span class=linenos data-linenos="48 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-52-49><a id=__codelineno-52-49 name=__codelineno-52-49></a><a href=#__codelineno-52-49><span class=linenos data-linenos="49 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-52-50><a id=__codelineno-52-50 name=__codelineno-52-50></a><a href=#__codelineno-52-50><span class=linenos data-linenos="50 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-52-51><a id=__codelineno-52-51 name=__codelineno-52-51></a><a href=#__codelineno-52-51><span class=linenos data-linenos="51 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_m_id</span>
</span><span id=__span-52-52><a id=__codelineno-52-52 name=__codelineno-52-52></a><a href=#__codelineno-52-52><span class=linenos data-linenos="52 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>title</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_m_title</span>
</span><span id=__span-52-53><a id=__codelineno-52-53 name=__codelineno-52-53></a><a href=#__codelineno-52-53><span class=linenos data-linenos="53 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-52-54><a id=__codelineno-52-54 name=__codelineno-52-54></a><a href=#__codelineno-52-54><span class=linenos data-linenos="54 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Movie</span>
</span><span id=__span-52-55><a id=__codelineno-52-55 name=__codelineno-52-55></a><a href=#__codelineno-52-55><span class=linenos data-linenos="55 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-52-56><a id=__codelineno-52-56 name=__codelineno-52-56></a><a href=#__codelineno-52-56><span class=linenos data-linenos="56 "></span></a><span class=w>      </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql_m_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_movie_id</span>
</span><span id=__span-52-57><a id=__codelineno-52-57 name=__codelineno-52-57></a><a href=#__codelineno-52-57><span class=linenos data-linenos="57 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-52-58><a id=__codelineno-52-58 name=__codelineno-52-58></a><a href=#__codelineno-52-58><span class=linenos data-linenos="58 "></span></a><span class=w>    </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-52-59><a id=__codelineno-52-59 name=__codelineno-52-59></a><a href=#__codelineno-52-59><span class=linenos data-linenos="59 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-53-1><a id=__codelineno-53-1 name=__codelineno-53-1></a><a href=#__codelineno-53-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-53-2><a id=__codelineno-53-2 name=__codelineno-53-2></a><a href=#__codelineno-53-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-53-3><a id=__codelineno-53-3 name=__codelineno-53-3></a><a href=#__codelineno-53-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=7;
</span><span id=__span-53-4><a id=__codelineno-53-4 name=__codelineno-53-4></a><a href=#__codelineno-53-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-53-5><a id=__codelineno-53-5 name=__codelineno-53-5></a><a href=#__codelineno-53-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-53-6><a id=__codelineno-53-6 name=__codelineno-53-6></a><a href=#__codelineno-53-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-53-7><a id=__codelineno-53-7 name=__codelineno-53-7></a><a href=#__codelineno-53-7><span class=linenos data-linenos=" 7 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-53-8><a id=__codelineno-53-8 name=__codelineno-53-8></a><a href=#__codelineno-53-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-53-9><a id=__codelineno-53-9 name=__codelineno-53-9></a><a href=#__codelineno-53-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: p:Person
</span><span id=__span-53-10><a id=__codelineno-53-10 name=__codelineno-53-10></a><a href=#__codelineno-53-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-53-11><a id=__codelineno-53-11 name=__codelineno-53-11></a><a href=#__codelineno-53-11><span class=linenos data-linenos="11 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-53-12><a id=__codelineno-53-12 name=__codelineno-53-12></a><a href=#__codelineno-53-12><span class=linenos data-linenos="12 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-53-13><a id=__codelineno-53-13 name=__codelineno-53-13></a><a href=#__codelineno-53-13><span class=linenos data-linenos="13 "></span></a>    DataSource: [_anon1:ACTED_IN]-&gt;
</span><span id=__span-53-14><a id=__codelineno-53-14 name=__codelineno-53-14></a><a href=#__codelineno-53-14><span class=linenos data-linenos="14 "></span></a>*
</span><span id=__span-53-15><a id=__codelineno-53-15 name=__codelineno-53-15></a><a href=#__codelineno-53-15><span class=linenos data-linenos="15 "></span></a>OpId=4 Op=DataSourceOperator; InOpIds=; OutOpIds=6;
</span><span id=__span-53-16><a id=__codelineno-53-16 name=__codelineno-53-16></a><a href=#__codelineno-53-16><span class=linenos data-linenos="16 "></span></a>  DataSourceOperator(id=4)
</span><span id=__span-53-17><a id=__codelineno-53-17 name=__codelineno-53-17></a><a href=#__codelineno-53-17><span class=linenos data-linenos="17 "></span></a>    DataSource: m:Movie
</span><span id=__span-53-18><a id=__codelineno-53-18 name=__codelineno-53-18></a><a href=#__codelineno-53-18><span class=linenos data-linenos="18 "></span></a>*
</span><span id=__span-53-19><a id=__codelineno-53-19 name=__codelineno-53-19></a><a href=#__codelineno-53-19><span class=linenos data-linenos="19 "></span></a>----------------------------------------------------------------------
</span><span id=__span-53-20><a id=__codelineno-53-20 name=__codelineno-53-20></a><a href=#__codelineno-53-20><span class=linenos data-linenos="20 "></span></a>Level 1:
</span><span id=__span-53-21><a id=__codelineno-53-21 name=__codelineno-53-21></a><a href=#__codelineno-53-21><span class=linenos data-linenos="21 "></span></a>----------------------------------------------------------------------
</span><span id=__span-53-22><a id=__codelineno-53-22 name=__codelineno-53-22></a><a href=#__codelineno-53-22><span class=linenos data-linenos="22 "></span></a>OpId=5 Op=JoinOperator; InOpIds=2,3; OutOpIds=6;
</span><span id=__span-53-23><a id=__codelineno-53-23 name=__codelineno-53-23></a><a href=#__codelineno-53-23><span class=linenos data-linenos="23 "></span></a>  JoinOperator(id=5)
</span><span id=__span-53-24><a id=__codelineno-53-24 name=__codelineno-53-24></a><a href=#__codelineno-53-24><span class=linenos data-linenos="24 "></span></a>    JoinType: INNER
</span><span id=__span-53-25><a id=__codelineno-53-25 name=__codelineno-53-25></a><a href=#__codelineno-53-25><span class=linenos data-linenos="25 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-53-26><a id=__codelineno-53-26 name=__codelineno-53-26></a><a href=#__codelineno-53-26><span class=linenos data-linenos="26 "></span></a>*
</span><span id=__span-53-27><a id=__codelineno-53-27 name=__codelineno-53-27></a><a href=#__codelineno-53-27><span class=linenos data-linenos="27 "></span></a>----------------------------------------------------------------------
</span><span id=__span-53-28><a id=__codelineno-53-28 name=__codelineno-53-28></a><a href=#__codelineno-53-28><span class=linenos data-linenos="28 "></span></a>Level 2:
</span><span id=__span-53-29><a id=__codelineno-53-29 name=__codelineno-53-29></a><a href=#__codelineno-53-29><span class=linenos data-linenos="29 "></span></a>----------------------------------------------------------------------
</span><span id=__span-53-30><a id=__codelineno-53-30 name=__codelineno-53-30></a><a href=#__codelineno-53-30><span class=linenos data-linenos="30 "></span></a>OpId=6 Op=JoinOperator; InOpIds=5,4; OutOpIds=7;
</span><span id=__span-53-31><a id=__codelineno-53-31 name=__codelineno-53-31></a><a href=#__codelineno-53-31><span class=linenos data-linenos="31 "></span></a>  JoinOperator(id=6)
</span><span id=__span-53-32><a id=__codelineno-53-32 name=__codelineno-53-32></a><a href=#__codelineno-53-32><span class=linenos data-linenos="32 "></span></a>    JoinType: INNER
</span><span id=__span-53-33><a id=__codelineno-53-33 name=__codelineno-53-33></a><a href=#__codelineno-53-33><span class=linenos data-linenos="33 "></span></a>    Joins: JoinPair: Node=m RelOrNode=_anon1 Type=SINK
</span><span id=__span-53-34><a id=__codelineno-53-34 name=__codelineno-53-34></a><a href=#__codelineno-53-34><span class=linenos data-linenos="34 "></span></a>*
</span><span id=__span-53-35><a id=__codelineno-53-35 name=__codelineno-53-35></a><a href=#__codelineno-53-35><span class=linenos data-linenos="35 "></span></a>----------------------------------------------------------------------
</span><span id=__span-53-36><a id=__codelineno-53-36 name=__codelineno-53-36></a><a href=#__codelineno-53-36><span class=linenos data-linenos="36 "></span></a>Level 3:
</span><span id=__span-53-37><a id=__codelineno-53-37 name=__codelineno-53-37></a><a href=#__codelineno-53-37><span class=linenos data-linenos="37 "></span></a>----------------------------------------------------------------------
</span><span id=__span-53-38><a id=__codelineno-53-38 name=__codelineno-53-38></a><a href=#__codelineno-53-38><span class=linenos data-linenos="38 "></span></a>OpId=7 Op=JoinOperator; InOpIds=1,6; OutOpIds=8;
</span><span id=__span-53-39><a id=__codelineno-53-39 name=__codelineno-53-39></a><a href=#__codelineno-53-39><span class=linenos data-linenos="39 "></span></a>  JoinOperator(id=7)
</span><span id=__span-53-40><a id=__codelineno-53-40 name=__codelineno-53-40></a><a href=#__codelineno-53-40><span class=linenos data-linenos="40 "></span></a>    JoinType: LEFT
</span><span id=__span-53-41><a id=__codelineno-53-41 name=__codelineno-53-41></a><a href=#__codelineno-53-41><span class=linenos data-linenos="41 "></span></a>    Joins: JoinPair: Node=p RelOrNode=p Type=NODE_ID
</span><span id=__span-53-42><a id=__codelineno-53-42 name=__codelineno-53-42></a><a href=#__codelineno-53-42><span class=linenos data-linenos="42 "></span></a>*
</span><span id=__span-53-43><a id=__codelineno-53-43 name=__codelineno-53-43></a><a href=#__codelineno-53-43><span class=linenos data-linenos="43 "></span></a>----------------------------------------------------------------------
</span><span id=__span-53-44><a id=__codelineno-53-44 name=__codelineno-53-44></a><a href=#__codelineno-53-44><span class=linenos data-linenos="44 "></span></a>Level 4:
</span><span id=__span-53-45><a id=__codelineno-53-45 name=__codelineno-53-45></a><a href=#__codelineno-53-45><span class=linenos data-linenos="45 "></span></a>----------------------------------------------------------------------
</span><span id=__span-53-46><a id=__codelineno-53-46 name=__codelineno-53-46></a><a href=#__codelineno-53-46><span class=linenos data-linenos="46 "></span></a>OpId=8 Op=ProjectionOperator; InOpIds=7; OutOpIds=;
</span><span id=__span-53-47><a id=__codelineno-53-47 name=__codelineno-53-47></a><a href=#__codelineno-53-47><span class=linenos data-linenos="47 "></span></a>  ProjectionOperator(id=8)
</span><span id=__span-53-48><a id=__codelineno-53-48 name=__codelineno-53-48></a><a href=#__codelineno-53-48><span class=linenos data-linenos="48 "></span></a>    Projections: name=p.name, title=m.title
</span><span id=__span-53-49><a id=__codelineno-53-49 name=__codelineno-53-49></a><a href=#__codelineno-53-49><span class=linenos data-linenos="49 "></span></a>*
</span><span id=__span-53-50><a id=__codelineno-53-50 name=__codelineno-53-50></a><a href=#__codelineno-53-50><span class=linenos data-linenos="50 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=19-variable-length-path-traversal-1-to-3-hops>19. Variable-length path traversal (1 to 3 hops)<a class=headerlink href=#19-variable-length-path-traversal-1-to-3-hops title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Recursive paths</p> <details class=note> <summary>Notes</summary> <p>Finds all people reachable within 1-3 hops.</p> <p>WHY USEFUL: Friend-of-friend queries, network analysis, influence propagation.</p> <p>DATABRICKS COMPLEXITY: O(k^d) where k=avg degree, d=max depth COST: HIGH. Uses WITH RECURSIVE CTE. Includes cycle detection to prevent infinite loops.</p> <p>SQL Pattern: WITH RECURSIVE paths AS ( -- base case UNION ALL -- recursive case with depth &lt; max_depth )</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-54-1><a id=__codelineno-54-1 name=__codelineno-54-1></a><a href=#__codelineno-54-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=p>*</span><span class=m>1</span><span class=p>..</span><span class=m>3</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>f</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-54-2><a id=__codelineno-54-2 name=__codelineno-54-2></a><a href=#__codelineno-54-2><span class=linenos data-linenos="2 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&#39;Alice&#39;</span>
</span><span id=__span-54-3><a id=__codelineno-54-3 name=__codelineno-54-3></a><a href=#__codelineno-54-3><span class=linenos data-linenos="3 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>reachable</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-55-1><a id=__codelineno-55-1 name=__codelineno-55-1></a><a href=#__codelineno-55-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span>
</span><span id=__span-55-2><a id=__codelineno-55-2 name=__codelineno-55-2></a><a href=#__codelineno-55-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>  </span><span class=n>paths_1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-55-3><a id=__codelineno-55-3 name=__codelineno-55-3></a><a href=#__codelineno-55-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>    </span><span class=c1>-- Base case: direct edges (depth = 1)</span>
</span><span id=__span-55-4><a id=__codelineno-55-4 name=__codelineno-55-4></a><a href=#__codelineno-55-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-55-5><a id=__codelineno-55-5 name=__codelineno-55-5></a><a href=#__codelineno-55-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-55-6><a id=__codelineno-55-6 name=__codelineno-55-6></a><a href=#__codelineno-55-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-55-7><a id=__codelineno-55-7 name=__codelineno-55-7></a><a href=#__codelineno-55-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>      </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-55-8><a id=__codelineno-55-8 name=__codelineno-55-8></a><a href=#__codelineno-55-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-55-9><a id=__codelineno-55-9 name=__codelineno-55-9></a><a href=#__codelineno-55-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-55-10><a id=__codelineno-55-10 name=__codelineno-55-10></a><a href=#__codelineno-55-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-55-11><a id=__codelineno-55-11 name=__codelineno-55-11></a><a href=#__codelineno-55-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=n>src</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>src</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span>
</span><span id=__span-55-12><a id=__codelineno-55-12 name=__codelineno-55-12></a><a href=#__codelineno-55-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=p>(</span><span class=n>src</span><span class=p>.</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Alice&#39;</span><span class=p>)</span>
</span><span id=__span-55-13><a id=__codelineno-55-13 name=__codelineno-55-13></a><a href=#__codelineno-55-13><span class=linenos data-linenos="13 "></span></a>
</span><span id=__span-55-14><a id=__codelineno-55-14 name=__codelineno-55-14></a><a href=#__codelineno-55-14><span class=linenos data-linenos="14 "></span></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-55-15><a id=__codelineno-55-15 name=__codelineno-55-15></a><a href=#__codelineno-55-15><span class=linenos data-linenos="15 "></span></a>
</span><span id=__span-55-16><a id=__codelineno-55-16 name=__codelineno-55-16></a><a href=#__codelineno-55-16><span class=linenos data-linenos="16 "></span></a><span class=w>    </span><span class=c1>-- Recursive case: extend paths</span>
</span><span id=__span-55-17><a id=__codelineno-55-17 name=__codelineno-55-17></a><a href=#__codelineno-55-17><span class=linenos data-linenos="17 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-55-18><a id=__codelineno-55-18 name=__codelineno-55-18></a><a href=#__codelineno-55-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-55-19><a id=__codelineno-55-19 name=__codelineno-55-19></a><a href=#__codelineno-55-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-55-20><a id=__codelineno-55-20 name=__codelineno-55-20></a><a href=#__codelineno-55-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-55-21><a id=__codelineno-55-21 name=__codelineno-55-21></a><a href=#__codelineno-55-21><span class=linenos data-linenos="21 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-55-22><a id=__codelineno-55-22 name=__codelineno-55-22></a><a href=#__codelineno-55-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-55-23><a id=__codelineno-55-23 name=__codelineno-55-23></a><a href=#__codelineno-55-23><span class=linenos data-linenos="23 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-55-24><a id=__codelineno-55-24 name=__codelineno-55-24></a><a href=#__codelineno-55-24><span class=linenos data-linenos="24 "></span></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-55-25><a id=__codelineno-55-25 name=__codelineno-55-25></a><a href=#__codelineno-55-25><span class=linenos data-linenos="25 "></span></a><span class=w>      </span><span class=k>ON</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span>
</span><span id=__span-55-26><a id=__codelineno-55-26 name=__codelineno-55-26></a><a href=#__codelineno-55-26><span class=linenos data-linenos="26 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>3</span>
</span><span id=__span-55-27><a id=__codelineno-55-27 name=__codelineno-55-27></a><a href=#__codelineno-55-27><span class=linenos data-linenos="27 "></span></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=n>ARRAY_CONTAINS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span>
</span><span id=__span-55-28><a id=__codelineno-55-28 name=__codelineno-55-28></a><a href=#__codelineno-55-28><span class=linenos data-linenos="28 "></span></a><span class=w>  </span><span class=p>)</span>
</span><span id=__span-55-29><a id=__codelineno-55-29 name=__codelineno-55-29></a><a href=#__codelineno-55-29><span class=linenos data-linenos="29 "></span></a><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span>
</span><span id=__span-55-30><a id=__codelineno-55-30 name=__codelineno-55-30></a><a href=#__codelineno-55-30><span class=linenos data-linenos="30 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>reachable</span>
</span><span id=__span-55-31><a id=__codelineno-55-31 name=__codelineno-55-31></a><a href=#__codelineno-55-31><span class=linenos data-linenos="31 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-55-32><a id=__codelineno-55-32 name=__codelineno-55-32></a><a href=#__codelineno-55-32><span class=linenos data-linenos="32 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-55-33><a id=__codelineno-55-33 name=__codelineno-55-33></a><a href=#__codelineno-55-33><span class=linenos data-linenos="33 "></span></a><span class=w>     </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-55-34><a id=__codelineno-55-34 name=__codelineno-55-34></a><a href=#__codelineno-55-34><span class=linenos data-linenos="34 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-55-35><a id=__codelineno-55-35 name=__codelineno-55-35></a><a href=#__codelineno-55-35><span class=linenos data-linenos="35 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_age</span>
</span><span id=__span-55-36><a id=__codelineno-55-36 name=__codelineno-55-36></a><a href=#__codelineno-55-36><span class=linenos data-linenos="36 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_nickname</span>
</span><span id=__span-55-37><a id=__codelineno-55-37 name=__codelineno-55-37></a><a href=#__codelineno-55-37><span class=linenos data-linenos="37 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_salary</span>
</span><span id=__span-55-38><a id=__codelineno-55-38 name=__codelineno-55-38></a><a href=#__codelineno-55-38><span class=linenos data-linenos="38 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_active</span>
</span><span id=__span-55-39><a id=__codelineno-55-39 name=__codelineno-55-39></a><a href=#__codelineno-55-39><span class=linenos data-linenos="39 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-55-40><a id=__codelineno-55-40 name=__codelineno-55-40></a><a href=#__codelineno-55-40><span class=linenos data-linenos="40 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-55-41><a id=__codelineno-55-41 name=__codelineno-55-41></a><a href=#__codelineno-55-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-55-42><a id=__codelineno-55-42 name=__codelineno-55-42></a><a href=#__codelineno-55-42><span class=linenos data-linenos="42 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_nickname</span>
</span><span id=__span-55-43><a id=__codelineno-55-43 name=__codelineno-55-43></a><a href=#__codelineno-55-43><span class=linenos data-linenos="43 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_salary</span>
</span><span id=__span-55-44><a id=__codelineno-55-44 name=__codelineno-55-44></a><a href=#__codelineno-55-44><span class=linenos data-linenos="44 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_active</span>
</span><span id=__span-55-45><a id=__codelineno-55-45 name=__codelineno-55-45></a><a href=#__codelineno-55-45><span class=linenos data-linenos="45 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-55-46><a id=__codelineno-55-46 name=__codelineno-55-46></a><a href=#__codelineno-55-46><span class=linenos data-linenos="46 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-55-47><a id=__codelineno-55-47 name=__codelineno-55-47></a><a href=#__codelineno-55-47><span class=linenos data-linenos="47 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>depth</span>
</span><span id=__span-55-48><a id=__codelineno-55-48 name=__codelineno-55-48></a><a href=#__codelineno-55-48><span class=linenos data-linenos="48 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>path</span>
</span><span id=__span-55-49><a id=__codelineno-55-49 name=__codelineno-55-49></a><a href=#__codelineno-55-49><span class=linenos data-linenos="49 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-55-50><a id=__codelineno-55-50 name=__codelineno-55-50></a><a href=#__codelineno-55-50><span class=linenos data-linenos="50 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=n>sink</span>
</span><span id=__span-55-51><a id=__codelineno-55-51 name=__codelineno-55-51></a><a href=#__codelineno-55-51><span class=linenos data-linenos="51 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-55-52><a id=__codelineno-55-52 name=__codelineno-55-52></a><a href=#__codelineno-55-52><span class=linenos data-linenos="52 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=k>source</span>
</span><span id=__span-55-53><a id=__codelineno-55-53 name=__codelineno-55-53></a><a href=#__codelineno-55-53><span class=linenos data-linenos="53 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-55-54><a id=__codelineno-55-54 name=__codelineno-55-54></a><a href=#__codelineno-55-54><span class=linenos data-linenos="54 "></span></a><span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>3</span>
</span><span id=__span-55-55><a id=__codelineno-55-55 name=__codelineno-55-55></a><a href=#__codelineno-55-55><span class=linenos data-linenos="55 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-56-1><a id=__codelineno-56-1 name=__codelineno-56-1></a><a href=#__codelineno-56-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-56-2><a id=__codelineno-56-2 name=__codelineno-56-2></a><a href=#__codelineno-56-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-56-3><a id=__codelineno-56-3 name=__codelineno-56-3></a><a href=#__codelineno-56-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=2;
</span><span id=__span-56-4><a id=__codelineno-56-4 name=__codelineno-56-4></a><a href=#__codelineno-56-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-56-5><a id=__codelineno-56-5 name=__codelineno-56-5></a><a href=#__codelineno-56-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-56-6><a id=__codelineno-56-6 name=__codelineno-56-6></a><a href=#__codelineno-56-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-56-7><a id=__codelineno-56-7 name=__codelineno-56-7></a><a href=#__codelineno-56-7><span class=linenos data-linenos=" 7 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-56-8><a id=__codelineno-56-8 name=__codelineno-56-8></a><a href=#__codelineno-56-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-56-9><a id=__codelineno-56-9 name=__codelineno-56-9></a><a href=#__codelineno-56-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: f:Person
</span><span id=__span-56-10><a id=__codelineno-56-10 name=__codelineno-56-10></a><a href=#__codelineno-56-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-56-11><a id=__codelineno-56-11 name=__codelineno-56-11></a><a href=#__codelineno-56-11><span class=linenos data-linenos="11 "></span></a>----------------------------------------------------------------------
</span><span id=__span-56-12><a id=__codelineno-56-12 name=__codelineno-56-12></a><a href=#__codelineno-56-12><span class=linenos data-linenos="12 "></span></a>Level 1:
</span><span id=__span-56-13><a id=__codelineno-56-13 name=__codelineno-56-13></a><a href=#__codelineno-56-13><span class=linenos data-linenos="13 "></span></a>----------------------------------------------------------------------
</span><span id=__span-56-14><a id=__codelineno-56-14 name=__codelineno-56-14></a><a href=#__codelineno-56-14><span class=linenos data-linenos="14 "></span></a>OpId=2 Op=RecursiveTraversalOperator; InOpIds=1; OutOpIds=4;
</span><span id=__span-56-15><a id=__codelineno-56-15 name=__codelineno-56-15></a><a href=#__codelineno-56-15><span class=linenos data-linenos="15 "></span></a>  RecursiveTraversal(KNOWS*1..3)
</span><span id=__span-56-16><a id=__codelineno-56-16 name=__codelineno-56-16></a><a href=#__codelineno-56-16><span class=linenos data-linenos="16 "></span></a>*
</span><span id=__span-56-17><a id=__codelineno-56-17 name=__codelineno-56-17></a><a href=#__codelineno-56-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-56-18><a id=__codelineno-56-18 name=__codelineno-56-18></a><a href=#__codelineno-56-18><span class=linenos data-linenos="18 "></span></a>Level 2:
</span><span id=__span-56-19><a id=__codelineno-56-19 name=__codelineno-56-19></a><a href=#__codelineno-56-19><span class=linenos data-linenos="19 "></span></a>----------------------------------------------------------------------
</span><span id=__span-56-20><a id=__codelineno-56-20 name=__codelineno-56-20></a><a href=#__codelineno-56-20><span class=linenos data-linenos="20 "></span></a>OpId=4 Op=JoinOperator; InOpIds=2,3; OutOpIds=5;
</span><span id=__span-56-21><a id=__codelineno-56-21 name=__codelineno-56-21></a><a href=#__codelineno-56-21><span class=linenos data-linenos="21 "></span></a>  JoinOperator(id=4)
</span><span id=__span-56-22><a id=__codelineno-56-22 name=__codelineno-56-22></a><a href=#__codelineno-56-22><span class=linenos data-linenos="22 "></span></a>    JoinType: INNER
</span><span id=__span-56-23><a id=__codelineno-56-23 name=__codelineno-56-23></a><a href=#__codelineno-56-23><span class=linenos data-linenos="23 "></span></a>    Joins: JoinPair: Node=f RelOrNode=paths__anon1 Type=SINK
</span><span id=__span-56-24><a id=__codelineno-56-24 name=__codelineno-56-24></a><a href=#__codelineno-56-24><span class=linenos data-linenos="24 "></span></a>*
</span><span id=__span-56-25><a id=__codelineno-56-25 name=__codelineno-56-25></a><a href=#__codelineno-56-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-56-26><a id=__codelineno-56-26 name=__codelineno-56-26></a><a href=#__codelineno-56-26><span class=linenos data-linenos="26 "></span></a>Level 3:
</span><span id=__span-56-27><a id=__codelineno-56-27 name=__codelineno-56-27></a><a href=#__codelineno-56-27><span class=linenos data-linenos="27 "></span></a>----------------------------------------------------------------------
</span><span id=__span-56-28><a id=__codelineno-56-28 name=__codelineno-56-28></a><a href=#__codelineno-56-28><span class=linenos data-linenos="28 "></span></a>OpId=5 Op=ProjectionOperator; InOpIds=4; OutOpIds=;
</span><span id=__span-56-29><a id=__codelineno-56-29 name=__codelineno-56-29></a><a href=#__codelineno-56-29><span class=linenos data-linenos="29 "></span></a>  ProjectionOperator(id=5)
</span><span id=__span-56-30><a id=__codelineno-56-30 name=__codelineno-56-30></a><a href=#__codelineno-56-30><span class=linenos data-linenos="30 "></span></a>    Projections: reachable=f.name
</span><span id=__span-56-31><a id=__codelineno-56-31 name=__codelineno-56-31></a><a href=#__codelineno-56-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-56-32><a id=__codelineno-56-32 name=__codelineno-56-32></a><a href=#__codelineno-56-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=20-variable-length-path-with-zero-length-includes-self>20. Variable-length path with zero-length (includes self)<a class=headerlink href=#20-variable-length-path-with-zero-length-includes-self title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Zero-length paths</p> <details class=note> <summary>Notes</summary> <p>Includes the starting node (depth=0) plus 1-2 hop neighbors.</p> <p>WHY USEFUL: Include self in results, optional relationship matching.</p> <p>DATABRICKS COMPLEXITY: O(1 + k + k^2) - identity + 1-hop + 2-hop COST: HIGH. Recursive CTE with special depth=0 base case. Depth 0 = no joins, just the starting node.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-57-1><a id=__codelineno-57-1 name=__codelineno-57-1></a><a href=#__codelineno-57-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=p>*</span><span class=m>0</span><span class=p>..</span><span class=m>2</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>f</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-57-2><a id=__codelineno-57-2 name=__codelineno-57-2></a><a href=#__codelineno-57-2><span class=linenos data-linenos="2 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&#39;Alice&#39;</span>
</span><span id=__span-57-3><a id=__codelineno-57-3 name=__codelineno-57-3></a><a href=#__codelineno-57-3><span class=linenos data-linenos="3 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>reachable</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-58-1><a id=__codelineno-58-1 name=__codelineno-58-1></a><a href=#__codelineno-58-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span>
</span><span id=__span-58-2><a id=__codelineno-58-2 name=__codelineno-58-2></a><a href=#__codelineno-58-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>  </span><span class=n>paths_1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-58-3><a id=__codelineno-58-3 name=__codelineno-58-3></a><a href=#__codelineno-58-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>    </span><span class=c1>-- Base case: Zero-length paths (depth = 0)</span>
</span><span id=__span-58-4><a id=__codelineno-58-4 name=__codelineno-58-4></a><a href=#__codelineno-58-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-58-5><a id=__codelineno-58-5 name=__codelineno-58-5></a><a href=#__codelineno-58-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>      </span><span class=n>n</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-58-6><a id=__codelineno-58-6 name=__codelineno-58-6></a><a href=#__codelineno-58-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>      </span><span class=n>n</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-58-7><a id=__codelineno-58-7 name=__codelineno-58-7></a><a href=#__codelineno-58-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>      </span><span class=mi>0</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-58-8><a id=__codelineno-58-8 name=__codelineno-58-8></a><a href=#__codelineno-58-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>n</span><span class=p>.</span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-58-9><a id=__codelineno-58-9 name=__codelineno-58-9></a><a href=#__codelineno-58-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>()</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-58-10><a id=__codelineno-58-10 name=__codelineno-58-10></a><a href=#__codelineno-58-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=n>n</span>
</span><span id=__span-58-11><a id=__codelineno-58-11 name=__codelineno-58-11></a><a href=#__codelineno-58-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=p>(</span><span class=n>n</span><span class=p>.</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Alice&#39;</span><span class=p>)</span>
</span><span id=__span-58-12><a id=__codelineno-58-12 name=__codelineno-58-12></a><a href=#__codelineno-58-12><span class=linenos data-linenos="12 "></span></a>
</span><span id=__span-58-13><a id=__codelineno-58-13 name=__codelineno-58-13></a><a href=#__codelineno-58-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-58-14><a id=__codelineno-58-14 name=__codelineno-58-14></a><a href=#__codelineno-58-14><span class=linenos data-linenos="14 "></span></a>
</span><span id=__span-58-15><a id=__codelineno-58-15 name=__codelineno-58-15></a><a href=#__codelineno-58-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=c1>-- Base case: direct edges (depth = 1)</span>
</span><span id=__span-58-16><a id=__codelineno-58-16 name=__codelineno-58-16></a><a href=#__codelineno-58-16><span class=linenos data-linenos="16 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-58-17><a id=__codelineno-58-17 name=__codelineno-58-17></a><a href=#__codelineno-58-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-58-18><a id=__codelineno-58-18 name=__codelineno-58-18></a><a href=#__codelineno-58-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-58-19><a id=__codelineno-58-19 name=__codelineno-58-19></a><a href=#__codelineno-58-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-58-20><a id=__codelineno-58-20 name=__codelineno-58-20></a><a href=#__codelineno-58-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-58-21><a id=__codelineno-58-21 name=__codelineno-58-21></a><a href=#__codelineno-58-21><span class=linenos data-linenos="21 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-58-22><a id=__codelineno-58-22 name=__codelineno-58-22></a><a href=#__codelineno-58-22><span class=linenos data-linenos="22 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-58-23><a id=__codelineno-58-23 name=__codelineno-58-23></a><a href=#__codelineno-58-23><span class=linenos data-linenos="23 "></span></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=n>src</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>src</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span>
</span><span id=__span-58-24><a id=__codelineno-58-24 name=__codelineno-58-24></a><a href=#__codelineno-58-24><span class=linenos data-linenos="24 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=p>(</span><span class=n>src</span><span class=p>.</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Alice&#39;</span><span class=p>)</span>
</span><span id=__span-58-25><a id=__codelineno-58-25 name=__codelineno-58-25></a><a href=#__codelineno-58-25><span class=linenos data-linenos="25 "></span></a>
</span><span id=__span-58-26><a id=__codelineno-58-26 name=__codelineno-58-26></a><a href=#__codelineno-58-26><span class=linenos data-linenos="26 "></span></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-58-27><a id=__codelineno-58-27 name=__codelineno-58-27></a><a href=#__codelineno-58-27><span class=linenos data-linenos="27 "></span></a>
</span><span id=__span-58-28><a id=__codelineno-58-28 name=__codelineno-58-28></a><a href=#__codelineno-58-28><span class=linenos data-linenos="28 "></span></a><span class=w>    </span><span class=c1>-- Recursive case: extend paths</span>
</span><span id=__span-58-29><a id=__codelineno-58-29 name=__codelineno-58-29></a><a href=#__codelineno-58-29><span class=linenos data-linenos="29 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-58-30><a id=__codelineno-58-30 name=__codelineno-58-30></a><a href=#__codelineno-58-30><span class=linenos data-linenos="30 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-58-31><a id=__codelineno-58-31 name=__codelineno-58-31></a><a href=#__codelineno-58-31><span class=linenos data-linenos="31 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-58-32><a id=__codelineno-58-32 name=__codelineno-58-32></a><a href=#__codelineno-58-32><span class=linenos data-linenos="32 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-58-33><a id=__codelineno-58-33 name=__codelineno-58-33></a><a href=#__codelineno-58-33><span class=linenos data-linenos="33 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-58-34><a id=__codelineno-58-34 name=__codelineno-58-34></a><a href=#__codelineno-58-34><span class=linenos data-linenos="34 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-58-35><a id=__codelineno-58-35 name=__codelineno-58-35></a><a href=#__codelineno-58-35><span class=linenos data-linenos="35 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-58-36><a id=__codelineno-58-36 name=__codelineno-58-36></a><a href=#__codelineno-58-36><span class=linenos data-linenos="36 "></span></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-58-37><a id=__codelineno-58-37 name=__codelineno-58-37></a><a href=#__codelineno-58-37><span class=linenos data-linenos="37 "></span></a><span class=w>      </span><span class=k>ON</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span>
</span><span id=__span-58-38><a id=__codelineno-58-38 name=__codelineno-58-38></a><a href=#__codelineno-58-38><span class=linenos data-linenos="38 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>2</span>
</span><span id=__span-58-39><a id=__codelineno-58-39 name=__codelineno-58-39></a><a href=#__codelineno-58-39><span class=linenos data-linenos="39 "></span></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=n>ARRAY_CONTAINS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span>
</span><span id=__span-58-40><a id=__codelineno-58-40 name=__codelineno-58-40></a><a href=#__codelineno-58-40><span class=linenos data-linenos="40 "></span></a><span class=w>  </span><span class=p>)</span>
</span><span id=__span-58-41><a id=__codelineno-58-41 name=__codelineno-58-41></a><a href=#__codelineno-58-41><span class=linenos data-linenos="41 "></span></a><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span>
</span><span id=__span-58-42><a id=__codelineno-58-42 name=__codelineno-58-42></a><a href=#__codelineno-58-42><span class=linenos data-linenos="42 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>reachable</span>
</span><span id=__span-58-43><a id=__codelineno-58-43 name=__codelineno-58-43></a><a href=#__codelineno-58-43><span class=linenos data-linenos="43 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-58-44><a id=__codelineno-58-44 name=__codelineno-58-44></a><a href=#__codelineno-58-44><span class=linenos data-linenos="44 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-58-45><a id=__codelineno-58-45 name=__codelineno-58-45></a><a href=#__codelineno-58-45><span class=linenos data-linenos="45 "></span></a><span class=w>     </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-58-46><a id=__codelineno-58-46 name=__codelineno-58-46></a><a href=#__codelineno-58-46><span class=linenos data-linenos="46 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-58-47><a id=__codelineno-58-47 name=__codelineno-58-47></a><a href=#__codelineno-58-47><span class=linenos data-linenos="47 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_age</span>
</span><span id=__span-58-48><a id=__codelineno-58-48 name=__codelineno-58-48></a><a href=#__codelineno-58-48><span class=linenos data-linenos="48 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_nickname</span>
</span><span id=__span-58-49><a id=__codelineno-58-49 name=__codelineno-58-49></a><a href=#__codelineno-58-49><span class=linenos data-linenos="49 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_salary</span>
</span><span id=__span-58-50><a id=__codelineno-58-50 name=__codelineno-58-50></a><a href=#__codelineno-58-50><span class=linenos data-linenos="50 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_active</span>
</span><span id=__span-58-51><a id=__codelineno-58-51 name=__codelineno-58-51></a><a href=#__codelineno-58-51><span class=linenos data-linenos="51 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-58-52><a id=__codelineno-58-52 name=__codelineno-58-52></a><a href=#__codelineno-58-52><span class=linenos data-linenos="52 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-58-53><a id=__codelineno-58-53 name=__codelineno-58-53></a><a href=#__codelineno-58-53><span class=linenos data-linenos="53 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-58-54><a id=__codelineno-58-54 name=__codelineno-58-54></a><a href=#__codelineno-58-54><span class=linenos data-linenos="54 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_nickname</span>
</span><span id=__span-58-55><a id=__codelineno-58-55 name=__codelineno-58-55></a><a href=#__codelineno-58-55><span class=linenos data-linenos="55 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_salary</span>
</span><span id=__span-58-56><a id=__codelineno-58-56 name=__codelineno-58-56></a><a href=#__codelineno-58-56><span class=linenos data-linenos="56 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_active</span>
</span><span id=__span-58-57><a id=__codelineno-58-57 name=__codelineno-58-57></a><a href=#__codelineno-58-57><span class=linenos data-linenos="57 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-58-58><a id=__codelineno-58-58 name=__codelineno-58-58></a><a href=#__codelineno-58-58><span class=linenos data-linenos="58 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-58-59><a id=__codelineno-58-59 name=__codelineno-58-59></a><a href=#__codelineno-58-59><span class=linenos data-linenos="59 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>depth</span>
</span><span id=__span-58-60><a id=__codelineno-58-60 name=__codelineno-58-60></a><a href=#__codelineno-58-60><span class=linenos data-linenos="60 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>path</span>
</span><span id=__span-58-61><a id=__codelineno-58-61 name=__codelineno-58-61></a><a href=#__codelineno-58-61><span class=linenos data-linenos="61 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-58-62><a id=__codelineno-58-62 name=__codelineno-58-62></a><a href=#__codelineno-58-62><span class=linenos data-linenos="62 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=n>sink</span>
</span><span id=__span-58-63><a id=__codelineno-58-63 name=__codelineno-58-63></a><a href=#__codelineno-58-63><span class=linenos data-linenos="63 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-58-64><a id=__codelineno-58-64 name=__codelineno-58-64></a><a href=#__codelineno-58-64><span class=linenos data-linenos="64 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=k>source</span>
</span><span id=__span-58-65><a id=__codelineno-58-65 name=__codelineno-58-65></a><a href=#__codelineno-58-65><span class=linenos data-linenos="65 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-58-66><a id=__codelineno-58-66 name=__codelineno-58-66></a><a href=#__codelineno-58-66><span class=linenos data-linenos="66 "></span></a><span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>2</span>
</span><span id=__span-58-67><a id=__codelineno-58-67 name=__codelineno-58-67></a><a href=#__codelineno-58-67><span class=linenos data-linenos="67 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-59-1><a id=__codelineno-59-1 name=__codelineno-59-1></a><a href=#__codelineno-59-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-59-2><a id=__codelineno-59-2 name=__codelineno-59-2></a><a href=#__codelineno-59-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-59-3><a id=__codelineno-59-3 name=__codelineno-59-3></a><a href=#__codelineno-59-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=2;
</span><span id=__span-59-4><a id=__codelineno-59-4 name=__codelineno-59-4></a><a href=#__codelineno-59-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-59-5><a id=__codelineno-59-5 name=__codelineno-59-5></a><a href=#__codelineno-59-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-59-6><a id=__codelineno-59-6 name=__codelineno-59-6></a><a href=#__codelineno-59-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-59-7><a id=__codelineno-59-7 name=__codelineno-59-7></a><a href=#__codelineno-59-7><span class=linenos data-linenos=" 7 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-59-8><a id=__codelineno-59-8 name=__codelineno-59-8></a><a href=#__codelineno-59-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-59-9><a id=__codelineno-59-9 name=__codelineno-59-9></a><a href=#__codelineno-59-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: f:Person
</span><span id=__span-59-10><a id=__codelineno-59-10 name=__codelineno-59-10></a><a href=#__codelineno-59-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-59-11><a id=__codelineno-59-11 name=__codelineno-59-11></a><a href=#__codelineno-59-11><span class=linenos data-linenos="11 "></span></a>----------------------------------------------------------------------
</span><span id=__span-59-12><a id=__codelineno-59-12 name=__codelineno-59-12></a><a href=#__codelineno-59-12><span class=linenos data-linenos="12 "></span></a>Level 1:
</span><span id=__span-59-13><a id=__codelineno-59-13 name=__codelineno-59-13></a><a href=#__codelineno-59-13><span class=linenos data-linenos="13 "></span></a>----------------------------------------------------------------------
</span><span id=__span-59-14><a id=__codelineno-59-14 name=__codelineno-59-14></a><a href=#__codelineno-59-14><span class=linenos data-linenos="14 "></span></a>OpId=2 Op=RecursiveTraversalOperator; InOpIds=1; OutOpIds=4;
</span><span id=__span-59-15><a id=__codelineno-59-15 name=__codelineno-59-15></a><a href=#__codelineno-59-15><span class=linenos data-linenos="15 "></span></a>  RecursiveTraversal(KNOWS*0..2)
</span><span id=__span-59-16><a id=__codelineno-59-16 name=__codelineno-59-16></a><a href=#__codelineno-59-16><span class=linenos data-linenos="16 "></span></a>*
</span><span id=__span-59-17><a id=__codelineno-59-17 name=__codelineno-59-17></a><a href=#__codelineno-59-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-59-18><a id=__codelineno-59-18 name=__codelineno-59-18></a><a href=#__codelineno-59-18><span class=linenos data-linenos="18 "></span></a>Level 2:
</span><span id=__span-59-19><a id=__codelineno-59-19 name=__codelineno-59-19></a><a href=#__codelineno-59-19><span class=linenos data-linenos="19 "></span></a>----------------------------------------------------------------------
</span><span id=__span-59-20><a id=__codelineno-59-20 name=__codelineno-59-20></a><a href=#__codelineno-59-20><span class=linenos data-linenos="20 "></span></a>OpId=4 Op=JoinOperator; InOpIds=2,3; OutOpIds=5;
</span><span id=__span-59-21><a id=__codelineno-59-21 name=__codelineno-59-21></a><a href=#__codelineno-59-21><span class=linenos data-linenos="21 "></span></a>  JoinOperator(id=4)
</span><span id=__span-59-22><a id=__codelineno-59-22 name=__codelineno-59-22></a><a href=#__codelineno-59-22><span class=linenos data-linenos="22 "></span></a>    JoinType: INNER
</span><span id=__span-59-23><a id=__codelineno-59-23 name=__codelineno-59-23></a><a href=#__codelineno-59-23><span class=linenos data-linenos="23 "></span></a>    Joins: JoinPair: Node=f RelOrNode=paths__anon1 Type=SINK
</span><span id=__span-59-24><a id=__codelineno-59-24 name=__codelineno-59-24></a><a href=#__codelineno-59-24><span class=linenos data-linenos="24 "></span></a>*
</span><span id=__span-59-25><a id=__codelineno-59-25 name=__codelineno-59-25></a><a href=#__codelineno-59-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-59-26><a id=__codelineno-59-26 name=__codelineno-59-26></a><a href=#__codelineno-59-26><span class=linenos data-linenos="26 "></span></a>Level 3:
</span><span id=__span-59-27><a id=__codelineno-59-27 name=__codelineno-59-27></a><a href=#__codelineno-59-27><span class=linenos data-linenos="27 "></span></a>----------------------------------------------------------------------
</span><span id=__span-59-28><a id=__codelineno-59-28 name=__codelineno-59-28></a><a href=#__codelineno-59-28><span class=linenos data-linenos="28 "></span></a>OpId=5 Op=ProjectionOperator; InOpIds=4; OutOpIds=;
</span><span id=__span-59-29><a id=__codelineno-59-29 name=__codelineno-59-29></a><a href=#__codelineno-59-29><span class=linenos data-linenos="29 "></span></a>  ProjectionOperator(id=5)
</span><span id=__span-59-30><a id=__codelineno-59-30 name=__codelineno-59-30></a><a href=#__codelineno-59-30><span class=linenos data-linenos="30 "></span></a>    Projections: reachable=f.name
</span><span id=__span-59-31><a id=__codelineno-59-31 name=__codelineno-59-31></a><a href=#__codelineno-59-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-59-32><a id=__codelineno-59-32 name=__codelineno-59-32></a><a href=#__codelineno-59-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=21-case-expression-for-conditional-values>21. CASE expression for conditional values<a class=headerlink href=#21-case-expression-for-conditional-values title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: CASE WHEN</p> <details class=note> <summary>Notes</summary> <p>Evaluates conditions sequentially, returns first match.</p> <p>WHY USEFUL: Categorize data, compute derived fields, business logic.</p> <p>DATABRICKS COMPLEXITY: O(n) - evaluated per row COST: Very low. Direct translation to SQL CASE. First matching WHEN wins. ELSE is optional (defaults to NULL). Can be used in WHERE, ORDER BY, GROUP BY.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-60-1><a id=__codelineno-60-1 name=__codelineno-60-1></a><a href=#__codelineno-60-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-60-2><a id=__codelineno-60-2 name=__codelineno-60-2></a><a href=#__codelineno-60-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=p>,</span>
</span><span id=__span-60-3><a id=__codelineno-60-3 name=__codelineno-60-3></a><a href=#__codelineno-60-3><span class=linenos data-linenos="3 "></span></a><span class=w>       </span><span class=k>CASE</span>
</span><span id=__span-60-4><a id=__codelineno-60-4 name=__codelineno-60-4></a><a href=#__codelineno-60-4><span class=linenos data-linenos="4 "></span></a><span class=w>         </span><span class=k>WHEN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=p>&lt;</span><span class=w> </span><span class=m>18</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s>&#39;minor&#39;</span>
</span><span id=__span-60-5><a id=__codelineno-60-5 name=__codelineno-60-5></a><a href=#__codelineno-60-5><span class=linenos data-linenos="5 "></span></a><span class=w>         </span><span class=k>WHEN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=p>&lt;</span><span class=w> </span><span class=m>65</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s>&#39;adult&#39;</span>
</span><span id=__span-60-6><a id=__codelineno-60-6 name=__codelineno-60-6></a><a href=#__codelineno-60-6><span class=linenos data-linenos="6 "></span></a><span class=w>         </span><span class=n>ELSE</span><span class=w> </span><span class=s>&#39;senior&#39;</span>
</span><span id=__span-60-7><a id=__codelineno-60-7 name=__codelineno-60-7></a><a href=#__codelineno-60-7><span class=linenos data-linenos="7 "></span></a><span class=w>       </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>ageGroup</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-61-1><a id=__codelineno-61-1 name=__codelineno-61-1></a><a href=#__codelineno-61-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-61-2><a id=__codelineno-61-2 name=__codelineno-61-2></a><a href=#__codelineno-61-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-61-3><a id=__codelineno-61-3 name=__codelineno-61-3></a><a href=#__codelineno-61-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=p>(</span><span class=n>_gsql2rsql_p_age</span><span class=p>)</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=p>(</span><span class=mi>18</span><span class=p>)</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;minor&#39;</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=p>(</span><span class=n>_gsql2rsql_p_age</span><span class=p>)</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=p>(</span><span class=mi>65</span><span class=p>)</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;adult&#39;</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;senior&#39;</span><span class=w> </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>ageGroup</span>
</span><span id=__span-61-4><a id=__codelineno-61-4 name=__codelineno-61-4></a><a href=#__codelineno-61-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-61-5><a id=__codelineno-61-5 name=__codelineno-61-5></a><a href=#__codelineno-61-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-61-6><a id=__codelineno-61-6 name=__codelineno-61-6></a><a href=#__codelineno-61-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-61-7><a id=__codelineno-61-7 name=__codelineno-61-7></a><a href=#__codelineno-61-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-61-8><a id=__codelineno-61-8 name=__codelineno-61-8></a><a href=#__codelineno-61-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-61-9><a id=__codelineno-61-9 name=__codelineno-61-9></a><a href=#__codelineno-61-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>  </span><span class=k>FROM</span>
</span><span id=__span-61-10><a id=__codelineno-61-10 name=__codelineno-61-10></a><a href=#__codelineno-61-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-61-11><a id=__codelineno-61-11 name=__codelineno-61-11></a><a href=#__codelineno-61-11><span class=linenos data-linenos="11 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-62-1><a id=__codelineno-62-1 name=__codelineno-62-1></a><a href=#__codelineno-62-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-62-2><a id=__codelineno-62-2 name=__codelineno-62-2></a><a href=#__codelineno-62-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-62-3><a id=__codelineno-62-3 name=__codelineno-62-3></a><a href=#__codelineno-62-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=2;
</span><span id=__span-62-4><a id=__codelineno-62-4 name=__codelineno-62-4></a><a href=#__codelineno-62-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-62-5><a id=__codelineno-62-5 name=__codelineno-62-5></a><a href=#__codelineno-62-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-62-6><a id=__codelineno-62-6 name=__codelineno-62-6></a><a href=#__codelineno-62-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-62-7><a id=__codelineno-62-7 name=__codelineno-62-7></a><a href=#__codelineno-62-7><span class=linenos data-linenos=" 7 "></span></a>----------------------------------------------------------------------
</span><span id=__span-62-8><a id=__codelineno-62-8 name=__codelineno-62-8></a><a href=#__codelineno-62-8><span class=linenos data-linenos=" 8 "></span></a>Level 1:
</span><span id=__span-62-9><a id=__codelineno-62-9 name=__codelineno-62-9></a><a href=#__codelineno-62-9><span class=linenos data-linenos=" 9 "></span></a>----------------------------------------------------------------------
</span><span id=__span-62-10><a id=__codelineno-62-10 name=__codelineno-62-10></a><a href=#__codelineno-62-10><span class=linenos data-linenos="10 "></span></a>OpId=2 Op=ProjectionOperator; InOpIds=1; OutOpIds=;
</span><span id=__span-62-11><a id=__codelineno-62-11 name=__codelineno-62-11></a><a href=#__codelineno-62-11><span class=linenos data-linenos="11 "></span></a>  ProjectionOperator(id=2)
</span><span id=__span-62-12><a id=__codelineno-62-12 name=__codelineno-62-12></a><a href=#__codelineno-62-12><span class=linenos data-linenos="12 "></span></a>    Projections: name=p.name, ageGroup=CASE WHEN (p.age LT 18) THEN &#39;minor&#39; WHEN (p.age LT 65) THEN &#39;adult&#39; ELSE &#39;senior&#39; END
</span><span id=__span-62-13><a id=__codelineno-62-13 name=__codelineno-62-13></a><a href=#__codelineno-62-13><span class=linenos data-linenos="13 "></span></a>*
</span><span id=__span-62-14><a id=__codelineno-62-14 name=__codelineno-62-14></a><a href=#__codelineno-62-14><span class=linenos data-linenos="14 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=22-coalesce-for-null-safe-default-values>22. COALESCE for null-safe default values<a class=headerlink href=#22-coalesce-for-null-safe-default-values title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: COALESCE</p> <details class=note> <summary>Notes</summary> <p>Returns first non-NULL value from the argument list.</p> <p>WHY USEFUL: Handle missing data, provide defaults.</p> <p>DATABRICKS COMPLEXITY: O(n) - evaluated per row COST: Very low. Native Databricks function. Left-to-right evaluation with short-circuit. COALESCE(a, b, c) = first non-NULL of a, b, c.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-63-1><a id=__codelineno-63-1 name=__codelineno-63-1></a><a href=#__codelineno-63-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-63-2><a id=__codelineno-63-2 name=__codelineno-63-2></a><a href=#__codelineno-63-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>COALESCE</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>nickname</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>displayName</span><span class=p>,</span>
</span><span id=__span-63-3><a id=__codelineno-63-3 name=__codelineno-63-3></a><a href=#__codelineno-63-3><span class=linenos data-linenos="3 "></span></a><span class=w>       </span><span class=n>COALESCE</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>salary</span><span class=p>,</span><span class=w> </span><span class=m>0</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>salary</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-64-1><a id=__codelineno-64-1 name=__codelineno-64-1></a><a href=#__codelineno-64-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-64-2><a id=__codelineno-64-2 name=__codelineno-64-2></a><a href=#__codelineno-64-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=k>COALESCE</span><span class=p>(</span><span class=n>_gsql2rsql_p_nickname</span><span class=p>,</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>displayName</span>
</span><span id=__span-64-3><a id=__codelineno-64-3 name=__codelineno-64-3></a><a href=#__codelineno-64-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=k>COALESCE</span><span class=p>(</span><span class=n>_gsql2rsql_p_salary</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>salary</span>
</span><span id=__span-64-4><a id=__codelineno-64-4 name=__codelineno-64-4></a><a href=#__codelineno-64-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-64-5><a id=__codelineno-64-5 name=__codelineno-64-5></a><a href=#__codelineno-64-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-64-6><a id=__codelineno-64-6 name=__codelineno-64-6></a><a href=#__codelineno-64-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-64-7><a id=__codelineno-64-7 name=__codelineno-64-7></a><a href=#__codelineno-64-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-64-8><a id=__codelineno-64-8 name=__codelineno-64-8></a><a href=#__codelineno-64-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_nickname</span>
</span><span id=__span-64-9><a id=__codelineno-64-9 name=__codelineno-64-9></a><a href=#__codelineno-64-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_salary</span>
</span><span id=__span-64-10><a id=__codelineno-64-10 name=__codelineno-64-10></a><a href=#__codelineno-64-10><span class=linenos data-linenos="10 "></span></a><span class=w>  </span><span class=k>FROM</span>
</span><span id=__span-64-11><a id=__codelineno-64-11 name=__codelineno-64-11></a><a href=#__codelineno-64-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-64-12><a id=__codelineno-64-12 name=__codelineno-64-12></a><a href=#__codelineno-64-12><span class=linenos data-linenos="12 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-65-1><a id=__codelineno-65-1 name=__codelineno-65-1></a><a href=#__codelineno-65-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-65-2><a id=__codelineno-65-2 name=__codelineno-65-2></a><a href=#__codelineno-65-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-65-3><a id=__codelineno-65-3 name=__codelineno-65-3></a><a href=#__codelineno-65-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=2;
</span><span id=__span-65-4><a id=__codelineno-65-4 name=__codelineno-65-4></a><a href=#__codelineno-65-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-65-5><a id=__codelineno-65-5 name=__codelineno-65-5></a><a href=#__codelineno-65-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-65-6><a id=__codelineno-65-6 name=__codelineno-65-6></a><a href=#__codelineno-65-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-65-7><a id=__codelineno-65-7 name=__codelineno-65-7></a><a href=#__codelineno-65-7><span class=linenos data-linenos=" 7 "></span></a>----------------------------------------------------------------------
</span><span id=__span-65-8><a id=__codelineno-65-8 name=__codelineno-65-8></a><a href=#__codelineno-65-8><span class=linenos data-linenos=" 8 "></span></a>Level 1:
</span><span id=__span-65-9><a id=__codelineno-65-9 name=__codelineno-65-9></a><a href=#__codelineno-65-9><span class=linenos data-linenos=" 9 "></span></a>----------------------------------------------------------------------
</span><span id=__span-65-10><a id=__codelineno-65-10 name=__codelineno-65-10></a><a href=#__codelineno-65-10><span class=linenos data-linenos="10 "></span></a>OpId=2 Op=ProjectionOperator; InOpIds=1; OutOpIds=;
</span><span id=__span-65-11><a id=__codelineno-65-11 name=__codelineno-65-11></a><a href=#__codelineno-65-11><span class=linenos data-linenos="11 "></span></a>  ProjectionOperator(id=2)
</span><span id=__span-65-12><a id=__codelineno-65-12 name=__codelineno-65-12></a><a href=#__codelineno-65-12><span class=linenos data-linenos="12 "></span></a>    Projections: displayName=COALESCE(p.nickname, p.name), salary=COALESCE(p.salary, 0)
</span><span id=__span-65-13><a id=__codelineno-65-13 name=__codelineno-65-13></a><a href=#__codelineno-65-13><span class=linenos data-linenos="13 "></span></a>*
</span><span id=__span-65-14><a id=__codelineno-65-14 name=__codelineno-65-14></a><a href=#__codelineno-65-14><span class=linenos data-linenos="14 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=23-distinct-for-deduplication>23. DISTINCT for deduplication<a class=headerlink href=#23-distinct-for-deduplication title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: DISTINCT</p> <details class=note> <summary>Notes</summary> <p>Removes duplicate rows from results.</p> <p>WHY USEFUL: Get unique values, eliminate duplicates from traversals.</p> <p>DATABRICKS COMPLEXITY: O(n log n) or O(n) with hash COST: Medium. Requires sorting or hashing. NULL is treated as a distinct value. Compares ALL returned columns for uniqueness.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-66-1><a id=__codelineno-66-1 name=__codelineno-66-1></a><a href=#__codelineno-66-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>ACTED_IN</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>m</span><span class=p>:</span><span class=n>Movie</span><span class=p>)</span>
</span><span id=__span-66-2><a id=__codelineno-66-2 name=__codelineno-66-2></a><a href=#__codelineno-66-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>m</span><span class=p>.</span><span class=n>genre</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-67-1><a id=__codelineno-67-1 name=__codelineno-67-1></a><a href=#__codelineno-67-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span>
</span><span id=__span-67-2><a id=__codelineno-67-2 name=__codelineno-67-2></a><a href=#__codelineno-67-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_m_genre</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>genre</span>
</span><span id=__span-67-3><a id=__codelineno-67-3 name=__codelineno-67-3></a><a href=#__codelineno-67-3><span class=linenos data-linenos=" 3 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-67-4><a id=__codelineno-67-4 name=__codelineno-67-4></a><a href=#__codelineno-67-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-67-5><a id=__codelineno-67-5 name=__codelineno-67-5></a><a href=#__codelineno-67-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-67-6><a id=__codelineno-67-6 name=__codelineno-67-6></a><a href=#__codelineno-67-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-67-7><a id=__codelineno-67-7 name=__codelineno-67-7></a><a href=#__codelineno-67-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_movie_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_movie_id</span>
</span><span id=__span-67-8><a id=__codelineno-67-8 name=__codelineno-67-8></a><a href=#__codelineno-67-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_m_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_m_id</span>
</span><span id=__span-67-9><a id=__codelineno-67-9 name=__codelineno-67-9></a><a href=#__codelineno-67-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_m_genre</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_m_genre</span>
</span><span id=__span-67-10><a id=__codelineno-67-10 name=__codelineno-67-10></a><a href=#__codelineno-67-10><span class=linenos data-linenos="10 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-67-11><a id=__codelineno-67-11 name=__codelineno-67-11></a><a href=#__codelineno-67-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-67-12><a id=__codelineno-67-12 name=__codelineno-67-12></a><a href=#__codelineno-67-12><span class=linenos data-linenos="12 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-67-13><a id=__codelineno-67-13 name=__codelineno-67-13></a><a href=#__codelineno-67-13><span class=linenos data-linenos="13 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-67-14><a id=__codelineno-67-14 name=__codelineno-67-14></a><a href=#__codelineno-67-14><span class=linenos data-linenos="14 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_movie_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_movie_id</span>
</span><span id=__span-67-15><a id=__codelineno-67-15 name=__codelineno-67-15></a><a href=#__codelineno-67-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-67-16><a id=__codelineno-67-16 name=__codelineno-67-16></a><a href=#__codelineno-67-16><span class=linenos data-linenos="16 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-67-17><a id=__codelineno-67-17 name=__codelineno-67-17></a><a href=#__codelineno-67-17><span class=linenos data-linenos="17 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-67-18><a id=__codelineno-67-18 name=__codelineno-67-18></a><a href=#__codelineno-67-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-67-19><a id=__codelineno-67-19 name=__codelineno-67-19></a><a href=#__codelineno-67-19><span class=linenos data-linenos="19 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-67-20><a id=__codelineno-67-20 name=__codelineno-67-20></a><a href=#__codelineno-67-20><span class=linenos data-linenos="20 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-67-21><a id=__codelineno-67-21 name=__codelineno-67-21></a><a href=#__codelineno-67-21><span class=linenos data-linenos="21 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-67-22><a id=__codelineno-67-22 name=__codelineno-67-22></a><a href=#__codelineno-67-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-67-23><a id=__codelineno-67-23 name=__codelineno-67-23></a><a href=#__codelineno-67-23><span class=linenos data-linenos="23 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-67-24><a id=__codelineno-67-24 name=__codelineno-67-24></a><a href=#__codelineno-67-24><span class=linenos data-linenos="24 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>movie_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_movie_id</span>
</span><span id=__span-67-25><a id=__codelineno-67-25 name=__codelineno-67-25></a><a href=#__codelineno-67-25><span class=linenos data-linenos="25 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-67-26><a id=__codelineno-67-26 name=__codelineno-67-26></a><a href=#__codelineno-67-26><span class=linenos data-linenos="26 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>ActedIn</span>
</span><span id=__span-67-27><a id=__codelineno-67-27 name=__codelineno-67-27></a><a href=#__codelineno-67-27><span class=linenos data-linenos="27 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-67-28><a id=__codelineno-67-28 name=__codelineno-67-28></a><a href=#__codelineno-67-28><span class=linenos data-linenos="28 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-67-29><a id=__codelineno-67-29 name=__codelineno-67-29></a><a href=#__codelineno-67-29><span class=linenos data-linenos="29 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-67-30><a id=__codelineno-67-30 name=__codelineno-67-30></a><a href=#__codelineno-67-30><span class=linenos data-linenos="30 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-67-31><a id=__codelineno-67-31 name=__codelineno-67-31></a><a href=#__codelineno-67-31><span class=linenos data-linenos="31 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-67-32><a id=__codelineno-67-32 name=__codelineno-67-32></a><a href=#__codelineno-67-32><span class=linenos data-linenos="32 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_m_id</span>
</span><span id=__span-67-33><a id=__codelineno-67-33 name=__codelineno-67-33></a><a href=#__codelineno-67-33><span class=linenos data-linenos="33 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>genre</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_m_genre</span>
</span><span id=__span-67-34><a id=__codelineno-67-34 name=__codelineno-67-34></a><a href=#__codelineno-67-34><span class=linenos data-linenos="34 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-67-35><a id=__codelineno-67-35 name=__codelineno-67-35></a><a href=#__codelineno-67-35><span class=linenos data-linenos="35 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Movie</span>
</span><span id=__span-67-36><a id=__codelineno-67-36 name=__codelineno-67-36></a><a href=#__codelineno-67-36><span class=linenos data-linenos="36 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-67-37><a id=__codelineno-67-37 name=__codelineno-67-37></a><a href=#__codelineno-67-37><span class=linenos data-linenos="37 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_m_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_movie_id</span>
</span><span id=__span-67-38><a id=__codelineno-67-38 name=__codelineno-67-38></a><a href=#__codelineno-67-38><span class=linenos data-linenos="38 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-68-1><a id=__codelineno-68-1 name=__codelineno-68-1></a><a href=#__codelineno-68-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-68-2><a id=__codelineno-68-2 name=__codelineno-68-2></a><a href=#__codelineno-68-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-68-3><a id=__codelineno-68-3 name=__codelineno-68-3></a><a href=#__codelineno-68-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-68-4><a id=__codelineno-68-4 name=__codelineno-68-4></a><a href=#__codelineno-68-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-68-5><a id=__codelineno-68-5 name=__codelineno-68-5></a><a href=#__codelineno-68-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-68-6><a id=__codelineno-68-6 name=__codelineno-68-6></a><a href=#__codelineno-68-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-68-7><a id=__codelineno-68-7 name=__codelineno-68-7></a><a href=#__codelineno-68-7><span class=linenos data-linenos=" 7 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-68-8><a id=__codelineno-68-8 name=__codelineno-68-8></a><a href=#__codelineno-68-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-68-9><a id=__codelineno-68-9 name=__codelineno-68-9></a><a href=#__codelineno-68-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: [_anon1:ACTED_IN]-&gt;
</span><span id=__span-68-10><a id=__codelineno-68-10 name=__codelineno-68-10></a><a href=#__codelineno-68-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-68-11><a id=__codelineno-68-11 name=__codelineno-68-11></a><a href=#__codelineno-68-11><span class=linenos data-linenos="11 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-68-12><a id=__codelineno-68-12 name=__codelineno-68-12></a><a href=#__codelineno-68-12><span class=linenos data-linenos="12 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-68-13><a id=__codelineno-68-13 name=__codelineno-68-13></a><a href=#__codelineno-68-13><span class=linenos data-linenos="13 "></span></a>    DataSource: m:Movie
</span><span id=__span-68-14><a id=__codelineno-68-14 name=__codelineno-68-14></a><a href=#__codelineno-68-14><span class=linenos data-linenos="14 "></span></a>*
</span><span id=__span-68-15><a id=__codelineno-68-15 name=__codelineno-68-15></a><a href=#__codelineno-68-15><span class=linenos data-linenos="15 "></span></a>----------------------------------------------------------------------
</span><span id=__span-68-16><a id=__codelineno-68-16 name=__codelineno-68-16></a><a href=#__codelineno-68-16><span class=linenos data-linenos="16 "></span></a>Level 1:
</span><span id=__span-68-17><a id=__codelineno-68-17 name=__codelineno-68-17></a><a href=#__codelineno-68-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-68-18><a id=__codelineno-68-18 name=__codelineno-68-18></a><a href=#__codelineno-68-18><span class=linenos data-linenos="18 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-68-19><a id=__codelineno-68-19 name=__codelineno-68-19></a><a href=#__codelineno-68-19><span class=linenos data-linenos="19 "></span></a>  JoinOperator(id=4)
</span><span id=__span-68-20><a id=__codelineno-68-20 name=__codelineno-68-20></a><a href=#__codelineno-68-20><span class=linenos data-linenos="20 "></span></a>    JoinType: INNER
</span><span id=__span-68-21><a id=__codelineno-68-21 name=__codelineno-68-21></a><a href=#__codelineno-68-21><span class=linenos data-linenos="21 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-68-22><a id=__codelineno-68-22 name=__codelineno-68-22></a><a href=#__codelineno-68-22><span class=linenos data-linenos="22 "></span></a>*
</span><span id=__span-68-23><a id=__codelineno-68-23 name=__codelineno-68-23></a><a href=#__codelineno-68-23><span class=linenos data-linenos="23 "></span></a>----------------------------------------------------------------------
</span><span id=__span-68-24><a id=__codelineno-68-24 name=__codelineno-68-24></a><a href=#__codelineno-68-24><span class=linenos data-linenos="24 "></span></a>Level 2:
</span><span id=__span-68-25><a id=__codelineno-68-25 name=__codelineno-68-25></a><a href=#__codelineno-68-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-68-26><a id=__codelineno-68-26 name=__codelineno-68-26></a><a href=#__codelineno-68-26><span class=linenos data-linenos="26 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=6;
</span><span id=__span-68-27><a id=__codelineno-68-27 name=__codelineno-68-27></a><a href=#__codelineno-68-27><span class=linenos data-linenos="27 "></span></a>  JoinOperator(id=5)
</span><span id=__span-68-28><a id=__codelineno-68-28 name=__codelineno-68-28></a><a href=#__codelineno-68-28><span class=linenos data-linenos="28 "></span></a>    JoinType: INNER
</span><span id=__span-68-29><a id=__codelineno-68-29 name=__codelineno-68-29></a><a href=#__codelineno-68-29><span class=linenos data-linenos="29 "></span></a>    Joins: JoinPair: Node=m RelOrNode=_anon1 Type=SINK
</span><span id=__span-68-30><a id=__codelineno-68-30 name=__codelineno-68-30></a><a href=#__codelineno-68-30><span class=linenos data-linenos="30 "></span></a>*
</span><span id=__span-68-31><a id=__codelineno-68-31 name=__codelineno-68-31></a><a href=#__codelineno-68-31><span class=linenos data-linenos="31 "></span></a>----------------------------------------------------------------------
</span><span id=__span-68-32><a id=__codelineno-68-32 name=__codelineno-68-32></a><a href=#__codelineno-68-32><span class=linenos data-linenos="32 "></span></a>Level 3:
</span><span id=__span-68-33><a id=__codelineno-68-33 name=__codelineno-68-33></a><a href=#__codelineno-68-33><span class=linenos data-linenos="33 "></span></a>----------------------------------------------------------------------
</span><span id=__span-68-34><a id=__codelineno-68-34 name=__codelineno-68-34></a><a href=#__codelineno-68-34><span class=linenos data-linenos="34 "></span></a>OpId=6 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-68-35><a id=__codelineno-68-35 name=__codelineno-68-35></a><a href=#__codelineno-68-35><span class=linenos data-linenos="35 "></span></a>  ProjectionOperator(id=6)
</span><span id=__span-68-36><a id=__codelineno-68-36 name=__codelineno-68-36></a><a href=#__codelineno-68-36><span class=linenos data-linenos="36 "></span></a>    Projections: genre=m.genre
</span><span id=__span-68-37><a id=__codelineno-68-37 name=__codelineno-68-37></a><a href=#__codelineno-68-37><span class=linenos data-linenos="37 "></span></a>*
</span><span id=__span-68-38><a id=__codelineno-68-38 name=__codelineno-68-38></a><a href=#__codelineno-68-38><span class=linenos data-linenos="38 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=24-union-to-combine-query-results>24. UNION to combine query results<a class=headerlink href=#24-union-to-combine-query-results title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: UNION</p> <details class=note> <summary>Notes</summary> <p>Combines results from two queries, removes duplicates.</p> <p>WHY USEFUL: Merge different query paths, find "actors OR directors".</p> <p>DATABRICKS COMPLEXITY: O(n + m + (n+m) log(n+m)) for dedup COST: High. UNION requires deduplication. Both queries must have same column count and compatible types. Use UNION ALL if duplicates are OK (faster).</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-69-1><a id=__codelineno-69-1 name=__codelineno-69-1></a><a href=#__codelineno-69-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>ACTED_IN</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>m</span><span class=p>:</span><span class=n>Movie</span><span class=p>)</span>
</span><span id=__span-69-2><a id=__codelineno-69-2 name=__codelineno-69-2></a><a href=#__codelineno-69-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-69-3><a id=__codelineno-69-3 name=__codelineno-69-3></a><a href=#__codelineno-69-3><span class=linenos data-linenos="3 "></span></a><span class=k>UNION</span>
</span><span id=__span-69-4><a id=__codelineno-69-4 name=__codelineno-69-4></a><a href=#__codelineno-69-4><span class=linenos data-linenos="4 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>d</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>DIRECTED</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>m</span><span class=p>:</span><span class=n>Movie</span><span class=p>)</span>
</span><span id=__span-69-5><a id=__codelineno-69-5 name=__codelineno-69-5></a><a href=#__codelineno-69-5><span class=linenos data-linenos="5 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-70-1><a id=__codelineno-70-1 name=__codelineno-70-1></a><a href=#__codelineno-70-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-70-2><a id=__codelineno-70-2 name=__codelineno-70-2></a><a href=#__codelineno-70-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-70-3><a id=__codelineno-70-3 name=__codelineno-70-3></a><a href=#__codelineno-70-3><span class=linenos data-linenos=" 3 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-70-4><a id=__codelineno-70-4 name=__codelineno-70-4></a><a href=#__codelineno-70-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-70-5><a id=__codelineno-70-5 name=__codelineno-70-5></a><a href=#__codelineno-70-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-70-6><a id=__codelineno-70-6 name=__codelineno-70-6></a><a href=#__codelineno-70-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-70-7><a id=__codelineno-70-7 name=__codelineno-70-7></a><a href=#__codelineno-70-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-70-8><a id=__codelineno-70-8 name=__codelineno-70-8></a><a href=#__codelineno-70-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_movie_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_movie_id</span>
</span><span id=__span-70-9><a id=__codelineno-70-9 name=__codelineno-70-9></a><a href=#__codelineno-70-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_m_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_m_id</span>
</span><span id=__span-70-10><a id=__codelineno-70-10 name=__codelineno-70-10></a><a href=#__codelineno-70-10><span class=linenos data-linenos="10 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-70-11><a id=__codelineno-70-11 name=__codelineno-70-11></a><a href=#__codelineno-70-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-70-12><a id=__codelineno-70-12 name=__codelineno-70-12></a><a href=#__codelineno-70-12><span class=linenos data-linenos="12 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-70-13><a id=__codelineno-70-13 name=__codelineno-70-13></a><a href=#__codelineno-70-13><span class=linenos data-linenos="13 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-70-14><a id=__codelineno-70-14 name=__codelineno-70-14></a><a href=#__codelineno-70-14><span class=linenos data-linenos="14 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-70-15><a id=__codelineno-70-15 name=__codelineno-70-15></a><a href=#__codelineno-70-15><span class=linenos data-linenos="15 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_movie_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_movie_id</span>
</span><span id=__span-70-16><a id=__codelineno-70-16 name=__codelineno-70-16></a><a href=#__codelineno-70-16><span class=linenos data-linenos="16 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-70-17><a id=__codelineno-70-17 name=__codelineno-70-17></a><a href=#__codelineno-70-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-70-18><a id=__codelineno-70-18 name=__codelineno-70-18></a><a href=#__codelineno-70-18><span class=linenos data-linenos="18 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-70-19><a id=__codelineno-70-19 name=__codelineno-70-19></a><a href=#__codelineno-70-19><span class=linenos data-linenos="19 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-70-20><a id=__codelineno-70-20 name=__codelineno-70-20></a><a href=#__codelineno-70-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-70-21><a id=__codelineno-70-21 name=__codelineno-70-21></a><a href=#__codelineno-70-21><span class=linenos data-linenos="21 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-70-22><a id=__codelineno-70-22 name=__codelineno-70-22></a><a href=#__codelineno-70-22><span class=linenos data-linenos="22 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-70-23><a id=__codelineno-70-23 name=__codelineno-70-23></a><a href=#__codelineno-70-23><span class=linenos data-linenos="23 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-70-24><a id=__codelineno-70-24 name=__codelineno-70-24></a><a href=#__codelineno-70-24><span class=linenos data-linenos="24 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-70-25><a id=__codelineno-70-25 name=__codelineno-70-25></a><a href=#__codelineno-70-25><span class=linenos data-linenos="25 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-70-26><a id=__codelineno-70-26 name=__codelineno-70-26></a><a href=#__codelineno-70-26><span class=linenos data-linenos="26 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>movie_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_movie_id</span>
</span><span id=__span-70-27><a id=__codelineno-70-27 name=__codelineno-70-27></a><a href=#__codelineno-70-27><span class=linenos data-linenos="27 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-70-28><a id=__codelineno-70-28 name=__codelineno-70-28></a><a href=#__codelineno-70-28><span class=linenos data-linenos="28 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>ActedIn</span>
</span><span id=__span-70-29><a id=__codelineno-70-29 name=__codelineno-70-29></a><a href=#__codelineno-70-29><span class=linenos data-linenos="29 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-70-30><a id=__codelineno-70-30 name=__codelineno-70-30></a><a href=#__codelineno-70-30><span class=linenos data-linenos="30 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-70-31><a id=__codelineno-70-31 name=__codelineno-70-31></a><a href=#__codelineno-70-31><span class=linenos data-linenos="31 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-70-32><a id=__codelineno-70-32 name=__codelineno-70-32></a><a href=#__codelineno-70-32><span class=linenos data-linenos="32 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-70-33><a id=__codelineno-70-33 name=__codelineno-70-33></a><a href=#__codelineno-70-33><span class=linenos data-linenos="33 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-70-34><a id=__codelineno-70-34 name=__codelineno-70-34></a><a href=#__codelineno-70-34><span class=linenos data-linenos="34 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_m_id</span>
</span><span id=__span-70-35><a id=__codelineno-70-35 name=__codelineno-70-35></a><a href=#__codelineno-70-35><span class=linenos data-linenos="35 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-70-36><a id=__codelineno-70-36 name=__codelineno-70-36></a><a href=#__codelineno-70-36><span class=linenos data-linenos="36 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Movie</span>
</span><span id=__span-70-37><a id=__codelineno-70-37 name=__codelineno-70-37></a><a href=#__codelineno-70-37><span class=linenos data-linenos="37 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-70-38><a id=__codelineno-70-38 name=__codelineno-70-38></a><a href=#__codelineno-70-38><span class=linenos data-linenos="38 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_m_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_movie_id</span>
</span><span id=__span-70-39><a id=__codelineno-70-39 name=__codelineno-70-39></a><a href=#__codelineno-70-39><span class=linenos data-linenos="39 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-70-40><a id=__codelineno-70-40 name=__codelineno-70-40></a><a href=#__codelineno-70-40><span class=linenos data-linenos="40 "></span></a><span class=k>UNION</span>
</span><span id=__span-70-41><a id=__codelineno-70-41 name=__codelineno-70-41></a><a href=#__codelineno-70-41><span class=linenos data-linenos="41 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-70-42><a id=__codelineno-70-42 name=__codelineno-70-42></a><a href=#__codelineno-70-42><span class=linenos data-linenos="42 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_d_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-70-43><a id=__codelineno-70-43 name=__codelineno-70-43></a><a href=#__codelineno-70-43><span class=linenos data-linenos="43 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-70-44><a id=__codelineno-70-44 name=__codelineno-70-44></a><a href=#__codelineno-70-44><span class=linenos data-linenos="44 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-70-45><a id=__codelineno-70-45 name=__codelineno-70-45></a><a href=#__codelineno-70-45><span class=linenos data-linenos="45 "></span></a><span class=w>     </span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql_d_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_d_id</span>
</span><span id=__span-70-46><a id=__codelineno-70-46 name=__codelineno-70-46></a><a href=#__codelineno-70-46><span class=linenos data-linenos="46 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql_d_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_d_name</span>
</span><span id=__span-70-47><a id=__codelineno-70-47 name=__codelineno-70-47></a><a href=#__codelineno-70-47><span class=linenos data-linenos="47 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-70-48><a id=__codelineno-70-48 name=__codelineno-70-48></a><a href=#__codelineno-70-48><span class=linenos data-linenos="48 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_movie_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_movie_id</span>
</span><span id=__span-70-49><a id=__codelineno-70-49 name=__codelineno-70-49></a><a href=#__codelineno-70-49><span class=linenos data-linenos="49 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_2</span><span class=p>.</span><span class=n>_gsql2rsql_m_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_m_id</span>
</span><span id=__span-70-50><a id=__codelineno-70-50 name=__codelineno-70-50></a><a href=#__codelineno-70-50><span class=linenos data-linenos="50 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-70-51><a id=__codelineno-70-51 name=__codelineno-70-51></a><a href=#__codelineno-70-51><span class=linenos data-linenos="51 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-70-52><a id=__codelineno-70-52 name=__codelineno-70-52></a><a href=#__codelineno-70-52><span class=linenos data-linenos="52 "></span></a><span class=w>       </span><span class=n>_left_3</span><span class=p>.</span><span class=n>_gsql2rsql_d_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_d_id</span>
</span><span id=__span-70-53><a id=__codelineno-70-53 name=__codelineno-70-53></a><a href=#__codelineno-70-53><span class=linenos data-linenos="53 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_3</span><span class=p>.</span><span class=n>_gsql2rsql_d_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_d_name</span>
</span><span id=__span-70-54><a id=__codelineno-70-54 name=__codelineno-70-54></a><a href=#__codelineno-70-54><span class=linenos data-linenos="54 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_3</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-70-55><a id=__codelineno-70-55 name=__codelineno-70-55></a><a href=#__codelineno-70-55><span class=linenos data-linenos="55 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_3</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_movie_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_movie_id</span>
</span><span id=__span-70-56><a id=__codelineno-70-56 name=__codelineno-70-56></a><a href=#__codelineno-70-56><span class=linenos data-linenos="56 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-70-57><a id=__codelineno-70-57 name=__codelineno-70-57></a><a href=#__codelineno-70-57><span class=linenos data-linenos="57 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-70-58><a id=__codelineno-70-58 name=__codelineno-70-58></a><a href=#__codelineno-70-58><span class=linenos data-linenos="58 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_d_id</span>
</span><span id=__span-70-59><a id=__codelineno-70-59 name=__codelineno-70-59></a><a href=#__codelineno-70-59><span class=linenos data-linenos="59 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_d_name</span>
</span><span id=__span-70-60><a id=__codelineno-70-60 name=__codelineno-70-60></a><a href=#__codelineno-70-60><span class=linenos data-linenos="60 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-70-61><a id=__codelineno-70-61 name=__codelineno-70-61></a><a href=#__codelineno-70-61><span class=linenos data-linenos="61 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-70-62><a id=__codelineno-70-62 name=__codelineno-70-62></a><a href=#__codelineno-70-62><span class=linenos data-linenos="62 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_3</span>
</span><span id=__span-70-63><a id=__codelineno-70-63 name=__codelineno-70-63></a><a href=#__codelineno-70-63><span class=linenos data-linenos="63 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-70-64><a id=__codelineno-70-64 name=__codelineno-70-64></a><a href=#__codelineno-70-64><span class=linenos data-linenos="64 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-70-65><a id=__codelineno-70-65 name=__codelineno-70-65></a><a href=#__codelineno-70-65><span class=linenos data-linenos="65 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-70-66><a id=__codelineno-70-66 name=__codelineno-70-66></a><a href=#__codelineno-70-66><span class=linenos data-linenos="66 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>movie_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_movie_id</span>
</span><span id=__span-70-67><a id=__codelineno-70-67 name=__codelineno-70-67></a><a href=#__codelineno-70-67><span class=linenos data-linenos="67 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-70-68><a id=__codelineno-70-68 name=__codelineno-70-68></a><a href=#__codelineno-70-68><span class=linenos data-linenos="68 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Directed</span>
</span><span id=__span-70-69><a id=__codelineno-70-69 name=__codelineno-70-69></a><a href=#__codelineno-70-69><span class=linenos data-linenos="69 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_3</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-70-70><a id=__codelineno-70-70 name=__codelineno-70-70></a><a href=#__codelineno-70-70><span class=linenos data-linenos="70 "></span></a><span class=w>      </span><span class=n>_left_3</span><span class=p>.</span><span class=n>_gsql2rsql_d_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_3</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-70-71><a id=__codelineno-70-71 name=__codelineno-70-71></a><a href=#__codelineno-70-71><span class=linenos data-linenos="71 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_2</span>
</span><span id=__span-70-72><a id=__codelineno-70-72 name=__codelineno-70-72></a><a href=#__codelineno-70-72><span class=linenos data-linenos="72 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-70-73><a id=__codelineno-70-73 name=__codelineno-70-73></a><a href=#__codelineno-70-73><span class=linenos data-linenos="73 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-70-74><a id=__codelineno-70-74 name=__codelineno-70-74></a><a href=#__codelineno-70-74><span class=linenos data-linenos="74 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_m_id</span>
</span><span id=__span-70-75><a id=__codelineno-70-75 name=__codelineno-70-75></a><a href=#__codelineno-70-75><span class=linenos data-linenos="75 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-70-76><a id=__codelineno-70-76 name=__codelineno-70-76></a><a href=#__codelineno-70-76><span class=linenos data-linenos="76 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Movie</span>
</span><span id=__span-70-77><a id=__codelineno-70-77 name=__codelineno-70-77></a><a href=#__codelineno-70-77><span class=linenos data-linenos="77 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_2</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-70-78><a id=__codelineno-70-78 name=__codelineno-70-78></a><a href=#__codelineno-70-78><span class=linenos data-linenos="78 "></span></a><span class=w>    </span><span class=n>_right_2</span><span class=p>.</span><span class=n>_gsql2rsql_m_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_movie_id</span>
</span><span id=__span-70-79><a id=__codelineno-70-79 name=__codelineno-70-79></a><a href=#__codelineno-70-79><span class=linenos data-linenos="79 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-71-1><a id=__codelineno-71-1 name=__codelineno-71-1></a><a href=#__codelineno-71-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-71-2><a id=__codelineno-71-2 name=__codelineno-71-2></a><a href=#__codelineno-71-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-71-3><a id=__codelineno-71-3 name=__codelineno-71-3></a><a href=#__codelineno-71-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-71-4><a id=__codelineno-71-4 name=__codelineno-71-4></a><a href=#__codelineno-71-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-71-5><a id=__codelineno-71-5 name=__codelineno-71-5></a><a href=#__codelineno-71-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-71-6><a id=__codelineno-71-6 name=__codelineno-71-6></a><a href=#__codelineno-71-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-71-7><a id=__codelineno-71-7 name=__codelineno-71-7></a><a href=#__codelineno-71-7><span class=linenos data-linenos=" 7 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-71-8><a id=__codelineno-71-8 name=__codelineno-71-8></a><a href=#__codelineno-71-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-71-9><a id=__codelineno-71-9 name=__codelineno-71-9></a><a href=#__codelineno-71-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: [_anon1:ACTED_IN]-&gt;
</span><span id=__span-71-10><a id=__codelineno-71-10 name=__codelineno-71-10></a><a href=#__codelineno-71-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-71-11><a id=__codelineno-71-11 name=__codelineno-71-11></a><a href=#__codelineno-71-11><span class=linenos data-linenos="11 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-71-12><a id=__codelineno-71-12 name=__codelineno-71-12></a><a href=#__codelineno-71-12><span class=linenos data-linenos="12 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-71-13><a id=__codelineno-71-13 name=__codelineno-71-13></a><a href=#__codelineno-71-13><span class=linenos data-linenos="13 "></span></a>    DataSource: m:Movie
</span><span id=__span-71-14><a id=__codelineno-71-14 name=__codelineno-71-14></a><a href=#__codelineno-71-14><span class=linenos data-linenos="14 "></span></a>*
</span><span id=__span-71-15><a id=__codelineno-71-15 name=__codelineno-71-15></a><a href=#__codelineno-71-15><span class=linenos data-linenos="15 "></span></a>OpId=7 Op=DataSourceOperator; InOpIds=; OutOpIds=10;
</span><span id=__span-71-16><a id=__codelineno-71-16 name=__codelineno-71-16></a><a href=#__codelineno-71-16><span class=linenos data-linenos="16 "></span></a>  DataSourceOperator(id=7)
</span><span id=__span-71-17><a id=__codelineno-71-17 name=__codelineno-71-17></a><a href=#__codelineno-71-17><span class=linenos data-linenos="17 "></span></a>    DataSource: d:Person
</span><span id=__span-71-18><a id=__codelineno-71-18 name=__codelineno-71-18></a><a href=#__codelineno-71-18><span class=linenos data-linenos="18 "></span></a>*
</span><span id=__span-71-19><a id=__codelineno-71-19 name=__codelineno-71-19></a><a href=#__codelineno-71-19><span class=linenos data-linenos="19 "></span></a>OpId=8 Op=DataSourceOperator; InOpIds=; OutOpIds=10;
</span><span id=__span-71-20><a id=__codelineno-71-20 name=__codelineno-71-20></a><a href=#__codelineno-71-20><span class=linenos data-linenos="20 "></span></a>  DataSourceOperator(id=8)
</span><span id=__span-71-21><a id=__codelineno-71-21 name=__codelineno-71-21></a><a href=#__codelineno-71-21><span class=linenos data-linenos="21 "></span></a>    DataSource: [_anon1:DIRECTED]-&gt;
</span><span id=__span-71-22><a id=__codelineno-71-22 name=__codelineno-71-22></a><a href=#__codelineno-71-22><span class=linenos data-linenos="22 "></span></a>*
</span><span id=__span-71-23><a id=__codelineno-71-23 name=__codelineno-71-23></a><a href=#__codelineno-71-23><span class=linenos data-linenos="23 "></span></a>OpId=9 Op=DataSourceOperator; InOpIds=; OutOpIds=11;
</span><span id=__span-71-24><a id=__codelineno-71-24 name=__codelineno-71-24></a><a href=#__codelineno-71-24><span class=linenos data-linenos="24 "></span></a>  DataSourceOperator(id=9)
</span><span id=__span-71-25><a id=__codelineno-71-25 name=__codelineno-71-25></a><a href=#__codelineno-71-25><span class=linenos data-linenos="25 "></span></a>    DataSource: m:Movie
</span><span id=__span-71-26><a id=__codelineno-71-26 name=__codelineno-71-26></a><a href=#__codelineno-71-26><span class=linenos data-linenos="26 "></span></a>*
</span><span id=__span-71-27><a id=__codelineno-71-27 name=__codelineno-71-27></a><a href=#__codelineno-71-27><span class=linenos data-linenos="27 "></span></a>----------------------------------------------------------------------
</span><span id=__span-71-28><a id=__codelineno-71-28 name=__codelineno-71-28></a><a href=#__codelineno-71-28><span class=linenos data-linenos="28 "></span></a>Level 1:
</span><span id=__span-71-29><a id=__codelineno-71-29 name=__codelineno-71-29></a><a href=#__codelineno-71-29><span class=linenos data-linenos="29 "></span></a>----------------------------------------------------------------------
</span><span id=__span-71-30><a id=__codelineno-71-30 name=__codelineno-71-30></a><a href=#__codelineno-71-30><span class=linenos data-linenos="30 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-71-31><a id=__codelineno-71-31 name=__codelineno-71-31></a><a href=#__codelineno-71-31><span class=linenos data-linenos="31 "></span></a>  JoinOperator(id=4)
</span><span id=__span-71-32><a id=__codelineno-71-32 name=__codelineno-71-32></a><a href=#__codelineno-71-32><span class=linenos data-linenos="32 "></span></a>    JoinType: INNER
</span><span id=__span-71-33><a id=__codelineno-71-33 name=__codelineno-71-33></a><a href=#__codelineno-71-33><span class=linenos data-linenos="33 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-71-34><a id=__codelineno-71-34 name=__codelineno-71-34></a><a href=#__codelineno-71-34><span class=linenos data-linenos="34 "></span></a>*
</span><span id=__span-71-35><a id=__codelineno-71-35 name=__codelineno-71-35></a><a href=#__codelineno-71-35><span class=linenos data-linenos="35 "></span></a>OpId=10 Op=JoinOperator; InOpIds=7,8; OutOpIds=11;
</span><span id=__span-71-36><a id=__codelineno-71-36 name=__codelineno-71-36></a><a href=#__codelineno-71-36><span class=linenos data-linenos="36 "></span></a>  JoinOperator(id=10)
</span><span id=__span-71-37><a id=__codelineno-71-37 name=__codelineno-71-37></a><a href=#__codelineno-71-37><span class=linenos data-linenos="37 "></span></a>    JoinType: INNER
</span><span id=__span-71-38><a id=__codelineno-71-38 name=__codelineno-71-38></a><a href=#__codelineno-71-38><span class=linenos data-linenos="38 "></span></a>    Joins: JoinPair: Node=d RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-71-39><a id=__codelineno-71-39 name=__codelineno-71-39></a><a href=#__codelineno-71-39><span class=linenos data-linenos="39 "></span></a>*
</span><span id=__span-71-40><a id=__codelineno-71-40 name=__codelineno-71-40></a><a href=#__codelineno-71-40><span class=linenos data-linenos="40 "></span></a>----------------------------------------------------------------------
</span><span id=__span-71-41><a id=__codelineno-71-41 name=__codelineno-71-41></a><a href=#__codelineno-71-41><span class=linenos data-linenos="41 "></span></a>Level 2:
</span><span id=__span-71-42><a id=__codelineno-71-42 name=__codelineno-71-42></a><a href=#__codelineno-71-42><span class=linenos data-linenos="42 "></span></a>----------------------------------------------------------------------
</span><span id=__span-71-43><a id=__codelineno-71-43 name=__codelineno-71-43></a><a href=#__codelineno-71-43><span class=linenos data-linenos="43 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=6;
</span><span id=__span-71-44><a id=__codelineno-71-44 name=__codelineno-71-44></a><a href=#__codelineno-71-44><span class=linenos data-linenos="44 "></span></a>  JoinOperator(id=5)
</span><span id=__span-71-45><a id=__codelineno-71-45 name=__codelineno-71-45></a><a href=#__codelineno-71-45><span class=linenos data-linenos="45 "></span></a>    JoinType: INNER
</span><span id=__span-71-46><a id=__codelineno-71-46 name=__codelineno-71-46></a><a href=#__codelineno-71-46><span class=linenos data-linenos="46 "></span></a>    Joins: JoinPair: Node=m RelOrNode=_anon1 Type=SINK
</span><span id=__span-71-47><a id=__codelineno-71-47 name=__codelineno-71-47></a><a href=#__codelineno-71-47><span class=linenos data-linenos="47 "></span></a>*
</span><span id=__span-71-48><a id=__codelineno-71-48 name=__codelineno-71-48></a><a href=#__codelineno-71-48><span class=linenos data-linenos="48 "></span></a>OpId=11 Op=JoinOperator; InOpIds=10,9; OutOpIds=12;
</span><span id=__span-71-49><a id=__codelineno-71-49 name=__codelineno-71-49></a><a href=#__codelineno-71-49><span class=linenos data-linenos="49 "></span></a>  JoinOperator(id=11)
</span><span id=__span-71-50><a id=__codelineno-71-50 name=__codelineno-71-50></a><a href=#__codelineno-71-50><span class=linenos data-linenos="50 "></span></a>    JoinType: INNER
</span><span id=__span-71-51><a id=__codelineno-71-51 name=__codelineno-71-51></a><a href=#__codelineno-71-51><span class=linenos data-linenos="51 "></span></a>    Joins: JoinPair: Node=m RelOrNode=_anon1 Type=SINK
</span><span id=__span-71-52><a id=__codelineno-71-52 name=__codelineno-71-52></a><a href=#__codelineno-71-52><span class=linenos data-linenos="52 "></span></a>*
</span><span id=__span-71-53><a id=__codelineno-71-53 name=__codelineno-71-53></a><a href=#__codelineno-71-53><span class=linenos data-linenos="53 "></span></a>----------------------------------------------------------------------
</span><span id=__span-71-54><a id=__codelineno-71-54 name=__codelineno-71-54></a><a href=#__codelineno-71-54><span class=linenos data-linenos="54 "></span></a>Level 3:
</span><span id=__span-71-55><a id=__codelineno-71-55 name=__codelineno-71-55></a><a href=#__codelineno-71-55><span class=linenos data-linenos="55 "></span></a>----------------------------------------------------------------------
</span><span id=__span-71-56><a id=__codelineno-71-56 name=__codelineno-71-56></a><a href=#__codelineno-71-56><span class=linenos data-linenos="56 "></span></a>OpId=6 Op=ProjectionOperator; InOpIds=5; OutOpIds=13;
</span><span id=__span-71-57><a id=__codelineno-71-57 name=__codelineno-71-57></a><a href=#__codelineno-71-57><span class=linenos data-linenos="57 "></span></a>  ProjectionOperator(id=6)
</span><span id=__span-71-58><a id=__codelineno-71-58 name=__codelineno-71-58></a><a href=#__codelineno-71-58><span class=linenos data-linenos="58 "></span></a>    Projections: name=p.name
</span><span id=__span-71-59><a id=__codelineno-71-59 name=__codelineno-71-59></a><a href=#__codelineno-71-59><span class=linenos data-linenos="59 "></span></a>*
</span><span id=__span-71-60><a id=__codelineno-71-60 name=__codelineno-71-60></a><a href=#__codelineno-71-60><span class=linenos data-linenos="60 "></span></a>OpId=12 Op=ProjectionOperator; InOpIds=11; OutOpIds=13;
</span><span id=__span-71-61><a id=__codelineno-71-61 name=__codelineno-71-61></a><a href=#__codelineno-71-61><span class=linenos data-linenos="61 "></span></a>  ProjectionOperator(id=12)
</span><span id=__span-71-62><a id=__codelineno-71-62 name=__codelineno-71-62></a><a href=#__codelineno-71-62><span class=linenos data-linenos="62 "></span></a>    Projections: name=d.name
</span><span id=__span-71-63><a id=__codelineno-71-63 name=__codelineno-71-63></a><a href=#__codelineno-71-63><span class=linenos data-linenos="63 "></span></a>*
</span><span id=__span-71-64><a id=__codelineno-71-64 name=__codelineno-71-64></a><a href=#__codelineno-71-64><span class=linenos data-linenos="64 "></span></a>----------------------------------------------------------------------
</span><span id=__span-71-65><a id=__codelineno-71-65 name=__codelineno-71-65></a><a href=#__codelineno-71-65><span class=linenos data-linenos="65 "></span></a>Level 4:
</span><span id=__span-71-66><a id=__codelineno-71-66 name=__codelineno-71-66></a><a href=#__codelineno-71-66><span class=linenos data-linenos="66 "></span></a>----------------------------------------------------------------------
</span><span id=__span-71-67><a id=__codelineno-71-67 name=__codelineno-71-67></a><a href=#__codelineno-71-67><span class=linenos data-linenos="67 "></span></a>OpId=13 Op=SetOperator; InOpIds=6,12; OutOpIds=;
</span><span id=__span-71-68><a id=__codelineno-71-68 name=__codelineno-71-68></a><a href=#__codelineno-71-68><span class=linenos data-linenos="68 "></span></a>  SetOperator(id=13)
</span><span id=__span-71-69><a id=__codelineno-71-69 name=__codelineno-71-69></a><a href=#__codelineno-71-69><span class=linenos data-linenos="69 "></span></a>    SetOp: UNION
</span><span id=__span-71-70><a id=__codelineno-71-70 name=__codelineno-71-70></a><a href=#__codelineno-71-70><span class=linenos data-linenos="70 "></span></a>*
</span><span id=__span-71-71><a id=__codelineno-71-71 name=__codelineno-71-71></a><a href=#__codelineno-71-71><span class=linenos data-linenos="71 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=25-multi-hop-path-with-intermediate-filtering>25. Multi-hop path with intermediate filtering<a class=headerlink href=#25-multi-hop-path-with-intermediate-filtering title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Chained patterns</p> <details class=note> <summary>Notes</summary> <p>Matches multiple relationship patterns from the same node.</p> <p>WHY USEFUL: Complex entity queries with multiple constraints.</p> <p>DATABRICKS COMPLEXITY: O(n * j1 * j2) worst case COST: Medium-High. Multiple JOINs. Comma-separated patterns share the same variable scope. Filter pushdown optimizes join order.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-72-1><a id=__codelineno-72-1 name=__codelineno-72-1></a><a href=#__codelineno-72-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>LIVES_IN</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>c</span><span class=p>:</span><span class=n>City</span><span class=p>),</span>
</span><span id=__span-72-2><a id=__codelineno-72-2 name=__codelineno-72-2></a><a href=#__codelineno-72-2><span class=linenos data-linenos="2 "></span></a><span class=w>      </span><span class=p>(</span><span class=n>p</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>WORKS_AT</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>co</span><span class=p>:</span><span class=n>Company</span><span class=p>)</span>
</span><span id=__span-72-3><a id=__codelineno-72-3 name=__codelineno-72-3></a><a href=#__codelineno-72-3><span class=linenos data-linenos="3 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>c</span><span class=p>.</span><span class=n>country</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&#39;USA&#39;</span><span class=w> </span><span class=n>AND</span><span class=w> </span><span class=n>co</span><span class=p>.</span><span class=n>industry</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&#39;Tech&#39;</span>
</span><span id=__span-72-4><a id=__codelineno-72-4 name=__codelineno-72-4></a><a href=#__codelineno-72-4><span class=linenos data-linenos="4 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>city</span><span class=p>,</span><span class=w> </span><span class=n>co</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>company</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-73-1><a id=__codelineno-73-1 name=__codelineno-73-1></a><a href=#__codelineno-73-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-73-2><a id=__codelineno-73-2 name=__codelineno-73-2></a><a href=#__codelineno-73-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-73-3><a id=__codelineno-73-3 name=__codelineno-73-3></a><a href=#__codelineno-73-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_c_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>city</span>
</span><span id=__span-73-4><a id=__codelineno-73-4 name=__codelineno-73-4></a><a href=#__codelineno-73-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_co_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>company</span>
</span><span id=__span-73-5><a id=__codelineno-73-5 name=__codelineno-73-5></a><a href=#__codelineno-73-5><span class=linenos data-linenos=" 5 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-73-6><a id=__codelineno-73-6 name=__codelineno-73-6></a><a href=#__codelineno-73-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-73-7><a id=__codelineno-73-7 name=__codelineno-73-7></a><a href=#__codelineno-73-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-73-8><a id=__codelineno-73-8 name=__codelineno-73-8></a><a href=#__codelineno-73-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-73-9><a id=__codelineno-73-9 name=__codelineno-73-9></a><a href=#__codelineno-73-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-73-10><a id=__codelineno-73-10 name=__codelineno-73-10></a><a href=#__codelineno-73-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_city_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-73-11><a id=__codelineno-73-11 name=__codelineno-73-11></a><a href=#__codelineno-73-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-73-12><a id=__codelineno-73-12 name=__codelineno-73-12></a><a href=#__codelineno-73-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span><span id=__span-73-13><a id=__codelineno-73-13 name=__codelineno-73-13></a><a href=#__codelineno-73-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_country</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_country</span>
</span><span id=__span-73-14><a id=__codelineno-73-14 name=__codelineno-73-14></a><a href=#__codelineno-73-14><span class=linenos data-linenos="14 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_person_id</span>
</span><span id=__span-73-15><a id=__codelineno-73-15 name=__codelineno-73-15></a><a href=#__codelineno-73-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_company_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_company_id</span>
</span><span id=__span-73-16><a id=__codelineno-73-16 name=__codelineno-73-16></a><a href=#__codelineno-73-16><span class=linenos data-linenos="16 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_co_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_co_id</span>
</span><span id=__span-73-17><a id=__codelineno-73-17 name=__codelineno-73-17></a><a href=#__codelineno-73-17><span class=linenos data-linenos="17 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_co_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_co_name</span>
</span><span id=__span-73-18><a id=__codelineno-73-18 name=__codelineno-73-18></a><a href=#__codelineno-73-18><span class=linenos data-linenos="18 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_co_industry</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_co_industry</span>
</span><span id=__span-73-19><a id=__codelineno-73-19 name=__codelineno-73-19></a><a href=#__codelineno-73-19><span class=linenos data-linenos="19 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-73-20><a id=__codelineno-73-20 name=__codelineno-73-20></a><a href=#__codelineno-73-20><span class=linenos data-linenos="20 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-73-21><a id=__codelineno-73-21 name=__codelineno-73-21></a><a href=#__codelineno-73-21><span class=linenos data-linenos="21 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-73-22><a id=__codelineno-73-22 name=__codelineno-73-22></a><a href=#__codelineno-73-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-73-23><a id=__codelineno-73-23 name=__codelineno-73-23></a><a href=#__codelineno-73-23><span class=linenos data-linenos="23 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-73-24><a id=__codelineno-73-24 name=__codelineno-73-24></a><a href=#__codelineno-73-24><span class=linenos data-linenos="24 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_city_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-73-25><a id=__codelineno-73-25 name=__codelineno-73-25></a><a href=#__codelineno-73-25><span class=linenos data-linenos="25 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-73-26><a id=__codelineno-73-26 name=__codelineno-73-26></a><a href=#__codelineno-73-26><span class=linenos data-linenos="26 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_c_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span><span id=__span-73-27><a id=__codelineno-73-27 name=__codelineno-73-27></a><a href=#__codelineno-73-27><span class=linenos data-linenos="27 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_c_country</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_country</span>
</span><span id=__span-73-28><a id=__codelineno-73-28 name=__codelineno-73-28></a><a href=#__codelineno-73-28><span class=linenos data-linenos="28 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_person_id</span>
</span><span id=__span-73-29><a id=__codelineno-73-29 name=__codelineno-73-29></a><a href=#__codelineno-73-29><span class=linenos data-linenos="29 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_company_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_company_id</span>
</span><span id=__span-73-30><a id=__codelineno-73-30 name=__codelineno-73-30></a><a href=#__codelineno-73-30><span class=linenos data-linenos="30 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-73-31><a id=__codelineno-73-31 name=__codelineno-73-31></a><a href=#__codelineno-73-31><span class=linenos data-linenos="31 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-73-32><a id=__codelineno-73-32 name=__codelineno-73-32></a><a href=#__codelineno-73-32><span class=linenos data-linenos="32 "></span></a><span class=w>         </span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-73-33><a id=__codelineno-73-33 name=__codelineno-73-33></a><a href=#__codelineno-73-33><span class=linenos data-linenos="33 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-73-34><a id=__codelineno-73-34 name=__codelineno-73-34></a><a href=#__codelineno-73-34><span class=linenos data-linenos="34 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-73-35><a id=__codelineno-73-35 name=__codelineno-73-35></a><a href=#__codelineno-73-35><span class=linenos data-linenos="35 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_city_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-73-36><a id=__codelineno-73-36 name=__codelineno-73-36></a><a href=#__codelineno-73-36><span class=linenos data-linenos="36 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_right_2</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-73-37><a id=__codelineno-73-37 name=__codelineno-73-37></a><a href=#__codelineno-73-37><span class=linenos data-linenos="37 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_right_2</span><span class=p>.</span><span class=n>_gsql2rsql_c_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span><span id=__span-73-38><a id=__codelineno-73-38 name=__codelineno-73-38></a><a href=#__codelineno-73-38><span class=linenos data-linenos="38 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_right_2</span><span class=p>.</span><span class=n>_gsql2rsql_c_country</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_country</span>
</span><span id=__span-73-39><a id=__codelineno-73-39 name=__codelineno-73-39></a><a href=#__codelineno-73-39><span class=linenos data-linenos="39 "></span></a><span class=w>      </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-73-40><a id=__codelineno-73-40 name=__codelineno-73-40></a><a href=#__codelineno-73-40><span class=linenos data-linenos="40 "></span></a><span class=w>        </span><span class=k>SELECT</span>
</span><span id=__span-73-41><a id=__codelineno-73-41 name=__codelineno-73-41></a><a href=#__codelineno-73-41><span class=linenos data-linenos="41 "></span></a><span class=w>           </span><span class=n>_left_3</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-73-42><a id=__codelineno-73-42 name=__codelineno-73-42></a><a href=#__codelineno-73-42><span class=linenos data-linenos="42 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>_left_3</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-73-43><a id=__codelineno-73-43 name=__codelineno-73-43></a><a href=#__codelineno-73-43><span class=linenos data-linenos="43 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>_right_3</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-73-44><a id=__codelineno-73-44 name=__codelineno-73-44></a><a href=#__codelineno-73-44><span class=linenos data-linenos="44 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>_right_3</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_city_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-73-45><a id=__codelineno-73-45 name=__codelineno-73-45></a><a href=#__codelineno-73-45><span class=linenos data-linenos="45 "></span></a><span class=w>        </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-73-46><a id=__codelineno-73-46 name=__codelineno-73-46></a><a href=#__codelineno-73-46><span class=linenos data-linenos="46 "></span></a><span class=w>          </span><span class=k>SELECT</span>
</span><span id=__span-73-47><a id=__codelineno-73-47 name=__codelineno-73-47></a><a href=#__codelineno-73-47><span class=linenos data-linenos="47 "></span></a><span class=w>             </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-73-48><a id=__codelineno-73-48 name=__codelineno-73-48></a><a href=#__codelineno-73-48><span class=linenos data-linenos="48 "></span></a><span class=w>            </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-73-49><a id=__codelineno-73-49 name=__codelineno-73-49></a><a href=#__codelineno-73-49><span class=linenos data-linenos="49 "></span></a><span class=w>          </span><span class=k>FROM</span>
</span><span id=__span-73-50><a id=__codelineno-73-50 name=__codelineno-73-50></a><a href=#__codelineno-73-50><span class=linenos data-linenos="50 "></span></a><span class=w>            </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-73-51><a id=__codelineno-73-51 name=__codelineno-73-51></a><a href=#__codelineno-73-51><span class=linenos data-linenos="51 "></span></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_3</span>
</span><span id=__span-73-52><a id=__codelineno-73-52 name=__codelineno-73-52></a><a href=#__codelineno-73-52><span class=linenos data-linenos="52 "></span></a><span class=w>        </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-73-53><a id=__codelineno-73-53 name=__codelineno-73-53></a><a href=#__codelineno-73-53><span class=linenos data-linenos="53 "></span></a><span class=w>          </span><span class=k>SELECT</span>
</span><span id=__span-73-54><a id=__codelineno-73-54 name=__codelineno-73-54></a><a href=#__codelineno-73-54><span class=linenos data-linenos="54 "></span></a><span class=w>             </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-73-55><a id=__codelineno-73-55 name=__codelineno-73-55></a><a href=#__codelineno-73-55><span class=linenos data-linenos="55 "></span></a><span class=w>            </span><span class=p>,</span><span class=n>city_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-73-56><a id=__codelineno-73-56 name=__codelineno-73-56></a><a href=#__codelineno-73-56><span class=linenos data-linenos="56 "></span></a><span class=w>          </span><span class=k>FROM</span>
</span><span id=__span-73-57><a id=__codelineno-73-57 name=__codelineno-73-57></a><a href=#__codelineno-73-57><span class=linenos data-linenos="57 "></span></a><span class=w>            </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>LivesIn</span>
</span><span id=__span-73-58><a id=__codelineno-73-58 name=__codelineno-73-58></a><a href=#__codelineno-73-58><span class=linenos data-linenos="58 "></span></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_3</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-73-59><a id=__codelineno-73-59 name=__codelineno-73-59></a><a href=#__codelineno-73-59><span class=linenos data-linenos="59 "></span></a><span class=w>          </span><span class=n>_left_3</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_3</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-73-60><a id=__codelineno-73-60 name=__codelineno-73-60></a><a href=#__codelineno-73-60><span class=linenos data-linenos="60 "></span></a><span class=w>      </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_2</span>
</span><span id=__span-73-61><a id=__codelineno-73-61 name=__codelineno-73-61></a><a href=#__codelineno-73-61><span class=linenos data-linenos="61 "></span></a><span class=w>      </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-73-62><a id=__codelineno-73-62 name=__codelineno-73-62></a><a href=#__codelineno-73-62><span class=linenos data-linenos="62 "></span></a><span class=w>        </span><span class=k>SELECT</span>
</span><span id=__span-73-63><a id=__codelineno-73-63 name=__codelineno-73-63></a><a href=#__codelineno-73-63><span class=linenos data-linenos="63 "></span></a><span class=w>           </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-73-64><a id=__codelineno-73-64 name=__codelineno-73-64></a><a href=#__codelineno-73-64><span class=linenos data-linenos="64 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span><span id=__span-73-65><a id=__codelineno-73-65 name=__codelineno-73-65></a><a href=#__codelineno-73-65><span class=linenos data-linenos="65 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>country</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_country</span>
</span><span id=__span-73-66><a id=__codelineno-73-66 name=__codelineno-73-66></a><a href=#__codelineno-73-66><span class=linenos data-linenos="66 "></span></a><span class=w>        </span><span class=k>FROM</span>
</span><span id=__span-73-67><a id=__codelineno-73-67 name=__codelineno-73-67></a><a href=#__codelineno-73-67><span class=linenos data-linenos="67 "></span></a><span class=w>          </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>City</span>
</span><span id=__span-73-68><a id=__codelineno-73-68 name=__codelineno-73-68></a><a href=#__codelineno-73-68><span class=linenos data-linenos="68 "></span></a><span class=w>        </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>country</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;USA&#39;</span><span class=p>))</span>
</span><span id=__span-73-69><a id=__codelineno-73-69 name=__codelineno-73-69></a><a href=#__codelineno-73-69><span class=linenos data-linenos="69 "></span></a><span class=w>      </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_2</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-73-70><a id=__codelineno-73-70 name=__codelineno-73-70></a><a href=#__codelineno-73-70><span class=linenos data-linenos="70 "></span></a><span class=w>        </span><span class=n>_right_2</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-73-71><a id=__codelineno-73-71 name=__codelineno-73-71></a><a href=#__codelineno-73-71><span class=linenos data-linenos="71 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-73-72><a id=__codelineno-73-72 name=__codelineno-73-72></a><a href=#__codelineno-73-72><span class=linenos data-linenos="72 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-73-73><a id=__codelineno-73-73 name=__codelineno-73-73></a><a href=#__codelineno-73-73><span class=linenos data-linenos="73 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-73-74><a id=__codelineno-73-74 name=__codelineno-73-74></a><a href=#__codelineno-73-74><span class=linenos data-linenos="74 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_person_id</span>
</span><span id=__span-73-75><a id=__codelineno-73-75 name=__codelineno-73-75></a><a href=#__codelineno-73-75><span class=linenos data-linenos="75 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>company_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_company_id</span>
</span><span id=__span-73-76><a id=__codelineno-73-76 name=__codelineno-73-76></a><a href=#__codelineno-73-76><span class=linenos data-linenos="76 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-73-77><a id=__codelineno-73-77 name=__codelineno-73-77></a><a href=#__codelineno-73-77><span class=linenos data-linenos="77 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>WorksAt</span>
</span><span id=__span-73-78><a id=__codelineno-73-78 name=__codelineno-73-78></a><a href=#__codelineno-73-78><span class=linenos data-linenos="78 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-73-79><a id=__codelineno-73-79 name=__codelineno-73-79></a><a href=#__codelineno-73-79><span class=linenos data-linenos="79 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_person_id</span>
</span><span id=__span-73-80><a id=__codelineno-73-80 name=__codelineno-73-80></a><a href=#__codelineno-73-80><span class=linenos data-linenos="80 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-73-81><a id=__codelineno-73-81 name=__codelineno-73-81></a><a href=#__codelineno-73-81><span class=linenos data-linenos="81 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-73-82><a id=__codelineno-73-82 name=__codelineno-73-82></a><a href=#__codelineno-73-82><span class=linenos data-linenos="82 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-73-83><a id=__codelineno-73-83 name=__codelineno-73-83></a><a href=#__codelineno-73-83><span class=linenos data-linenos="83 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_co_id</span>
</span><span id=__span-73-84><a id=__codelineno-73-84 name=__codelineno-73-84></a><a href=#__codelineno-73-84><span class=linenos data-linenos="84 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_co_name</span>
</span><span id=__span-73-85><a id=__codelineno-73-85 name=__codelineno-73-85></a><a href=#__codelineno-73-85><span class=linenos data-linenos="85 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>industry</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_co_industry</span>
</span><span id=__span-73-86><a id=__codelineno-73-86 name=__codelineno-73-86></a><a href=#__codelineno-73-86><span class=linenos data-linenos="86 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-73-87><a id=__codelineno-73-87 name=__codelineno-73-87></a><a href=#__codelineno-73-87><span class=linenos data-linenos="87 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Company</span>
</span><span id=__span-73-88><a id=__codelineno-73-88 name=__codelineno-73-88></a><a href=#__codelineno-73-88><span class=linenos data-linenos="88 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>industry</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Tech&#39;</span><span class=p>))</span>
</span><span id=__span-73-89><a id=__codelineno-73-89 name=__codelineno-73-89></a><a href=#__codelineno-73-89><span class=linenos data-linenos="89 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-73-90><a id=__codelineno-73-90 name=__codelineno-73-90></a><a href=#__codelineno-73-90><span class=linenos data-linenos="90 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_co_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_company_id</span>
</span><span id=__span-73-91><a id=__codelineno-73-91 name=__codelineno-73-91></a><a href=#__codelineno-73-91><span class=linenos data-linenos="91 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-74-1><a id=__codelineno-74-1 name=__codelineno-74-1></a><a href=#__codelineno-74-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-74-2><a id=__codelineno-74-2 name=__codelineno-74-2></a><a href=#__codelineno-74-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-74-3><a id=__codelineno-74-3 name=__codelineno-74-3></a><a href=#__codelineno-74-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=6;
</span><span id=__span-74-4><a id=__codelineno-74-4 name=__codelineno-74-4></a><a href=#__codelineno-74-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-74-5><a id=__codelineno-74-5 name=__codelineno-74-5></a><a href=#__codelineno-74-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-74-6><a id=__codelineno-74-6 name=__codelineno-74-6></a><a href=#__codelineno-74-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-74-7><a id=__codelineno-74-7 name=__codelineno-74-7></a><a href=#__codelineno-74-7><span class=linenos data-linenos=" 7 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=6;
</span><span id=__span-74-8><a id=__codelineno-74-8 name=__codelineno-74-8></a><a href=#__codelineno-74-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-74-9><a id=__codelineno-74-9 name=__codelineno-74-9></a><a href=#__codelineno-74-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: [_anon1:LIVES_IN]-&gt;
</span><span id=__span-74-10><a id=__codelineno-74-10 name=__codelineno-74-10></a><a href=#__codelineno-74-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-74-11><a id=__codelineno-74-11 name=__codelineno-74-11></a><a href=#__codelineno-74-11><span class=linenos data-linenos="11 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=7;
</span><span id=__span-74-12><a id=__codelineno-74-12 name=__codelineno-74-12></a><a href=#__codelineno-74-12><span class=linenos data-linenos="12 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-74-13><a id=__codelineno-74-13 name=__codelineno-74-13></a><a href=#__codelineno-74-13><span class=linenos data-linenos="13 "></span></a>    DataSource: c:City
</span><span id=__span-74-14><a id=__codelineno-74-14 name=__codelineno-74-14></a><a href=#__codelineno-74-14><span class=linenos data-linenos="14 "></span></a>    Filter: (c.country EQ &#39;USA&#39;)
</span><span id=__span-74-15><a id=__codelineno-74-15 name=__codelineno-74-15></a><a href=#__codelineno-74-15><span class=linenos data-linenos="15 "></span></a>*
</span><span id=__span-74-16><a id=__codelineno-74-16 name=__codelineno-74-16></a><a href=#__codelineno-74-16><span class=linenos data-linenos="16 "></span></a>OpId=4 Op=DataSourceOperator; InOpIds=; OutOpIds=8;
</span><span id=__span-74-17><a id=__codelineno-74-17 name=__codelineno-74-17></a><a href=#__codelineno-74-17><span class=linenos data-linenos="17 "></span></a>  DataSourceOperator(id=4)
</span><span id=__span-74-18><a id=__codelineno-74-18 name=__codelineno-74-18></a><a href=#__codelineno-74-18><span class=linenos data-linenos="18 "></span></a>    DataSource: [_anon2:WORKS_AT]-&gt;
</span><span id=__span-74-19><a id=__codelineno-74-19 name=__codelineno-74-19></a><a href=#__codelineno-74-19><span class=linenos data-linenos="19 "></span></a>*
</span><span id=__span-74-20><a id=__codelineno-74-20 name=__codelineno-74-20></a><a href=#__codelineno-74-20><span class=linenos data-linenos="20 "></span></a>OpId=5 Op=DataSourceOperator; InOpIds=; OutOpIds=9;
</span><span id=__span-74-21><a id=__codelineno-74-21 name=__codelineno-74-21></a><a href=#__codelineno-74-21><span class=linenos data-linenos="21 "></span></a>  DataSourceOperator(id=5)
</span><span id=__span-74-22><a id=__codelineno-74-22 name=__codelineno-74-22></a><a href=#__codelineno-74-22><span class=linenos data-linenos="22 "></span></a>    DataSource: co:Company
</span><span id=__span-74-23><a id=__codelineno-74-23 name=__codelineno-74-23></a><a href=#__codelineno-74-23><span class=linenos data-linenos="23 "></span></a>    Filter: (co.industry EQ &#39;Tech&#39;)
</span><span id=__span-74-24><a id=__codelineno-74-24 name=__codelineno-74-24></a><a href=#__codelineno-74-24><span class=linenos data-linenos="24 "></span></a>*
</span><span id=__span-74-25><a id=__codelineno-74-25 name=__codelineno-74-25></a><a href=#__codelineno-74-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-74-26><a id=__codelineno-74-26 name=__codelineno-74-26></a><a href=#__codelineno-74-26><span class=linenos data-linenos="26 "></span></a>Level 1:
</span><span id=__span-74-27><a id=__codelineno-74-27 name=__codelineno-74-27></a><a href=#__codelineno-74-27><span class=linenos data-linenos="27 "></span></a>----------------------------------------------------------------------
</span><span id=__span-74-28><a id=__codelineno-74-28 name=__codelineno-74-28></a><a href=#__codelineno-74-28><span class=linenos data-linenos="28 "></span></a>OpId=6 Op=JoinOperator; InOpIds=1,2; OutOpIds=7;
</span><span id=__span-74-29><a id=__codelineno-74-29 name=__codelineno-74-29></a><a href=#__codelineno-74-29><span class=linenos data-linenos="29 "></span></a>  JoinOperator(id=6)
</span><span id=__span-74-30><a id=__codelineno-74-30 name=__codelineno-74-30></a><a href=#__codelineno-74-30><span class=linenos data-linenos="30 "></span></a>    JoinType: INNER
</span><span id=__span-74-31><a id=__codelineno-74-31 name=__codelineno-74-31></a><a href=#__codelineno-74-31><span class=linenos data-linenos="31 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-74-32><a id=__codelineno-74-32 name=__codelineno-74-32></a><a href=#__codelineno-74-32><span class=linenos data-linenos="32 "></span></a>*
</span><span id=__span-74-33><a id=__codelineno-74-33 name=__codelineno-74-33></a><a href=#__codelineno-74-33><span class=linenos data-linenos="33 "></span></a>----------------------------------------------------------------------
</span><span id=__span-74-34><a id=__codelineno-74-34 name=__codelineno-74-34></a><a href=#__codelineno-74-34><span class=linenos data-linenos="34 "></span></a>Level 2:
</span><span id=__span-74-35><a id=__codelineno-74-35 name=__codelineno-74-35></a><a href=#__codelineno-74-35><span class=linenos data-linenos="35 "></span></a>----------------------------------------------------------------------
</span><span id=__span-74-36><a id=__codelineno-74-36 name=__codelineno-74-36></a><a href=#__codelineno-74-36><span class=linenos data-linenos="36 "></span></a>OpId=7 Op=JoinOperator; InOpIds=6,3; OutOpIds=8;
</span><span id=__span-74-37><a id=__codelineno-74-37 name=__codelineno-74-37></a><a href=#__codelineno-74-37><span class=linenos data-linenos="37 "></span></a>  JoinOperator(id=7)
</span><span id=__span-74-38><a id=__codelineno-74-38 name=__codelineno-74-38></a><a href=#__codelineno-74-38><span class=linenos data-linenos="38 "></span></a>    JoinType: INNER
</span><span id=__span-74-39><a id=__codelineno-74-39 name=__codelineno-74-39></a><a href=#__codelineno-74-39><span class=linenos data-linenos="39 "></span></a>    Joins: JoinPair: Node=c RelOrNode=_anon1 Type=SINK
</span><span id=__span-74-40><a id=__codelineno-74-40 name=__codelineno-74-40></a><a href=#__codelineno-74-40><span class=linenos data-linenos="40 "></span></a>*
</span><span id=__span-74-41><a id=__codelineno-74-41 name=__codelineno-74-41></a><a href=#__codelineno-74-41><span class=linenos data-linenos="41 "></span></a>----------------------------------------------------------------------
</span><span id=__span-74-42><a id=__codelineno-74-42 name=__codelineno-74-42></a><a href=#__codelineno-74-42><span class=linenos data-linenos="42 "></span></a>Level 3:
</span><span id=__span-74-43><a id=__codelineno-74-43 name=__codelineno-74-43></a><a href=#__codelineno-74-43><span class=linenos data-linenos="43 "></span></a>----------------------------------------------------------------------
</span><span id=__span-74-44><a id=__codelineno-74-44 name=__codelineno-74-44></a><a href=#__codelineno-74-44><span class=linenos data-linenos="44 "></span></a>OpId=8 Op=JoinOperator; InOpIds=7,4; OutOpIds=9;
</span><span id=__span-74-45><a id=__codelineno-74-45 name=__codelineno-74-45></a><a href=#__codelineno-74-45><span class=linenos data-linenos="45 "></span></a>  JoinOperator(id=8)
</span><span id=__span-74-46><a id=__codelineno-74-46 name=__codelineno-74-46></a><a href=#__codelineno-74-46><span class=linenos data-linenos="46 "></span></a>    JoinType: INNER
</span><span id=__span-74-47><a id=__codelineno-74-47 name=__codelineno-74-47></a><a href=#__codelineno-74-47><span class=linenos data-linenos="47 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon2 Type=SOURCE
</span><span id=__span-74-48><a id=__codelineno-74-48 name=__codelineno-74-48></a><a href=#__codelineno-74-48><span class=linenos data-linenos="48 "></span></a>*
</span><span id=__span-74-49><a id=__codelineno-74-49 name=__codelineno-74-49></a><a href=#__codelineno-74-49><span class=linenos data-linenos="49 "></span></a>----------------------------------------------------------------------
</span><span id=__span-74-50><a id=__codelineno-74-50 name=__codelineno-74-50></a><a href=#__codelineno-74-50><span class=linenos data-linenos="50 "></span></a>Level 4:
</span><span id=__span-74-51><a id=__codelineno-74-51 name=__codelineno-74-51></a><a href=#__codelineno-74-51><span class=linenos data-linenos="51 "></span></a>----------------------------------------------------------------------
</span><span id=__span-74-52><a id=__codelineno-74-52 name=__codelineno-74-52></a><a href=#__codelineno-74-52><span class=linenos data-linenos="52 "></span></a>OpId=9 Op=JoinOperator; InOpIds=8,5; OutOpIds=11;
</span><span id=__span-74-53><a id=__codelineno-74-53 name=__codelineno-74-53></a><a href=#__codelineno-74-53><span class=linenos data-linenos="53 "></span></a>  JoinOperator(id=9)
</span><span id=__span-74-54><a id=__codelineno-74-54 name=__codelineno-74-54></a><a href=#__codelineno-74-54><span class=linenos data-linenos="54 "></span></a>    JoinType: INNER
</span><span id=__span-74-55><a id=__codelineno-74-55 name=__codelineno-74-55></a><a href=#__codelineno-74-55><span class=linenos data-linenos="55 "></span></a>    Joins: JoinPair: Node=co RelOrNode=_anon2 Type=SINK
</span><span id=__span-74-56><a id=__codelineno-74-56 name=__codelineno-74-56></a><a href=#__codelineno-74-56><span class=linenos data-linenos="56 "></span></a>*
</span><span id=__span-74-57><a id=__codelineno-74-57 name=__codelineno-74-57></a><a href=#__codelineno-74-57><span class=linenos data-linenos="57 "></span></a>----------------------------------------------------------------------
</span><span id=__span-74-58><a id=__codelineno-74-58 name=__codelineno-74-58></a><a href=#__codelineno-74-58><span class=linenos data-linenos="58 "></span></a>Level 5:
</span><span id=__span-74-59><a id=__codelineno-74-59 name=__codelineno-74-59></a><a href=#__codelineno-74-59><span class=linenos data-linenos="59 "></span></a>----------------------------------------------------------------------
</span><span id=__span-74-60><a id=__codelineno-74-60 name=__codelineno-74-60></a><a href=#__codelineno-74-60><span class=linenos data-linenos="60 "></span></a>OpId=11 Op=ProjectionOperator; InOpIds=9; OutOpIds=;
</span><span id=__span-74-61><a id=__codelineno-74-61 name=__codelineno-74-61></a><a href=#__codelineno-74-61><span class=linenos data-linenos="61 "></span></a>  ProjectionOperator(id=11)
</span><span id=__span-74-62><a id=__codelineno-74-62 name=__codelineno-74-62></a><a href=#__codelineno-74-62><span class=linenos data-linenos="62 "></span></a>    Projections: name=p.name, city=c.name, company=co.name
</span><span id=__span-74-63><a id=__codelineno-74-63 name=__codelineno-74-63></a><a href=#__codelineno-74-63><span class=linenos data-linenos="63 "></span></a>*
</span><span id=__span-74-64><a id=__codelineno-74-64 name=__codelineno-74-64></a><a href=#__codelineno-74-64><span class=linenos data-linenos="64 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=26-chained-with-for-multi-stage-computation>26. Chained WITH for multi-stage computation<a class=headerlink href=#26-chained-with-for-multi-stage-computation title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: WITH chaining</p> <details class=note> <summary>Notes</summary> <p>Chains multiple WITH clauses for staged computation.</p> <p>WHY USEFUL: Break complex queries into steps, compute derived values.</p> <p>DATABRICKS COMPLEXITY: O(n) per stage COST: Medium. Each WITH creates a logical stage. Variables from previous WITH are available in next stage. Useful for aggregation  filtering  transformation pipelines.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-75-1><a id=__codelineno-75-1 name=__codelineno-75-1></a><a href=#__codelineno-75-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>LIVES_IN</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>c</span><span class=p>:</span><span class=n>City</span><span class=p>)</span>
</span><span id=__span-75-2><a id=__codelineno-75-2 name=__codelineno-75-2></a><a href=#__codelineno-75-2><span class=linenos data-linenos="2 "></span></a><span class=k>WITH</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>COUNT</span><span class=p>(</span><span class=n>p</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>pop</span>
</span><span id=__span-75-3><a id=__codelineno-75-3 name=__codelineno-75-3></a><a href=#__codelineno-75-3><span class=linenos data-linenos="3 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>pop</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>100</span>
</span><span id=__span-75-4><a id=__codelineno-75-4 name=__codelineno-75-4></a><a href=#__codelineno-75-4><span class=linenos data-linenos="4 "></span></a><span class=k>WITH</span><span class=w> </span><span class=n>c</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>city</span><span class=p>,</span><span class=w> </span><span class=n>pop</span><span class=p>,</span><span class=w> </span><span class=n>pop</span><span class=w> </span><span class=p>*</span><span class=w> </span><span class=m>1</span><span class=p>.</span><span class=m>0</span><span class=w> </span><span class=err>/</span><span class=w> </span><span class=m>1000</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>popK</span>
</span><span id=__span-75-5><a id=__codelineno-75-5 name=__codelineno-75-5></a><a href=#__codelineno-75-5><span class=linenos data-linenos="5 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>city</span><span class=p>,</span><span class=w> </span><span class=n>popK</span>
</span><span id=__span-75-6><a id=__codelineno-75-6 name=__codelineno-75-6></a><a href=#__codelineno-75-6><span class=linenos data-linenos="6 "></span></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>popK</span><span class=w> </span><span class=k>DESC</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-76-1><a id=__codelineno-76-1 name=__codelineno-76-1></a><a href=#__codelineno-76-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-76-2><a id=__codelineno-76-2 name=__codelineno-76-2></a><a href=#__codelineno-76-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>city</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>city</span>
</span><span id=__span-76-3><a id=__codelineno-76-3 name=__codelineno-76-3></a><a href=#__codelineno-76-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>popK</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>popK</span>
</span><span id=__span-76-4><a id=__codelineno-76-4 name=__codelineno-76-4></a><a href=#__codelineno-76-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-76-5><a id=__codelineno-76-5 name=__codelineno-76-5></a><a href=#__codelineno-76-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-76-6><a id=__codelineno-76-6 name=__codelineno-76-6></a><a href=#__codelineno-76-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>_gsql2rsql_c_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>city</span>
</span><span id=__span-76-7><a id=__codelineno-76-7 name=__codelineno-76-7></a><a href=#__codelineno-76-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>pop</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>pop</span>
</span><span id=__span-76-8><a id=__codelineno-76-8 name=__codelineno-76-8></a><a href=#__codelineno-76-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,((</span><span class=n>pop</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=p>.</span><span class=mi>0</span><span class=p>))</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=p>(</span><span class=mi>1000</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>popK</span>
</span><span id=__span-76-9><a id=__codelineno-76-9 name=__codelineno-76-9></a><a href=#__codelineno-76-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-76-10><a id=__codelineno-76-10 name=__codelineno-76-10></a><a href=#__codelineno-76-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-76-11><a id=__codelineno-76-11 name=__codelineno-76-11></a><a href=#__codelineno-76-11><span class=linenos data-linenos="11 "></span></a><span class=w>       </span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-76-12><a id=__codelineno-76-12 name=__codelineno-76-12></a><a href=#__codelineno-76-12><span class=linenos data-linenos="12 "></span></a><span class=w>      </span><span class=p>,</span><span class=k>COUNT</span><span class=p>(</span><span class=n>_gsql2rsql_p_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>pop</span>
</span><span id=__span-76-13><a id=__codelineno-76-13 name=__codelineno-76-13></a><a href=#__codelineno-76-13><span class=linenos data-linenos="13 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_gsql2rsql_c_country</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_country</span>
</span><span id=__span-76-14><a id=__codelineno-76-14 name=__codelineno-76-14></a><a href=#__codelineno-76-14><span class=linenos data-linenos="14 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_gsql2rsql_c_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span><span id=__span-76-15><a id=__codelineno-76-15 name=__codelineno-76-15></a><a href=#__codelineno-76-15><span class=linenos data-linenos="15 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_gsql2rsql_c_population</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_population</span>
</span><span id=__span-76-16><a id=__codelineno-76-16 name=__codelineno-76-16></a><a href=#__codelineno-76-16><span class=linenos data-linenos="16 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-76-17><a id=__codelineno-76-17 name=__codelineno-76-17></a><a href=#__codelineno-76-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-76-18><a id=__codelineno-76-18 name=__codelineno-76-18></a><a href=#__codelineno-76-18><span class=linenos data-linenos="18 "></span></a><span class=w>         </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-76-19><a id=__codelineno-76-19 name=__codelineno-76-19></a><a href=#__codelineno-76-19><span class=linenos data-linenos="19 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-76-20><a id=__codelineno-76-20 name=__codelineno-76-20></a><a href=#__codelineno-76-20><span class=linenos data-linenos="20 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_city_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-76-21><a id=__codelineno-76-21 name=__codelineno-76-21></a><a href=#__codelineno-76-21><span class=linenos data-linenos="21 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-76-22><a id=__codelineno-76-22 name=__codelineno-76-22></a><a href=#__codelineno-76-22><span class=linenos data-linenos="22 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span><span id=__span-76-23><a id=__codelineno-76-23 name=__codelineno-76-23></a><a href=#__codelineno-76-23><span class=linenos data-linenos="23 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_population</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_population</span>
</span><span id=__span-76-24><a id=__codelineno-76-24 name=__codelineno-76-24></a><a href=#__codelineno-76-24><span class=linenos data-linenos="24 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_country</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_country</span>
</span><span id=__span-76-25><a id=__codelineno-76-25 name=__codelineno-76-25></a><a href=#__codelineno-76-25><span class=linenos data-linenos="25 "></span></a><span class=w>      </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-76-26><a id=__codelineno-76-26 name=__codelineno-76-26></a><a href=#__codelineno-76-26><span class=linenos data-linenos="26 "></span></a><span class=w>        </span><span class=k>SELECT</span>
</span><span id=__span-76-27><a id=__codelineno-76-27 name=__codelineno-76-27></a><a href=#__codelineno-76-27><span class=linenos data-linenos="27 "></span></a><span class=w>           </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-76-28><a id=__codelineno-76-28 name=__codelineno-76-28></a><a href=#__codelineno-76-28><span class=linenos data-linenos="28 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-76-29><a id=__codelineno-76-29 name=__codelineno-76-29></a><a href=#__codelineno-76-29><span class=linenos data-linenos="29 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_city_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-76-30><a id=__codelineno-76-30 name=__codelineno-76-30></a><a href=#__codelineno-76-30><span class=linenos data-linenos="30 "></span></a><span class=w>        </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-76-31><a id=__codelineno-76-31 name=__codelineno-76-31></a><a href=#__codelineno-76-31><span class=linenos data-linenos="31 "></span></a><span class=w>          </span><span class=k>SELECT</span>
</span><span id=__span-76-32><a id=__codelineno-76-32 name=__codelineno-76-32></a><a href=#__codelineno-76-32><span class=linenos data-linenos="32 "></span></a><span class=w>             </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-76-33><a id=__codelineno-76-33 name=__codelineno-76-33></a><a href=#__codelineno-76-33><span class=linenos data-linenos="33 "></span></a><span class=w>          </span><span class=k>FROM</span>
</span><span id=__span-76-34><a id=__codelineno-76-34 name=__codelineno-76-34></a><a href=#__codelineno-76-34><span class=linenos data-linenos="34 "></span></a><span class=w>            </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-76-35><a id=__codelineno-76-35 name=__codelineno-76-35></a><a href=#__codelineno-76-35><span class=linenos data-linenos="35 "></span></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-76-36><a id=__codelineno-76-36 name=__codelineno-76-36></a><a href=#__codelineno-76-36><span class=linenos data-linenos="36 "></span></a><span class=w>        </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-76-37><a id=__codelineno-76-37 name=__codelineno-76-37></a><a href=#__codelineno-76-37><span class=linenos data-linenos="37 "></span></a><span class=w>          </span><span class=k>SELECT</span>
</span><span id=__span-76-38><a id=__codelineno-76-38 name=__codelineno-76-38></a><a href=#__codelineno-76-38><span class=linenos data-linenos="38 "></span></a><span class=w>             </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-76-39><a id=__codelineno-76-39 name=__codelineno-76-39></a><a href=#__codelineno-76-39><span class=linenos data-linenos="39 "></span></a><span class=w>            </span><span class=p>,</span><span class=n>city_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-76-40><a id=__codelineno-76-40 name=__codelineno-76-40></a><a href=#__codelineno-76-40><span class=linenos data-linenos="40 "></span></a><span class=w>          </span><span class=k>FROM</span>
</span><span id=__span-76-41><a id=__codelineno-76-41 name=__codelineno-76-41></a><a href=#__codelineno-76-41><span class=linenos data-linenos="41 "></span></a><span class=w>            </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>LivesIn</span>
</span><span id=__span-76-42><a id=__codelineno-76-42 name=__codelineno-76-42></a><a href=#__codelineno-76-42><span class=linenos data-linenos="42 "></span></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-76-43><a id=__codelineno-76-43 name=__codelineno-76-43></a><a href=#__codelineno-76-43><span class=linenos data-linenos="43 "></span></a><span class=w>          </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-76-44><a id=__codelineno-76-44 name=__codelineno-76-44></a><a href=#__codelineno-76-44><span class=linenos data-linenos="44 "></span></a><span class=w>      </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-76-45><a id=__codelineno-76-45 name=__codelineno-76-45></a><a href=#__codelineno-76-45><span class=linenos data-linenos="45 "></span></a><span class=w>      </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-76-46><a id=__codelineno-76-46 name=__codelineno-76-46></a><a href=#__codelineno-76-46><span class=linenos data-linenos="46 "></span></a><span class=w>        </span><span class=k>SELECT</span>
</span><span id=__span-76-47><a id=__codelineno-76-47 name=__codelineno-76-47></a><a href=#__codelineno-76-47><span class=linenos data-linenos="47 "></span></a><span class=w>           </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-76-48><a id=__codelineno-76-48 name=__codelineno-76-48></a><a href=#__codelineno-76-48><span class=linenos data-linenos="48 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span><span id=__span-76-49><a id=__codelineno-76-49 name=__codelineno-76-49></a><a href=#__codelineno-76-49><span class=linenos data-linenos="49 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>population</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_population</span>
</span><span id=__span-76-50><a id=__codelineno-76-50 name=__codelineno-76-50></a><a href=#__codelineno-76-50><span class=linenos data-linenos="50 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>country</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_country</span>
</span><span id=__span-76-51><a id=__codelineno-76-51 name=__codelineno-76-51></a><a href=#__codelineno-76-51><span class=linenos data-linenos="51 "></span></a><span class=w>        </span><span class=k>FROM</span>
</span><span id=__span-76-52><a id=__codelineno-76-52 name=__codelineno-76-52></a><a href=#__codelineno-76-52><span class=linenos data-linenos="52 "></span></a><span class=w>          </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>City</span>
</span><span id=__span-76-53><a id=__codelineno-76-53 name=__codelineno-76-53></a><a href=#__codelineno-76-53><span class=linenos data-linenos="53 "></span></a><span class=w>      </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-76-54><a id=__codelineno-76-54 name=__codelineno-76-54></a><a href=#__codelineno-76-54><span class=linenos data-linenos="54 "></span></a><span class=w>        </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_city_id</span>
</span><span id=__span-76-55><a id=__codelineno-76-55 name=__codelineno-76-55></a><a href=#__codelineno-76-55><span class=linenos data-linenos="55 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-76-56><a id=__codelineno-76-56 name=__codelineno-76-56></a><a href=#__codelineno-76-56><span class=linenos data-linenos="56 "></span></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span><span class=p>,</span><span class=w> </span><span class=n>_gsql2rsql_c_country</span><span class=p>,</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span><span class=p>,</span><span class=w> </span><span class=n>_gsql2rsql_c_population</span>
</span><span id=__span-76-57><a id=__codelineno-76-57 name=__codelineno-76-57></a><a href=#__codelineno-76-57><span class=linenos data-linenos="57 "></span></a><span class=w>    </span><span class=k>HAVING</span><span class=w> </span><span class=p>(</span><span class=n>pop</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>100</span><span class=p>)</span>
</span><span id=__span-76-58><a id=__codelineno-76-58 name=__codelineno-76-58></a><a href=#__codelineno-76-58><span class=linenos data-linenos="58 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-76-59><a id=__codelineno-76-59 name=__codelineno-76-59></a><a href=#__codelineno-76-59><span class=linenos data-linenos="59 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-76-60><a id=__codelineno-76-60 name=__codelineno-76-60></a><a href=#__codelineno-76-60><span class=linenos data-linenos="60 "></span></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>popK</span><span class=w> </span><span class=k>DESC</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-77-1><a id=__codelineno-77-1 name=__codelineno-77-1></a><a href=#__codelineno-77-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-77-2><a id=__codelineno-77-2 name=__codelineno-77-2></a><a href=#__codelineno-77-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-77-3><a id=__codelineno-77-3 name=__codelineno-77-3></a><a href=#__codelineno-77-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-77-4><a id=__codelineno-77-4 name=__codelineno-77-4></a><a href=#__codelineno-77-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-77-5><a id=__codelineno-77-5 name=__codelineno-77-5></a><a href=#__codelineno-77-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-77-6><a id=__codelineno-77-6 name=__codelineno-77-6></a><a href=#__codelineno-77-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-77-7><a id=__codelineno-77-7 name=__codelineno-77-7></a><a href=#__codelineno-77-7><span class=linenos data-linenos=" 7 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-77-8><a id=__codelineno-77-8 name=__codelineno-77-8></a><a href=#__codelineno-77-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-77-9><a id=__codelineno-77-9 name=__codelineno-77-9></a><a href=#__codelineno-77-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: [_anon1:LIVES_IN]-&gt;
</span><span id=__span-77-10><a id=__codelineno-77-10 name=__codelineno-77-10></a><a href=#__codelineno-77-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-77-11><a id=__codelineno-77-11 name=__codelineno-77-11></a><a href=#__codelineno-77-11><span class=linenos data-linenos="11 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-77-12><a id=__codelineno-77-12 name=__codelineno-77-12></a><a href=#__codelineno-77-12><span class=linenos data-linenos="12 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-77-13><a id=__codelineno-77-13 name=__codelineno-77-13></a><a href=#__codelineno-77-13><span class=linenos data-linenos="13 "></span></a>    DataSource: c:City
</span><span id=__span-77-14><a id=__codelineno-77-14 name=__codelineno-77-14></a><a href=#__codelineno-77-14><span class=linenos data-linenos="14 "></span></a>*
</span><span id=__span-77-15><a id=__codelineno-77-15 name=__codelineno-77-15></a><a href=#__codelineno-77-15><span class=linenos data-linenos="15 "></span></a>----------------------------------------------------------------------
</span><span id=__span-77-16><a id=__codelineno-77-16 name=__codelineno-77-16></a><a href=#__codelineno-77-16><span class=linenos data-linenos="16 "></span></a>Level 1:
</span><span id=__span-77-17><a id=__codelineno-77-17 name=__codelineno-77-17></a><a href=#__codelineno-77-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-77-18><a id=__codelineno-77-18 name=__codelineno-77-18></a><a href=#__codelineno-77-18><span class=linenos data-linenos="18 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-77-19><a id=__codelineno-77-19 name=__codelineno-77-19></a><a href=#__codelineno-77-19><span class=linenos data-linenos="19 "></span></a>  JoinOperator(id=4)
</span><span id=__span-77-20><a id=__codelineno-77-20 name=__codelineno-77-20></a><a href=#__codelineno-77-20><span class=linenos data-linenos="20 "></span></a>    JoinType: INNER
</span><span id=__span-77-21><a id=__codelineno-77-21 name=__codelineno-77-21></a><a href=#__codelineno-77-21><span class=linenos data-linenos="21 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-77-22><a id=__codelineno-77-22 name=__codelineno-77-22></a><a href=#__codelineno-77-22><span class=linenos data-linenos="22 "></span></a>*
</span><span id=__span-77-23><a id=__codelineno-77-23 name=__codelineno-77-23></a><a href=#__codelineno-77-23><span class=linenos data-linenos="23 "></span></a>----------------------------------------------------------------------
</span><span id=__span-77-24><a id=__codelineno-77-24 name=__codelineno-77-24></a><a href=#__codelineno-77-24><span class=linenos data-linenos="24 "></span></a>Level 2:
</span><span id=__span-77-25><a id=__codelineno-77-25 name=__codelineno-77-25></a><a href=#__codelineno-77-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-77-26><a id=__codelineno-77-26 name=__codelineno-77-26></a><a href=#__codelineno-77-26><span class=linenos data-linenos="26 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=6;
</span><span id=__span-77-27><a id=__codelineno-77-27 name=__codelineno-77-27></a><a href=#__codelineno-77-27><span class=linenos data-linenos="27 "></span></a>  JoinOperator(id=5)
</span><span id=__span-77-28><a id=__codelineno-77-28 name=__codelineno-77-28></a><a href=#__codelineno-77-28><span class=linenos data-linenos="28 "></span></a>    JoinType: INNER
</span><span id=__span-77-29><a id=__codelineno-77-29 name=__codelineno-77-29></a><a href=#__codelineno-77-29><span class=linenos data-linenos="29 "></span></a>    Joins: JoinPair: Node=c RelOrNode=_anon1 Type=SINK
</span><span id=__span-77-30><a id=__codelineno-77-30 name=__codelineno-77-30></a><a href=#__codelineno-77-30><span class=linenos data-linenos="30 "></span></a>*
</span><span id=__span-77-31><a id=__codelineno-77-31 name=__codelineno-77-31></a><a href=#__codelineno-77-31><span class=linenos data-linenos="31 "></span></a>----------------------------------------------------------------------
</span><span id=__span-77-32><a id=__codelineno-77-32 name=__codelineno-77-32></a><a href=#__codelineno-77-32><span class=linenos data-linenos="32 "></span></a>Level 3:
</span><span id=__span-77-33><a id=__codelineno-77-33 name=__codelineno-77-33></a><a href=#__codelineno-77-33><span class=linenos data-linenos="33 "></span></a>----------------------------------------------------------------------
</span><span id=__span-77-34><a id=__codelineno-77-34 name=__codelineno-77-34></a><a href=#__codelineno-77-34><span class=linenos data-linenos="34 "></span></a>OpId=6 Op=ProjectionOperator; InOpIds=5; OutOpIds=7;
</span><span id=__span-77-35><a id=__codelineno-77-35 name=__codelineno-77-35></a><a href=#__codelineno-77-35><span class=linenos data-linenos="35 "></span></a>  ProjectionOperator(id=6)
</span><span id=__span-77-36><a id=__codelineno-77-36 name=__codelineno-77-36></a><a href=#__codelineno-77-36><span class=linenos data-linenos="36 "></span></a>    Projections: c=c, pop=COUNT(p)
</span><span id=__span-77-37><a id=__codelineno-77-37 name=__codelineno-77-37></a><a href=#__codelineno-77-37><span class=linenos data-linenos="37 "></span></a>    Having: (pop GT 100)
</span><span id=__span-77-38><a id=__codelineno-77-38 name=__codelineno-77-38></a><a href=#__codelineno-77-38><span class=linenos data-linenos="38 "></span></a>*
</span><span id=__span-77-39><a id=__codelineno-77-39 name=__codelineno-77-39></a><a href=#__codelineno-77-39><span class=linenos data-linenos="39 "></span></a>----------------------------------------------------------------------
</span><span id=__span-77-40><a id=__codelineno-77-40 name=__codelineno-77-40></a><a href=#__codelineno-77-40><span class=linenos data-linenos="40 "></span></a>Level 4:
</span><span id=__span-77-41><a id=__codelineno-77-41 name=__codelineno-77-41></a><a href=#__codelineno-77-41><span class=linenos data-linenos="41 "></span></a>----------------------------------------------------------------------
</span><span id=__span-77-42><a id=__codelineno-77-42 name=__codelineno-77-42></a><a href=#__codelineno-77-42><span class=linenos data-linenos="42 "></span></a>OpId=7 Op=ProjectionOperator; InOpIds=6; OutOpIds=8;
</span><span id=__span-77-43><a id=__codelineno-77-43 name=__codelineno-77-43></a><a href=#__codelineno-77-43><span class=linenos data-linenos="43 "></span></a>  ProjectionOperator(id=7)
</span><span id=__span-77-44><a id=__codelineno-77-44 name=__codelineno-77-44></a><a href=#__codelineno-77-44><span class=linenos data-linenos="44 "></span></a>    Projections: city=c.name, pop=pop, popK=((pop MULTIPLY 1.0) DIVIDE 1000)
</span><span id=__span-77-45><a id=__codelineno-77-45 name=__codelineno-77-45></a><a href=#__codelineno-77-45><span class=linenos data-linenos="45 "></span></a>*
</span><span id=__span-77-46><a id=__codelineno-77-46 name=__codelineno-77-46></a><a href=#__codelineno-77-46><span class=linenos data-linenos="46 "></span></a>----------------------------------------------------------------------
</span><span id=__span-77-47><a id=__codelineno-77-47 name=__codelineno-77-47></a><a href=#__codelineno-77-47><span class=linenos data-linenos="47 "></span></a>Level 5:
</span><span id=__span-77-48><a id=__codelineno-77-48 name=__codelineno-77-48></a><a href=#__codelineno-77-48><span class=linenos data-linenos="48 "></span></a>----------------------------------------------------------------------
</span><span id=__span-77-49><a id=__codelineno-77-49 name=__codelineno-77-49></a><a href=#__codelineno-77-49><span class=linenos data-linenos="49 "></span></a>OpId=8 Op=ProjectionOperator; InOpIds=7; OutOpIds=;
</span><span id=__span-77-50><a id=__codelineno-77-50 name=__codelineno-77-50></a><a href=#__codelineno-77-50><span class=linenos data-linenos="50 "></span></a>  ProjectionOperator(id=8)
</span><span id=__span-77-51><a id=__codelineno-77-51 name=__codelineno-77-51></a><a href=#__codelineno-77-51><span class=linenos data-linenos="51 "></span></a>    Projections: city=city, popK=popK
</span><span id=__span-77-52><a id=__codelineno-77-52 name=__codelineno-77-52></a><a href=#__codelineno-77-52><span class=linenos data-linenos="52 "></span></a>*
</span><span id=__span-77-53><a id=__codelineno-77-53 name=__codelineno-77-53></a><a href=#__codelineno-77-53><span class=linenos data-linenos="53 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=27-simplest-sink-filter-pushdown>27. Simplest sink filter pushdown<a class=headerlink href=#27-simplest-sink-filter-pushdown title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Sink Filter Pushdown</p> <details class=note> <summary>Notes</summary> <p>Minimal example: filter on sink node b is pushed into recursive join.</p> <p>SQL: WHERE p.depth &gt;= 1 AND p.depth &lt;= 2 AND (sink.age) &gt; (30)</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-78-1><a id=__codelineno-78-1 name=__codelineno-78-1></a><a href=#__codelineno-78-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=p>*</span><span class=m>1</span><span class=p>..</span><span class=m>2</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>b</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-78-2><a id=__codelineno-78-2 name=__codelineno-78-2></a><a href=#__codelineno-78-2><span class=linenos data-linenos="2 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>30</span>
</span><span id=__span-78-3><a id=__codelineno-78-3 name=__codelineno-78-3></a><a href=#__codelineno-78-3><span class=linenos data-linenos="3 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>name</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-79-1><a id=__codelineno-79-1 name=__codelineno-79-1></a><a href=#__codelineno-79-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span>
</span><span id=__span-79-2><a id=__codelineno-79-2 name=__codelineno-79-2></a><a href=#__codelineno-79-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>  </span><span class=n>paths_1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-79-3><a id=__codelineno-79-3 name=__codelineno-79-3></a><a href=#__codelineno-79-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>    </span><span class=c1>-- Base case: direct edges (depth = 1)</span>
</span><span id=__span-79-4><a id=__codelineno-79-4 name=__codelineno-79-4></a><a href=#__codelineno-79-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-79-5><a id=__codelineno-79-5 name=__codelineno-79-5></a><a href=#__codelineno-79-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-79-6><a id=__codelineno-79-6 name=__codelineno-79-6></a><a href=#__codelineno-79-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-79-7><a id=__codelineno-79-7 name=__codelineno-79-7></a><a href=#__codelineno-79-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>      </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-79-8><a id=__codelineno-79-8 name=__codelineno-79-8></a><a href=#__codelineno-79-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-79-9><a id=__codelineno-79-9 name=__codelineno-79-9></a><a href=#__codelineno-79-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-79-10><a id=__codelineno-79-10 name=__codelineno-79-10></a><a href=#__codelineno-79-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-79-11><a id=__codelineno-79-11 name=__codelineno-79-11></a><a href=#__codelineno-79-11><span class=linenos data-linenos="11 "></span></a>
</span><span id=__span-79-12><a id=__codelineno-79-12 name=__codelineno-79-12></a><a href=#__codelineno-79-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-79-13><a id=__codelineno-79-13 name=__codelineno-79-13></a><a href=#__codelineno-79-13><span class=linenos data-linenos="13 "></span></a>
</span><span id=__span-79-14><a id=__codelineno-79-14 name=__codelineno-79-14></a><a href=#__codelineno-79-14><span class=linenos data-linenos="14 "></span></a><span class=w>    </span><span class=c1>-- Recursive case: extend paths</span>
</span><span id=__span-79-15><a id=__codelineno-79-15 name=__codelineno-79-15></a><a href=#__codelineno-79-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-79-16><a id=__codelineno-79-16 name=__codelineno-79-16></a><a href=#__codelineno-79-16><span class=linenos data-linenos="16 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-79-17><a id=__codelineno-79-17 name=__codelineno-79-17></a><a href=#__codelineno-79-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-79-18><a id=__codelineno-79-18 name=__codelineno-79-18></a><a href=#__codelineno-79-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-79-19><a id=__codelineno-79-19 name=__codelineno-79-19></a><a href=#__codelineno-79-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-79-20><a id=__codelineno-79-20 name=__codelineno-79-20></a><a href=#__codelineno-79-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-79-21><a id=__codelineno-79-21 name=__codelineno-79-21></a><a href=#__codelineno-79-21><span class=linenos data-linenos="21 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-79-22><a id=__codelineno-79-22 name=__codelineno-79-22></a><a href=#__codelineno-79-22><span class=linenos data-linenos="22 "></span></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-79-23><a id=__codelineno-79-23 name=__codelineno-79-23></a><a href=#__codelineno-79-23><span class=linenos data-linenos="23 "></span></a><span class=w>      </span><span class=k>ON</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span>
</span><span id=__span-79-24><a id=__codelineno-79-24 name=__codelineno-79-24></a><a href=#__codelineno-79-24><span class=linenos data-linenos="24 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>2</span>
</span><span id=__span-79-25><a id=__codelineno-79-25 name=__codelineno-79-25></a><a href=#__codelineno-79-25><span class=linenos data-linenos="25 "></span></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=n>ARRAY_CONTAINS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span>
</span><span id=__span-79-26><a id=__codelineno-79-26 name=__codelineno-79-26></a><a href=#__codelineno-79-26><span class=linenos data-linenos="26 "></span></a><span class=w>  </span><span class=p>)</span>
</span><span id=__span-79-27><a id=__codelineno-79-27 name=__codelineno-79-27></a><a href=#__codelineno-79-27><span class=linenos data-linenos="27 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-79-28><a id=__codelineno-79-28 name=__codelineno-79-28></a><a href=#__codelineno-79-28><span class=linenos data-linenos="28 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_a_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-79-29><a id=__codelineno-79-29 name=__codelineno-79-29></a><a href=#__codelineno-79-29><span class=linenos data-linenos="29 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_b_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-79-30><a id=__codelineno-79-30 name=__codelineno-79-30></a><a href=#__codelineno-79-30><span class=linenos data-linenos="30 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-79-31><a id=__codelineno-79-31 name=__codelineno-79-31></a><a href=#__codelineno-79-31><span class=linenos data-linenos="31 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-79-32><a id=__codelineno-79-32 name=__codelineno-79-32></a><a href=#__codelineno-79-32><span class=linenos data-linenos="32 "></span></a><span class=w>     </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_id</span>
</span><span id=__span-79-33><a id=__codelineno-79-33 name=__codelineno-79-33></a><a href=#__codelineno-79-33><span class=linenos data-linenos="33 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_name</span>
</span><span id=__span-79-34><a id=__codelineno-79-34 name=__codelineno-79-34></a><a href=#__codelineno-79-34><span class=linenos data-linenos="34 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_age</span>
</span><span id=__span-79-35><a id=__codelineno-79-35 name=__codelineno-79-35></a><a href=#__codelineno-79-35><span class=linenos data-linenos="35 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_nickname</span>
</span><span id=__span-79-36><a id=__codelineno-79-36 name=__codelineno-79-36></a><a href=#__codelineno-79-36><span class=linenos data-linenos="36 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_salary</span>
</span><span id=__span-79-37><a id=__codelineno-79-37 name=__codelineno-79-37></a><a href=#__codelineno-79-37><span class=linenos data-linenos="37 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_active</span>
</span><span id=__span-79-38><a id=__codelineno-79-38 name=__codelineno-79-38></a><a href=#__codelineno-79-38><span class=linenos data-linenos="38 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-79-39><a id=__codelineno-79-39 name=__codelineno-79-39></a><a href=#__codelineno-79-39><span class=linenos data-linenos="39 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-79-40><a id=__codelineno-79-40 name=__codelineno-79-40></a><a href=#__codelineno-79-40><span class=linenos data-linenos="40 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_age</span>
</span><span id=__span-79-41><a id=__codelineno-79-41 name=__codelineno-79-41></a><a href=#__codelineno-79-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_nickname</span>
</span><span id=__span-79-42><a id=__codelineno-79-42 name=__codelineno-79-42></a><a href=#__codelineno-79-42><span class=linenos data-linenos="42 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_salary</span>
</span><span id=__span-79-43><a id=__codelineno-79-43 name=__codelineno-79-43></a><a href=#__codelineno-79-43><span class=linenos data-linenos="43 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_active</span>
</span><span id=__span-79-44><a id=__codelineno-79-44 name=__codelineno-79-44></a><a href=#__codelineno-79-44><span class=linenos data-linenos="44 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-79-45><a id=__codelineno-79-45 name=__codelineno-79-45></a><a href=#__codelineno-79-45><span class=linenos data-linenos="45 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-79-46><a id=__codelineno-79-46 name=__codelineno-79-46></a><a href=#__codelineno-79-46><span class=linenos data-linenos="46 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>depth</span>
</span><span id=__span-79-47><a id=__codelineno-79-47 name=__codelineno-79-47></a><a href=#__codelineno-79-47><span class=linenos data-linenos="47 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>path</span>
</span><span id=__span-79-48><a id=__codelineno-79-48 name=__codelineno-79-48></a><a href=#__codelineno-79-48><span class=linenos data-linenos="48 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-79-49><a id=__codelineno-79-49 name=__codelineno-79-49></a><a href=#__codelineno-79-49><span class=linenos data-linenos="49 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=n>sink</span>
</span><span id=__span-79-50><a id=__codelineno-79-50 name=__codelineno-79-50></a><a href=#__codelineno-79-50><span class=linenos data-linenos="50 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-79-51><a id=__codelineno-79-51 name=__codelineno-79-51></a><a href=#__codelineno-79-51><span class=linenos data-linenos="51 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=k>source</span>
</span><span id=__span-79-52><a id=__codelineno-79-52 name=__codelineno-79-52></a><a href=#__codelineno-79-52><span class=linenos data-linenos="52 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-79-53><a id=__codelineno-79-53 name=__codelineno-79-53></a><a href=#__codelineno-79-53><span class=linenos data-linenos="53 "></span></a><span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=n>sink</span><span class=p>.</span><span class=n>age</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>30</span><span class=p>)</span>
</span><span id=__span-79-54><a id=__codelineno-79-54 name=__codelineno-79-54></a><a href=#__codelineno-79-54><span class=linenos data-linenos="54 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-80-1><a id=__codelineno-80-1 name=__codelineno-80-1></a><a href=#__codelineno-80-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-80-2><a id=__codelineno-80-2 name=__codelineno-80-2></a><a href=#__codelineno-80-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-80-3><a id=__codelineno-80-3 name=__codelineno-80-3></a><a href=#__codelineno-80-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=2;
</span><span id=__span-80-4><a id=__codelineno-80-4 name=__codelineno-80-4></a><a href=#__codelineno-80-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-80-5><a id=__codelineno-80-5 name=__codelineno-80-5></a><a href=#__codelineno-80-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: a:Person
</span><span id=__span-80-6><a id=__codelineno-80-6 name=__codelineno-80-6></a><a href=#__codelineno-80-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-80-7><a id=__codelineno-80-7 name=__codelineno-80-7></a><a href=#__codelineno-80-7><span class=linenos data-linenos=" 7 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-80-8><a id=__codelineno-80-8 name=__codelineno-80-8></a><a href=#__codelineno-80-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-80-9><a id=__codelineno-80-9 name=__codelineno-80-9></a><a href=#__codelineno-80-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: b:Person
</span><span id=__span-80-10><a id=__codelineno-80-10 name=__codelineno-80-10></a><a href=#__codelineno-80-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-80-11><a id=__codelineno-80-11 name=__codelineno-80-11></a><a href=#__codelineno-80-11><span class=linenos data-linenos="11 "></span></a>----------------------------------------------------------------------
</span><span id=__span-80-12><a id=__codelineno-80-12 name=__codelineno-80-12></a><a href=#__codelineno-80-12><span class=linenos data-linenos="12 "></span></a>Level 1:
</span><span id=__span-80-13><a id=__codelineno-80-13 name=__codelineno-80-13></a><a href=#__codelineno-80-13><span class=linenos data-linenos="13 "></span></a>----------------------------------------------------------------------
</span><span id=__span-80-14><a id=__codelineno-80-14 name=__codelineno-80-14></a><a href=#__codelineno-80-14><span class=linenos data-linenos="14 "></span></a>OpId=2 Op=RecursiveTraversalOperator; InOpIds=1; OutOpIds=4;
</span><span id=__span-80-15><a id=__codelineno-80-15 name=__codelineno-80-15></a><a href=#__codelineno-80-15><span class=linenos data-linenos="15 "></span></a>  RecursiveTraversal(KNOWS*1..2)
</span><span id=__span-80-16><a id=__codelineno-80-16 name=__codelineno-80-16></a><a href=#__codelineno-80-16><span class=linenos data-linenos="16 "></span></a>*
</span><span id=__span-80-17><a id=__codelineno-80-17 name=__codelineno-80-17></a><a href=#__codelineno-80-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-80-18><a id=__codelineno-80-18 name=__codelineno-80-18></a><a href=#__codelineno-80-18><span class=linenos data-linenos="18 "></span></a>Level 2:
</span><span id=__span-80-19><a id=__codelineno-80-19 name=__codelineno-80-19></a><a href=#__codelineno-80-19><span class=linenos data-linenos="19 "></span></a>----------------------------------------------------------------------
</span><span id=__span-80-20><a id=__codelineno-80-20 name=__codelineno-80-20></a><a href=#__codelineno-80-20><span class=linenos data-linenos="20 "></span></a>OpId=4 Op=JoinOperator; InOpIds=2,3; OutOpIds=5;
</span><span id=__span-80-21><a id=__codelineno-80-21 name=__codelineno-80-21></a><a href=#__codelineno-80-21><span class=linenos data-linenos="21 "></span></a>  JoinOperator(id=4)
</span><span id=__span-80-22><a id=__codelineno-80-22 name=__codelineno-80-22></a><a href=#__codelineno-80-22><span class=linenos data-linenos="22 "></span></a>    JoinType: INNER
</span><span id=__span-80-23><a id=__codelineno-80-23 name=__codelineno-80-23></a><a href=#__codelineno-80-23><span class=linenos data-linenos="23 "></span></a>    Joins: JoinPair: Node=b RelOrNode=paths__anon1 Type=SINK
</span><span id=__span-80-24><a id=__codelineno-80-24 name=__codelineno-80-24></a><a href=#__codelineno-80-24><span class=linenos data-linenos="24 "></span></a>*
</span><span id=__span-80-25><a id=__codelineno-80-25 name=__codelineno-80-25></a><a href=#__codelineno-80-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-80-26><a id=__codelineno-80-26 name=__codelineno-80-26></a><a href=#__codelineno-80-26><span class=linenos data-linenos="26 "></span></a>Level 3:
</span><span id=__span-80-27><a id=__codelineno-80-27 name=__codelineno-80-27></a><a href=#__codelineno-80-27><span class=linenos data-linenos="27 "></span></a>----------------------------------------------------------------------
</span><span id=__span-80-28><a id=__codelineno-80-28 name=__codelineno-80-28></a><a href=#__codelineno-80-28><span class=linenos data-linenos="28 "></span></a>OpId=5 Op=ProjectionOperator; InOpIds=4; OutOpIds=;
</span><span id=__span-80-29><a id=__codelineno-80-29 name=__codelineno-80-29></a><a href=#__codelineno-80-29><span class=linenos data-linenos="29 "></span></a>  ProjectionOperator(id=5)
</span><span id=__span-80-30><a id=__codelineno-80-30 name=__codelineno-80-30></a><a href=#__codelineno-80-30><span class=linenos data-linenos="30 "></span></a>    Projections: name=a.name, name=b.name
</span><span id=__span-80-31><a id=__codelineno-80-31 name=__codelineno-80-31></a><a href=#__codelineno-80-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-80-32><a id=__codelineno-80-32 name=__codelineno-80-32></a><a href=#__codelineno-80-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=28-variable-length-path-with-sink-filter-pushdown>28. Variable-length path with sink filter pushdown<a class=headerlink href=#28-variable-length-path-with-sink-filter-pushdown title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Recursive Sink Filter Pushdown</p> <details class=note> <summary>Notes</summary> <p>Filter on sink node (b.age &gt; 50) is pushed into the recursive join.</p> <p>OPTIMIZATION APPLIED: BEFORE: CTE  JOIN sink  JOIN source  depth filter  OUTER sink filter AFTER: CTE  JOIN sink  JOIN source  WHERE depth AND sink.age &gt; 50</p> <p>WHY IT MATTERS: Instead of filtering 1000 paths after all joins complete, we filter during the join and only keep paths ending at older people.</p> <p>SQL Pattern (optimized): FROM paths_1 p JOIN Person sink ON sink.id = p.end_node JOIN Person source ON source.id = p.start_node WHERE p.depth &gt;= 2 AND p.depth &lt;= 4 AND (sink.age) &gt; (50)</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-81-1><a id=__codelineno-81-1 name=__codelineno-81-1></a><a href=#__codelineno-81-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=n>path</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=p>*</span><span class=m>2</span><span class=p>..</span><span class=m>4</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>b</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-81-2><a id=__codelineno-81-2 name=__codelineno-81-2></a><a href=#__codelineno-81-2><span class=linenos data-linenos="2 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>50</span>
</span><span id=__span-81-3><a id=__codelineno-81-3 name=__codelineno-81-3></a><a href=#__codelineno-81-3><span class=linenos data-linenos="3 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>LENGTH</span><span class=p>(</span><span class=n>path</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>chain_length</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-82-1><a id=__codelineno-82-1 name=__codelineno-82-1></a><a href=#__codelineno-82-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span>
</span><span id=__span-82-2><a id=__codelineno-82-2 name=__codelineno-82-2></a><a href=#__codelineno-82-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>  </span><span class=n>paths_1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-82-3><a id=__codelineno-82-3 name=__codelineno-82-3></a><a href=#__codelineno-82-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>    </span><span class=c1>-- Base case: direct edges (depth = 1)</span>
</span><span id=__span-82-4><a id=__codelineno-82-4 name=__codelineno-82-4></a><a href=#__codelineno-82-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-82-5><a id=__codelineno-82-5 name=__codelineno-82-5></a><a href=#__codelineno-82-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-82-6><a id=__codelineno-82-6 name=__codelineno-82-6></a><a href=#__codelineno-82-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-82-7><a id=__codelineno-82-7 name=__codelineno-82-7></a><a href=#__codelineno-82-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>      </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-82-8><a id=__codelineno-82-8 name=__codelineno-82-8></a><a href=#__codelineno-82-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-82-9><a id=__codelineno-82-9 name=__codelineno-82-9></a><a href=#__codelineno-82-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>NAMED_STRUCT</span><span class=p>(</span><span class=s1>&#39;person_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;friend_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;since&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>since</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;strength&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>strength</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path_edges</span><span class=p>,</span>
</span><span id=__span-82-10><a id=__codelineno-82-10 name=__codelineno-82-10></a><a href=#__codelineno-82-10><span class=linenos data-linenos="10 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-82-11><a id=__codelineno-82-11 name=__codelineno-82-11></a><a href=#__codelineno-82-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-82-12><a id=__codelineno-82-12 name=__codelineno-82-12></a><a href=#__codelineno-82-12><span class=linenos data-linenos="12 "></span></a>
</span><span id=__span-82-13><a id=__codelineno-82-13 name=__codelineno-82-13></a><a href=#__codelineno-82-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-82-14><a id=__codelineno-82-14 name=__codelineno-82-14></a><a href=#__codelineno-82-14><span class=linenos data-linenos="14 "></span></a>
</span><span id=__span-82-15><a id=__codelineno-82-15 name=__codelineno-82-15></a><a href=#__codelineno-82-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=c1>-- Recursive case: extend paths</span>
</span><span id=__span-82-16><a id=__codelineno-82-16 name=__codelineno-82-16></a><a href=#__codelineno-82-16><span class=linenos data-linenos="16 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-82-17><a id=__codelineno-82-17 name=__codelineno-82-17></a><a href=#__codelineno-82-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-82-18><a id=__codelineno-82-18 name=__codelineno-82-18></a><a href=#__codelineno-82-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-82-19><a id=__codelineno-82-19 name=__codelineno-82-19></a><a href=#__codelineno-82-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-82-20><a id=__codelineno-82-20 name=__codelineno-82-20></a><a href=#__codelineno-82-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-82-21><a id=__codelineno-82-21 name=__codelineno-82-21></a><a href=#__codelineno-82-21><span class=linenos data-linenos="21 "></span></a><span class=w>      </span><span class=n>ARRAY_APPEND</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path_edges</span><span class=p>,</span><span class=w> </span><span class=n>NAMED_STRUCT</span><span class=p>(</span><span class=s1>&#39;person_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;friend_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;since&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>since</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;strength&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>strength</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path_edges</span><span class=p>,</span>
</span><span id=__span-82-22><a id=__codelineno-82-22 name=__codelineno-82-22></a><a href=#__codelineno-82-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-82-23><a id=__codelineno-82-23 name=__codelineno-82-23></a><a href=#__codelineno-82-23><span class=linenos data-linenos="23 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-82-24><a id=__codelineno-82-24 name=__codelineno-82-24></a><a href=#__codelineno-82-24><span class=linenos data-linenos="24 "></span></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-82-25><a id=__codelineno-82-25 name=__codelineno-82-25></a><a href=#__codelineno-82-25><span class=linenos data-linenos="25 "></span></a><span class=w>      </span><span class=k>ON</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span>
</span><span id=__span-82-26><a id=__codelineno-82-26 name=__codelineno-82-26></a><a href=#__codelineno-82-26><span class=linenos data-linenos="26 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>4</span>
</span><span id=__span-82-27><a id=__codelineno-82-27 name=__codelineno-82-27></a><a href=#__codelineno-82-27><span class=linenos data-linenos="27 "></span></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=n>ARRAY_CONTAINS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span>
</span><span id=__span-82-28><a id=__codelineno-82-28 name=__codelineno-82-28></a><a href=#__codelineno-82-28><span class=linenos data-linenos="28 "></span></a><span class=w>  </span><span class=p>)</span>
</span><span id=__span-82-29><a id=__codelineno-82-29 name=__codelineno-82-29></a><a href=#__codelineno-82-29><span class=linenos data-linenos="29 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-82-30><a id=__codelineno-82-30 name=__codelineno-82-30></a><a href=#__codelineno-82-30><span class=linenos data-linenos="30 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_a_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>id</span>
</span><span id=__span-82-31><a id=__codelineno-82-31 name=__codelineno-82-31></a><a href=#__codelineno-82-31><span class=linenos data-linenos="31 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_b_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>id</span>
</span><span id=__span-82-32><a id=__codelineno-82-32 name=__codelineno-82-32></a><a href=#__codelineno-82-32><span class=linenos data-linenos="32 "></span></a><span class=w>  </span><span class=p>,(</span><span class=k>SIZE</span><span class=p>(</span><span class=n>_gsql2rsql_path_id</span><span class=p>)</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>chain_length</span>
</span><span id=__span-82-33><a id=__codelineno-82-33 name=__codelineno-82-33></a><a href=#__codelineno-82-33><span class=linenos data-linenos="33 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-82-34><a id=__codelineno-82-34 name=__codelineno-82-34></a><a href=#__codelineno-82-34><span class=linenos data-linenos="34 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-82-35><a id=__codelineno-82-35 name=__codelineno-82-35></a><a href=#__codelineno-82-35><span class=linenos data-linenos="35 "></span></a><span class=w>     </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_id</span>
</span><span id=__span-82-36><a id=__codelineno-82-36 name=__codelineno-82-36></a><a href=#__codelineno-82-36><span class=linenos data-linenos="36 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_name</span>
</span><span id=__span-82-37><a id=__codelineno-82-37 name=__codelineno-82-37></a><a href=#__codelineno-82-37><span class=linenos data-linenos="37 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_age</span>
</span><span id=__span-82-38><a id=__codelineno-82-38 name=__codelineno-82-38></a><a href=#__codelineno-82-38><span class=linenos data-linenos="38 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_nickname</span>
</span><span id=__span-82-39><a id=__codelineno-82-39 name=__codelineno-82-39></a><a href=#__codelineno-82-39><span class=linenos data-linenos="39 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_salary</span>
</span><span id=__span-82-40><a id=__codelineno-82-40 name=__codelineno-82-40></a><a href=#__codelineno-82-40><span class=linenos data-linenos="40 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_active</span>
</span><span id=__span-82-41><a id=__codelineno-82-41 name=__codelineno-82-41></a><a href=#__codelineno-82-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-82-42><a id=__codelineno-82-42 name=__codelineno-82-42></a><a href=#__codelineno-82-42><span class=linenos data-linenos="42 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-82-43><a id=__codelineno-82-43 name=__codelineno-82-43></a><a href=#__codelineno-82-43><span class=linenos data-linenos="43 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_age</span>
</span><span id=__span-82-44><a id=__codelineno-82-44 name=__codelineno-82-44></a><a href=#__codelineno-82-44><span class=linenos data-linenos="44 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_nickname</span>
</span><span id=__span-82-45><a id=__codelineno-82-45 name=__codelineno-82-45></a><a href=#__codelineno-82-45><span class=linenos data-linenos="45 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_salary</span>
</span><span id=__span-82-46><a id=__codelineno-82-46 name=__codelineno-82-46></a><a href=#__codelineno-82-46><span class=linenos data-linenos="46 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_active</span>
</span><span id=__span-82-47><a id=__codelineno-82-47 name=__codelineno-82-47></a><a href=#__codelineno-82-47><span class=linenos data-linenos="47 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-82-48><a id=__codelineno-82-48 name=__codelineno-82-48></a><a href=#__codelineno-82-48><span class=linenos data-linenos="48 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-82-49><a id=__codelineno-82-49 name=__codelineno-82-49></a><a href=#__codelineno-82-49><span class=linenos data-linenos="49 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>depth</span>
</span><span id=__span-82-50><a id=__codelineno-82-50 name=__codelineno-82-50></a><a href=#__codelineno-82-50><span class=linenos data-linenos="50 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_path_id</span>
</span><span id=__span-82-51><a id=__codelineno-82-51 name=__codelineno-82-51></a><a href=#__codelineno-82-51><span class=linenos data-linenos="51 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>path_edges</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_path_edges</span>
</span><span id=__span-82-52><a id=__codelineno-82-52 name=__codelineno-82-52></a><a href=#__codelineno-82-52><span class=linenos data-linenos="52 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-82-53><a id=__codelineno-82-53 name=__codelineno-82-53></a><a href=#__codelineno-82-53><span class=linenos data-linenos="53 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=n>sink</span>
</span><span id=__span-82-54><a id=__codelineno-82-54 name=__codelineno-82-54></a><a href=#__codelineno-82-54><span class=linenos data-linenos="54 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-82-55><a id=__codelineno-82-55 name=__codelineno-82-55></a><a href=#__codelineno-82-55><span class=linenos data-linenos="55 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=k>source</span>
</span><span id=__span-82-56><a id=__codelineno-82-56 name=__codelineno-82-56></a><a href=#__codelineno-82-56><span class=linenos data-linenos="56 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-82-57><a id=__codelineno-82-57 name=__codelineno-82-57></a><a href=#__codelineno-82-57><span class=linenos data-linenos="57 "></span></a><span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>4</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=n>sink</span><span class=p>.</span><span class=n>age</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>50</span><span class=p>)</span>
</span><span id=__span-82-58><a id=__codelineno-82-58 name=__codelineno-82-58></a><a href=#__codelineno-82-58><span class=linenos data-linenos="58 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-83-1><a id=__codelineno-83-1 name=__codelineno-83-1></a><a href=#__codelineno-83-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-83-2><a id=__codelineno-83-2 name=__codelineno-83-2></a><a href=#__codelineno-83-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-83-3><a id=__codelineno-83-3 name=__codelineno-83-3></a><a href=#__codelineno-83-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=2;
</span><span id=__span-83-4><a id=__codelineno-83-4 name=__codelineno-83-4></a><a href=#__codelineno-83-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-83-5><a id=__codelineno-83-5 name=__codelineno-83-5></a><a href=#__codelineno-83-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: a:Person
</span><span id=__span-83-6><a id=__codelineno-83-6 name=__codelineno-83-6></a><a href=#__codelineno-83-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-83-7><a id=__codelineno-83-7 name=__codelineno-83-7></a><a href=#__codelineno-83-7><span class=linenos data-linenos=" 7 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-83-8><a id=__codelineno-83-8 name=__codelineno-83-8></a><a href=#__codelineno-83-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-83-9><a id=__codelineno-83-9 name=__codelineno-83-9></a><a href=#__codelineno-83-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: b:Person
</span><span id=__span-83-10><a id=__codelineno-83-10 name=__codelineno-83-10></a><a href=#__codelineno-83-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-83-11><a id=__codelineno-83-11 name=__codelineno-83-11></a><a href=#__codelineno-83-11><span class=linenos data-linenos="11 "></span></a>----------------------------------------------------------------------
</span><span id=__span-83-12><a id=__codelineno-83-12 name=__codelineno-83-12></a><a href=#__codelineno-83-12><span class=linenos data-linenos="12 "></span></a>Level 1:
</span><span id=__span-83-13><a id=__codelineno-83-13 name=__codelineno-83-13></a><a href=#__codelineno-83-13><span class=linenos data-linenos="13 "></span></a>----------------------------------------------------------------------
</span><span id=__span-83-14><a id=__codelineno-83-14 name=__codelineno-83-14></a><a href=#__codelineno-83-14><span class=linenos data-linenos="14 "></span></a>OpId=2 Op=RecursiveTraversalOperator; InOpIds=1; OutOpIds=4;
</span><span id=__span-83-15><a id=__codelineno-83-15 name=__codelineno-83-15></a><a href=#__codelineno-83-15><span class=linenos data-linenos="15 "></span></a>  RecursiveTraversal(KNOWS*2..4, path=path)
</span><span id=__span-83-16><a id=__codelineno-83-16 name=__codelineno-83-16></a><a href=#__codelineno-83-16><span class=linenos data-linenos="16 "></span></a>*
</span><span id=__span-83-17><a id=__codelineno-83-17 name=__codelineno-83-17></a><a href=#__codelineno-83-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-83-18><a id=__codelineno-83-18 name=__codelineno-83-18></a><a href=#__codelineno-83-18><span class=linenos data-linenos="18 "></span></a>Level 2:
</span><span id=__span-83-19><a id=__codelineno-83-19 name=__codelineno-83-19></a><a href=#__codelineno-83-19><span class=linenos data-linenos="19 "></span></a>----------------------------------------------------------------------
</span><span id=__span-83-20><a id=__codelineno-83-20 name=__codelineno-83-20></a><a href=#__codelineno-83-20><span class=linenos data-linenos="20 "></span></a>OpId=4 Op=JoinOperator; InOpIds=2,3; OutOpIds=5;
</span><span id=__span-83-21><a id=__codelineno-83-21 name=__codelineno-83-21></a><a href=#__codelineno-83-21><span class=linenos data-linenos="21 "></span></a>  JoinOperator(id=4)
</span><span id=__span-83-22><a id=__codelineno-83-22 name=__codelineno-83-22></a><a href=#__codelineno-83-22><span class=linenos data-linenos="22 "></span></a>    JoinType: INNER
</span><span id=__span-83-23><a id=__codelineno-83-23 name=__codelineno-83-23></a><a href=#__codelineno-83-23><span class=linenos data-linenos="23 "></span></a>    Joins: JoinPair: Node=b RelOrNode=paths__anon1 Type=SINK
</span><span id=__span-83-24><a id=__codelineno-83-24 name=__codelineno-83-24></a><a href=#__codelineno-83-24><span class=linenos data-linenos="24 "></span></a>*
</span><span id=__span-83-25><a id=__codelineno-83-25 name=__codelineno-83-25></a><a href=#__codelineno-83-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-83-26><a id=__codelineno-83-26 name=__codelineno-83-26></a><a href=#__codelineno-83-26><span class=linenos data-linenos="26 "></span></a>Level 3:
</span><span id=__span-83-27><a id=__codelineno-83-27 name=__codelineno-83-27></a><a href=#__codelineno-83-27><span class=linenos data-linenos="27 "></span></a>----------------------------------------------------------------------
</span><span id=__span-83-28><a id=__codelineno-83-28 name=__codelineno-83-28></a><a href=#__codelineno-83-28><span class=linenos data-linenos="28 "></span></a>OpId=5 Op=ProjectionOperator; InOpIds=4; OutOpIds=;
</span><span id=__span-83-29><a id=__codelineno-83-29 name=__codelineno-83-29></a><a href=#__codelineno-83-29><span class=linenos data-linenos="29 "></span></a>  ProjectionOperator(id=5)
</span><span id=__span-83-30><a id=__codelineno-83-30 name=__codelineno-83-30></a><a href=#__codelineno-83-30><span class=linenos data-linenos="30 "></span></a>    Projections: id=a.id, id=b.id, chain_length=LENGTH(path)
</span><span id=__span-83-31><a id=__codelineno-83-31 name=__codelineno-83-31></a><a href=#__codelineno-83-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-83-32><a id=__codelineno-83-32 name=__codelineno-83-32></a><a href=#__codelineno-83-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=29-variable-length-with-source-and-sink-filter-pushdown>29. Variable-length with source AND sink filter pushdown<a class=headerlink href=#29-variable-length-with-source-and-sink-filter-pushdown title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Dual Filter Pushdown</p> <details class=note> <summary>Notes</summary> <p>Both source and sink filters are optimized: - Source filter (a.age &gt; 30)  pushed into CTE base case - Sink filter (b.age &gt; 50)  pushed into recursive join</p> <p>BENEFIT: Maximum optimization for path queries between filtered nodes. We only explore paths starting from people over 30 (source filter) and only keep paths ending at people over 50 (sink filter).</p> <p>SQL Pattern: Base case: ... JOIN Person src ON ... WHERE (src.age) &gt; (30) Join: ... WHERE depth_bounds AND (sink.age) &gt; (50)</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-84-1><a id=__codelineno-84-1 name=__codelineno-84-1></a><a href=#__codelineno-84-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=n>path</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=p>*</span><span class=m>2</span><span class=p>..</span><span class=m>4</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>b</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-84-2><a id=__codelineno-84-2 name=__codelineno-84-2></a><a href=#__codelineno-84-2><span class=linenos data-linenos="2 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>30</span><span class=w> </span><span class=n>AND</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>50</span>
</span><span id=__span-84-3><a id=__codelineno-84-3 name=__codelineno-84-3></a><a href=#__codelineno-84-3><span class=linenos data-linenos="3 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>id</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-85-1><a id=__codelineno-85-1 name=__codelineno-85-1></a><a href=#__codelineno-85-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span>
</span><span id=__span-85-2><a id=__codelineno-85-2 name=__codelineno-85-2></a><a href=#__codelineno-85-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>  </span><span class=n>paths_1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-85-3><a id=__codelineno-85-3 name=__codelineno-85-3></a><a href=#__codelineno-85-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>    </span><span class=c1>-- Base case: direct edges (depth = 1)</span>
</span><span id=__span-85-4><a id=__codelineno-85-4 name=__codelineno-85-4></a><a href=#__codelineno-85-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-85-5><a id=__codelineno-85-5 name=__codelineno-85-5></a><a href=#__codelineno-85-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-85-6><a id=__codelineno-85-6 name=__codelineno-85-6></a><a href=#__codelineno-85-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-85-7><a id=__codelineno-85-7 name=__codelineno-85-7></a><a href=#__codelineno-85-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>      </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-85-8><a id=__codelineno-85-8 name=__codelineno-85-8></a><a href=#__codelineno-85-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-85-9><a id=__codelineno-85-9 name=__codelineno-85-9></a><a href=#__codelineno-85-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>NAMED_STRUCT</span><span class=p>(</span><span class=s1>&#39;person_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;friend_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;since&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>since</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;strength&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>strength</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path_edges</span><span class=p>,</span>
</span><span id=__span-85-10><a id=__codelineno-85-10 name=__codelineno-85-10></a><a href=#__codelineno-85-10><span class=linenos data-linenos="10 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-85-11><a id=__codelineno-85-11 name=__codelineno-85-11></a><a href=#__codelineno-85-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-85-12><a id=__codelineno-85-12 name=__codelineno-85-12></a><a href=#__codelineno-85-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=n>src</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>src</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span>
</span><span id=__span-85-13><a id=__codelineno-85-13 name=__codelineno-85-13></a><a href=#__codelineno-85-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=p>(</span><span class=n>src</span><span class=p>.</span><span class=n>age</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>30</span><span class=p>)</span>
</span><span id=__span-85-14><a id=__codelineno-85-14 name=__codelineno-85-14></a><a href=#__codelineno-85-14><span class=linenos data-linenos="14 "></span></a>
</span><span id=__span-85-15><a id=__codelineno-85-15 name=__codelineno-85-15></a><a href=#__codelineno-85-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-85-16><a id=__codelineno-85-16 name=__codelineno-85-16></a><a href=#__codelineno-85-16><span class=linenos data-linenos="16 "></span></a>
</span><span id=__span-85-17><a id=__codelineno-85-17 name=__codelineno-85-17></a><a href=#__codelineno-85-17><span class=linenos data-linenos="17 "></span></a><span class=w>    </span><span class=c1>-- Recursive case: extend paths</span>
</span><span id=__span-85-18><a id=__codelineno-85-18 name=__codelineno-85-18></a><a href=#__codelineno-85-18><span class=linenos data-linenos="18 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-85-19><a id=__codelineno-85-19 name=__codelineno-85-19></a><a href=#__codelineno-85-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-85-20><a id=__codelineno-85-20 name=__codelineno-85-20></a><a href=#__codelineno-85-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-85-21><a id=__codelineno-85-21 name=__codelineno-85-21></a><a href=#__codelineno-85-21><span class=linenos data-linenos="21 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-85-22><a id=__codelineno-85-22 name=__codelineno-85-22></a><a href=#__codelineno-85-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-85-23><a id=__codelineno-85-23 name=__codelineno-85-23></a><a href=#__codelineno-85-23><span class=linenos data-linenos="23 "></span></a><span class=w>      </span><span class=n>ARRAY_APPEND</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path_edges</span><span class=p>,</span><span class=w> </span><span class=n>NAMED_STRUCT</span><span class=p>(</span><span class=s1>&#39;person_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;friend_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;since&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>since</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;strength&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>strength</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path_edges</span><span class=p>,</span>
</span><span id=__span-85-24><a id=__codelineno-85-24 name=__codelineno-85-24></a><a href=#__codelineno-85-24><span class=linenos data-linenos="24 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-85-25><a id=__codelineno-85-25 name=__codelineno-85-25></a><a href=#__codelineno-85-25><span class=linenos data-linenos="25 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-85-26><a id=__codelineno-85-26 name=__codelineno-85-26></a><a href=#__codelineno-85-26><span class=linenos data-linenos="26 "></span></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-85-27><a id=__codelineno-85-27 name=__codelineno-85-27></a><a href=#__codelineno-85-27><span class=linenos data-linenos="27 "></span></a><span class=w>      </span><span class=k>ON</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span>
</span><span id=__span-85-28><a id=__codelineno-85-28 name=__codelineno-85-28></a><a href=#__codelineno-85-28><span class=linenos data-linenos="28 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>4</span>
</span><span id=__span-85-29><a id=__codelineno-85-29 name=__codelineno-85-29></a><a href=#__codelineno-85-29><span class=linenos data-linenos="29 "></span></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=n>ARRAY_CONTAINS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span>
</span><span id=__span-85-30><a id=__codelineno-85-30 name=__codelineno-85-30></a><a href=#__codelineno-85-30><span class=linenos data-linenos="30 "></span></a><span class=w>  </span><span class=p>)</span>
</span><span id=__span-85-31><a id=__codelineno-85-31 name=__codelineno-85-31></a><a href=#__codelineno-85-31><span class=linenos data-linenos="31 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-85-32><a id=__codelineno-85-32 name=__codelineno-85-32></a><a href=#__codelineno-85-32><span class=linenos data-linenos="32 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_a_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>id</span>
</span><span id=__span-85-33><a id=__codelineno-85-33 name=__codelineno-85-33></a><a href=#__codelineno-85-33><span class=linenos data-linenos="33 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_b_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>id</span>
</span><span id=__span-85-34><a id=__codelineno-85-34 name=__codelineno-85-34></a><a href=#__codelineno-85-34><span class=linenos data-linenos="34 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-85-35><a id=__codelineno-85-35 name=__codelineno-85-35></a><a href=#__codelineno-85-35><span class=linenos data-linenos="35 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-85-36><a id=__codelineno-85-36 name=__codelineno-85-36></a><a href=#__codelineno-85-36><span class=linenos data-linenos="36 "></span></a><span class=w>     </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_id</span>
</span><span id=__span-85-37><a id=__codelineno-85-37 name=__codelineno-85-37></a><a href=#__codelineno-85-37><span class=linenos data-linenos="37 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_name</span>
</span><span id=__span-85-38><a id=__codelineno-85-38 name=__codelineno-85-38></a><a href=#__codelineno-85-38><span class=linenos data-linenos="38 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_age</span>
</span><span id=__span-85-39><a id=__codelineno-85-39 name=__codelineno-85-39></a><a href=#__codelineno-85-39><span class=linenos data-linenos="39 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_nickname</span>
</span><span id=__span-85-40><a id=__codelineno-85-40 name=__codelineno-85-40></a><a href=#__codelineno-85-40><span class=linenos data-linenos="40 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_salary</span>
</span><span id=__span-85-41><a id=__codelineno-85-41 name=__codelineno-85-41></a><a href=#__codelineno-85-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_active</span>
</span><span id=__span-85-42><a id=__codelineno-85-42 name=__codelineno-85-42></a><a href=#__codelineno-85-42><span class=linenos data-linenos="42 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-85-43><a id=__codelineno-85-43 name=__codelineno-85-43></a><a href=#__codelineno-85-43><span class=linenos data-linenos="43 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-85-44><a id=__codelineno-85-44 name=__codelineno-85-44></a><a href=#__codelineno-85-44><span class=linenos data-linenos="44 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_age</span>
</span><span id=__span-85-45><a id=__codelineno-85-45 name=__codelineno-85-45></a><a href=#__codelineno-85-45><span class=linenos data-linenos="45 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_nickname</span>
</span><span id=__span-85-46><a id=__codelineno-85-46 name=__codelineno-85-46></a><a href=#__codelineno-85-46><span class=linenos data-linenos="46 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_salary</span>
</span><span id=__span-85-47><a id=__codelineno-85-47 name=__codelineno-85-47></a><a href=#__codelineno-85-47><span class=linenos data-linenos="47 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_active</span>
</span><span id=__span-85-48><a id=__codelineno-85-48 name=__codelineno-85-48></a><a href=#__codelineno-85-48><span class=linenos data-linenos="48 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-85-49><a id=__codelineno-85-49 name=__codelineno-85-49></a><a href=#__codelineno-85-49><span class=linenos data-linenos="49 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-85-50><a id=__codelineno-85-50 name=__codelineno-85-50></a><a href=#__codelineno-85-50><span class=linenos data-linenos="50 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>depth</span>
</span><span id=__span-85-51><a id=__codelineno-85-51 name=__codelineno-85-51></a><a href=#__codelineno-85-51><span class=linenos data-linenos="51 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_path_id</span>
</span><span id=__span-85-52><a id=__codelineno-85-52 name=__codelineno-85-52></a><a href=#__codelineno-85-52><span class=linenos data-linenos="52 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>path_edges</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_path_edges</span>
</span><span id=__span-85-53><a id=__codelineno-85-53 name=__codelineno-85-53></a><a href=#__codelineno-85-53><span class=linenos data-linenos="53 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-85-54><a id=__codelineno-85-54 name=__codelineno-85-54></a><a href=#__codelineno-85-54><span class=linenos data-linenos="54 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=n>sink</span>
</span><span id=__span-85-55><a id=__codelineno-85-55 name=__codelineno-85-55></a><a href=#__codelineno-85-55><span class=linenos data-linenos="55 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-85-56><a id=__codelineno-85-56 name=__codelineno-85-56></a><a href=#__codelineno-85-56><span class=linenos data-linenos="56 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=k>source</span>
</span><span id=__span-85-57><a id=__codelineno-85-57 name=__codelineno-85-57></a><a href=#__codelineno-85-57><span class=linenos data-linenos="57 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-85-58><a id=__codelineno-85-58 name=__codelineno-85-58></a><a href=#__codelineno-85-58><span class=linenos data-linenos="58 "></span></a><span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>4</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=n>sink</span><span class=p>.</span><span class=n>age</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>50</span><span class=p>)</span>
</span><span id=__span-85-59><a id=__codelineno-85-59 name=__codelineno-85-59></a><a href=#__codelineno-85-59><span class=linenos data-linenos="59 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-86-1><a id=__codelineno-86-1 name=__codelineno-86-1></a><a href=#__codelineno-86-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-86-2><a id=__codelineno-86-2 name=__codelineno-86-2></a><a href=#__codelineno-86-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-86-3><a id=__codelineno-86-3 name=__codelineno-86-3></a><a href=#__codelineno-86-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=2;
</span><span id=__span-86-4><a id=__codelineno-86-4 name=__codelineno-86-4></a><a href=#__codelineno-86-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-86-5><a id=__codelineno-86-5 name=__codelineno-86-5></a><a href=#__codelineno-86-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: a:Person
</span><span id=__span-86-6><a id=__codelineno-86-6 name=__codelineno-86-6></a><a href=#__codelineno-86-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-86-7><a id=__codelineno-86-7 name=__codelineno-86-7></a><a href=#__codelineno-86-7><span class=linenos data-linenos=" 7 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-86-8><a id=__codelineno-86-8 name=__codelineno-86-8></a><a href=#__codelineno-86-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-86-9><a id=__codelineno-86-9 name=__codelineno-86-9></a><a href=#__codelineno-86-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: b:Person
</span><span id=__span-86-10><a id=__codelineno-86-10 name=__codelineno-86-10></a><a href=#__codelineno-86-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-86-11><a id=__codelineno-86-11 name=__codelineno-86-11></a><a href=#__codelineno-86-11><span class=linenos data-linenos="11 "></span></a>----------------------------------------------------------------------
</span><span id=__span-86-12><a id=__codelineno-86-12 name=__codelineno-86-12></a><a href=#__codelineno-86-12><span class=linenos data-linenos="12 "></span></a>Level 1:
</span><span id=__span-86-13><a id=__codelineno-86-13 name=__codelineno-86-13></a><a href=#__codelineno-86-13><span class=linenos data-linenos="13 "></span></a>----------------------------------------------------------------------
</span><span id=__span-86-14><a id=__codelineno-86-14 name=__codelineno-86-14></a><a href=#__codelineno-86-14><span class=linenos data-linenos="14 "></span></a>OpId=2 Op=RecursiveTraversalOperator; InOpIds=1; OutOpIds=4;
</span><span id=__span-86-15><a id=__codelineno-86-15 name=__codelineno-86-15></a><a href=#__codelineno-86-15><span class=linenos data-linenos="15 "></span></a>  RecursiveTraversal(KNOWS*2..4, path=path)
</span><span id=__span-86-16><a id=__codelineno-86-16 name=__codelineno-86-16></a><a href=#__codelineno-86-16><span class=linenos data-linenos="16 "></span></a>*
</span><span id=__span-86-17><a id=__codelineno-86-17 name=__codelineno-86-17></a><a href=#__codelineno-86-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-86-18><a id=__codelineno-86-18 name=__codelineno-86-18></a><a href=#__codelineno-86-18><span class=linenos data-linenos="18 "></span></a>Level 2:
</span><span id=__span-86-19><a id=__codelineno-86-19 name=__codelineno-86-19></a><a href=#__codelineno-86-19><span class=linenos data-linenos="19 "></span></a>----------------------------------------------------------------------
</span><span id=__span-86-20><a id=__codelineno-86-20 name=__codelineno-86-20></a><a href=#__codelineno-86-20><span class=linenos data-linenos="20 "></span></a>OpId=4 Op=JoinOperator; InOpIds=2,3; OutOpIds=5;
</span><span id=__span-86-21><a id=__codelineno-86-21 name=__codelineno-86-21></a><a href=#__codelineno-86-21><span class=linenos data-linenos="21 "></span></a>  JoinOperator(id=4)
</span><span id=__span-86-22><a id=__codelineno-86-22 name=__codelineno-86-22></a><a href=#__codelineno-86-22><span class=linenos data-linenos="22 "></span></a>    JoinType: INNER
</span><span id=__span-86-23><a id=__codelineno-86-23 name=__codelineno-86-23></a><a href=#__codelineno-86-23><span class=linenos data-linenos="23 "></span></a>    Joins: JoinPair: Node=b RelOrNode=paths__anon1 Type=SINK
</span><span id=__span-86-24><a id=__codelineno-86-24 name=__codelineno-86-24></a><a href=#__codelineno-86-24><span class=linenos data-linenos="24 "></span></a>*
</span><span id=__span-86-25><a id=__codelineno-86-25 name=__codelineno-86-25></a><a href=#__codelineno-86-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-86-26><a id=__codelineno-86-26 name=__codelineno-86-26></a><a href=#__codelineno-86-26><span class=linenos data-linenos="26 "></span></a>Level 3:
</span><span id=__span-86-27><a id=__codelineno-86-27 name=__codelineno-86-27></a><a href=#__codelineno-86-27><span class=linenos data-linenos="27 "></span></a>----------------------------------------------------------------------
</span><span id=__span-86-28><a id=__codelineno-86-28 name=__codelineno-86-28></a><a href=#__codelineno-86-28><span class=linenos data-linenos="28 "></span></a>OpId=5 Op=ProjectionOperator; InOpIds=4; OutOpIds=;
</span><span id=__span-86-29><a id=__codelineno-86-29 name=__codelineno-86-29></a><a href=#__codelineno-86-29><span class=linenos data-linenos="29 "></span></a>  ProjectionOperator(id=5)
</span><span id=__span-86-30><a id=__codelineno-86-30 name=__codelineno-86-30></a><a href=#__codelineno-86-30><span class=linenos data-linenos="30 "></span></a>    Projections: id=a.id, id=b.id
</span><span id=__span-86-31><a id=__codelineno-86-31 name=__codelineno-86-31></a><a href=#__codelineno-86-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-86-32><a id=__codelineno-86-32 name=__codelineno-86-32></a><a href=#__codelineno-86-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=30-variable-length-with-compound-sink-filter>30. Variable-length with compound sink filter<a class=headerlink href=#30-variable-length-with-compound-sink-filter title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Compound Sink Filter Pushdown</p> <details class=note> <summary>Notes</summary> <p>Compound sink filter (AND of two conditions) is pushed together.</p> <p>OPTIMIZATION: Both conditions are applied in the recursive join WHERE: WHERE p.depth &gt;= 1 AND ((sink.age) &gt; (40) AND sink.active = true)</p> <p>USE CASE: Find chains of connections ending at active people over 40.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-87-1><a id=__codelineno-87-1 name=__codelineno-87-1></a><a href=#__codelineno-87-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=n>path</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=p>*</span><span class=m>1</span><span class=p>..</span><span class=m>3</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>b</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-87-2><a id=__codelineno-87-2 name=__codelineno-87-2></a><a href=#__codelineno-87-2><span class=linenos data-linenos="2 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>40</span><span class=w> </span><span class=n>AND</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=k>true</span>
</span><span id=__span-87-3><a id=__codelineno-87-3 name=__codelineno-87-3></a><a href=#__codelineno-87-3><span class=linenos data-linenos="3 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=o>[</span><span class=n>n</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=n>nodes</span><span class=p>(</span><span class=n>path</span><span class=p>)</span><span class=w> </span><span class=p>|</span><span class=w> </span><span class=n>n</span><span class=p>.</span><span class=n>id</span><span class=o>]</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path_nodes</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-88-1><a id=__codelineno-88-1 name=__codelineno-88-1></a><a href=#__codelineno-88-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span>
</span><span id=__span-88-2><a id=__codelineno-88-2 name=__codelineno-88-2></a><a href=#__codelineno-88-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>  </span><span class=n>paths_1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-88-3><a id=__codelineno-88-3 name=__codelineno-88-3></a><a href=#__codelineno-88-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>    </span><span class=c1>-- Base case: direct edges (depth = 1)</span>
</span><span id=__span-88-4><a id=__codelineno-88-4 name=__codelineno-88-4></a><a href=#__codelineno-88-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-88-5><a id=__codelineno-88-5 name=__codelineno-88-5></a><a href=#__codelineno-88-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-88-6><a id=__codelineno-88-6 name=__codelineno-88-6></a><a href=#__codelineno-88-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-88-7><a id=__codelineno-88-7 name=__codelineno-88-7></a><a href=#__codelineno-88-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>      </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-88-8><a id=__codelineno-88-8 name=__codelineno-88-8></a><a href=#__codelineno-88-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-88-9><a id=__codelineno-88-9 name=__codelineno-88-9></a><a href=#__codelineno-88-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>NAMED_STRUCT</span><span class=p>(</span><span class=s1>&#39;person_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;friend_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;since&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>since</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;strength&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>strength</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path_edges</span><span class=p>,</span>
</span><span id=__span-88-10><a id=__codelineno-88-10 name=__codelineno-88-10></a><a href=#__codelineno-88-10><span class=linenos data-linenos="10 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-88-11><a id=__codelineno-88-11 name=__codelineno-88-11></a><a href=#__codelineno-88-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-88-12><a id=__codelineno-88-12 name=__codelineno-88-12></a><a href=#__codelineno-88-12><span class=linenos data-linenos="12 "></span></a>
</span><span id=__span-88-13><a id=__codelineno-88-13 name=__codelineno-88-13></a><a href=#__codelineno-88-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-88-14><a id=__codelineno-88-14 name=__codelineno-88-14></a><a href=#__codelineno-88-14><span class=linenos data-linenos="14 "></span></a>
</span><span id=__span-88-15><a id=__codelineno-88-15 name=__codelineno-88-15></a><a href=#__codelineno-88-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=c1>-- Recursive case: extend paths</span>
</span><span id=__span-88-16><a id=__codelineno-88-16 name=__codelineno-88-16></a><a href=#__codelineno-88-16><span class=linenos data-linenos="16 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-88-17><a id=__codelineno-88-17 name=__codelineno-88-17></a><a href=#__codelineno-88-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-88-18><a id=__codelineno-88-18 name=__codelineno-88-18></a><a href=#__codelineno-88-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-88-19><a id=__codelineno-88-19 name=__codelineno-88-19></a><a href=#__codelineno-88-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-88-20><a id=__codelineno-88-20 name=__codelineno-88-20></a><a href=#__codelineno-88-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-88-21><a id=__codelineno-88-21 name=__codelineno-88-21></a><a href=#__codelineno-88-21><span class=linenos data-linenos="21 "></span></a><span class=w>      </span><span class=n>ARRAY_APPEND</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path_edges</span><span class=p>,</span><span class=w> </span><span class=n>NAMED_STRUCT</span><span class=p>(</span><span class=s1>&#39;person_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;friend_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;since&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>since</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;strength&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>strength</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path_edges</span><span class=p>,</span>
</span><span id=__span-88-22><a id=__codelineno-88-22 name=__codelineno-88-22></a><a href=#__codelineno-88-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-88-23><a id=__codelineno-88-23 name=__codelineno-88-23></a><a href=#__codelineno-88-23><span class=linenos data-linenos="23 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-88-24><a id=__codelineno-88-24 name=__codelineno-88-24></a><a href=#__codelineno-88-24><span class=linenos data-linenos="24 "></span></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-88-25><a id=__codelineno-88-25 name=__codelineno-88-25></a><a href=#__codelineno-88-25><span class=linenos data-linenos="25 "></span></a><span class=w>      </span><span class=k>ON</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span>
</span><span id=__span-88-26><a id=__codelineno-88-26 name=__codelineno-88-26></a><a href=#__codelineno-88-26><span class=linenos data-linenos="26 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>3</span>
</span><span id=__span-88-27><a id=__codelineno-88-27 name=__codelineno-88-27></a><a href=#__codelineno-88-27><span class=linenos data-linenos="27 "></span></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=n>ARRAY_CONTAINS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span>
</span><span id=__span-88-28><a id=__codelineno-88-28 name=__codelineno-88-28></a><a href=#__codelineno-88-28><span class=linenos data-linenos="28 "></span></a><span class=w>  </span><span class=p>)</span>
</span><span id=__span-88-29><a id=__codelineno-88-29 name=__codelineno-88-29></a><a href=#__codelineno-88-29><span class=linenos data-linenos="29 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-88-30><a id=__codelineno-88-30 name=__codelineno-88-30></a><a href=#__codelineno-88-30><span class=linenos data-linenos="30 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_a_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>id</span>
</span><span id=__span-88-31><a id=__codelineno-88-31 name=__codelineno-88-31></a><a href=#__codelineno-88-31><span class=linenos data-linenos="31 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_b_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>id</span>
</span><span id=__span-88-32><a id=__codelineno-88-32 name=__codelineno-88-32></a><a href=#__codelineno-88-32><span class=linenos data-linenos="32 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_path_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path_nodes</span>
</span><span id=__span-88-33><a id=__codelineno-88-33 name=__codelineno-88-33></a><a href=#__codelineno-88-33><span class=linenos data-linenos="33 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-88-34><a id=__codelineno-88-34 name=__codelineno-88-34></a><a href=#__codelineno-88-34><span class=linenos data-linenos="34 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-88-35><a id=__codelineno-88-35 name=__codelineno-88-35></a><a href=#__codelineno-88-35><span class=linenos data-linenos="35 "></span></a><span class=w>     </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_id</span>
</span><span id=__span-88-36><a id=__codelineno-88-36 name=__codelineno-88-36></a><a href=#__codelineno-88-36><span class=linenos data-linenos="36 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_name</span>
</span><span id=__span-88-37><a id=__codelineno-88-37 name=__codelineno-88-37></a><a href=#__codelineno-88-37><span class=linenos data-linenos="37 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_age</span>
</span><span id=__span-88-38><a id=__codelineno-88-38 name=__codelineno-88-38></a><a href=#__codelineno-88-38><span class=linenos data-linenos="38 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_nickname</span>
</span><span id=__span-88-39><a id=__codelineno-88-39 name=__codelineno-88-39></a><a href=#__codelineno-88-39><span class=linenos data-linenos="39 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_salary</span>
</span><span id=__span-88-40><a id=__codelineno-88-40 name=__codelineno-88-40></a><a href=#__codelineno-88-40><span class=linenos data-linenos="40 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_active</span>
</span><span id=__span-88-41><a id=__codelineno-88-41 name=__codelineno-88-41></a><a href=#__codelineno-88-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-88-42><a id=__codelineno-88-42 name=__codelineno-88-42></a><a href=#__codelineno-88-42><span class=linenos data-linenos="42 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-88-43><a id=__codelineno-88-43 name=__codelineno-88-43></a><a href=#__codelineno-88-43><span class=linenos data-linenos="43 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_age</span>
</span><span id=__span-88-44><a id=__codelineno-88-44 name=__codelineno-88-44></a><a href=#__codelineno-88-44><span class=linenos data-linenos="44 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_nickname</span>
</span><span id=__span-88-45><a id=__codelineno-88-45 name=__codelineno-88-45></a><a href=#__codelineno-88-45><span class=linenos data-linenos="45 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_salary</span>
</span><span id=__span-88-46><a id=__codelineno-88-46 name=__codelineno-88-46></a><a href=#__codelineno-88-46><span class=linenos data-linenos="46 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_active</span>
</span><span id=__span-88-47><a id=__codelineno-88-47 name=__codelineno-88-47></a><a href=#__codelineno-88-47><span class=linenos data-linenos="47 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-88-48><a id=__codelineno-88-48 name=__codelineno-88-48></a><a href=#__codelineno-88-48><span class=linenos data-linenos="48 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-88-49><a id=__codelineno-88-49 name=__codelineno-88-49></a><a href=#__codelineno-88-49><span class=linenos data-linenos="49 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>depth</span>
</span><span id=__span-88-50><a id=__codelineno-88-50 name=__codelineno-88-50></a><a href=#__codelineno-88-50><span class=linenos data-linenos="50 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_path_id</span>
</span><span id=__span-88-51><a id=__codelineno-88-51 name=__codelineno-88-51></a><a href=#__codelineno-88-51><span class=linenos data-linenos="51 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>path_edges</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_path_edges</span>
</span><span id=__span-88-52><a id=__codelineno-88-52 name=__codelineno-88-52></a><a href=#__codelineno-88-52><span class=linenos data-linenos="52 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-88-53><a id=__codelineno-88-53 name=__codelineno-88-53></a><a href=#__codelineno-88-53><span class=linenos data-linenos="53 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=n>sink</span>
</span><span id=__span-88-54><a id=__codelineno-88-54 name=__codelineno-88-54></a><a href=#__codelineno-88-54><span class=linenos data-linenos="54 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-88-55><a id=__codelineno-88-55 name=__codelineno-88-55></a><a href=#__codelineno-88-55><span class=linenos data-linenos="55 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=k>source</span>
</span><span id=__span-88-56><a id=__codelineno-88-56 name=__codelineno-88-56></a><a href=#__codelineno-88-56><span class=linenos data-linenos="56 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-88-57><a id=__codelineno-88-57 name=__codelineno-88-57></a><a href=#__codelineno-88-57><span class=linenos data-linenos="57 "></span></a><span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=p>((</span><span class=n>sink</span><span class=p>.</span><span class=n>age</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>40</span><span class=p>))</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=p>((</span><span class=n>sink</span><span class=p>.</span><span class=n>active</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=k>TRUE</span><span class=p>))</span>
</span><span id=__span-88-58><a id=__codelineno-88-58 name=__codelineno-88-58></a><a href=#__codelineno-88-58><span class=linenos data-linenos="58 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-89-1><a id=__codelineno-89-1 name=__codelineno-89-1></a><a href=#__codelineno-89-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-89-2><a id=__codelineno-89-2 name=__codelineno-89-2></a><a href=#__codelineno-89-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-89-3><a id=__codelineno-89-3 name=__codelineno-89-3></a><a href=#__codelineno-89-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=2;
</span><span id=__span-89-4><a id=__codelineno-89-4 name=__codelineno-89-4></a><a href=#__codelineno-89-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-89-5><a id=__codelineno-89-5 name=__codelineno-89-5></a><a href=#__codelineno-89-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: a:Person
</span><span id=__span-89-6><a id=__codelineno-89-6 name=__codelineno-89-6></a><a href=#__codelineno-89-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-89-7><a id=__codelineno-89-7 name=__codelineno-89-7></a><a href=#__codelineno-89-7><span class=linenos data-linenos=" 7 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-89-8><a id=__codelineno-89-8 name=__codelineno-89-8></a><a href=#__codelineno-89-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-89-9><a id=__codelineno-89-9 name=__codelineno-89-9></a><a href=#__codelineno-89-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: b:Person
</span><span id=__span-89-10><a id=__codelineno-89-10 name=__codelineno-89-10></a><a href=#__codelineno-89-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-89-11><a id=__codelineno-89-11 name=__codelineno-89-11></a><a href=#__codelineno-89-11><span class=linenos data-linenos="11 "></span></a>----------------------------------------------------------------------
</span><span id=__span-89-12><a id=__codelineno-89-12 name=__codelineno-89-12></a><a href=#__codelineno-89-12><span class=linenos data-linenos="12 "></span></a>Level 1:
</span><span id=__span-89-13><a id=__codelineno-89-13 name=__codelineno-89-13></a><a href=#__codelineno-89-13><span class=linenos data-linenos="13 "></span></a>----------------------------------------------------------------------
</span><span id=__span-89-14><a id=__codelineno-89-14 name=__codelineno-89-14></a><a href=#__codelineno-89-14><span class=linenos data-linenos="14 "></span></a>OpId=2 Op=RecursiveTraversalOperator; InOpIds=1; OutOpIds=4;
</span><span id=__span-89-15><a id=__codelineno-89-15 name=__codelineno-89-15></a><a href=#__codelineno-89-15><span class=linenos data-linenos="15 "></span></a>  RecursiveTraversal(KNOWS*1..3, path=path)
</span><span id=__span-89-16><a id=__codelineno-89-16 name=__codelineno-89-16></a><a href=#__codelineno-89-16><span class=linenos data-linenos="16 "></span></a>*
</span><span id=__span-89-17><a id=__codelineno-89-17 name=__codelineno-89-17></a><a href=#__codelineno-89-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-89-18><a id=__codelineno-89-18 name=__codelineno-89-18></a><a href=#__codelineno-89-18><span class=linenos data-linenos="18 "></span></a>Level 2:
</span><span id=__span-89-19><a id=__codelineno-89-19 name=__codelineno-89-19></a><a href=#__codelineno-89-19><span class=linenos data-linenos="19 "></span></a>----------------------------------------------------------------------
</span><span id=__span-89-20><a id=__codelineno-89-20 name=__codelineno-89-20></a><a href=#__codelineno-89-20><span class=linenos data-linenos="20 "></span></a>OpId=4 Op=JoinOperator; InOpIds=2,3; OutOpIds=5;
</span><span id=__span-89-21><a id=__codelineno-89-21 name=__codelineno-89-21></a><a href=#__codelineno-89-21><span class=linenos data-linenos="21 "></span></a>  JoinOperator(id=4)
</span><span id=__span-89-22><a id=__codelineno-89-22 name=__codelineno-89-22></a><a href=#__codelineno-89-22><span class=linenos data-linenos="22 "></span></a>    JoinType: INNER
</span><span id=__span-89-23><a id=__codelineno-89-23 name=__codelineno-89-23></a><a href=#__codelineno-89-23><span class=linenos data-linenos="23 "></span></a>    Joins: JoinPair: Node=b RelOrNode=paths__anon1 Type=SINK
</span><span id=__span-89-24><a id=__codelineno-89-24 name=__codelineno-89-24></a><a href=#__codelineno-89-24><span class=linenos data-linenos="24 "></span></a>*
</span><span id=__span-89-25><a id=__codelineno-89-25 name=__codelineno-89-25></a><a href=#__codelineno-89-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-89-26><a id=__codelineno-89-26 name=__codelineno-89-26></a><a href=#__codelineno-89-26><span class=linenos data-linenos="26 "></span></a>Level 3:
</span><span id=__span-89-27><a id=__codelineno-89-27 name=__codelineno-89-27></a><a href=#__codelineno-89-27><span class=linenos data-linenos="27 "></span></a>----------------------------------------------------------------------
</span><span id=__span-89-28><a id=__codelineno-89-28 name=__codelineno-89-28></a><a href=#__codelineno-89-28><span class=linenos data-linenos="28 "></span></a>OpId=5 Op=ProjectionOperator; InOpIds=4; OutOpIds=;
</span><span id=__span-89-29><a id=__codelineno-89-29 name=__codelineno-89-29></a><a href=#__codelineno-89-29><span class=linenos data-linenos="29 "></span></a>  ProjectionOperator(id=5)
</span><span id=__span-89-30><a id=__codelineno-89-30 name=__codelineno-89-30></a><a href=#__codelineno-89-30><span class=linenos data-linenos="30 "></span></a>    Projections: id=a.id, id=b.id, path_nodes=[n IN NODES(path) | n.id]
</span><span id=__span-89-31><a id=__codelineno-89-31 name=__codelineno-89-31></a><a href=#__codelineno-89-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-89-32><a id=__codelineno-89-32 name=__codelineno-89-32></a><a href=#__codelineno-89-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=31-variable-length-with-sink-filter-and-edge-predicate>31. Variable-length with sink filter and edge predicate<a class=headerlink href=#31-variable-length-with-sink-filter-and-edge-predicate title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Combined Optimizations</p> <details class=note> <summary>Notes</summary> <p>Combines multiple optimizations: 1. Edge predicate (since &gt; 2010) pushed into CTE base and recursive cases 2. Sink filter (age &gt; 60) pushed into recursive join</p> <p>USE CASE: Find chains of recent connections ending at seniors. Only explores paths where EVERY connection was made after 2010.</p> <p>SQL Pattern: Base case: WHERE (e.since) &gt; (2010) Recursive: WHERE depth &lt; 5 AND (e.since) &gt; (2010) Join: WHERE depth_bounds AND (sink.age) &gt; (60)</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-90-1><a id=__codelineno-90-1 name=__codelineno-90-1></a><a href=#__codelineno-90-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=n>path</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=p>*</span><span class=m>2</span><span class=p>..</span><span class=m>5</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>b</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-90-2><a id=__codelineno-90-2 name=__codelineno-90-2></a><a href=#__codelineno-90-2><span class=linenos data-linenos="2 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>60</span>
</span><span id=__span-90-3><a id=__codelineno-90-3 name=__codelineno-90-3></a><a href=#__codelineno-90-3><span class=linenos data-linenos="3 "></span></a><span class=w>  </span><span class=n>AND</span><span class=w> </span><span class=k>ALL</span><span class=p>(</span><span class=n>k</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=n>relationships</span><span class=p>(</span><span class=n>path</span><span class=p>)</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>k</span><span class=p>.</span><span class=n>since</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>2010</span><span class=p>)</span>
</span><span id=__span-90-4><a id=__codelineno-90-4 name=__codelineno-90-4></a><a href=#__codelineno-90-4><span class=linenos data-linenos="4 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>LENGTH</span><span class=p>(</span><span class=n>path</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>hops</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-91-1><a id=__codelineno-91-1 name=__codelineno-91-1></a><a href=#__codelineno-91-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span>
</span><span id=__span-91-2><a id=__codelineno-91-2 name=__codelineno-91-2></a><a href=#__codelineno-91-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>  </span><span class=n>paths_1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-91-3><a id=__codelineno-91-3 name=__codelineno-91-3></a><a href=#__codelineno-91-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>    </span><span class=c1>-- Base case: direct edges (depth = 1)</span>
</span><span id=__span-91-4><a id=__codelineno-91-4 name=__codelineno-91-4></a><a href=#__codelineno-91-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-91-5><a id=__codelineno-91-5 name=__codelineno-91-5></a><a href=#__codelineno-91-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-91-6><a id=__codelineno-91-6 name=__codelineno-91-6></a><a href=#__codelineno-91-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-91-7><a id=__codelineno-91-7 name=__codelineno-91-7></a><a href=#__codelineno-91-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>      </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-91-8><a id=__codelineno-91-8 name=__codelineno-91-8></a><a href=#__codelineno-91-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-91-9><a id=__codelineno-91-9 name=__codelineno-91-9></a><a href=#__codelineno-91-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>NAMED_STRUCT</span><span class=p>(</span><span class=s1>&#39;person_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;friend_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;since&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>since</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;strength&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>strength</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path_edges</span><span class=p>,</span>
</span><span id=__span-91-10><a id=__codelineno-91-10 name=__codelineno-91-10></a><a href=#__codelineno-91-10><span class=linenos data-linenos="10 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-91-11><a id=__codelineno-91-11 name=__codelineno-91-11></a><a href=#__codelineno-91-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-91-12><a id=__codelineno-91-12 name=__codelineno-91-12></a><a href=#__codelineno-91-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>since</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>2010</span><span class=p>)</span>
</span><span id=__span-91-13><a id=__codelineno-91-13 name=__codelineno-91-13></a><a href=#__codelineno-91-13><span class=linenos data-linenos="13 "></span></a>
</span><span id=__span-91-14><a id=__codelineno-91-14 name=__codelineno-91-14></a><a href=#__codelineno-91-14><span class=linenos data-linenos="14 "></span></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-91-15><a id=__codelineno-91-15 name=__codelineno-91-15></a><a href=#__codelineno-91-15><span class=linenos data-linenos="15 "></span></a>
</span><span id=__span-91-16><a id=__codelineno-91-16 name=__codelineno-91-16></a><a href=#__codelineno-91-16><span class=linenos data-linenos="16 "></span></a><span class=w>    </span><span class=c1>-- Recursive case: extend paths</span>
</span><span id=__span-91-17><a id=__codelineno-91-17 name=__codelineno-91-17></a><a href=#__codelineno-91-17><span class=linenos data-linenos="17 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-91-18><a id=__codelineno-91-18 name=__codelineno-91-18></a><a href=#__codelineno-91-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-91-19><a id=__codelineno-91-19 name=__codelineno-91-19></a><a href=#__codelineno-91-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-91-20><a id=__codelineno-91-20 name=__codelineno-91-20></a><a href=#__codelineno-91-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-91-21><a id=__codelineno-91-21 name=__codelineno-91-21></a><a href=#__codelineno-91-21><span class=linenos data-linenos="21 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-91-22><a id=__codelineno-91-22 name=__codelineno-91-22></a><a href=#__codelineno-91-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=n>ARRAY_APPEND</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path_edges</span><span class=p>,</span><span class=w> </span><span class=n>NAMED_STRUCT</span><span class=p>(</span><span class=s1>&#39;person_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;friend_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;since&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>since</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;strength&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>strength</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path_edges</span><span class=p>,</span>
</span><span id=__span-91-23><a id=__codelineno-91-23 name=__codelineno-91-23></a><a href=#__codelineno-91-23><span class=linenos data-linenos="23 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-91-24><a id=__codelineno-91-24 name=__codelineno-91-24></a><a href=#__codelineno-91-24><span class=linenos data-linenos="24 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-91-25><a id=__codelineno-91-25 name=__codelineno-91-25></a><a href=#__codelineno-91-25><span class=linenos data-linenos="25 "></span></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-91-26><a id=__codelineno-91-26 name=__codelineno-91-26></a><a href=#__codelineno-91-26><span class=linenos data-linenos="26 "></span></a><span class=w>      </span><span class=k>ON</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span>
</span><span id=__span-91-27><a id=__codelineno-91-27 name=__codelineno-91-27></a><a href=#__codelineno-91-27><span class=linenos data-linenos="27 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>5</span>
</span><span id=__span-91-28><a id=__codelineno-91-28 name=__codelineno-91-28></a><a href=#__codelineno-91-28><span class=linenos data-linenos="28 "></span></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=n>ARRAY_CONTAINS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span>
</span><span id=__span-91-29><a id=__codelineno-91-29 name=__codelineno-91-29></a><a href=#__codelineno-91-29><span class=linenos data-linenos="29 "></span></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>since</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>2010</span><span class=p>)</span>
</span><span id=__span-91-30><a id=__codelineno-91-30 name=__codelineno-91-30></a><a href=#__codelineno-91-30><span class=linenos data-linenos="30 "></span></a><span class=w>  </span><span class=p>)</span>
</span><span id=__span-91-31><a id=__codelineno-91-31 name=__codelineno-91-31></a><a href=#__codelineno-91-31><span class=linenos data-linenos="31 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-91-32><a id=__codelineno-91-32 name=__codelineno-91-32></a><a href=#__codelineno-91-32><span class=linenos data-linenos="32 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_a_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>id</span>
</span><span id=__span-91-33><a id=__codelineno-91-33 name=__codelineno-91-33></a><a href=#__codelineno-91-33><span class=linenos data-linenos="33 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_b_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>id</span>
</span><span id=__span-91-34><a id=__codelineno-91-34 name=__codelineno-91-34></a><a href=#__codelineno-91-34><span class=linenos data-linenos="34 "></span></a><span class=w>  </span><span class=p>,(</span><span class=k>SIZE</span><span class=p>(</span><span class=n>_gsql2rsql_path_id</span><span class=p>)</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>hops</span>
</span><span id=__span-91-35><a id=__codelineno-91-35 name=__codelineno-91-35></a><a href=#__codelineno-91-35><span class=linenos data-linenos="35 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-91-36><a id=__codelineno-91-36 name=__codelineno-91-36></a><a href=#__codelineno-91-36><span class=linenos data-linenos="36 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-91-37><a id=__codelineno-91-37 name=__codelineno-91-37></a><a href=#__codelineno-91-37><span class=linenos data-linenos="37 "></span></a><span class=w>     </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_id</span>
</span><span id=__span-91-38><a id=__codelineno-91-38 name=__codelineno-91-38></a><a href=#__codelineno-91-38><span class=linenos data-linenos="38 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_name</span>
</span><span id=__span-91-39><a id=__codelineno-91-39 name=__codelineno-91-39></a><a href=#__codelineno-91-39><span class=linenos data-linenos="39 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_age</span>
</span><span id=__span-91-40><a id=__codelineno-91-40 name=__codelineno-91-40></a><a href=#__codelineno-91-40><span class=linenos data-linenos="40 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_nickname</span>
</span><span id=__span-91-41><a id=__codelineno-91-41 name=__codelineno-91-41></a><a href=#__codelineno-91-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_salary</span>
</span><span id=__span-91-42><a id=__codelineno-91-42 name=__codelineno-91-42></a><a href=#__codelineno-91-42><span class=linenos data-linenos="42 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_active</span>
</span><span id=__span-91-43><a id=__codelineno-91-43 name=__codelineno-91-43></a><a href=#__codelineno-91-43><span class=linenos data-linenos="43 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-91-44><a id=__codelineno-91-44 name=__codelineno-91-44></a><a href=#__codelineno-91-44><span class=linenos data-linenos="44 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-91-45><a id=__codelineno-91-45 name=__codelineno-91-45></a><a href=#__codelineno-91-45><span class=linenos data-linenos="45 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_age</span>
</span><span id=__span-91-46><a id=__codelineno-91-46 name=__codelineno-91-46></a><a href=#__codelineno-91-46><span class=linenos data-linenos="46 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_nickname</span>
</span><span id=__span-91-47><a id=__codelineno-91-47 name=__codelineno-91-47></a><a href=#__codelineno-91-47><span class=linenos data-linenos="47 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_salary</span>
</span><span id=__span-91-48><a id=__codelineno-91-48 name=__codelineno-91-48></a><a href=#__codelineno-91-48><span class=linenos data-linenos="48 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_active</span>
</span><span id=__span-91-49><a id=__codelineno-91-49 name=__codelineno-91-49></a><a href=#__codelineno-91-49><span class=linenos data-linenos="49 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-91-50><a id=__codelineno-91-50 name=__codelineno-91-50></a><a href=#__codelineno-91-50><span class=linenos data-linenos="50 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-91-51><a id=__codelineno-91-51 name=__codelineno-91-51></a><a href=#__codelineno-91-51><span class=linenos data-linenos="51 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>depth</span>
</span><span id=__span-91-52><a id=__codelineno-91-52 name=__codelineno-91-52></a><a href=#__codelineno-91-52><span class=linenos data-linenos="52 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_path_id</span>
</span><span id=__span-91-53><a id=__codelineno-91-53 name=__codelineno-91-53></a><a href=#__codelineno-91-53><span class=linenos data-linenos="53 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>path_edges</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_path_edges</span>
</span><span id=__span-91-54><a id=__codelineno-91-54 name=__codelineno-91-54></a><a href=#__codelineno-91-54><span class=linenos data-linenos="54 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-91-55><a id=__codelineno-91-55 name=__codelineno-91-55></a><a href=#__codelineno-91-55><span class=linenos data-linenos="55 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=n>sink</span>
</span><span id=__span-91-56><a id=__codelineno-91-56 name=__codelineno-91-56></a><a href=#__codelineno-91-56><span class=linenos data-linenos="56 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-91-57><a id=__codelineno-91-57 name=__codelineno-91-57></a><a href=#__codelineno-91-57><span class=linenos data-linenos="57 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=k>source</span>
</span><span id=__span-91-58><a id=__codelineno-91-58 name=__codelineno-91-58></a><a href=#__codelineno-91-58><span class=linenos data-linenos="58 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-91-59><a id=__codelineno-91-59 name=__codelineno-91-59></a><a href=#__codelineno-91-59><span class=linenos data-linenos="59 "></span></a><span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>5</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=n>sink</span><span class=p>.</span><span class=n>age</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>60</span><span class=p>)</span>
</span><span id=__span-91-60><a id=__codelineno-91-60 name=__codelineno-91-60></a><a href=#__codelineno-91-60><span class=linenos data-linenos="60 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-92-1><a id=__codelineno-92-1 name=__codelineno-92-1></a><a href=#__codelineno-92-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-92-2><a id=__codelineno-92-2 name=__codelineno-92-2></a><a href=#__codelineno-92-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-92-3><a id=__codelineno-92-3 name=__codelineno-92-3></a><a href=#__codelineno-92-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=2;
</span><span id=__span-92-4><a id=__codelineno-92-4 name=__codelineno-92-4></a><a href=#__codelineno-92-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-92-5><a id=__codelineno-92-5 name=__codelineno-92-5></a><a href=#__codelineno-92-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: a:Person
</span><span id=__span-92-6><a id=__codelineno-92-6 name=__codelineno-92-6></a><a href=#__codelineno-92-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-92-7><a id=__codelineno-92-7 name=__codelineno-92-7></a><a href=#__codelineno-92-7><span class=linenos data-linenos=" 7 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-92-8><a id=__codelineno-92-8 name=__codelineno-92-8></a><a href=#__codelineno-92-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-92-9><a id=__codelineno-92-9 name=__codelineno-92-9></a><a href=#__codelineno-92-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: b:Person
</span><span id=__span-92-10><a id=__codelineno-92-10 name=__codelineno-92-10></a><a href=#__codelineno-92-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-92-11><a id=__codelineno-92-11 name=__codelineno-92-11></a><a href=#__codelineno-92-11><span class=linenos data-linenos="11 "></span></a>----------------------------------------------------------------------
</span><span id=__span-92-12><a id=__codelineno-92-12 name=__codelineno-92-12></a><a href=#__codelineno-92-12><span class=linenos data-linenos="12 "></span></a>Level 1:
</span><span id=__span-92-13><a id=__codelineno-92-13 name=__codelineno-92-13></a><a href=#__codelineno-92-13><span class=linenos data-linenos="13 "></span></a>----------------------------------------------------------------------
</span><span id=__span-92-14><a id=__codelineno-92-14 name=__codelineno-92-14></a><a href=#__codelineno-92-14><span class=linenos data-linenos="14 "></span></a>OpId=2 Op=RecursiveTraversalOperator; InOpIds=1; OutOpIds=4;
</span><span id=__span-92-15><a id=__codelineno-92-15 name=__codelineno-92-15></a><a href=#__codelineno-92-15><span class=linenos data-linenos="15 "></span></a>  RecursiveTraversal(KNOWS*2..5, path=path)
</span><span id=__span-92-16><a id=__codelineno-92-16 name=__codelineno-92-16></a><a href=#__codelineno-92-16><span class=linenos data-linenos="16 "></span></a>*
</span><span id=__span-92-17><a id=__codelineno-92-17 name=__codelineno-92-17></a><a href=#__codelineno-92-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-92-18><a id=__codelineno-92-18 name=__codelineno-92-18></a><a href=#__codelineno-92-18><span class=linenos data-linenos="18 "></span></a>Level 2:
</span><span id=__span-92-19><a id=__codelineno-92-19 name=__codelineno-92-19></a><a href=#__codelineno-92-19><span class=linenos data-linenos="19 "></span></a>----------------------------------------------------------------------
</span><span id=__span-92-20><a id=__codelineno-92-20 name=__codelineno-92-20></a><a href=#__codelineno-92-20><span class=linenos data-linenos="20 "></span></a>OpId=4 Op=JoinOperator; InOpIds=2,3; OutOpIds=5;
</span><span id=__span-92-21><a id=__codelineno-92-21 name=__codelineno-92-21></a><a href=#__codelineno-92-21><span class=linenos data-linenos="21 "></span></a>  JoinOperator(id=4)
</span><span id=__span-92-22><a id=__codelineno-92-22 name=__codelineno-92-22></a><a href=#__codelineno-92-22><span class=linenos data-linenos="22 "></span></a>    JoinType: INNER
</span><span id=__span-92-23><a id=__codelineno-92-23 name=__codelineno-92-23></a><a href=#__codelineno-92-23><span class=linenos data-linenos="23 "></span></a>    Joins: JoinPair: Node=b RelOrNode=paths__anon1 Type=SINK
</span><span id=__span-92-24><a id=__codelineno-92-24 name=__codelineno-92-24></a><a href=#__codelineno-92-24><span class=linenos data-linenos="24 "></span></a>*
</span><span id=__span-92-25><a id=__codelineno-92-25 name=__codelineno-92-25></a><a href=#__codelineno-92-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-92-26><a id=__codelineno-92-26 name=__codelineno-92-26></a><a href=#__codelineno-92-26><span class=linenos data-linenos="26 "></span></a>Level 3:
</span><span id=__span-92-27><a id=__codelineno-92-27 name=__codelineno-92-27></a><a href=#__codelineno-92-27><span class=linenos data-linenos="27 "></span></a>----------------------------------------------------------------------
</span><span id=__span-92-28><a id=__codelineno-92-28 name=__codelineno-92-28></a><a href=#__codelineno-92-28><span class=linenos data-linenos="28 "></span></a>OpId=5 Op=ProjectionOperator; InOpIds=4; OutOpIds=;
</span><span id=__span-92-29><a id=__codelineno-92-29 name=__codelineno-92-29></a><a href=#__codelineno-92-29><span class=linenos data-linenos="29 "></span></a>  ProjectionOperator(id=5)
</span><span id=__span-92-30><a id=__codelineno-92-30 name=__codelineno-92-30></a><a href=#__codelineno-92-30><span class=linenos data-linenos="30 "></span></a>    Projections: id=a.id, id=b.id, hops=LENGTH(path)
</span><span id=__span-92-31><a id=__codelineno-92-31 name=__codelineno-92-31></a><a href=#__codelineno-92-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-92-32><a id=__codelineno-92-32 name=__codelineno-92-32></a><a href=#__codelineno-92-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=32-undirected-both-filters-pushdown-split-and-to-both-sources>32. Undirected both filters pushdown - split AND to both sources<a class=headerlink href=#32-undirected-both-filters-pushdown-split-and-to-both-sources title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Conjunction Splitting Pushdown</p> <details class=note> <summary>Notes</summary> <p>BEFORE optimization (suboptimal): Selection(p.name='Alice' AND f.age&gt;30) sits AFTER the join  Joins ALL Person rows, then filters.</p> <p>AFTER optimization (with conjunction splitting): - p.name = 'Alice'  pushed to DataSource(p) - f.age &gt; 30  pushed to DataSource(f)  Both filters applied BEFORE the join!</p> <p>SQL Pattern (optimized): FROM (SELECT ... FROM Person WHERE name = 'Alice') AS _left JOIN ... JOIN (SELECT ... FROM Person WHERE age &gt; 30) AS _right</p> <p>PERFORMANCE: Dramatically reduces join cardinality.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-93-1><a id=__codelineno-93-1 name=__codelineno-93-1></a><a href=#__codelineno-93-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=o>]-</span><span class=p>(</span><span class=n>f</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-93-2><a id=__codelineno-93-2 name=__codelineno-93-2></a><a href=#__codelineno-93-2><span class=linenos data-linenos="2 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&#39;Alice&#39;</span><span class=w> </span><span class=n>AND</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>30</span>
</span><span id=__span-93-3><a id=__codelineno-93-3 name=__codelineno-93-3></a><a href=#__codelineno-93-3><span class=linenos data-linenos="3 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>age</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-94-1><a id=__codelineno-94-1 name=__codelineno-94-1></a><a href=#__codelineno-94-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-94-2><a id=__codelineno-94-2 name=__codelineno-94-2></a><a href=#__codelineno-94-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-94-3><a id=__codelineno-94-3 name=__codelineno-94-3></a><a href=#__codelineno-94-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-94-4><a id=__codelineno-94-4 name=__codelineno-94-4></a><a href=#__codelineno-94-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_f_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>age</span>
</span><span id=__span-94-5><a id=__codelineno-94-5 name=__codelineno-94-5></a><a href=#__codelineno-94-5><span class=linenos data-linenos=" 5 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-94-6><a id=__codelineno-94-6 name=__codelineno-94-6></a><a href=#__codelineno-94-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-94-7><a id=__codelineno-94-7 name=__codelineno-94-7></a><a href=#__codelineno-94-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-94-8><a id=__codelineno-94-8 name=__codelineno-94-8></a><a href=#__codelineno-94-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-94-9><a id=__codelineno-94-9 name=__codelineno-94-9></a><a href=#__codelineno-94-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-94-10><a id=__codelineno-94-10 name=__codelineno-94-10></a><a href=#__codelineno-94-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-94-11><a id=__codelineno-94-11 name=__codelineno-94-11></a><a href=#__codelineno-94-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-94-12><a id=__codelineno-94-12 name=__codelineno-94-12></a><a href=#__codelineno-94-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-94-13><a id=__codelineno-94-13 name=__codelineno-94-13></a><a href=#__codelineno-94-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_age</span>
</span><span id=__span-94-14><a id=__codelineno-94-14 name=__codelineno-94-14></a><a href=#__codelineno-94-14><span class=linenos data-linenos="14 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-94-15><a id=__codelineno-94-15 name=__codelineno-94-15></a><a href=#__codelineno-94-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-94-16><a id=__codelineno-94-16 name=__codelineno-94-16></a><a href=#__codelineno-94-16><span class=linenos data-linenos="16 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-94-17><a id=__codelineno-94-17 name=__codelineno-94-17></a><a href=#__codelineno-94-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-94-18><a id=__codelineno-94-18 name=__codelineno-94-18></a><a href=#__codelineno-94-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-94-19><a id=__codelineno-94-19 name=__codelineno-94-19></a><a href=#__codelineno-94-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-94-20><a id=__codelineno-94-20 name=__codelineno-94-20></a><a href=#__codelineno-94-20><span class=linenos data-linenos="20 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-94-21><a id=__codelineno-94-21 name=__codelineno-94-21></a><a href=#__codelineno-94-21><span class=linenos data-linenos="21 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-94-22><a id=__codelineno-94-22 name=__codelineno-94-22></a><a href=#__codelineno-94-22><span class=linenos data-linenos="22 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-94-23><a id=__codelineno-94-23 name=__codelineno-94-23></a><a href=#__codelineno-94-23><span class=linenos data-linenos="23 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-94-24><a id=__codelineno-94-24 name=__codelineno-94-24></a><a href=#__codelineno-94-24><span class=linenos data-linenos="24 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-94-25><a id=__codelineno-94-25 name=__codelineno-94-25></a><a href=#__codelineno-94-25><span class=linenos data-linenos="25 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-94-26><a id=__codelineno-94-26 name=__codelineno-94-26></a><a href=#__codelineno-94-26><span class=linenos data-linenos="26 "></span></a><span class=w>      </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Alice&#39;</span><span class=p>))</span>
</span><span id=__span-94-27><a id=__codelineno-94-27 name=__codelineno-94-27></a><a href=#__codelineno-94-27><span class=linenos data-linenos="27 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-94-28><a id=__codelineno-94-28 name=__codelineno-94-28></a><a href=#__codelineno-94-28><span class=linenos data-linenos="28 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-94-29><a id=__codelineno-94-29 name=__codelineno-94-29></a><a href=#__codelineno-94-29><span class=linenos data-linenos="29 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-94-30><a id=__codelineno-94-30 name=__codelineno-94-30></a><a href=#__codelineno-94-30><span class=linenos data-linenos="30 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-94-31><a id=__codelineno-94-31 name=__codelineno-94-31></a><a href=#__codelineno-94-31><span class=linenos data-linenos="31 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-94-32><a id=__codelineno-94-32 name=__codelineno-94-32></a><a href=#__codelineno-94-32><span class=linenos data-linenos="32 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-94-33><a id=__codelineno-94-33 name=__codelineno-94-33></a><a href=#__codelineno-94-33><span class=linenos data-linenos="33 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_strength</span>
</span><span id=__span-94-34><a id=__codelineno-94-34 name=__codelineno-94-34></a><a href=#__codelineno-94-34><span class=linenos data-linenos="34 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-94-35><a id=__codelineno-94-35 name=__codelineno-94-35></a><a href=#__codelineno-94-35><span class=linenos data-linenos="35 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-94-36><a id=__codelineno-94-36 name=__codelineno-94-36></a><a href=#__codelineno-94-36><span class=linenos data-linenos="36 "></span></a><span class=w>      </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-94-37><a id=__codelineno-94-37 name=__codelineno-94-37></a><a href=#__codelineno-94-37><span class=linenos data-linenos="37 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-94-38><a id=__codelineno-94-38 name=__codelineno-94-38></a><a href=#__codelineno-94-38><span class=linenos data-linenos="38 "></span></a><span class=w>         </span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-94-39><a id=__codelineno-94-39 name=__codelineno-94-39></a><a href=#__codelineno-94-39><span class=linenos data-linenos="39 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-94-40><a id=__codelineno-94-40 name=__codelineno-94-40></a><a href=#__codelineno-94-40><span class=linenos data-linenos="40 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-94-41><a id=__codelineno-94-41 name=__codelineno-94-41></a><a href=#__codelineno-94-41><span class=linenos data-linenos="41 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_strength</span>
</span><span id=__span-94-42><a id=__codelineno-94-42 name=__codelineno-94-42></a><a href=#__codelineno-94-42><span class=linenos data-linenos="42 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-94-43><a id=__codelineno-94-43 name=__codelineno-94-43></a><a href=#__codelineno-94-43><span class=linenos data-linenos="43 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-94-44><a id=__codelineno-94-44 name=__codelineno-94-44></a><a href=#__codelineno-94-44><span class=linenos data-linenos="44 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-94-45><a id=__codelineno-94-45 name=__codelineno-94-45></a><a href=#__codelineno-94-45><span class=linenos data-linenos="45 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-94-46><a id=__codelineno-94-46 name=__codelineno-94-46></a><a href=#__codelineno-94-46><span class=linenos data-linenos="46 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-94-47><a id=__codelineno-94-47 name=__codelineno-94-47></a><a href=#__codelineno-94-47><span class=linenos data-linenos="47 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-94-48><a id=__codelineno-94-48 name=__codelineno-94-48></a><a href=#__codelineno-94-48><span class=linenos data-linenos="48 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-94-49><a id=__codelineno-94-49 name=__codelineno-94-49></a><a href=#__codelineno-94-49><span class=linenos data-linenos="49 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-94-50><a id=__codelineno-94-50 name=__codelineno-94-50></a><a href=#__codelineno-94-50><span class=linenos data-linenos="50 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-94-51><a id=__codelineno-94-51 name=__codelineno-94-51></a><a href=#__codelineno-94-51><span class=linenos data-linenos="51 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_age</span>
</span><span id=__span-94-52><a id=__codelineno-94-52 name=__codelineno-94-52></a><a href=#__codelineno-94-52><span class=linenos data-linenos="52 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-94-53><a id=__codelineno-94-53 name=__codelineno-94-53></a><a href=#__codelineno-94-53><span class=linenos data-linenos="53 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-94-54><a id=__codelineno-94-54 name=__codelineno-94-54></a><a href=#__codelineno-94-54><span class=linenos data-linenos="54 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>age</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>30</span><span class=p>))</span>
</span><span id=__span-94-55><a id=__codelineno-94-55 name=__codelineno-94-55></a><a href=#__codelineno-94-55><span class=linenos data-linenos="55 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-94-56><a id=__codelineno-94-56 name=__codelineno-94-56></a><a href=#__codelineno-94-56><span class=linenos data-linenos="56 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-94-57><a id=__codelineno-94-57 name=__codelineno-94-57></a><a href=#__codelineno-94-57><span class=linenos data-linenos="57 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-95-1><a id=__codelineno-95-1 name=__codelineno-95-1></a><a href=#__codelineno-95-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-95-2><a id=__codelineno-95-2 name=__codelineno-95-2></a><a href=#__codelineno-95-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-95-3><a id=__codelineno-95-3 name=__codelineno-95-3></a><a href=#__codelineno-95-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-95-4><a id=__codelineno-95-4 name=__codelineno-95-4></a><a href=#__codelineno-95-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-95-5><a id=__codelineno-95-5 name=__codelineno-95-5></a><a href=#__codelineno-95-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-95-6><a id=__codelineno-95-6 name=__codelineno-95-6></a><a href=#__codelineno-95-6><span class=linenos data-linenos=" 6 "></span></a>    Filter: (p.name EQ &#39;Alice&#39;)
</span><span id=__span-95-7><a id=__codelineno-95-7 name=__codelineno-95-7></a><a href=#__codelineno-95-7><span class=linenos data-linenos=" 7 "></span></a>*
</span><span id=__span-95-8><a id=__codelineno-95-8 name=__codelineno-95-8></a><a href=#__codelineno-95-8><span class=linenos data-linenos=" 8 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-95-9><a id=__codelineno-95-9 name=__codelineno-95-9></a><a href=#__codelineno-95-9><span class=linenos data-linenos=" 9 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-95-10><a id=__codelineno-95-10 name=__codelineno-95-10></a><a href=#__codelineno-95-10><span class=linenos data-linenos="10 "></span></a>    DataSource: [_anon1:KNOWS]-
</span><span id=__span-95-11><a id=__codelineno-95-11 name=__codelineno-95-11></a><a href=#__codelineno-95-11><span class=linenos data-linenos="11 "></span></a>*
</span><span id=__span-95-12><a id=__codelineno-95-12 name=__codelineno-95-12></a><a href=#__codelineno-95-12><span class=linenos data-linenos="12 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-95-13><a id=__codelineno-95-13 name=__codelineno-95-13></a><a href=#__codelineno-95-13><span class=linenos data-linenos="13 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-95-14><a id=__codelineno-95-14 name=__codelineno-95-14></a><a href=#__codelineno-95-14><span class=linenos data-linenos="14 "></span></a>    DataSource: f:Person
</span><span id=__span-95-15><a id=__codelineno-95-15 name=__codelineno-95-15></a><a href=#__codelineno-95-15><span class=linenos data-linenos="15 "></span></a>    Filter: (f.age GT 30)
</span><span id=__span-95-16><a id=__codelineno-95-16 name=__codelineno-95-16></a><a href=#__codelineno-95-16><span class=linenos data-linenos="16 "></span></a>*
</span><span id=__span-95-17><a id=__codelineno-95-17 name=__codelineno-95-17></a><a href=#__codelineno-95-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-95-18><a id=__codelineno-95-18 name=__codelineno-95-18></a><a href=#__codelineno-95-18><span class=linenos data-linenos="18 "></span></a>Level 1:
</span><span id=__span-95-19><a id=__codelineno-95-19 name=__codelineno-95-19></a><a href=#__codelineno-95-19><span class=linenos data-linenos="19 "></span></a>----------------------------------------------------------------------
</span><span id=__span-95-20><a id=__codelineno-95-20 name=__codelineno-95-20></a><a href=#__codelineno-95-20><span class=linenos data-linenos="20 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-95-21><a id=__codelineno-95-21 name=__codelineno-95-21></a><a href=#__codelineno-95-21><span class=linenos data-linenos="21 "></span></a>  JoinOperator(id=4)
</span><span id=__span-95-22><a id=__codelineno-95-22 name=__codelineno-95-22></a><a href=#__codelineno-95-22><span class=linenos data-linenos="22 "></span></a>    JoinType: INNER
</span><span id=__span-95-23><a id=__codelineno-95-23 name=__codelineno-95-23></a><a href=#__codelineno-95-23><span class=linenos data-linenos="23 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=EITHER_AS_SOURCE
</span><span id=__span-95-24><a id=__codelineno-95-24 name=__codelineno-95-24></a><a href=#__codelineno-95-24><span class=linenos data-linenos="24 "></span></a>*
</span><span id=__span-95-25><a id=__codelineno-95-25 name=__codelineno-95-25></a><a href=#__codelineno-95-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-95-26><a id=__codelineno-95-26 name=__codelineno-95-26></a><a href=#__codelineno-95-26><span class=linenos data-linenos="26 "></span></a>Level 2:
</span><span id=__span-95-27><a id=__codelineno-95-27 name=__codelineno-95-27></a><a href=#__codelineno-95-27><span class=linenos data-linenos="27 "></span></a>----------------------------------------------------------------------
</span><span id=__span-95-28><a id=__codelineno-95-28 name=__codelineno-95-28></a><a href=#__codelineno-95-28><span class=linenos data-linenos="28 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=7;
</span><span id=__span-95-29><a id=__codelineno-95-29 name=__codelineno-95-29></a><a href=#__codelineno-95-29><span class=linenos data-linenos="29 "></span></a>  JoinOperator(id=5)
</span><span id=__span-95-30><a id=__codelineno-95-30 name=__codelineno-95-30></a><a href=#__codelineno-95-30><span class=linenos data-linenos="30 "></span></a>    JoinType: INNER
</span><span id=__span-95-31><a id=__codelineno-95-31 name=__codelineno-95-31></a><a href=#__codelineno-95-31><span class=linenos data-linenos="31 "></span></a>    Joins: JoinPair: Node=f RelOrNode=_anon1 Type=EITHER_AS_SINK
</span><span id=__span-95-32><a id=__codelineno-95-32 name=__codelineno-95-32></a><a href=#__codelineno-95-32><span class=linenos data-linenos="32 "></span></a>*
</span><span id=__span-95-33><a id=__codelineno-95-33 name=__codelineno-95-33></a><a href=#__codelineno-95-33><span class=linenos data-linenos="33 "></span></a>----------------------------------------------------------------------
</span><span id=__span-95-34><a id=__codelineno-95-34 name=__codelineno-95-34></a><a href=#__codelineno-95-34><span class=linenos data-linenos="34 "></span></a>Level 3:
</span><span id=__span-95-35><a id=__codelineno-95-35 name=__codelineno-95-35></a><a href=#__codelineno-95-35><span class=linenos data-linenos="35 "></span></a>----------------------------------------------------------------------
</span><span id=__span-95-36><a id=__codelineno-95-36 name=__codelineno-95-36></a><a href=#__codelineno-95-36><span class=linenos data-linenos="36 "></span></a>OpId=7 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-95-37><a id=__codelineno-95-37 name=__codelineno-95-37></a><a href=#__codelineno-95-37><span class=linenos data-linenos="37 "></span></a>  ProjectionOperator(id=7)
</span><span id=__span-95-38><a id=__codelineno-95-38 name=__codelineno-95-38></a><a href=#__codelineno-95-38><span class=linenos data-linenos="38 "></span></a>    Projections: name=p.name, name=f.name, age=f.age
</span><span id=__span-95-39><a id=__codelineno-95-39 name=__codelineno-95-39></a><a href=#__codelineno-95-39><span class=linenos data-linenos="39 "></span></a>*
</span><span id=__span-95-40><a id=__codelineno-95-40 name=__codelineno-95-40></a><a href=#__codelineno-95-40><span class=linenos data-linenos="40 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=33-undirected-partial-pushdown-one-pushed-one-cross-variable>33. Undirected partial pushdown - one pushed, one cross-variable<a class=headerlink href=#33-undirected-partial-pushdown-one-pushed-one-cross-variable title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Partial Conjunction Pushdown</p> <details class=note> <summary>Notes</summary> <p>The optimizer splits the AND conjunction: - p.age &gt; 25  PUSHED to DataSource(p) (single-variable) - p.name = f.name  KEPT in Selection (cross-variable, cannot push!)</p> <p>BENEFIT: Even partial pushdown reduces join input size. The cross-variable predicate (p.name = f.name) must be evaluated after the join because it compares values from both sides.</p> <p>SQL Pattern: FROM (SELECT ... FROM Person WHERE age &gt; 25) AS _left -- PUSHED JOIN ... WHERE p.name = f.name -- KEPT (cross-variable)</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-96-1><a id=__codelineno-96-1 name=__codelineno-96-1></a><a href=#__codelineno-96-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=o>]-</span><span class=p>(</span><span class=n>f</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-96-2><a id=__codelineno-96-2 name=__codelineno-96-2></a><a href=#__codelineno-96-2><span class=linenos data-linenos="2 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>25</span><span class=w> </span><span class=n>AND</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>name</span>
</span><span id=__span-96-3><a id=__codelineno-96-3 name=__codelineno-96-3></a><a href=#__codelineno-96-3><span class=linenos data-linenos="3 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>name</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-97-1><a id=__codelineno-97-1 name=__codelineno-97-1></a><a href=#__codelineno-97-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-97-2><a id=__codelineno-97-2 name=__codelineno-97-2></a><a href=#__codelineno-97-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-97-3><a id=__codelineno-97-3 name=__codelineno-97-3></a><a href=#__codelineno-97-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-97-4><a id=__codelineno-97-4 name=__codelineno-97-4></a><a href=#__codelineno-97-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-97-5><a id=__codelineno-97-5 name=__codelineno-97-5></a><a href=#__codelineno-97-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-97-6><a id=__codelineno-97-6 name=__codelineno-97-6></a><a href=#__codelineno-97-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-97-7><a id=__codelineno-97-7 name=__codelineno-97-7></a><a href=#__codelineno-97-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-97-8><a id=__codelineno-97-8 name=__codelineno-97-8></a><a href=#__codelineno-97-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-97-9><a id=__codelineno-97-9 name=__codelineno-97-9></a><a href=#__codelineno-97-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-97-10><a id=__codelineno-97-10 name=__codelineno-97-10></a><a href=#__codelineno-97-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-97-11><a id=__codelineno-97-11 name=__codelineno-97-11></a><a href=#__codelineno-97-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-97-12><a id=__codelineno-97-12 name=__codelineno-97-12></a><a href=#__codelineno-97-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-97-13><a id=__codelineno-97-13 name=__codelineno-97-13></a><a href=#__codelineno-97-13><span class=linenos data-linenos="13 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-97-14><a id=__codelineno-97-14 name=__codelineno-97-14></a><a href=#__codelineno-97-14><span class=linenos data-linenos="14 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-97-15><a id=__codelineno-97-15 name=__codelineno-97-15></a><a href=#__codelineno-97-15><span class=linenos data-linenos="15 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-97-16><a id=__codelineno-97-16 name=__codelineno-97-16></a><a href=#__codelineno-97-16><span class=linenos data-linenos="16 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-97-17><a id=__codelineno-97-17 name=__codelineno-97-17></a><a href=#__codelineno-97-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-97-18><a id=__codelineno-97-18 name=__codelineno-97-18></a><a href=#__codelineno-97-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-97-19><a id=__codelineno-97-19 name=__codelineno-97-19></a><a href=#__codelineno-97-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-97-20><a id=__codelineno-97-20 name=__codelineno-97-20></a><a href=#__codelineno-97-20><span class=linenos data-linenos="20 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-97-21><a id=__codelineno-97-21 name=__codelineno-97-21></a><a href=#__codelineno-97-21><span class=linenos data-linenos="21 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-97-22><a id=__codelineno-97-22 name=__codelineno-97-22></a><a href=#__codelineno-97-22><span class=linenos data-linenos="22 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-97-23><a id=__codelineno-97-23 name=__codelineno-97-23></a><a href=#__codelineno-97-23><span class=linenos data-linenos="23 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-97-24><a id=__codelineno-97-24 name=__codelineno-97-24></a><a href=#__codelineno-97-24><span class=linenos data-linenos="24 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-97-25><a id=__codelineno-97-25 name=__codelineno-97-25></a><a href=#__codelineno-97-25><span class=linenos data-linenos="25 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-97-26><a id=__codelineno-97-26 name=__codelineno-97-26></a><a href=#__codelineno-97-26><span class=linenos data-linenos="26 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-97-27><a id=__codelineno-97-27 name=__codelineno-97-27></a><a href=#__codelineno-97-27><span class=linenos data-linenos="27 "></span></a><span class=w>      </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>age</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>25</span><span class=p>))</span>
</span><span id=__span-97-28><a id=__codelineno-97-28 name=__codelineno-97-28></a><a href=#__codelineno-97-28><span class=linenos data-linenos="28 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-97-29><a id=__codelineno-97-29 name=__codelineno-97-29></a><a href=#__codelineno-97-29><span class=linenos data-linenos="29 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-97-30><a id=__codelineno-97-30 name=__codelineno-97-30></a><a href=#__codelineno-97-30><span class=linenos data-linenos="30 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-97-31><a id=__codelineno-97-31 name=__codelineno-97-31></a><a href=#__codelineno-97-31><span class=linenos data-linenos="31 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-97-32><a id=__codelineno-97-32 name=__codelineno-97-32></a><a href=#__codelineno-97-32><span class=linenos data-linenos="32 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-97-33><a id=__codelineno-97-33 name=__codelineno-97-33></a><a href=#__codelineno-97-33><span class=linenos data-linenos="33 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-97-34><a id=__codelineno-97-34 name=__codelineno-97-34></a><a href=#__codelineno-97-34><span class=linenos data-linenos="34 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_strength</span>
</span><span id=__span-97-35><a id=__codelineno-97-35 name=__codelineno-97-35></a><a href=#__codelineno-97-35><span class=linenos data-linenos="35 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-97-36><a id=__codelineno-97-36 name=__codelineno-97-36></a><a href=#__codelineno-97-36><span class=linenos data-linenos="36 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-97-37><a id=__codelineno-97-37 name=__codelineno-97-37></a><a href=#__codelineno-97-37><span class=linenos data-linenos="37 "></span></a><span class=w>      </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-97-38><a id=__codelineno-97-38 name=__codelineno-97-38></a><a href=#__codelineno-97-38><span class=linenos data-linenos="38 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-97-39><a id=__codelineno-97-39 name=__codelineno-97-39></a><a href=#__codelineno-97-39><span class=linenos data-linenos="39 "></span></a><span class=w>         </span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-97-40><a id=__codelineno-97-40 name=__codelineno-97-40></a><a href=#__codelineno-97-40><span class=linenos data-linenos="40 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-97-41><a id=__codelineno-97-41 name=__codelineno-97-41></a><a href=#__codelineno-97-41><span class=linenos data-linenos="41 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-97-42><a id=__codelineno-97-42 name=__codelineno-97-42></a><a href=#__codelineno-97-42><span class=linenos data-linenos="42 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_strength</span>
</span><span id=__span-97-43><a id=__codelineno-97-43 name=__codelineno-97-43></a><a href=#__codelineno-97-43><span class=linenos data-linenos="43 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-97-44><a id=__codelineno-97-44 name=__codelineno-97-44></a><a href=#__codelineno-97-44><span class=linenos data-linenos="44 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-97-45><a id=__codelineno-97-45 name=__codelineno-97-45></a><a href=#__codelineno-97-45><span class=linenos data-linenos="45 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-97-46><a id=__codelineno-97-46 name=__codelineno-97-46></a><a href=#__codelineno-97-46><span class=linenos data-linenos="46 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-97-47><a id=__codelineno-97-47 name=__codelineno-97-47></a><a href=#__codelineno-97-47><span class=linenos data-linenos="47 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-97-48><a id=__codelineno-97-48 name=__codelineno-97-48></a><a href=#__codelineno-97-48><span class=linenos data-linenos="48 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-97-49><a id=__codelineno-97-49 name=__codelineno-97-49></a><a href=#__codelineno-97-49><span class=linenos data-linenos="49 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-97-50><a id=__codelineno-97-50 name=__codelineno-97-50></a><a href=#__codelineno-97-50><span class=linenos data-linenos="50 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-97-51><a id=__codelineno-97-51 name=__codelineno-97-51></a><a href=#__codelineno-97-51><span class=linenos data-linenos="51 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-97-52><a id=__codelineno-97-52 name=__codelineno-97-52></a><a href=#__codelineno-97-52><span class=linenos data-linenos="52 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-97-53><a id=__codelineno-97-53 name=__codelineno-97-53></a><a href=#__codelineno-97-53><span class=linenos data-linenos="53 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-97-54><a id=__codelineno-97-54 name=__codelineno-97-54></a><a href=#__codelineno-97-54><span class=linenos data-linenos="54 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-97-55><a id=__codelineno-97-55 name=__codelineno-97-55></a><a href=#__codelineno-97-55><span class=linenos data-linenos="55 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-97-56><a id=__codelineno-97-56 name=__codelineno-97-56></a><a href=#__codelineno-97-56><span class=linenos data-linenos="56 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-97-57><a id=__codelineno-97-57 name=__codelineno-97-57></a><a href=#__codelineno-97-57><span class=linenos data-linenos="57 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=p>(</span><span class=n>_gsql2rsql_p_name</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>_gsql2rsql_f_name</span><span class=p>)</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-98-1><a id=__codelineno-98-1 name=__codelineno-98-1></a><a href=#__codelineno-98-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-98-2><a id=__codelineno-98-2 name=__codelineno-98-2></a><a href=#__codelineno-98-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-98-3><a id=__codelineno-98-3 name=__codelineno-98-3></a><a href=#__codelineno-98-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-98-4><a id=__codelineno-98-4 name=__codelineno-98-4></a><a href=#__codelineno-98-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-98-5><a id=__codelineno-98-5 name=__codelineno-98-5></a><a href=#__codelineno-98-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-98-6><a id=__codelineno-98-6 name=__codelineno-98-6></a><a href=#__codelineno-98-6><span class=linenos data-linenos=" 6 "></span></a>    Filter: (p.age GT 25)
</span><span id=__span-98-7><a id=__codelineno-98-7 name=__codelineno-98-7></a><a href=#__codelineno-98-7><span class=linenos data-linenos=" 7 "></span></a>*
</span><span id=__span-98-8><a id=__codelineno-98-8 name=__codelineno-98-8></a><a href=#__codelineno-98-8><span class=linenos data-linenos=" 8 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-98-9><a id=__codelineno-98-9 name=__codelineno-98-9></a><a href=#__codelineno-98-9><span class=linenos data-linenos=" 9 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-98-10><a id=__codelineno-98-10 name=__codelineno-98-10></a><a href=#__codelineno-98-10><span class=linenos data-linenos="10 "></span></a>    DataSource: [_anon1:KNOWS]-
</span><span id=__span-98-11><a id=__codelineno-98-11 name=__codelineno-98-11></a><a href=#__codelineno-98-11><span class=linenos data-linenos="11 "></span></a>*
</span><span id=__span-98-12><a id=__codelineno-98-12 name=__codelineno-98-12></a><a href=#__codelineno-98-12><span class=linenos data-linenos="12 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-98-13><a id=__codelineno-98-13 name=__codelineno-98-13></a><a href=#__codelineno-98-13><span class=linenos data-linenos="13 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-98-14><a id=__codelineno-98-14 name=__codelineno-98-14></a><a href=#__codelineno-98-14><span class=linenos data-linenos="14 "></span></a>    DataSource: f:Person
</span><span id=__span-98-15><a id=__codelineno-98-15 name=__codelineno-98-15></a><a href=#__codelineno-98-15><span class=linenos data-linenos="15 "></span></a>*
</span><span id=__span-98-16><a id=__codelineno-98-16 name=__codelineno-98-16></a><a href=#__codelineno-98-16><span class=linenos data-linenos="16 "></span></a>----------------------------------------------------------------------
</span><span id=__span-98-17><a id=__codelineno-98-17 name=__codelineno-98-17></a><a href=#__codelineno-98-17><span class=linenos data-linenos="17 "></span></a>Level 1:
</span><span id=__span-98-18><a id=__codelineno-98-18 name=__codelineno-98-18></a><a href=#__codelineno-98-18><span class=linenos data-linenos="18 "></span></a>----------------------------------------------------------------------
</span><span id=__span-98-19><a id=__codelineno-98-19 name=__codelineno-98-19></a><a href=#__codelineno-98-19><span class=linenos data-linenos="19 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-98-20><a id=__codelineno-98-20 name=__codelineno-98-20></a><a href=#__codelineno-98-20><span class=linenos data-linenos="20 "></span></a>  JoinOperator(id=4)
</span><span id=__span-98-21><a id=__codelineno-98-21 name=__codelineno-98-21></a><a href=#__codelineno-98-21><span class=linenos data-linenos="21 "></span></a>    JoinType: INNER
</span><span id=__span-98-22><a id=__codelineno-98-22 name=__codelineno-98-22></a><a href=#__codelineno-98-22><span class=linenos data-linenos="22 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=EITHER_AS_SOURCE
</span><span id=__span-98-23><a id=__codelineno-98-23 name=__codelineno-98-23></a><a href=#__codelineno-98-23><span class=linenos data-linenos="23 "></span></a>*
</span><span id=__span-98-24><a id=__codelineno-98-24 name=__codelineno-98-24></a><a href=#__codelineno-98-24><span class=linenos data-linenos="24 "></span></a>----------------------------------------------------------------------
</span><span id=__span-98-25><a id=__codelineno-98-25 name=__codelineno-98-25></a><a href=#__codelineno-98-25><span class=linenos data-linenos="25 "></span></a>Level 2:
</span><span id=__span-98-26><a id=__codelineno-98-26 name=__codelineno-98-26></a><a href=#__codelineno-98-26><span class=linenos data-linenos="26 "></span></a>----------------------------------------------------------------------
</span><span id=__span-98-27><a id=__codelineno-98-27 name=__codelineno-98-27></a><a href=#__codelineno-98-27><span class=linenos data-linenos="27 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=7;
</span><span id=__span-98-28><a id=__codelineno-98-28 name=__codelineno-98-28></a><a href=#__codelineno-98-28><span class=linenos data-linenos="28 "></span></a>  JoinOperator(id=5)
</span><span id=__span-98-29><a id=__codelineno-98-29 name=__codelineno-98-29></a><a href=#__codelineno-98-29><span class=linenos data-linenos="29 "></span></a>    JoinType: INNER
</span><span id=__span-98-30><a id=__codelineno-98-30 name=__codelineno-98-30></a><a href=#__codelineno-98-30><span class=linenos data-linenos="30 "></span></a>    Joins: JoinPair: Node=f RelOrNode=_anon1 Type=EITHER_AS_SINK
</span><span id=__span-98-31><a id=__codelineno-98-31 name=__codelineno-98-31></a><a href=#__codelineno-98-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-98-32><a id=__codelineno-98-32 name=__codelineno-98-32></a><a href=#__codelineno-98-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span><span id=__span-98-33><a id=__codelineno-98-33 name=__codelineno-98-33></a><a href=#__codelineno-98-33><span class=linenos data-linenos="33 "></span></a>Level 3:
</span><span id=__span-98-34><a id=__codelineno-98-34 name=__codelineno-98-34></a><a href=#__codelineno-98-34><span class=linenos data-linenos="34 "></span></a>----------------------------------------------------------------------
</span><span id=__span-98-35><a id=__codelineno-98-35 name=__codelineno-98-35></a><a href=#__codelineno-98-35><span class=linenos data-linenos="35 "></span></a>OpId=7 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-98-36><a id=__codelineno-98-36 name=__codelineno-98-36></a><a href=#__codelineno-98-36><span class=linenos data-linenos="36 "></span></a>  ProjectionOperator(id=7)
</span><span id=__span-98-37><a id=__codelineno-98-37 name=__codelineno-98-37></a><a href=#__codelineno-98-37><span class=linenos data-linenos="37 "></span></a>    Projections: name=p.name, name=f.name
</span><span id=__span-98-38><a id=__codelineno-98-38 name=__codelineno-98-38></a><a href=#__codelineno-98-38><span class=linenos data-linenos="38 "></span></a>    Filter: (p.name EQ f.name)
</span><span id=__span-98-39><a id=__codelineno-98-39 name=__codelineno-98-39></a><a href=#__codelineno-98-39><span class=linenos data-linenos="39 "></span></a>*
</span><span id=__span-98-40><a id=__codelineno-98-40 name=__codelineno-98-40></a><a href=#__codelineno-98-40><span class=linenos data-linenos="40 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=34-undirected-multiple-same-variable-predicates-combined>34. Undirected multiple same-variable predicates combined<a class=headerlink href=#34-undirected-multiple-same-variable-predicates-combined title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Predicate Combination</p> <details class=note> <summary>Notes</summary> <p>Multiple predicates for the same variable are combined with AND: - p: (name='Bob' AND age&gt;18 AND active=true)  pushed to DataSource(p) - f: (salary&gt;50000)  pushed to DataSource(f)</p> <p>OPTIMIZATION: All predicates pushed, SelectionOperator removed entirely!</p> <p>SQL Pattern: FROM (SELECT ... FROM Person WHERE name='Bob' AND age&gt;18 AND active=true) AS _left JOIN ... JOIN (SELECT ... FROM Person WHERE salary &gt; 50000) AS _right</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-99-1><a id=__codelineno-99-1 name=__codelineno-99-1></a><a href=#__codelineno-99-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=o>]-</span><span class=p>(</span><span class=n>f</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-99-2><a id=__codelineno-99-2 name=__codelineno-99-2></a><a href=#__codelineno-99-2><span class=linenos data-linenos="2 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&#39;Bob&#39;</span><span class=w> </span><span class=n>AND</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>18</span><span class=w> </span><span class=n>AND</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=k>true</span><span class=w> </span><span class=n>AND</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>50000</span>
</span><span id=__span-99-3><a id=__codelineno-99-3 name=__codelineno-99-3></a><a href=#__codelineno-99-3><span class=linenos data-linenos="3 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>id</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-100-1><a id=__codelineno-100-1 name=__codelineno-100-1></a><a href=#__codelineno-100-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-100-2><a id=__codelineno-100-2 name=__codelineno-100-2></a><a href=#__codelineno-100-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>id</span>
</span><span id=__span-100-3><a id=__codelineno-100-3 name=__codelineno-100-3></a><a href=#__codelineno-100-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>id</span>
</span><span id=__span-100-4><a id=__codelineno-100-4 name=__codelineno-100-4></a><a href=#__codelineno-100-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-100-5><a id=__codelineno-100-5 name=__codelineno-100-5></a><a href=#__codelineno-100-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-100-6><a id=__codelineno-100-6 name=__codelineno-100-6></a><a href=#__codelineno-100-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-100-7><a id=__codelineno-100-7 name=__codelineno-100-7></a><a href=#__codelineno-100-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-100-8><a id=__codelineno-100-8 name=__codelineno-100-8></a><a href=#__codelineno-100-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-100-9><a id=__codelineno-100-9 name=__codelineno-100-9></a><a href=#__codelineno-100-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_active</span>
</span><span id=__span-100-10><a id=__codelineno-100-10 name=__codelineno-100-10></a><a href=#__codelineno-100-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-100-11><a id=__codelineno-100-11 name=__codelineno-100-11></a><a href=#__codelineno-100-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-100-12><a id=__codelineno-100-12 name=__codelineno-100-12></a><a href=#__codelineno-100-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-100-13><a id=__codelineno-100-13 name=__codelineno-100-13></a><a href=#__codelineno-100-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_salary</span>
</span><span id=__span-100-14><a id=__codelineno-100-14 name=__codelineno-100-14></a><a href=#__codelineno-100-14><span class=linenos data-linenos="14 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-100-15><a id=__codelineno-100-15 name=__codelineno-100-15></a><a href=#__codelineno-100-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-100-16><a id=__codelineno-100-16 name=__codelineno-100-16></a><a href=#__codelineno-100-16><span class=linenos data-linenos="16 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-100-17><a id=__codelineno-100-17 name=__codelineno-100-17></a><a href=#__codelineno-100-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-100-18><a id=__codelineno-100-18 name=__codelineno-100-18></a><a href=#__codelineno-100-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-100-19><a id=__codelineno-100-19 name=__codelineno-100-19></a><a href=#__codelineno-100-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_active</span>
</span><span id=__span-100-20><a id=__codelineno-100-20 name=__codelineno-100-20></a><a href=#__codelineno-100-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-100-21><a id=__codelineno-100-21 name=__codelineno-100-21></a><a href=#__codelineno-100-21><span class=linenos data-linenos="21 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-100-22><a id=__codelineno-100-22 name=__codelineno-100-22></a><a href=#__codelineno-100-22><span class=linenos data-linenos="22 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-100-23><a id=__codelineno-100-23 name=__codelineno-100-23></a><a href=#__codelineno-100-23><span class=linenos data-linenos="23 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-100-24><a id=__codelineno-100-24 name=__codelineno-100-24></a><a href=#__codelineno-100-24><span class=linenos data-linenos="24 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-100-25><a id=__codelineno-100-25 name=__codelineno-100-25></a><a href=#__codelineno-100-25><span class=linenos data-linenos="25 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-100-26><a id=__codelineno-100-26 name=__codelineno-100-26></a><a href=#__codelineno-100-26><span class=linenos data-linenos="26 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-100-27><a id=__codelineno-100-27 name=__codelineno-100-27></a><a href=#__codelineno-100-27><span class=linenos data-linenos="27 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_active</span>
</span><span id=__span-100-28><a id=__codelineno-100-28 name=__codelineno-100-28></a><a href=#__codelineno-100-28><span class=linenos data-linenos="28 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-100-29><a id=__codelineno-100-29 name=__codelineno-100-29></a><a href=#__codelineno-100-29><span class=linenos data-linenos="29 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-100-30><a id=__codelineno-100-30 name=__codelineno-100-30></a><a href=#__codelineno-100-30><span class=linenos data-linenos="30 "></span></a><span class=w>      </span><span class=k>WHERE</span><span class=w> </span><span class=p>((((</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Bob&#39;</span><span class=p>))</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=p>((</span><span class=n>age</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>18</span><span class=p>)))</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=p>((</span><span class=n>active</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=k>TRUE</span><span class=p>)))</span>
</span><span id=__span-100-31><a id=__codelineno-100-31 name=__codelineno-100-31></a><a href=#__codelineno-100-31><span class=linenos data-linenos="31 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-100-32><a id=__codelineno-100-32 name=__codelineno-100-32></a><a href=#__codelineno-100-32><span class=linenos data-linenos="32 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-100-33><a id=__codelineno-100-33 name=__codelineno-100-33></a><a href=#__codelineno-100-33><span class=linenos data-linenos="33 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-100-34><a id=__codelineno-100-34 name=__codelineno-100-34></a><a href=#__codelineno-100-34><span class=linenos data-linenos="34 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-100-35><a id=__codelineno-100-35 name=__codelineno-100-35></a><a href=#__codelineno-100-35><span class=linenos data-linenos="35 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-100-36><a id=__codelineno-100-36 name=__codelineno-100-36></a><a href=#__codelineno-100-36><span class=linenos data-linenos="36 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-100-37><a id=__codelineno-100-37 name=__codelineno-100-37></a><a href=#__codelineno-100-37><span class=linenos data-linenos="37 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_strength</span>
</span><span id=__span-100-38><a id=__codelineno-100-38 name=__codelineno-100-38></a><a href=#__codelineno-100-38><span class=linenos data-linenos="38 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-100-39><a id=__codelineno-100-39 name=__codelineno-100-39></a><a href=#__codelineno-100-39><span class=linenos data-linenos="39 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-100-40><a id=__codelineno-100-40 name=__codelineno-100-40></a><a href=#__codelineno-100-40><span class=linenos data-linenos="40 "></span></a><span class=w>      </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-100-41><a id=__codelineno-100-41 name=__codelineno-100-41></a><a href=#__codelineno-100-41><span class=linenos data-linenos="41 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-100-42><a id=__codelineno-100-42 name=__codelineno-100-42></a><a href=#__codelineno-100-42><span class=linenos data-linenos="42 "></span></a><span class=w>         </span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-100-43><a id=__codelineno-100-43 name=__codelineno-100-43></a><a href=#__codelineno-100-43><span class=linenos data-linenos="43 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-100-44><a id=__codelineno-100-44 name=__codelineno-100-44></a><a href=#__codelineno-100-44><span class=linenos data-linenos="44 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-100-45><a id=__codelineno-100-45 name=__codelineno-100-45></a><a href=#__codelineno-100-45><span class=linenos data-linenos="45 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_strength</span>
</span><span id=__span-100-46><a id=__codelineno-100-46 name=__codelineno-100-46></a><a href=#__codelineno-100-46><span class=linenos data-linenos="46 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-100-47><a id=__codelineno-100-47 name=__codelineno-100-47></a><a href=#__codelineno-100-47><span class=linenos data-linenos="47 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-100-48><a id=__codelineno-100-48 name=__codelineno-100-48></a><a href=#__codelineno-100-48><span class=linenos data-linenos="48 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-100-49><a id=__codelineno-100-49 name=__codelineno-100-49></a><a href=#__codelineno-100-49><span class=linenos data-linenos="49 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-100-50><a id=__codelineno-100-50 name=__codelineno-100-50></a><a href=#__codelineno-100-50><span class=linenos data-linenos="50 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-100-51><a id=__codelineno-100-51 name=__codelineno-100-51></a><a href=#__codelineno-100-51><span class=linenos data-linenos="51 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-100-52><a id=__codelineno-100-52 name=__codelineno-100-52></a><a href=#__codelineno-100-52><span class=linenos data-linenos="52 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-100-53><a id=__codelineno-100-53 name=__codelineno-100-53></a><a href=#__codelineno-100-53><span class=linenos data-linenos="53 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-100-54><a id=__codelineno-100-54 name=__codelineno-100-54></a><a href=#__codelineno-100-54><span class=linenos data-linenos="54 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_salary</span>
</span><span id=__span-100-55><a id=__codelineno-100-55 name=__codelineno-100-55></a><a href=#__codelineno-100-55><span class=linenos data-linenos="55 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-100-56><a id=__codelineno-100-56 name=__codelineno-100-56></a><a href=#__codelineno-100-56><span class=linenos data-linenos="56 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-100-57><a id=__codelineno-100-57 name=__codelineno-100-57></a><a href=#__codelineno-100-57><span class=linenos data-linenos="57 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>salary</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>50000</span><span class=p>))</span>
</span><span id=__span-100-58><a id=__codelineno-100-58 name=__codelineno-100-58></a><a href=#__codelineno-100-58><span class=linenos data-linenos="58 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-100-59><a id=__codelineno-100-59 name=__codelineno-100-59></a><a href=#__codelineno-100-59><span class=linenos data-linenos="59 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-100-60><a id=__codelineno-100-60 name=__codelineno-100-60></a><a href=#__codelineno-100-60><span class=linenos data-linenos="60 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-101-1><a id=__codelineno-101-1 name=__codelineno-101-1></a><a href=#__codelineno-101-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-101-2><a id=__codelineno-101-2 name=__codelineno-101-2></a><a href=#__codelineno-101-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-101-3><a id=__codelineno-101-3 name=__codelineno-101-3></a><a href=#__codelineno-101-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-101-4><a id=__codelineno-101-4 name=__codelineno-101-4></a><a href=#__codelineno-101-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-101-5><a id=__codelineno-101-5 name=__codelineno-101-5></a><a href=#__codelineno-101-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-101-6><a id=__codelineno-101-6 name=__codelineno-101-6></a><a href=#__codelineno-101-6><span class=linenos data-linenos=" 6 "></span></a>    Filter: (((p.name EQ &#39;Bob&#39;) AND (p.age GT 18)) AND (p.active EQ true))
</span><span id=__span-101-7><a id=__codelineno-101-7 name=__codelineno-101-7></a><a href=#__codelineno-101-7><span class=linenos data-linenos=" 7 "></span></a>*
</span><span id=__span-101-8><a id=__codelineno-101-8 name=__codelineno-101-8></a><a href=#__codelineno-101-8><span class=linenos data-linenos=" 8 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-101-9><a id=__codelineno-101-9 name=__codelineno-101-9></a><a href=#__codelineno-101-9><span class=linenos data-linenos=" 9 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-101-10><a id=__codelineno-101-10 name=__codelineno-101-10></a><a href=#__codelineno-101-10><span class=linenos data-linenos="10 "></span></a>    DataSource: [_anon1:KNOWS]-
</span><span id=__span-101-11><a id=__codelineno-101-11 name=__codelineno-101-11></a><a href=#__codelineno-101-11><span class=linenos data-linenos="11 "></span></a>*
</span><span id=__span-101-12><a id=__codelineno-101-12 name=__codelineno-101-12></a><a href=#__codelineno-101-12><span class=linenos data-linenos="12 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-101-13><a id=__codelineno-101-13 name=__codelineno-101-13></a><a href=#__codelineno-101-13><span class=linenos data-linenos="13 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-101-14><a id=__codelineno-101-14 name=__codelineno-101-14></a><a href=#__codelineno-101-14><span class=linenos data-linenos="14 "></span></a>    DataSource: f:Person
</span><span id=__span-101-15><a id=__codelineno-101-15 name=__codelineno-101-15></a><a href=#__codelineno-101-15><span class=linenos data-linenos="15 "></span></a>    Filter: (f.salary GT 50000)
</span><span id=__span-101-16><a id=__codelineno-101-16 name=__codelineno-101-16></a><a href=#__codelineno-101-16><span class=linenos data-linenos="16 "></span></a>*
</span><span id=__span-101-17><a id=__codelineno-101-17 name=__codelineno-101-17></a><a href=#__codelineno-101-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-101-18><a id=__codelineno-101-18 name=__codelineno-101-18></a><a href=#__codelineno-101-18><span class=linenos data-linenos="18 "></span></a>Level 1:
</span><span id=__span-101-19><a id=__codelineno-101-19 name=__codelineno-101-19></a><a href=#__codelineno-101-19><span class=linenos data-linenos="19 "></span></a>----------------------------------------------------------------------
</span><span id=__span-101-20><a id=__codelineno-101-20 name=__codelineno-101-20></a><a href=#__codelineno-101-20><span class=linenos data-linenos="20 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-101-21><a id=__codelineno-101-21 name=__codelineno-101-21></a><a href=#__codelineno-101-21><span class=linenos data-linenos="21 "></span></a>  JoinOperator(id=4)
</span><span id=__span-101-22><a id=__codelineno-101-22 name=__codelineno-101-22></a><a href=#__codelineno-101-22><span class=linenos data-linenos="22 "></span></a>    JoinType: INNER
</span><span id=__span-101-23><a id=__codelineno-101-23 name=__codelineno-101-23></a><a href=#__codelineno-101-23><span class=linenos data-linenos="23 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=EITHER_AS_SOURCE
</span><span id=__span-101-24><a id=__codelineno-101-24 name=__codelineno-101-24></a><a href=#__codelineno-101-24><span class=linenos data-linenos="24 "></span></a>*
</span><span id=__span-101-25><a id=__codelineno-101-25 name=__codelineno-101-25></a><a href=#__codelineno-101-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-101-26><a id=__codelineno-101-26 name=__codelineno-101-26></a><a href=#__codelineno-101-26><span class=linenos data-linenos="26 "></span></a>Level 2:
</span><span id=__span-101-27><a id=__codelineno-101-27 name=__codelineno-101-27></a><a href=#__codelineno-101-27><span class=linenos data-linenos="27 "></span></a>----------------------------------------------------------------------
</span><span id=__span-101-28><a id=__codelineno-101-28 name=__codelineno-101-28></a><a href=#__codelineno-101-28><span class=linenos data-linenos="28 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=7;
</span><span id=__span-101-29><a id=__codelineno-101-29 name=__codelineno-101-29></a><a href=#__codelineno-101-29><span class=linenos data-linenos="29 "></span></a>  JoinOperator(id=5)
</span><span id=__span-101-30><a id=__codelineno-101-30 name=__codelineno-101-30></a><a href=#__codelineno-101-30><span class=linenos data-linenos="30 "></span></a>    JoinType: INNER
</span><span id=__span-101-31><a id=__codelineno-101-31 name=__codelineno-101-31></a><a href=#__codelineno-101-31><span class=linenos data-linenos="31 "></span></a>    Joins: JoinPair: Node=f RelOrNode=_anon1 Type=EITHER_AS_SINK
</span><span id=__span-101-32><a id=__codelineno-101-32 name=__codelineno-101-32></a><a href=#__codelineno-101-32><span class=linenos data-linenos="32 "></span></a>*
</span><span id=__span-101-33><a id=__codelineno-101-33 name=__codelineno-101-33></a><a href=#__codelineno-101-33><span class=linenos data-linenos="33 "></span></a>----------------------------------------------------------------------
</span><span id=__span-101-34><a id=__codelineno-101-34 name=__codelineno-101-34></a><a href=#__codelineno-101-34><span class=linenos data-linenos="34 "></span></a>Level 3:
</span><span id=__span-101-35><a id=__codelineno-101-35 name=__codelineno-101-35></a><a href=#__codelineno-101-35><span class=linenos data-linenos="35 "></span></a>----------------------------------------------------------------------
</span><span id=__span-101-36><a id=__codelineno-101-36 name=__codelineno-101-36></a><a href=#__codelineno-101-36><span class=linenos data-linenos="36 "></span></a>OpId=7 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-101-37><a id=__codelineno-101-37 name=__codelineno-101-37></a><a href=#__codelineno-101-37><span class=linenos data-linenos="37 "></span></a>  ProjectionOperator(id=7)
</span><span id=__span-101-38><a id=__codelineno-101-38 name=__codelineno-101-38></a><a href=#__codelineno-101-38><span class=linenos data-linenos="38 "></span></a>    Projections: id=p.id, id=f.id
</span><span id=__span-101-39><a id=__codelineno-101-39 name=__codelineno-101-39></a><a href=#__codelineno-101-39><span class=linenos data-linenos="39 "></span></a>*
</span><span id=__span-101-40><a id=__codelineno-101-40 name=__codelineno-101-40></a><a href=#__codelineno-101-40><span class=linenos data-linenos="40 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=35-undirected-with-or-predicate-cannot-split>35. Undirected with OR predicate - cannot split<a class=headerlink href=#35-undirected-with-or-predicate-cannot-split title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: OR Predicate Handling</p> <details class=note> <summary>Notes</summary> <p>OR predicates CANNOT be split! This is algebraically unsafe: _{p(A)  q(B)}(A  B)  _{p(A)}(A)  _{q(B)}(B)</p> <p>If we pushed, we'd miss rows where: - p.name != 'Alice' but f.age &gt; 30</p> <p>RESULT: Entire predicate stays in Selection (no pushdown).</p> <p>TODO: Future optimization could rewrite as UNION: (MATCH ... WHERE p.name='Alice') UNION (MATCH ... WHERE f.age &gt; 30)</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-102-1><a id=__codelineno-102-1 name=__codelineno-102-1></a><a href=#__codelineno-102-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=o>]-</span><span class=p>(</span><span class=n>f</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-102-2><a id=__codelineno-102-2 name=__codelineno-102-2></a><a href=#__codelineno-102-2><span class=linenos data-linenos="2 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&#39;Alice&#39;</span><span class=w> </span><span class=n>OR</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>30</span>
</span><span id=__span-102-3><a id=__codelineno-102-3 name=__codelineno-102-3></a><a href=#__codelineno-102-3><span class=linenos data-linenos="3 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>name</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-103-1><a id=__codelineno-103-1 name=__codelineno-103-1></a><a href=#__codelineno-103-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-103-2><a id=__codelineno-103-2 name=__codelineno-103-2></a><a href=#__codelineno-103-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-103-3><a id=__codelineno-103-3 name=__codelineno-103-3></a><a href=#__codelineno-103-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-103-4><a id=__codelineno-103-4 name=__codelineno-103-4></a><a href=#__codelineno-103-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-103-5><a id=__codelineno-103-5 name=__codelineno-103-5></a><a href=#__codelineno-103-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-103-6><a id=__codelineno-103-6 name=__codelineno-103-6></a><a href=#__codelineno-103-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-103-7><a id=__codelineno-103-7 name=__codelineno-103-7></a><a href=#__codelineno-103-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-103-8><a id=__codelineno-103-8 name=__codelineno-103-8></a><a href=#__codelineno-103-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-103-9><a id=__codelineno-103-9 name=__codelineno-103-9></a><a href=#__codelineno-103-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-103-10><a id=__codelineno-103-10 name=__codelineno-103-10></a><a href=#__codelineno-103-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-103-11><a id=__codelineno-103-11 name=__codelineno-103-11></a><a href=#__codelineno-103-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-103-12><a id=__codelineno-103-12 name=__codelineno-103-12></a><a href=#__codelineno-103-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_age</span>
</span><span id=__span-103-13><a id=__codelineno-103-13 name=__codelineno-103-13></a><a href=#__codelineno-103-13><span class=linenos data-linenos="13 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-103-14><a id=__codelineno-103-14 name=__codelineno-103-14></a><a href=#__codelineno-103-14><span class=linenos data-linenos="14 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-103-15><a id=__codelineno-103-15 name=__codelineno-103-15></a><a href=#__codelineno-103-15><span class=linenos data-linenos="15 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-103-16><a id=__codelineno-103-16 name=__codelineno-103-16></a><a href=#__codelineno-103-16><span class=linenos data-linenos="16 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-103-17><a id=__codelineno-103-17 name=__codelineno-103-17></a><a href=#__codelineno-103-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-103-18><a id=__codelineno-103-18 name=__codelineno-103-18></a><a href=#__codelineno-103-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-103-19><a id=__codelineno-103-19 name=__codelineno-103-19></a><a href=#__codelineno-103-19><span class=linenos data-linenos="19 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-103-20><a id=__codelineno-103-20 name=__codelineno-103-20></a><a href=#__codelineno-103-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-103-21><a id=__codelineno-103-21 name=__codelineno-103-21></a><a href=#__codelineno-103-21><span class=linenos data-linenos="21 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-103-22><a id=__codelineno-103-22 name=__codelineno-103-22></a><a href=#__codelineno-103-22><span class=linenos data-linenos="22 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-103-23><a id=__codelineno-103-23 name=__codelineno-103-23></a><a href=#__codelineno-103-23><span class=linenos data-linenos="23 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-103-24><a id=__codelineno-103-24 name=__codelineno-103-24></a><a href=#__codelineno-103-24><span class=linenos data-linenos="24 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-103-25><a id=__codelineno-103-25 name=__codelineno-103-25></a><a href=#__codelineno-103-25><span class=linenos data-linenos="25 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-103-26><a id=__codelineno-103-26 name=__codelineno-103-26></a><a href=#__codelineno-103-26><span class=linenos data-linenos="26 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-103-27><a id=__codelineno-103-27 name=__codelineno-103-27></a><a href=#__codelineno-103-27><span class=linenos data-linenos="27 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-103-28><a id=__codelineno-103-28 name=__codelineno-103-28></a><a href=#__codelineno-103-28><span class=linenos data-linenos="28 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-103-29><a id=__codelineno-103-29 name=__codelineno-103-29></a><a href=#__codelineno-103-29><span class=linenos data-linenos="29 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-103-30><a id=__codelineno-103-30 name=__codelineno-103-30></a><a href=#__codelineno-103-30><span class=linenos data-linenos="30 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-103-31><a id=__codelineno-103-31 name=__codelineno-103-31></a><a href=#__codelineno-103-31><span class=linenos data-linenos="31 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_strength</span>
</span><span id=__span-103-32><a id=__codelineno-103-32 name=__codelineno-103-32></a><a href=#__codelineno-103-32><span class=linenos data-linenos="32 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-103-33><a id=__codelineno-103-33 name=__codelineno-103-33></a><a href=#__codelineno-103-33><span class=linenos data-linenos="33 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-103-34><a id=__codelineno-103-34 name=__codelineno-103-34></a><a href=#__codelineno-103-34><span class=linenos data-linenos="34 "></span></a><span class=w>      </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-103-35><a id=__codelineno-103-35 name=__codelineno-103-35></a><a href=#__codelineno-103-35><span class=linenos data-linenos="35 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-103-36><a id=__codelineno-103-36 name=__codelineno-103-36></a><a href=#__codelineno-103-36><span class=linenos data-linenos="36 "></span></a><span class=w>         </span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-103-37><a id=__codelineno-103-37 name=__codelineno-103-37></a><a href=#__codelineno-103-37><span class=linenos data-linenos="37 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-103-38><a id=__codelineno-103-38 name=__codelineno-103-38></a><a href=#__codelineno-103-38><span class=linenos data-linenos="38 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-103-39><a id=__codelineno-103-39 name=__codelineno-103-39></a><a href=#__codelineno-103-39><span class=linenos data-linenos="39 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_strength</span>
</span><span id=__span-103-40><a id=__codelineno-103-40 name=__codelineno-103-40></a><a href=#__codelineno-103-40><span class=linenos data-linenos="40 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-103-41><a id=__codelineno-103-41 name=__codelineno-103-41></a><a href=#__codelineno-103-41><span class=linenos data-linenos="41 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-103-42><a id=__codelineno-103-42 name=__codelineno-103-42></a><a href=#__codelineno-103-42><span class=linenos data-linenos="42 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-103-43><a id=__codelineno-103-43 name=__codelineno-103-43></a><a href=#__codelineno-103-43><span class=linenos data-linenos="43 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-103-44><a id=__codelineno-103-44 name=__codelineno-103-44></a><a href=#__codelineno-103-44><span class=linenos data-linenos="44 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-103-45><a id=__codelineno-103-45 name=__codelineno-103-45></a><a href=#__codelineno-103-45><span class=linenos data-linenos="45 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-103-46><a id=__codelineno-103-46 name=__codelineno-103-46></a><a href=#__codelineno-103-46><span class=linenos data-linenos="46 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-103-47><a id=__codelineno-103-47 name=__codelineno-103-47></a><a href=#__codelineno-103-47><span class=linenos data-linenos="47 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-103-48><a id=__codelineno-103-48 name=__codelineno-103-48></a><a href=#__codelineno-103-48><span class=linenos data-linenos="48 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-103-49><a id=__codelineno-103-49 name=__codelineno-103-49></a><a href=#__codelineno-103-49><span class=linenos data-linenos="49 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_age</span>
</span><span id=__span-103-50><a id=__codelineno-103-50 name=__codelineno-103-50></a><a href=#__codelineno-103-50><span class=linenos data-linenos="50 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-103-51><a id=__codelineno-103-51 name=__codelineno-103-51></a><a href=#__codelineno-103-51><span class=linenos data-linenos="51 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-103-52><a id=__codelineno-103-52 name=__codelineno-103-52></a><a href=#__codelineno-103-52><span class=linenos data-linenos="52 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-103-53><a id=__codelineno-103-53 name=__codelineno-103-53></a><a href=#__codelineno-103-53><span class=linenos data-linenos="53 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-103-54><a id=__codelineno-103-54 name=__codelineno-103-54></a><a href=#__codelineno-103-54><span class=linenos data-linenos="54 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-103-55><a id=__codelineno-103-55 name=__codelineno-103-55></a><a href=#__codelineno-103-55><span class=linenos data-linenos="55 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>_gsql2rsql_p_name</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Alice&#39;</span><span class=p>))</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=p>((</span><span class=n>_gsql2rsql_f_age</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>30</span><span class=p>))</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-104-1><a id=__codelineno-104-1 name=__codelineno-104-1></a><a href=#__codelineno-104-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-104-2><a id=__codelineno-104-2 name=__codelineno-104-2></a><a href=#__codelineno-104-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-104-3><a id=__codelineno-104-3 name=__codelineno-104-3></a><a href=#__codelineno-104-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-104-4><a id=__codelineno-104-4 name=__codelineno-104-4></a><a href=#__codelineno-104-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-104-5><a id=__codelineno-104-5 name=__codelineno-104-5></a><a href=#__codelineno-104-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-104-6><a id=__codelineno-104-6 name=__codelineno-104-6></a><a href=#__codelineno-104-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-104-7><a id=__codelineno-104-7 name=__codelineno-104-7></a><a href=#__codelineno-104-7><span class=linenos data-linenos=" 7 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-104-8><a id=__codelineno-104-8 name=__codelineno-104-8></a><a href=#__codelineno-104-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-104-9><a id=__codelineno-104-9 name=__codelineno-104-9></a><a href=#__codelineno-104-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: [_anon1:KNOWS]-
</span><span id=__span-104-10><a id=__codelineno-104-10 name=__codelineno-104-10></a><a href=#__codelineno-104-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-104-11><a id=__codelineno-104-11 name=__codelineno-104-11></a><a href=#__codelineno-104-11><span class=linenos data-linenos="11 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-104-12><a id=__codelineno-104-12 name=__codelineno-104-12></a><a href=#__codelineno-104-12><span class=linenos data-linenos="12 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-104-13><a id=__codelineno-104-13 name=__codelineno-104-13></a><a href=#__codelineno-104-13><span class=linenos data-linenos="13 "></span></a>    DataSource: f:Person
</span><span id=__span-104-14><a id=__codelineno-104-14 name=__codelineno-104-14></a><a href=#__codelineno-104-14><span class=linenos data-linenos="14 "></span></a>*
</span><span id=__span-104-15><a id=__codelineno-104-15 name=__codelineno-104-15></a><a href=#__codelineno-104-15><span class=linenos data-linenos="15 "></span></a>----------------------------------------------------------------------
</span><span id=__span-104-16><a id=__codelineno-104-16 name=__codelineno-104-16></a><a href=#__codelineno-104-16><span class=linenos data-linenos="16 "></span></a>Level 1:
</span><span id=__span-104-17><a id=__codelineno-104-17 name=__codelineno-104-17></a><a href=#__codelineno-104-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-104-18><a id=__codelineno-104-18 name=__codelineno-104-18></a><a href=#__codelineno-104-18><span class=linenos data-linenos="18 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-104-19><a id=__codelineno-104-19 name=__codelineno-104-19></a><a href=#__codelineno-104-19><span class=linenos data-linenos="19 "></span></a>  JoinOperator(id=4)
</span><span id=__span-104-20><a id=__codelineno-104-20 name=__codelineno-104-20></a><a href=#__codelineno-104-20><span class=linenos data-linenos="20 "></span></a>    JoinType: INNER
</span><span id=__span-104-21><a id=__codelineno-104-21 name=__codelineno-104-21></a><a href=#__codelineno-104-21><span class=linenos data-linenos="21 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=EITHER_AS_SOURCE
</span><span id=__span-104-22><a id=__codelineno-104-22 name=__codelineno-104-22></a><a href=#__codelineno-104-22><span class=linenos data-linenos="22 "></span></a>*
</span><span id=__span-104-23><a id=__codelineno-104-23 name=__codelineno-104-23></a><a href=#__codelineno-104-23><span class=linenos data-linenos="23 "></span></a>----------------------------------------------------------------------
</span><span id=__span-104-24><a id=__codelineno-104-24 name=__codelineno-104-24></a><a href=#__codelineno-104-24><span class=linenos data-linenos="24 "></span></a>Level 2:
</span><span id=__span-104-25><a id=__codelineno-104-25 name=__codelineno-104-25></a><a href=#__codelineno-104-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-104-26><a id=__codelineno-104-26 name=__codelineno-104-26></a><a href=#__codelineno-104-26><span class=linenos data-linenos="26 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=7;
</span><span id=__span-104-27><a id=__codelineno-104-27 name=__codelineno-104-27></a><a href=#__codelineno-104-27><span class=linenos data-linenos="27 "></span></a>  JoinOperator(id=5)
</span><span id=__span-104-28><a id=__codelineno-104-28 name=__codelineno-104-28></a><a href=#__codelineno-104-28><span class=linenos data-linenos="28 "></span></a>    JoinType: INNER
</span><span id=__span-104-29><a id=__codelineno-104-29 name=__codelineno-104-29></a><a href=#__codelineno-104-29><span class=linenos data-linenos="29 "></span></a>    Joins: JoinPair: Node=f RelOrNode=_anon1 Type=EITHER_AS_SINK
</span><span id=__span-104-30><a id=__codelineno-104-30 name=__codelineno-104-30></a><a href=#__codelineno-104-30><span class=linenos data-linenos="30 "></span></a>*
</span><span id=__span-104-31><a id=__codelineno-104-31 name=__codelineno-104-31></a><a href=#__codelineno-104-31><span class=linenos data-linenos="31 "></span></a>----------------------------------------------------------------------
</span><span id=__span-104-32><a id=__codelineno-104-32 name=__codelineno-104-32></a><a href=#__codelineno-104-32><span class=linenos data-linenos="32 "></span></a>Level 3:
</span><span id=__span-104-33><a id=__codelineno-104-33 name=__codelineno-104-33></a><a href=#__codelineno-104-33><span class=linenos data-linenos="33 "></span></a>----------------------------------------------------------------------
</span><span id=__span-104-34><a id=__codelineno-104-34 name=__codelineno-104-34></a><a href=#__codelineno-104-34><span class=linenos data-linenos="34 "></span></a>OpId=7 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-104-35><a id=__codelineno-104-35 name=__codelineno-104-35></a><a href=#__codelineno-104-35><span class=linenos data-linenos="35 "></span></a>  ProjectionOperator(id=7)
</span><span id=__span-104-36><a id=__codelineno-104-36 name=__codelineno-104-36></a><a href=#__codelineno-104-36><span class=linenos data-linenos="36 "></span></a>    Projections: name=p.name, name=f.name
</span><span id=__span-104-37><a id=__codelineno-104-37 name=__codelineno-104-37></a><a href=#__codelineno-104-37><span class=linenos data-linenos="37 "></span></a>    Filter: ((p.name EQ &#39;Alice&#39;) OR (f.age GT 30))
</span><span id=__span-104-38><a id=__codelineno-104-38 name=__codelineno-104-38></a><a href=#__codelineno-104-38><span class=linenos data-linenos="38 "></span></a>*
</span><span id=__span-104-39><a id=__codelineno-104-39 name=__codelineno-104-39></a><a href=#__codelineno-104-39><span class=linenos data-linenos="39 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=36-undirected-three-way-mixed-filters>36. Undirected three-way mixed filters<a class=headerlink href=#36-undirected-three-way-mixed-filters title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Complex Conjunction Splitting</p> <details class=note> <summary>Notes</summary> <p>Three-way join with filters on all three entities: - p.age &gt; 25  pushed to DataSource(p) - f.salary &gt; 50000  pushed to DataSource(f) - c.industry = 'Tech'  pushed to DataSource&copy;</p> <p>BENEFIT: All three table scans are filtered before any joins! The SelectionOperator is completely removed.</p> <p>SQL Pattern: FROM (SELECT ... FROM Person WHERE age &gt; 25) AS p JOIN ... JOIN (SELECT ... FROM Person WHERE salary &gt; 50000) AS f JOIN ... JOIN (SELECT ... FROM Company WHERE industry = 'Tech') AS c</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-105-1><a id=__codelineno-105-1 name=__codelineno-105-1></a><a href=#__codelineno-105-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=o>]</span><span class=err>-</span><span class=p>(</span><span class=n>f</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=err>-</span><span class=o>[</span><span class=p>:</span><span class=n>WORKS_AT</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>c</span><span class=p>:</span><span class=n>Company</span><span class=p>)</span>
</span><span id=__span-105-2><a id=__codelineno-105-2 name=__codelineno-105-2></a><a href=#__codelineno-105-2><span class=linenos data-linenos="2 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>25</span><span class=w> </span><span class=n>AND</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>50000</span><span class=w> </span><span class=n>AND</span><span class=w> </span><span class=n>c</span><span class=p>.</span><span class=n>industry</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&#39;Tech&#39;</span>
</span><span id=__span-105-3><a id=__codelineno-105-3 name=__codelineno-105-3></a><a href=#__codelineno-105-3><span class=linenos data-linenos="3 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>.</span><span class=n>name</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-106-1><a id=__codelineno-106-1 name=__codelineno-106-1></a><a href=#__codelineno-106-1><span class=linenos data-linenos="  1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-106-2><a id=__codelineno-106-2 name=__codelineno-106-2></a><a href=#__codelineno-106-2><span class=linenos data-linenos="  2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-106-3><a id=__codelineno-106-3 name=__codelineno-106-3></a><a href=#__codelineno-106-3><span class=linenos data-linenos="  3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-106-4><a id=__codelineno-106-4 name=__codelineno-106-4></a><a href=#__codelineno-106-4><span class=linenos data-linenos="  4 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_c_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-106-5><a id=__codelineno-106-5 name=__codelineno-106-5></a><a href=#__codelineno-106-5><span class=linenos data-linenos="  5 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-106-6><a id=__codelineno-106-6 name=__codelineno-106-6></a><a href=#__codelineno-106-6><span class=linenos data-linenos="  6 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-106-7><a id=__codelineno-106-7 name=__codelineno-106-7></a><a href=#__codelineno-106-7><span class=linenos data-linenos="  7 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-106-8><a id=__codelineno-106-8 name=__codelineno-106-8></a><a href=#__codelineno-106-8><span class=linenos data-linenos="  8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-106-9><a id=__codelineno-106-9 name=__codelineno-106-9></a><a href=#__codelineno-106-9><span class=linenos data-linenos="  9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-106-10><a id=__codelineno-106-10 name=__codelineno-106-10></a><a href=#__codelineno-106-10><span class=linenos data-linenos=" 10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-106-11><a id=__codelineno-106-11 name=__codelineno-106-11></a><a href=#__codelineno-106-11><span class=linenos data-linenos=" 11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-106-12><a id=__codelineno-106-12 name=__codelineno-106-12></a><a href=#__codelineno-106-12><span class=linenos data-linenos=" 12 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-106-13><a id=__codelineno-106-13 name=__codelineno-106-13></a><a href=#__codelineno-106-13><span class=linenos data-linenos=" 13 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-106-14><a id=__codelineno-106-14 name=__codelineno-106-14></a><a href=#__codelineno-106-14><span class=linenos data-linenos=" 14 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_salary</span>
</span><span id=__span-106-15><a id=__codelineno-106-15 name=__codelineno-106-15></a><a href=#__codelineno-106-15><span class=linenos data-linenos=" 15 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_person_id</span>
</span><span id=__span-106-16><a id=__codelineno-106-16 name=__codelineno-106-16></a><a href=#__codelineno-106-16><span class=linenos data-linenos=" 16 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_company_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_company_id</span>
</span><span id=__span-106-17><a id=__codelineno-106-17 name=__codelineno-106-17></a><a href=#__codelineno-106-17><span class=linenos data-linenos=" 17 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-106-18><a id=__codelineno-106-18 name=__codelineno-106-18></a><a href=#__codelineno-106-18><span class=linenos data-linenos=" 18 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span><span id=__span-106-19><a id=__codelineno-106-19 name=__codelineno-106-19></a><a href=#__codelineno-106-19><span class=linenos data-linenos=" 19 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_industry</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_industry</span>
</span><span id=__span-106-20><a id=__codelineno-106-20 name=__codelineno-106-20></a><a href=#__codelineno-106-20><span class=linenos data-linenos=" 20 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-106-21><a id=__codelineno-106-21 name=__codelineno-106-21></a><a href=#__codelineno-106-21><span class=linenos data-linenos=" 21 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-106-22><a id=__codelineno-106-22 name=__codelineno-106-22></a><a href=#__codelineno-106-22><span class=linenos data-linenos=" 22 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-106-23><a id=__codelineno-106-23 name=__codelineno-106-23></a><a href=#__codelineno-106-23><span class=linenos data-linenos=" 23 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-106-24><a id=__codelineno-106-24 name=__codelineno-106-24></a><a href=#__codelineno-106-24><span class=linenos data-linenos=" 24 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-106-25><a id=__codelineno-106-25 name=__codelineno-106-25></a><a href=#__codelineno-106-25><span class=linenos data-linenos=" 25 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-106-26><a id=__codelineno-106-26 name=__codelineno-106-26></a><a href=#__codelineno-106-26><span class=linenos data-linenos=" 26 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-106-27><a id=__codelineno-106-27 name=__codelineno-106-27></a><a href=#__codelineno-106-27><span class=linenos data-linenos=" 27 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-106-28><a id=__codelineno-106-28 name=__codelineno-106-28></a><a href=#__codelineno-106-28><span class=linenos data-linenos=" 28 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-106-29><a id=__codelineno-106-29 name=__codelineno-106-29></a><a href=#__codelineno-106-29><span class=linenos data-linenos=" 29 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_f_salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_salary</span>
</span><span id=__span-106-30><a id=__codelineno-106-30 name=__codelineno-106-30></a><a href=#__codelineno-106-30><span class=linenos data-linenos=" 30 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_person_id</span>
</span><span id=__span-106-31><a id=__codelineno-106-31 name=__codelineno-106-31></a><a href=#__codelineno-106-31><span class=linenos data-linenos=" 31 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_company_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_company_id</span>
</span><span id=__span-106-32><a id=__codelineno-106-32 name=__codelineno-106-32></a><a href=#__codelineno-106-32><span class=linenos data-linenos=" 32 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-106-33><a id=__codelineno-106-33 name=__codelineno-106-33></a><a href=#__codelineno-106-33><span class=linenos data-linenos=" 33 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-106-34><a id=__codelineno-106-34 name=__codelineno-106-34></a><a href=#__codelineno-106-34><span class=linenos data-linenos=" 34 "></span></a><span class=w>         </span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-106-35><a id=__codelineno-106-35 name=__codelineno-106-35></a><a href=#__codelineno-106-35><span class=linenos data-linenos=" 35 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-106-36><a id=__codelineno-106-36 name=__codelineno-106-36></a><a href=#__codelineno-106-36><span class=linenos data-linenos=" 36 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql_p_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-106-37><a id=__codelineno-106-37 name=__codelineno-106-37></a><a href=#__codelineno-106-37><span class=linenos data-linenos=" 37 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-106-38><a id=__codelineno-106-38 name=__codelineno-106-38></a><a href=#__codelineno-106-38><span class=linenos data-linenos=" 38 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-106-39><a id=__codelineno-106-39 name=__codelineno-106-39></a><a href=#__codelineno-106-39><span class=linenos data-linenos=" 39 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_right_2</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-106-40><a id=__codelineno-106-40 name=__codelineno-106-40></a><a href=#__codelineno-106-40><span class=linenos data-linenos=" 40 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_right_2</span><span class=p>.</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-106-41><a id=__codelineno-106-41 name=__codelineno-106-41></a><a href=#__codelineno-106-41><span class=linenos data-linenos=" 41 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_right_2</span><span class=p>.</span><span class=n>_gsql2rsql_f_salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_salary</span>
</span><span id=__span-106-42><a id=__codelineno-106-42 name=__codelineno-106-42></a><a href=#__codelineno-106-42><span class=linenos data-linenos=" 42 "></span></a><span class=w>      </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-106-43><a id=__codelineno-106-43 name=__codelineno-106-43></a><a href=#__codelineno-106-43><span class=linenos data-linenos=" 43 "></span></a><span class=w>        </span><span class=k>SELECT</span>
</span><span id=__span-106-44><a id=__codelineno-106-44 name=__codelineno-106-44></a><a href=#__codelineno-106-44><span class=linenos data-linenos=" 44 "></span></a><span class=w>           </span><span class=n>_left_3</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-106-45><a id=__codelineno-106-45 name=__codelineno-106-45></a><a href=#__codelineno-106-45><span class=linenos data-linenos=" 45 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>_left_3</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-106-46><a id=__codelineno-106-46 name=__codelineno-106-46></a><a href=#__codelineno-106-46><span class=linenos data-linenos=" 46 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>_left_3</span><span class=p>.</span><span class=n>_gsql2rsql_p_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-106-47><a id=__codelineno-106-47 name=__codelineno-106-47></a><a href=#__codelineno-106-47><span class=linenos data-linenos=" 47 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>_right_3</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-106-48><a id=__codelineno-106-48 name=__codelineno-106-48></a><a href=#__codelineno-106-48><span class=linenos data-linenos=" 48 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>_right_3</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-106-49><a id=__codelineno-106-49 name=__codelineno-106-49></a><a href=#__codelineno-106-49><span class=linenos data-linenos=" 49 "></span></a><span class=w>        </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-106-50><a id=__codelineno-106-50 name=__codelineno-106-50></a><a href=#__codelineno-106-50><span class=linenos data-linenos=" 50 "></span></a><span class=w>          </span><span class=k>SELECT</span>
</span><span id=__span-106-51><a id=__codelineno-106-51 name=__codelineno-106-51></a><a href=#__codelineno-106-51><span class=linenos data-linenos=" 51 "></span></a><span class=w>             </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-106-52><a id=__codelineno-106-52 name=__codelineno-106-52></a><a href=#__codelineno-106-52><span class=linenos data-linenos=" 52 "></span></a><span class=w>            </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-106-53><a id=__codelineno-106-53 name=__codelineno-106-53></a><a href=#__codelineno-106-53><span class=linenos data-linenos=" 53 "></span></a><span class=w>            </span><span class=p>,</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-106-54><a id=__codelineno-106-54 name=__codelineno-106-54></a><a href=#__codelineno-106-54><span class=linenos data-linenos=" 54 "></span></a><span class=w>          </span><span class=k>FROM</span>
</span><span id=__span-106-55><a id=__codelineno-106-55 name=__codelineno-106-55></a><a href=#__codelineno-106-55><span class=linenos data-linenos=" 55 "></span></a><span class=w>            </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-106-56><a id=__codelineno-106-56 name=__codelineno-106-56></a><a href=#__codelineno-106-56><span class=linenos data-linenos=" 56 "></span></a><span class=w>          </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>age</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>25</span><span class=p>))</span>
</span><span id=__span-106-57><a id=__codelineno-106-57 name=__codelineno-106-57></a><a href=#__codelineno-106-57><span class=linenos data-linenos=" 57 "></span></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_3</span>
</span><span id=__span-106-58><a id=__codelineno-106-58 name=__codelineno-106-58></a><a href=#__codelineno-106-58><span class=linenos data-linenos=" 58 "></span></a><span class=w>        </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-106-59><a id=__codelineno-106-59 name=__codelineno-106-59></a><a href=#__codelineno-106-59><span class=linenos data-linenos=" 59 "></span></a><span class=w>          </span><span class=k>SELECT</span>
</span><span id=__span-106-60><a id=__codelineno-106-60 name=__codelineno-106-60></a><a href=#__codelineno-106-60><span class=linenos data-linenos=" 60 "></span></a><span class=w>             </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-106-61><a id=__codelineno-106-61 name=__codelineno-106-61></a><a href=#__codelineno-106-61><span class=linenos data-linenos=" 61 "></span></a><span class=w>            </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-106-62><a id=__codelineno-106-62 name=__codelineno-106-62></a><a href=#__codelineno-106-62><span class=linenos data-linenos=" 62 "></span></a><span class=w>            </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-106-63><a id=__codelineno-106-63 name=__codelineno-106-63></a><a href=#__codelineno-106-63><span class=linenos data-linenos=" 63 "></span></a><span class=w>            </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_strength</span>
</span><span id=__span-106-64><a id=__codelineno-106-64 name=__codelineno-106-64></a><a href=#__codelineno-106-64><span class=linenos data-linenos=" 64 "></span></a><span class=w>          </span><span class=k>FROM</span>
</span><span id=__span-106-65><a id=__codelineno-106-65 name=__codelineno-106-65></a><a href=#__codelineno-106-65><span class=linenos data-linenos=" 65 "></span></a><span class=w>            </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-106-66><a id=__codelineno-106-66 name=__codelineno-106-66></a><a href=#__codelineno-106-66><span class=linenos data-linenos=" 66 "></span></a><span class=w>          </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-106-67><a id=__codelineno-106-67 name=__codelineno-106-67></a><a href=#__codelineno-106-67><span class=linenos data-linenos=" 67 "></span></a><span class=w>          </span><span class=k>SELECT</span>
</span><span id=__span-106-68><a id=__codelineno-106-68 name=__codelineno-106-68></a><a href=#__codelineno-106-68><span class=linenos data-linenos=" 68 "></span></a><span class=w>             </span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-106-69><a id=__codelineno-106-69 name=__codelineno-106-69></a><a href=#__codelineno-106-69><span class=linenos data-linenos=" 69 "></span></a><span class=w>            </span><span class=p>,</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-106-70><a id=__codelineno-106-70 name=__codelineno-106-70></a><a href=#__codelineno-106-70><span class=linenos data-linenos=" 70 "></span></a><span class=w>            </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-106-71><a id=__codelineno-106-71 name=__codelineno-106-71></a><a href=#__codelineno-106-71><span class=linenos data-linenos=" 71 "></span></a><span class=w>            </span><span class=p>,</span><span class=n>strength</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_strength</span>
</span><span id=__span-106-72><a id=__codelineno-106-72 name=__codelineno-106-72></a><a href=#__codelineno-106-72><span class=linenos data-linenos=" 72 "></span></a><span class=w>          </span><span class=k>FROM</span>
</span><span id=__span-106-73><a id=__codelineno-106-73 name=__codelineno-106-73></a><a href=#__codelineno-106-73><span class=linenos data-linenos=" 73 "></span></a><span class=w>            </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-106-74><a id=__codelineno-106-74 name=__codelineno-106-74></a><a href=#__codelineno-106-74><span class=linenos data-linenos=" 74 "></span></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_3</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-106-75><a id=__codelineno-106-75 name=__codelineno-106-75></a><a href=#__codelineno-106-75><span class=linenos data-linenos=" 75 "></span></a><span class=w>          </span><span class=n>_left_3</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_3</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-106-76><a id=__codelineno-106-76 name=__codelineno-106-76></a><a href=#__codelineno-106-76><span class=linenos data-linenos=" 76 "></span></a><span class=w>      </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_2</span>
</span><span id=__span-106-77><a id=__codelineno-106-77 name=__codelineno-106-77></a><a href=#__codelineno-106-77><span class=linenos data-linenos=" 77 "></span></a><span class=w>      </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-106-78><a id=__codelineno-106-78 name=__codelineno-106-78></a><a href=#__codelineno-106-78><span class=linenos data-linenos=" 78 "></span></a><span class=w>        </span><span class=k>SELECT</span>
</span><span id=__span-106-79><a id=__codelineno-106-79 name=__codelineno-106-79></a><a href=#__codelineno-106-79><span class=linenos data-linenos=" 79 "></span></a><span class=w>           </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-106-80><a id=__codelineno-106-80 name=__codelineno-106-80></a><a href=#__codelineno-106-80><span class=linenos data-linenos=" 80 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-106-81><a id=__codelineno-106-81 name=__codelineno-106-81></a><a href=#__codelineno-106-81><span class=linenos data-linenos=" 81 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_salary</span>
</span><span id=__span-106-82><a id=__codelineno-106-82 name=__codelineno-106-82></a><a href=#__codelineno-106-82><span class=linenos data-linenos=" 82 "></span></a><span class=w>        </span><span class=k>FROM</span>
</span><span id=__span-106-83><a id=__codelineno-106-83 name=__codelineno-106-83></a><a href=#__codelineno-106-83><span class=linenos data-linenos=" 83 "></span></a><span class=w>          </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-106-84><a id=__codelineno-106-84 name=__codelineno-106-84></a><a href=#__codelineno-106-84><span class=linenos data-linenos=" 84 "></span></a><span class=w>        </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>salary</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>50000</span><span class=p>))</span>
</span><span id=__span-106-85><a id=__codelineno-106-85 name=__codelineno-106-85></a><a href=#__codelineno-106-85><span class=linenos data-linenos=" 85 "></span></a><span class=w>      </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_2</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-106-86><a id=__codelineno-106-86 name=__codelineno-106-86></a><a href=#__codelineno-106-86><span class=linenos data-linenos=" 86 "></span></a><span class=w>        </span><span class=n>_right_2</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_2</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-106-87><a id=__codelineno-106-87 name=__codelineno-106-87></a><a href=#__codelineno-106-87><span class=linenos data-linenos=" 87 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-106-88><a id=__codelineno-106-88 name=__codelineno-106-88></a><a href=#__codelineno-106-88><span class=linenos data-linenos=" 88 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-106-89><a id=__codelineno-106-89 name=__codelineno-106-89></a><a href=#__codelineno-106-89><span class=linenos data-linenos=" 89 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-106-90><a id=__codelineno-106-90 name=__codelineno-106-90></a><a href=#__codelineno-106-90><span class=linenos data-linenos=" 90 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_person_id</span>
</span><span id=__span-106-91><a id=__codelineno-106-91 name=__codelineno-106-91></a><a href=#__codelineno-106-91><span class=linenos data-linenos=" 91 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>company_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_company_id</span>
</span><span id=__span-106-92><a id=__codelineno-106-92 name=__codelineno-106-92></a><a href=#__codelineno-106-92><span class=linenos data-linenos=" 92 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-106-93><a id=__codelineno-106-93 name=__codelineno-106-93></a><a href=#__codelineno-106-93><span class=linenos data-linenos=" 93 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>WorksAt</span>
</span><span id=__span-106-94><a id=__codelineno-106-94 name=__codelineno-106-94></a><a href=#__codelineno-106-94><span class=linenos data-linenos=" 94 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-106-95><a id=__codelineno-106-95 name=__codelineno-106-95></a><a href=#__codelineno-106-95><span class=linenos data-linenos=" 95 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_person_id</span>
</span><span id=__span-106-96><a id=__codelineno-106-96 name=__codelineno-106-96></a><a href=#__codelineno-106-96><span class=linenos data-linenos=" 96 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-106-97><a id=__codelineno-106-97 name=__codelineno-106-97></a><a href=#__codelineno-106-97><span class=linenos data-linenos=" 97 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-106-98><a id=__codelineno-106-98 name=__codelineno-106-98></a><a href=#__codelineno-106-98><span class=linenos data-linenos=" 98 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-106-99><a id=__codelineno-106-99 name=__codelineno-106-99></a><a href=#__codelineno-106-99><span class=linenos data-linenos=" 99 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-106-100><a id=__codelineno-106-100 name=__codelineno-106-100></a><a href=#__codelineno-106-100><span class=linenos data-linenos="100 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span><span id=__span-106-101><a id=__codelineno-106-101 name=__codelineno-106-101></a><a href=#__codelineno-106-101><span class=linenos data-linenos="101 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>industry</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_industry</span>
</span><span id=__span-106-102><a id=__codelineno-106-102 name=__codelineno-106-102></a><a href=#__codelineno-106-102><span class=linenos data-linenos="102 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-106-103><a id=__codelineno-106-103 name=__codelineno-106-103></a><a href=#__codelineno-106-103><span class=linenos data-linenos="103 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Company</span>
</span><span id=__span-106-104><a id=__codelineno-106-104 name=__codelineno-106-104></a><a href=#__codelineno-106-104><span class=linenos data-linenos="104 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>industry</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Tech&#39;</span><span class=p>))</span>
</span><span id=__span-106-105><a id=__codelineno-106-105 name=__codelineno-106-105></a><a href=#__codelineno-106-105><span class=linenos data-linenos="105 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-106-106><a id=__codelineno-106-106 name=__codelineno-106-106></a><a href=#__codelineno-106-106><span class=linenos data-linenos="106 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_company_id</span>
</span><span id=__span-106-107><a id=__codelineno-106-107 name=__codelineno-106-107></a><a href=#__codelineno-106-107><span class=linenos data-linenos="107 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-107-1><a id=__codelineno-107-1 name=__codelineno-107-1></a><a href=#__codelineno-107-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-107-2><a id=__codelineno-107-2 name=__codelineno-107-2></a><a href=#__codelineno-107-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-107-3><a id=__codelineno-107-3 name=__codelineno-107-3></a><a href=#__codelineno-107-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=6;
</span><span id=__span-107-4><a id=__codelineno-107-4 name=__codelineno-107-4></a><a href=#__codelineno-107-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-107-5><a id=__codelineno-107-5 name=__codelineno-107-5></a><a href=#__codelineno-107-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-107-6><a id=__codelineno-107-6 name=__codelineno-107-6></a><a href=#__codelineno-107-6><span class=linenos data-linenos=" 6 "></span></a>    Filter: (p.age GT 25)
</span><span id=__span-107-7><a id=__codelineno-107-7 name=__codelineno-107-7></a><a href=#__codelineno-107-7><span class=linenos data-linenos=" 7 "></span></a>*
</span><span id=__span-107-8><a id=__codelineno-107-8 name=__codelineno-107-8></a><a href=#__codelineno-107-8><span class=linenos data-linenos=" 8 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=6;
</span><span id=__span-107-9><a id=__codelineno-107-9 name=__codelineno-107-9></a><a href=#__codelineno-107-9><span class=linenos data-linenos=" 9 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-107-10><a id=__codelineno-107-10 name=__codelineno-107-10></a><a href=#__codelineno-107-10><span class=linenos data-linenos="10 "></span></a>    DataSource: [_anon1:KNOWS]-
</span><span id=__span-107-11><a id=__codelineno-107-11 name=__codelineno-107-11></a><a href=#__codelineno-107-11><span class=linenos data-linenos="11 "></span></a>*
</span><span id=__span-107-12><a id=__codelineno-107-12 name=__codelineno-107-12></a><a href=#__codelineno-107-12><span class=linenos data-linenos="12 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=7;
</span><span id=__span-107-13><a id=__codelineno-107-13 name=__codelineno-107-13></a><a href=#__codelineno-107-13><span class=linenos data-linenos="13 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-107-14><a id=__codelineno-107-14 name=__codelineno-107-14></a><a href=#__codelineno-107-14><span class=linenos data-linenos="14 "></span></a>    DataSource: f:Person
</span><span id=__span-107-15><a id=__codelineno-107-15 name=__codelineno-107-15></a><a href=#__codelineno-107-15><span class=linenos data-linenos="15 "></span></a>    Filter: (f.salary GT 50000)
</span><span id=__span-107-16><a id=__codelineno-107-16 name=__codelineno-107-16></a><a href=#__codelineno-107-16><span class=linenos data-linenos="16 "></span></a>*
</span><span id=__span-107-17><a id=__codelineno-107-17 name=__codelineno-107-17></a><a href=#__codelineno-107-17><span class=linenos data-linenos="17 "></span></a>OpId=4 Op=DataSourceOperator; InOpIds=; OutOpIds=8;
</span><span id=__span-107-18><a id=__codelineno-107-18 name=__codelineno-107-18></a><a href=#__codelineno-107-18><span class=linenos data-linenos="18 "></span></a>  DataSourceOperator(id=4)
</span><span id=__span-107-19><a id=__codelineno-107-19 name=__codelineno-107-19></a><a href=#__codelineno-107-19><span class=linenos data-linenos="19 "></span></a>    DataSource: [_anon2:WORKS_AT]-&gt;
</span><span id=__span-107-20><a id=__codelineno-107-20 name=__codelineno-107-20></a><a href=#__codelineno-107-20><span class=linenos data-linenos="20 "></span></a>*
</span><span id=__span-107-21><a id=__codelineno-107-21 name=__codelineno-107-21></a><a href=#__codelineno-107-21><span class=linenos data-linenos="21 "></span></a>OpId=5 Op=DataSourceOperator; InOpIds=; OutOpIds=9;
</span><span id=__span-107-22><a id=__codelineno-107-22 name=__codelineno-107-22></a><a href=#__codelineno-107-22><span class=linenos data-linenos="22 "></span></a>  DataSourceOperator(id=5)
</span><span id=__span-107-23><a id=__codelineno-107-23 name=__codelineno-107-23></a><a href=#__codelineno-107-23><span class=linenos data-linenos="23 "></span></a>    DataSource: c:Company
</span><span id=__span-107-24><a id=__codelineno-107-24 name=__codelineno-107-24></a><a href=#__codelineno-107-24><span class=linenos data-linenos="24 "></span></a>    Filter: (c.industry EQ &#39;Tech&#39;)
</span><span id=__span-107-25><a id=__codelineno-107-25 name=__codelineno-107-25></a><a href=#__codelineno-107-25><span class=linenos data-linenos="25 "></span></a>*
</span><span id=__span-107-26><a id=__codelineno-107-26 name=__codelineno-107-26></a><a href=#__codelineno-107-26><span class=linenos data-linenos="26 "></span></a>----------------------------------------------------------------------
</span><span id=__span-107-27><a id=__codelineno-107-27 name=__codelineno-107-27></a><a href=#__codelineno-107-27><span class=linenos data-linenos="27 "></span></a>Level 1:
</span><span id=__span-107-28><a id=__codelineno-107-28 name=__codelineno-107-28></a><a href=#__codelineno-107-28><span class=linenos data-linenos="28 "></span></a>----------------------------------------------------------------------
</span><span id=__span-107-29><a id=__codelineno-107-29 name=__codelineno-107-29></a><a href=#__codelineno-107-29><span class=linenos data-linenos="29 "></span></a>OpId=6 Op=JoinOperator; InOpIds=1,2; OutOpIds=7;
</span><span id=__span-107-30><a id=__codelineno-107-30 name=__codelineno-107-30></a><a href=#__codelineno-107-30><span class=linenos data-linenos="30 "></span></a>  JoinOperator(id=6)
</span><span id=__span-107-31><a id=__codelineno-107-31 name=__codelineno-107-31></a><a href=#__codelineno-107-31><span class=linenos data-linenos="31 "></span></a>    JoinType: INNER
</span><span id=__span-107-32><a id=__codelineno-107-32 name=__codelineno-107-32></a><a href=#__codelineno-107-32><span class=linenos data-linenos="32 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=EITHER_AS_SOURCE
</span><span id=__span-107-33><a id=__codelineno-107-33 name=__codelineno-107-33></a><a href=#__codelineno-107-33><span class=linenos data-linenos="33 "></span></a>*
</span><span id=__span-107-34><a id=__codelineno-107-34 name=__codelineno-107-34></a><a href=#__codelineno-107-34><span class=linenos data-linenos="34 "></span></a>----------------------------------------------------------------------
</span><span id=__span-107-35><a id=__codelineno-107-35 name=__codelineno-107-35></a><a href=#__codelineno-107-35><span class=linenos data-linenos="35 "></span></a>Level 2:
</span><span id=__span-107-36><a id=__codelineno-107-36 name=__codelineno-107-36></a><a href=#__codelineno-107-36><span class=linenos data-linenos="36 "></span></a>----------------------------------------------------------------------
</span><span id=__span-107-37><a id=__codelineno-107-37 name=__codelineno-107-37></a><a href=#__codelineno-107-37><span class=linenos data-linenos="37 "></span></a>OpId=7 Op=JoinOperator; InOpIds=6,3; OutOpIds=8;
</span><span id=__span-107-38><a id=__codelineno-107-38 name=__codelineno-107-38></a><a href=#__codelineno-107-38><span class=linenos data-linenos="38 "></span></a>  JoinOperator(id=7)
</span><span id=__span-107-39><a id=__codelineno-107-39 name=__codelineno-107-39></a><a href=#__codelineno-107-39><span class=linenos data-linenos="39 "></span></a>    JoinType: INNER
</span><span id=__span-107-40><a id=__codelineno-107-40 name=__codelineno-107-40></a><a href=#__codelineno-107-40><span class=linenos data-linenos="40 "></span></a>    Joins: JoinPair: Node=f RelOrNode=_anon1 Type=EITHER_AS_SINK
</span><span id=__span-107-41><a id=__codelineno-107-41 name=__codelineno-107-41></a><a href=#__codelineno-107-41><span class=linenos data-linenos="41 "></span></a>*
</span><span id=__span-107-42><a id=__codelineno-107-42 name=__codelineno-107-42></a><a href=#__codelineno-107-42><span class=linenos data-linenos="42 "></span></a>----------------------------------------------------------------------
</span><span id=__span-107-43><a id=__codelineno-107-43 name=__codelineno-107-43></a><a href=#__codelineno-107-43><span class=linenos data-linenos="43 "></span></a>Level 3:
</span><span id=__span-107-44><a id=__codelineno-107-44 name=__codelineno-107-44></a><a href=#__codelineno-107-44><span class=linenos data-linenos="44 "></span></a>----------------------------------------------------------------------
</span><span id=__span-107-45><a id=__codelineno-107-45 name=__codelineno-107-45></a><a href=#__codelineno-107-45><span class=linenos data-linenos="45 "></span></a>OpId=8 Op=JoinOperator; InOpIds=7,4; OutOpIds=9;
</span><span id=__span-107-46><a id=__codelineno-107-46 name=__codelineno-107-46></a><a href=#__codelineno-107-46><span class=linenos data-linenos="46 "></span></a>  JoinOperator(id=8)
</span><span id=__span-107-47><a id=__codelineno-107-47 name=__codelineno-107-47></a><a href=#__codelineno-107-47><span class=linenos data-linenos="47 "></span></a>    JoinType: INNER
</span><span id=__span-107-48><a id=__codelineno-107-48 name=__codelineno-107-48></a><a href=#__codelineno-107-48><span class=linenos data-linenos="48 "></span></a>    Joins: JoinPair: Node=f RelOrNode=_anon2 Type=SOURCE
</span><span id=__span-107-49><a id=__codelineno-107-49 name=__codelineno-107-49></a><a href=#__codelineno-107-49><span class=linenos data-linenos="49 "></span></a>*
</span><span id=__span-107-50><a id=__codelineno-107-50 name=__codelineno-107-50></a><a href=#__codelineno-107-50><span class=linenos data-linenos="50 "></span></a>----------------------------------------------------------------------
</span><span id=__span-107-51><a id=__codelineno-107-51 name=__codelineno-107-51></a><a href=#__codelineno-107-51><span class=linenos data-linenos="51 "></span></a>Level 4:
</span><span id=__span-107-52><a id=__codelineno-107-52 name=__codelineno-107-52></a><a href=#__codelineno-107-52><span class=linenos data-linenos="52 "></span></a>----------------------------------------------------------------------
</span><span id=__span-107-53><a id=__codelineno-107-53 name=__codelineno-107-53></a><a href=#__codelineno-107-53><span class=linenos data-linenos="53 "></span></a>OpId=9 Op=JoinOperator; InOpIds=8,5; OutOpIds=11;
</span><span id=__span-107-54><a id=__codelineno-107-54 name=__codelineno-107-54></a><a href=#__codelineno-107-54><span class=linenos data-linenos="54 "></span></a>  JoinOperator(id=9)
</span><span id=__span-107-55><a id=__codelineno-107-55 name=__codelineno-107-55></a><a href=#__codelineno-107-55><span class=linenos data-linenos="55 "></span></a>    JoinType: INNER
</span><span id=__span-107-56><a id=__codelineno-107-56 name=__codelineno-107-56></a><a href=#__codelineno-107-56><span class=linenos data-linenos="56 "></span></a>    Joins: JoinPair: Node=c RelOrNode=_anon2 Type=SINK
</span><span id=__span-107-57><a id=__codelineno-107-57 name=__codelineno-107-57></a><a href=#__codelineno-107-57><span class=linenos data-linenos="57 "></span></a>*
</span><span id=__span-107-58><a id=__codelineno-107-58 name=__codelineno-107-58></a><a href=#__codelineno-107-58><span class=linenos data-linenos="58 "></span></a>----------------------------------------------------------------------
</span><span id=__span-107-59><a id=__codelineno-107-59 name=__codelineno-107-59></a><a href=#__codelineno-107-59><span class=linenos data-linenos="59 "></span></a>Level 5:
</span><span id=__span-107-60><a id=__codelineno-107-60 name=__codelineno-107-60></a><a href=#__codelineno-107-60><span class=linenos data-linenos="60 "></span></a>----------------------------------------------------------------------
</span><span id=__span-107-61><a id=__codelineno-107-61 name=__codelineno-107-61></a><a href=#__codelineno-107-61><span class=linenos data-linenos="61 "></span></a>OpId=11 Op=ProjectionOperator; InOpIds=9; OutOpIds=;
</span><span id=__span-107-62><a id=__codelineno-107-62 name=__codelineno-107-62></a><a href=#__codelineno-107-62><span class=linenos data-linenos="62 "></span></a>  ProjectionOperator(id=11)
</span><span id=__span-107-63><a id=__codelineno-107-63 name=__codelineno-107-63></a><a href=#__codelineno-107-63><span class=linenos data-linenos="63 "></span></a>    Projections: name=p.name, name=f.name, name=c.name
</span><span id=__span-107-64><a id=__codelineno-107-64 name=__codelineno-107-64></a><a href=#__codelineno-107-64><span class=linenos data-linenos="64 "></span></a>*
</span><span id=__span-107-65><a id=__codelineno-107-65 name=__codelineno-107-65></a><a href=#__codelineno-107-65><span class=linenos data-linenos="65 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=37-variable-length-paths-with-multi-hop-traversal-and-aggregation>37. Variable-length paths with multi-hop traversal and aggregation<a class=headerlink href=#37-variable-length-paths-with-multi-hop-traversal-and-aggregation title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Complex graph traversal with aggregation</p> <details class=note> <summary>Notes</summary> <p>This query demonstrates a powerful combination of features: 1. Variable-length path: KNOWS*1..3 (1 to 3 hops) 2. Pattern continuation after varlen path 3. Filter on final relationship target 4. Aggregation with COUNT(DISTINCT) 5. Ordering by aggregated column</p> <p>REAL-WORLD USE: Find people with the most connections to tech workers. Used in professional networking, talent acquisition, and social graph analysis.</p> <p>OPTIMIZATION: Filter on c.industry pushed down before joins.</p> <p>COMPLEXITY: O(n^3) for 3-hop traversal, but filtered early. Result deduplication via DISTINCT crucial for accurate counts.</p> <p>SQL Pattern: WITH RECURSIVE path AS (...) -- Variable-length expansion SELECT p.name, COUNT(DISTINCT friend_id) AS tech_connections FROM path JOIN WorksAt ON ... JOIN (SELECT ... FROM Company WHERE industry = 'Technology') AS c GROUP BY p.name ORDER BY tech_connections DESC LIMIT 10</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-108-1><a id=__codelineno-108-1 name=__codelineno-108-1></a><a href=#__codelineno-108-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=p>*</span><span class=m>1</span><span class=p>..</span><span class=m>3</span><span class=o>]</span><span class=err>-</span><span class=p>(</span><span class=n>friend</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=err>-</span><span class=o>[</span><span class=p>:</span><span class=n>WORKS_AT</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>c</span><span class=p>:</span><span class=n>Company</span><span class=p>)</span>
</span><span id=__span-108-2><a id=__codelineno-108-2 name=__codelineno-108-2></a><a href=#__codelineno-108-2><span class=linenos data-linenos="2 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>c</span><span class=p>.</span><span class=n>industry</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&#39;Technology&#39;</span>
</span><span id=__span-108-3><a id=__codelineno-108-3 name=__codelineno-108-3></a><a href=#__codelineno-108-3><span class=linenos data-linenos="3 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>friend</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>tech_connections</span>
</span><span id=__span-108-4><a id=__codelineno-108-4 name=__codelineno-108-4></a><a href=#__codelineno-108-4><span class=linenos data-linenos="4 "></span></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>tech_connections</span><span class=w> </span><span class=k>DESC</span>
</span><span id=__span-108-5><a id=__codelineno-108-5 name=__codelineno-108-5></a><a href=#__codelineno-108-5><span class=linenos data-linenos="5 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=m>10</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-109-1><a id=__codelineno-109-1 name=__codelineno-109-1></a><a href=#__codelineno-109-1><span class=linenos data-linenos="  1 "></span></a><span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span>
</span><span id=__span-109-2><a id=__codelineno-109-2 name=__codelineno-109-2></a><a href=#__codelineno-109-2><span class=linenos data-linenos="  2 "></span></a><span class=w>  </span><span class=n>paths_1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-109-3><a id=__codelineno-109-3 name=__codelineno-109-3></a><a href=#__codelineno-109-3><span class=linenos data-linenos="  3 "></span></a><span class=w>    </span><span class=c1>-- Base case: direct edges (depth = 1)</span>
</span><span id=__span-109-4><a id=__codelineno-109-4 name=__codelineno-109-4></a><a href=#__codelineno-109-4><span class=linenos data-linenos="  4 "></span></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-109-5><a id=__codelineno-109-5 name=__codelineno-109-5></a><a href=#__codelineno-109-5><span class=linenos data-linenos="  5 "></span></a><span class=w>    </span><span class=c1>-- Forward direction</span>
</span><span id=__span-109-6><a id=__codelineno-109-6 name=__codelineno-109-6></a><a href=#__codelineno-109-6><span class=linenos data-linenos="  6 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-109-7><a id=__codelineno-109-7 name=__codelineno-109-7></a><a href=#__codelineno-109-7><span class=linenos data-linenos="  7 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-109-8><a id=__codelineno-109-8 name=__codelineno-109-8></a><a href=#__codelineno-109-8><span class=linenos data-linenos="  8 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-109-9><a id=__codelineno-109-9 name=__codelineno-109-9></a><a href=#__codelineno-109-9><span class=linenos data-linenos="  9 "></span></a><span class=w>      </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-109-10><a id=__codelineno-109-10 name=__codelineno-109-10></a><a href=#__codelineno-109-10><span class=linenos data-linenos=" 10 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-109-11><a id=__codelineno-109-11 name=__codelineno-109-11></a><a href=#__codelineno-109-11><span class=linenos data-linenos=" 11 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-109-12><a id=__codelineno-109-12 name=__codelineno-109-12></a><a href=#__codelineno-109-12><span class=linenos data-linenos=" 12 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-109-13><a id=__codelineno-109-13 name=__codelineno-109-13></a><a href=#__codelineno-109-13><span class=linenos data-linenos=" 13 "></span></a>
</span><span id=__span-109-14><a id=__codelineno-109-14 name=__codelineno-109-14></a><a href=#__codelineno-109-14><span class=linenos data-linenos=" 14 "></span></a><span class=w>      </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-109-15><a id=__codelineno-109-15 name=__codelineno-109-15></a><a href=#__codelineno-109-15><span class=linenos data-linenos=" 15 "></span></a>
</span><span id=__span-109-16><a id=__codelineno-109-16 name=__codelineno-109-16></a><a href=#__codelineno-109-16><span class=linenos data-linenos=" 16 "></span></a><span class=w>    </span><span class=c1>-- Backward direction</span>
</span><span id=__span-109-17><a id=__codelineno-109-17 name=__codelineno-109-17></a><a href=#__codelineno-109-17><span class=linenos data-linenos=" 17 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-109-18><a id=__codelineno-109-18 name=__codelineno-109-18></a><a href=#__codelineno-109-18><span class=linenos data-linenos=" 18 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-109-19><a id=__codelineno-109-19 name=__codelineno-109-19></a><a href=#__codelineno-109-19><span class=linenos data-linenos=" 19 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-109-20><a id=__codelineno-109-20 name=__codelineno-109-20></a><a href=#__codelineno-109-20><span class=linenos data-linenos=" 20 "></span></a><span class=w>      </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-109-21><a id=__codelineno-109-21 name=__codelineno-109-21></a><a href=#__codelineno-109-21><span class=linenos data-linenos=" 21 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-109-22><a id=__codelineno-109-22 name=__codelineno-109-22></a><a href=#__codelineno-109-22><span class=linenos data-linenos=" 22 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-109-23><a id=__codelineno-109-23 name=__codelineno-109-23></a><a href=#__codelineno-109-23><span class=linenos data-linenos=" 23 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-109-24><a id=__codelineno-109-24 name=__codelineno-109-24></a><a href=#__codelineno-109-24><span class=linenos data-linenos=" 24 "></span></a><span class=w>    </span><span class=p>)</span>
</span><span id=__span-109-25><a id=__codelineno-109-25 name=__codelineno-109-25></a><a href=#__codelineno-109-25><span class=linenos data-linenos=" 25 "></span></a>
</span><span id=__span-109-26><a id=__codelineno-109-26 name=__codelineno-109-26></a><a href=#__codelineno-109-26><span class=linenos data-linenos=" 26 "></span></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-109-27><a id=__codelineno-109-27 name=__codelineno-109-27></a><a href=#__codelineno-109-27><span class=linenos data-linenos=" 27 "></span></a>
</span><span id=__span-109-28><a id=__codelineno-109-28 name=__codelineno-109-28></a><a href=#__codelineno-109-28><span class=linenos data-linenos=" 28 "></span></a><span class=w>    </span><span class=c1>-- Recursive case: extend paths</span>
</span><span id=__span-109-29><a id=__codelineno-109-29 name=__codelineno-109-29></a><a href=#__codelineno-109-29><span class=linenos data-linenos=" 29 "></span></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-109-30><a id=__codelineno-109-30 name=__codelineno-109-30></a><a href=#__codelineno-109-30><span class=linenos data-linenos=" 30 "></span></a><span class=w>    </span><span class=c1>-- Forward direction</span>
</span><span id=__span-109-31><a id=__codelineno-109-31 name=__codelineno-109-31></a><a href=#__codelineno-109-31><span class=linenos data-linenos=" 31 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-109-32><a id=__codelineno-109-32 name=__codelineno-109-32></a><a href=#__codelineno-109-32><span class=linenos data-linenos=" 32 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-109-33><a id=__codelineno-109-33 name=__codelineno-109-33></a><a href=#__codelineno-109-33><span class=linenos data-linenos=" 33 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-109-34><a id=__codelineno-109-34 name=__codelineno-109-34></a><a href=#__codelineno-109-34><span class=linenos data-linenos=" 34 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-109-35><a id=__codelineno-109-35 name=__codelineno-109-35></a><a href=#__codelineno-109-35><span class=linenos data-linenos=" 35 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-109-36><a id=__codelineno-109-36 name=__codelineno-109-36></a><a href=#__codelineno-109-36><span class=linenos data-linenos=" 36 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-109-37><a id=__codelineno-109-37 name=__codelineno-109-37></a><a href=#__codelineno-109-37><span class=linenos data-linenos=" 37 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-109-38><a id=__codelineno-109-38 name=__codelineno-109-38></a><a href=#__codelineno-109-38><span class=linenos data-linenos=" 38 "></span></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-109-39><a id=__codelineno-109-39 name=__codelineno-109-39></a><a href=#__codelineno-109-39><span class=linenos data-linenos=" 39 "></span></a><span class=w>      </span><span class=k>ON</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span>
</span><span id=__span-109-40><a id=__codelineno-109-40 name=__codelineno-109-40></a><a href=#__codelineno-109-40><span class=linenos data-linenos=" 40 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>3</span>
</span><span id=__span-109-41><a id=__codelineno-109-41 name=__codelineno-109-41></a><a href=#__codelineno-109-41><span class=linenos data-linenos=" 41 "></span></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=n>ARRAY_CONTAINS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span>
</span><span id=__span-109-42><a id=__codelineno-109-42 name=__codelineno-109-42></a><a href=#__codelineno-109-42><span class=linenos data-linenos=" 42 "></span></a>
</span><span id=__span-109-43><a id=__codelineno-109-43 name=__codelineno-109-43></a><a href=#__codelineno-109-43><span class=linenos data-linenos=" 43 "></span></a><span class=w>      </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-109-44><a id=__codelineno-109-44 name=__codelineno-109-44></a><a href=#__codelineno-109-44><span class=linenos data-linenos=" 44 "></span></a>
</span><span id=__span-109-45><a id=__codelineno-109-45 name=__codelineno-109-45></a><a href=#__codelineno-109-45><span class=linenos data-linenos=" 45 "></span></a><span class=w>    </span><span class=c1>-- Backward direction</span>
</span><span id=__span-109-46><a id=__codelineno-109-46 name=__codelineno-109-46></a><a href=#__codelineno-109-46><span class=linenos data-linenos=" 46 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-109-47><a id=__codelineno-109-47 name=__codelineno-109-47></a><a href=#__codelineno-109-47><span class=linenos data-linenos=" 47 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-109-48><a id=__codelineno-109-48 name=__codelineno-109-48></a><a href=#__codelineno-109-48><span class=linenos data-linenos=" 48 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-109-49><a id=__codelineno-109-49 name=__codelineno-109-49></a><a href=#__codelineno-109-49><span class=linenos data-linenos=" 49 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-109-50><a id=__codelineno-109-50 name=__codelineno-109-50></a><a href=#__codelineno-109-50><span class=linenos data-linenos=" 50 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-109-51><a id=__codelineno-109-51 name=__codelineno-109-51></a><a href=#__codelineno-109-51><span class=linenos data-linenos=" 51 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-109-52><a id=__codelineno-109-52 name=__codelineno-109-52></a><a href=#__codelineno-109-52><span class=linenos data-linenos=" 52 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-109-53><a id=__codelineno-109-53 name=__codelineno-109-53></a><a href=#__codelineno-109-53><span class=linenos data-linenos=" 53 "></span></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-109-54><a id=__codelineno-109-54 name=__codelineno-109-54></a><a href=#__codelineno-109-54><span class=linenos data-linenos=" 54 "></span></a><span class=w>      </span><span class=k>ON</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span>
</span><span id=__span-109-55><a id=__codelineno-109-55 name=__codelineno-109-55></a><a href=#__codelineno-109-55><span class=linenos data-linenos=" 55 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>3</span>
</span><span id=__span-109-56><a id=__codelineno-109-56 name=__codelineno-109-56></a><a href=#__codelineno-109-56><span class=linenos data-linenos=" 56 "></span></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=n>ARRAY_CONTAINS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>)</span>
</span><span id=__span-109-57><a id=__codelineno-109-57 name=__codelineno-109-57></a><a href=#__codelineno-109-57><span class=linenos data-linenos=" 57 "></span></a><span class=w>    </span><span class=p>)</span>
</span><span id=__span-109-58><a id=__codelineno-109-58 name=__codelineno-109-58></a><a href=#__codelineno-109-58><span class=linenos data-linenos=" 58 "></span></a><span class=w>  </span><span class=p>)</span>
</span><span id=__span-109-59><a id=__codelineno-109-59 name=__codelineno-109-59></a><a href=#__codelineno-109-59><span class=linenos data-linenos=" 59 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-109-60><a id=__codelineno-109-60 name=__codelineno-109-60></a><a href=#__codelineno-109-60><span class=linenos data-linenos=" 60 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-109-61><a id=__codelineno-109-61 name=__codelineno-109-61></a><a href=#__codelineno-109-61><span class=linenos data-linenos=" 61 "></span></a><span class=w>  </span><span class=p>,</span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>_gsql2rsql_friend_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>tech_connections</span>
</span><span id=__span-109-62><a id=__codelineno-109-62 name=__codelineno-109-62></a><a href=#__codelineno-109-62><span class=linenos data-linenos=" 62 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-109-63><a id=__codelineno-109-63 name=__codelineno-109-63></a><a href=#__codelineno-109-63><span class=linenos data-linenos=" 63 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-109-64><a id=__codelineno-109-64 name=__codelineno-109-64></a><a href=#__codelineno-109-64><span class=linenos data-linenos=" 64 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-109-65><a id=__codelineno-109-65 name=__codelineno-109-65></a><a href=#__codelineno-109-65><span class=linenos data-linenos=" 65 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-109-66><a id=__codelineno-109-66 name=__codelineno-109-66></a><a href=#__codelineno-109-66><span class=linenos data-linenos=" 66 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_friend_id</span>
</span><span id=__span-109-67><a id=__codelineno-109-67 name=__codelineno-109-67></a><a href=#__codelineno-109-67><span class=linenos data-linenos=" 67 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_person_id</span>
</span><span id=__span-109-68><a id=__codelineno-109-68 name=__codelineno-109-68></a><a href=#__codelineno-109-68><span class=linenos data-linenos=" 68 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_company_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_company_id</span>
</span><span id=__span-109-69><a id=__codelineno-109-69 name=__codelineno-109-69></a><a href=#__codelineno-109-69><span class=linenos data-linenos=" 69 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-109-70><a id=__codelineno-109-70 name=__codelineno-109-70></a><a href=#__codelineno-109-70><span class=linenos data-linenos=" 70 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_industry</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_industry</span>
</span><span id=__span-109-71><a id=__codelineno-109-71 name=__codelineno-109-71></a><a href=#__codelineno-109-71><span class=linenos data-linenos=" 71 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-109-72><a id=__codelineno-109-72 name=__codelineno-109-72></a><a href=#__codelineno-109-72><span class=linenos data-linenos=" 72 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-109-73><a id=__codelineno-109-73 name=__codelineno-109-73></a><a href=#__codelineno-109-73><span class=linenos data-linenos=" 73 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-109-74><a id=__codelineno-109-74 name=__codelineno-109-74></a><a href=#__codelineno-109-74><span class=linenos data-linenos=" 74 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-109-75><a id=__codelineno-109-75 name=__codelineno-109-75></a><a href=#__codelineno-109-75><span class=linenos data-linenos=" 75 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_friend_id</span>
</span><span id=__span-109-76><a id=__codelineno-109-76 name=__codelineno-109-76></a><a href=#__codelineno-109-76><span class=linenos data-linenos=" 76 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_person_id</span>
</span><span id=__span-109-77><a id=__codelineno-109-77 name=__codelineno-109-77></a><a href=#__codelineno-109-77><span class=linenos data-linenos=" 77 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_company_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_company_id</span>
</span><span id=__span-109-78><a id=__codelineno-109-78 name=__codelineno-109-78></a><a href=#__codelineno-109-78><span class=linenos data-linenos=" 78 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-109-79><a id=__codelineno-109-79 name=__codelineno-109-79></a><a href=#__codelineno-109-79><span class=linenos data-linenos=" 79 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-109-80><a id=__codelineno-109-80 name=__codelineno-109-80></a><a href=#__codelineno-109-80><span class=linenos data-linenos=" 80 "></span></a><span class=w>         </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_friend_id</span>
</span><span id=__span-109-81><a id=__codelineno-109-81 name=__codelineno-109-81></a><a href=#__codelineno-109-81><span class=linenos data-linenos=" 81 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_friend_name</span>
</span><span id=__span-109-82><a id=__codelineno-109-82 name=__codelineno-109-82></a><a href=#__codelineno-109-82><span class=linenos data-linenos=" 82 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_friend_age</span>
</span><span id=__span-109-83><a id=__codelineno-109-83 name=__codelineno-109-83></a><a href=#__codelineno-109-83><span class=linenos data-linenos=" 83 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_friend_nickname</span>
</span><span id=__span-109-84><a id=__codelineno-109-84 name=__codelineno-109-84></a><a href=#__codelineno-109-84><span class=linenos data-linenos=" 84 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_friend_salary</span>
</span><span id=__span-109-85><a id=__codelineno-109-85 name=__codelineno-109-85></a><a href=#__codelineno-109-85><span class=linenos data-linenos=" 85 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_friend_active</span>
</span><span id=__span-109-86><a id=__codelineno-109-86 name=__codelineno-109-86></a><a href=#__codelineno-109-86><span class=linenos data-linenos=" 86 "></span></a><span class=w>        </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-109-87><a id=__codelineno-109-87 name=__codelineno-109-87></a><a href=#__codelineno-109-87><span class=linenos data-linenos=" 87 "></span></a><span class=w>        </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-109-88><a id=__codelineno-109-88 name=__codelineno-109-88></a><a href=#__codelineno-109-88><span class=linenos data-linenos=" 88 "></span></a><span class=w>        </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-109-89><a id=__codelineno-109-89 name=__codelineno-109-89></a><a href=#__codelineno-109-89><span class=linenos data-linenos=" 89 "></span></a><span class=w>        </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_nickname</span>
</span><span id=__span-109-90><a id=__codelineno-109-90 name=__codelineno-109-90></a><a href=#__codelineno-109-90><span class=linenos data-linenos=" 90 "></span></a><span class=w>        </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_salary</span>
</span><span id=__span-109-91><a id=__codelineno-109-91 name=__codelineno-109-91></a><a href=#__codelineno-109-91><span class=linenos data-linenos=" 91 "></span></a><span class=w>        </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_active</span>
</span><span id=__span-109-92><a id=__codelineno-109-92 name=__codelineno-109-92></a><a href=#__codelineno-109-92><span class=linenos data-linenos=" 92 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-109-93><a id=__codelineno-109-93 name=__codelineno-109-93></a><a href=#__codelineno-109-93><span class=linenos data-linenos=" 93 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-109-94><a id=__codelineno-109-94 name=__codelineno-109-94></a><a href=#__codelineno-109-94><span class=linenos data-linenos=" 94 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>depth</span>
</span><span id=__span-109-95><a id=__codelineno-109-95 name=__codelineno-109-95></a><a href=#__codelineno-109-95><span class=linenos data-linenos=" 95 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>path</span>
</span><span id=__span-109-96><a id=__codelineno-109-96 name=__codelineno-109-96></a><a href=#__codelineno-109-96><span class=linenos data-linenos=" 96 "></span></a><span class=w>      </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-109-97><a id=__codelineno-109-97 name=__codelineno-109-97></a><a href=#__codelineno-109-97><span class=linenos data-linenos=" 97 "></span></a><span class=w>      </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=n>sink</span>
</span><span id=__span-109-98><a id=__codelineno-109-98 name=__codelineno-109-98></a><a href=#__codelineno-109-98><span class=linenos data-linenos=" 98 "></span></a><span class=w>        </span><span class=k>ON</span><span class=w> </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-109-99><a id=__codelineno-109-99 name=__codelineno-109-99></a><a href=#__codelineno-109-99><span class=linenos data-linenos=" 99 "></span></a><span class=w>      </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=k>source</span>
</span><span id=__span-109-100><a id=__codelineno-109-100 name=__codelineno-109-100></a><a href=#__codelineno-109-100><span class=linenos data-linenos="100 "></span></a><span class=w>        </span><span class=k>ON</span><span class=w> </span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-109-101><a id=__codelineno-109-101 name=__codelineno-109-101></a><a href=#__codelineno-109-101><span class=linenos data-linenos="101 "></span></a><span class=w>      </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>3</span>
</span><span id=__span-109-102><a id=__codelineno-109-102 name=__codelineno-109-102></a><a href=#__codelineno-109-102><span class=linenos data-linenos="102 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-109-103><a id=__codelineno-109-103 name=__codelineno-109-103></a><a href=#__codelineno-109-103><span class=linenos data-linenos="103 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-109-104><a id=__codelineno-109-104 name=__codelineno-109-104></a><a href=#__codelineno-109-104><span class=linenos data-linenos="104 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-109-105><a id=__codelineno-109-105 name=__codelineno-109-105></a><a href=#__codelineno-109-105><span class=linenos data-linenos="105 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_person_id</span>
</span><span id=__span-109-106><a id=__codelineno-109-106 name=__codelineno-109-106></a><a href=#__codelineno-109-106><span class=linenos data-linenos="106 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>company_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_company_id</span>
</span><span id=__span-109-107><a id=__codelineno-109-107 name=__codelineno-109-107></a><a href=#__codelineno-109-107><span class=linenos data-linenos="107 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-109-108><a id=__codelineno-109-108 name=__codelineno-109-108></a><a href=#__codelineno-109-108><span class=linenos data-linenos="108 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>WorksAt</span>
</span><span id=__span-109-109><a id=__codelineno-109-109 name=__codelineno-109-109></a><a href=#__codelineno-109-109><span class=linenos data-linenos="109 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-109-110><a id=__codelineno-109-110 name=__codelineno-109-110></a><a href=#__codelineno-109-110><span class=linenos data-linenos="110 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_friend_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_person_id</span>
</span><span id=__span-109-111><a id=__codelineno-109-111 name=__codelineno-109-111></a><a href=#__codelineno-109-111><span class=linenos data-linenos="111 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-109-112><a id=__codelineno-109-112 name=__codelineno-109-112></a><a href=#__codelineno-109-112><span class=linenos data-linenos="112 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-109-113><a id=__codelineno-109-113 name=__codelineno-109-113></a><a href=#__codelineno-109-113><span class=linenos data-linenos="113 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-109-114><a id=__codelineno-109-114 name=__codelineno-109-114></a><a href=#__codelineno-109-114><span class=linenos data-linenos="114 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-109-115><a id=__codelineno-109-115 name=__codelineno-109-115></a><a href=#__codelineno-109-115><span class=linenos data-linenos="115 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>industry</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_industry</span>
</span><span id=__span-109-116><a id=__codelineno-109-116 name=__codelineno-109-116></a><a href=#__codelineno-109-116><span class=linenos data-linenos="116 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-109-117><a id=__codelineno-109-117 name=__codelineno-109-117></a><a href=#__codelineno-109-117><span class=linenos data-linenos="117 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Company</span>
</span><span id=__span-109-118><a id=__codelineno-109-118 name=__codelineno-109-118></a><a href=#__codelineno-109-118><span class=linenos data-linenos="118 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-109-119><a id=__codelineno-109-119 name=__codelineno-109-119></a><a href=#__codelineno-109-119><span class=linenos data-linenos="119 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_company_id</span>
</span><span id=__span-109-120><a id=__codelineno-109-120 name=__codelineno-109-120></a><a href=#__codelineno-109-120><span class=linenos data-linenos="120 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-109-121><a id=__codelineno-109-121 name=__codelineno-109-121></a><a href=#__codelineno-109-121><span class=linenos data-linenos="121 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=p>(</span><span class=n>_gsql2rsql_c_industry</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Technology&#39;</span><span class=p>)</span>
</span><span id=__span-109-122><a id=__codelineno-109-122 name=__codelineno-109-122></a><a href=#__codelineno-109-122><span class=linenos data-linenos="122 "></span></a><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-109-123><a id=__codelineno-109-123 name=__codelineno-109-123></a><a href=#__codelineno-109-123><span class=linenos data-linenos="123 "></span></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>tech_connections</span><span class=w> </span><span class=k>DESC</span>
</span><span id=__span-109-124><a id=__codelineno-109-124 name=__codelineno-109-124></a><a href=#__codelineno-109-124><span class=linenos data-linenos="124 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=mi>10</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-110-1><a id=__codelineno-110-1 name=__codelineno-110-1></a><a href=#__codelineno-110-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-110-2><a id=__codelineno-110-2 name=__codelineno-110-2></a><a href=#__codelineno-110-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-110-3><a id=__codelineno-110-3 name=__codelineno-110-3></a><a href=#__codelineno-110-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=2;
</span><span id=__span-110-4><a id=__codelineno-110-4 name=__codelineno-110-4></a><a href=#__codelineno-110-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-110-5><a id=__codelineno-110-5 name=__codelineno-110-5></a><a href=#__codelineno-110-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-110-6><a id=__codelineno-110-6 name=__codelineno-110-6></a><a href=#__codelineno-110-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-110-7><a id=__codelineno-110-7 name=__codelineno-110-7></a><a href=#__codelineno-110-7><span class=linenos data-linenos=" 7 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-110-8><a id=__codelineno-110-8 name=__codelineno-110-8></a><a href=#__codelineno-110-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-110-9><a id=__codelineno-110-9 name=__codelineno-110-9></a><a href=#__codelineno-110-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: friend:Person
</span><span id=__span-110-10><a id=__codelineno-110-10 name=__codelineno-110-10></a><a href=#__codelineno-110-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-110-11><a id=__codelineno-110-11 name=__codelineno-110-11></a><a href=#__codelineno-110-11><span class=linenos data-linenos="11 "></span></a>OpId=5 Op=DataSourceOperator; InOpIds=; OutOpIds=6;
</span><span id=__span-110-12><a id=__codelineno-110-12 name=__codelineno-110-12></a><a href=#__codelineno-110-12><span class=linenos data-linenos="12 "></span></a>  DataSourceOperator(id=5)
</span><span id=__span-110-13><a id=__codelineno-110-13 name=__codelineno-110-13></a><a href=#__codelineno-110-13><span class=linenos data-linenos="13 "></span></a>    DataSource: [_anon2:WORKS_AT]-&gt;
</span><span id=__span-110-14><a id=__codelineno-110-14 name=__codelineno-110-14></a><a href=#__codelineno-110-14><span class=linenos data-linenos="14 "></span></a>*
</span><span id=__span-110-15><a id=__codelineno-110-15 name=__codelineno-110-15></a><a href=#__codelineno-110-15><span class=linenos data-linenos="15 "></span></a>OpId=7 Op=DataSourceOperator; InOpIds=; OutOpIds=8;
</span><span id=__span-110-16><a id=__codelineno-110-16 name=__codelineno-110-16></a><a href=#__codelineno-110-16><span class=linenos data-linenos="16 "></span></a>  DataSourceOperator(id=7)
</span><span id=__span-110-17><a id=__codelineno-110-17 name=__codelineno-110-17></a><a href=#__codelineno-110-17><span class=linenos data-linenos="17 "></span></a>    DataSource: c:Company
</span><span id=__span-110-18><a id=__codelineno-110-18 name=__codelineno-110-18></a><a href=#__codelineno-110-18><span class=linenos data-linenos="18 "></span></a>*
</span><span id=__span-110-19><a id=__codelineno-110-19 name=__codelineno-110-19></a><a href=#__codelineno-110-19><span class=linenos data-linenos="19 "></span></a>----------------------------------------------------------------------
</span><span id=__span-110-20><a id=__codelineno-110-20 name=__codelineno-110-20></a><a href=#__codelineno-110-20><span class=linenos data-linenos="20 "></span></a>Level 1:
</span><span id=__span-110-21><a id=__codelineno-110-21 name=__codelineno-110-21></a><a href=#__codelineno-110-21><span class=linenos data-linenos="21 "></span></a>----------------------------------------------------------------------
</span><span id=__span-110-22><a id=__codelineno-110-22 name=__codelineno-110-22></a><a href=#__codelineno-110-22><span class=linenos data-linenos="22 "></span></a>OpId=2 Op=RecursiveTraversalOperator; InOpIds=1; OutOpIds=4;
</span><span id=__span-110-23><a id=__codelineno-110-23 name=__codelineno-110-23></a><a href=#__codelineno-110-23><span class=linenos data-linenos="23 "></span></a>  RecursiveTraversal(KNOWS*1..3, direction=BOTH)
</span><span id=__span-110-24><a id=__codelineno-110-24 name=__codelineno-110-24></a><a href=#__codelineno-110-24><span class=linenos data-linenos="24 "></span></a>*
</span><span id=__span-110-25><a id=__codelineno-110-25 name=__codelineno-110-25></a><a href=#__codelineno-110-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-110-26><a id=__codelineno-110-26 name=__codelineno-110-26></a><a href=#__codelineno-110-26><span class=linenos data-linenos="26 "></span></a>Level 2:
</span><span id=__span-110-27><a id=__codelineno-110-27 name=__codelineno-110-27></a><a href=#__codelineno-110-27><span class=linenos data-linenos="27 "></span></a>----------------------------------------------------------------------
</span><span id=__span-110-28><a id=__codelineno-110-28 name=__codelineno-110-28></a><a href=#__codelineno-110-28><span class=linenos data-linenos="28 "></span></a>OpId=4 Op=JoinOperator; InOpIds=2,3; OutOpIds=6;
</span><span id=__span-110-29><a id=__codelineno-110-29 name=__codelineno-110-29></a><a href=#__codelineno-110-29><span class=linenos data-linenos="29 "></span></a>  JoinOperator(id=4)
</span><span id=__span-110-30><a id=__codelineno-110-30 name=__codelineno-110-30></a><a href=#__codelineno-110-30><span class=linenos data-linenos="30 "></span></a>    JoinType: INNER
</span><span id=__span-110-31><a id=__codelineno-110-31 name=__codelineno-110-31></a><a href=#__codelineno-110-31><span class=linenos data-linenos="31 "></span></a>    Joins: JoinPair: Node=friend RelOrNode=paths__anon1 Type=SINK
</span><span id=__span-110-32><a id=__codelineno-110-32 name=__codelineno-110-32></a><a href=#__codelineno-110-32><span class=linenos data-linenos="32 "></span></a>*
</span><span id=__span-110-33><a id=__codelineno-110-33 name=__codelineno-110-33></a><a href=#__codelineno-110-33><span class=linenos data-linenos="33 "></span></a>----------------------------------------------------------------------
</span><span id=__span-110-34><a id=__codelineno-110-34 name=__codelineno-110-34></a><a href=#__codelineno-110-34><span class=linenos data-linenos="34 "></span></a>Level 3:
</span><span id=__span-110-35><a id=__codelineno-110-35 name=__codelineno-110-35></a><a href=#__codelineno-110-35><span class=linenos data-linenos="35 "></span></a>----------------------------------------------------------------------
</span><span id=__span-110-36><a id=__codelineno-110-36 name=__codelineno-110-36></a><a href=#__codelineno-110-36><span class=linenos data-linenos="36 "></span></a>OpId=6 Op=JoinOperator; InOpIds=4,5; OutOpIds=8;
</span><span id=__span-110-37><a id=__codelineno-110-37 name=__codelineno-110-37></a><a href=#__codelineno-110-37><span class=linenos data-linenos="37 "></span></a>  JoinOperator(id=6)
</span><span id=__span-110-38><a id=__codelineno-110-38 name=__codelineno-110-38></a><a href=#__codelineno-110-38><span class=linenos data-linenos="38 "></span></a>    JoinType: INNER
</span><span id=__span-110-39><a id=__codelineno-110-39 name=__codelineno-110-39></a><a href=#__codelineno-110-39><span class=linenos data-linenos="39 "></span></a>    Joins: JoinPair: Node=friend RelOrNode=_anon2 Type=SOURCE
</span><span id=__span-110-40><a id=__codelineno-110-40 name=__codelineno-110-40></a><a href=#__codelineno-110-40><span class=linenos data-linenos="40 "></span></a>*
</span><span id=__span-110-41><a id=__codelineno-110-41 name=__codelineno-110-41></a><a href=#__codelineno-110-41><span class=linenos data-linenos="41 "></span></a>----------------------------------------------------------------------
</span><span id=__span-110-42><a id=__codelineno-110-42 name=__codelineno-110-42></a><a href=#__codelineno-110-42><span class=linenos data-linenos="42 "></span></a>Level 4:
</span><span id=__span-110-43><a id=__codelineno-110-43 name=__codelineno-110-43></a><a href=#__codelineno-110-43><span class=linenos data-linenos="43 "></span></a>----------------------------------------------------------------------
</span><span id=__span-110-44><a id=__codelineno-110-44 name=__codelineno-110-44></a><a href=#__codelineno-110-44><span class=linenos data-linenos="44 "></span></a>OpId=8 Op=JoinOperator; InOpIds=6,7; OutOpIds=10;
</span><span id=__span-110-45><a id=__codelineno-110-45 name=__codelineno-110-45></a><a href=#__codelineno-110-45><span class=linenos data-linenos="45 "></span></a>  JoinOperator(id=8)
</span><span id=__span-110-46><a id=__codelineno-110-46 name=__codelineno-110-46></a><a href=#__codelineno-110-46><span class=linenos data-linenos="46 "></span></a>    JoinType: INNER
</span><span id=__span-110-47><a id=__codelineno-110-47 name=__codelineno-110-47></a><a href=#__codelineno-110-47><span class=linenos data-linenos="47 "></span></a>    Joins: JoinPair: Node=c RelOrNode=_anon2 Type=SINK
</span><span id=__span-110-48><a id=__codelineno-110-48 name=__codelineno-110-48></a><a href=#__codelineno-110-48><span class=linenos data-linenos="48 "></span></a>*
</span><span id=__span-110-49><a id=__codelineno-110-49 name=__codelineno-110-49></a><a href=#__codelineno-110-49><span class=linenos data-linenos="49 "></span></a>----------------------------------------------------------------------
</span><span id=__span-110-50><a id=__codelineno-110-50 name=__codelineno-110-50></a><a href=#__codelineno-110-50><span class=linenos data-linenos="50 "></span></a>Level 5:
</span><span id=__span-110-51><a id=__codelineno-110-51 name=__codelineno-110-51></a><a href=#__codelineno-110-51><span class=linenos data-linenos="51 "></span></a>----------------------------------------------------------------------
</span><span id=__span-110-52><a id=__codelineno-110-52 name=__codelineno-110-52></a><a href=#__codelineno-110-52><span class=linenos data-linenos="52 "></span></a>OpId=10 Op=ProjectionOperator; InOpIds=8; OutOpIds=;
</span><span id=__span-110-53><a id=__codelineno-110-53 name=__codelineno-110-53></a><a href=#__codelineno-110-53><span class=linenos data-linenos="53 "></span></a>  ProjectionOperator(id=10)
</span><span id=__span-110-54><a id=__codelineno-110-54 name=__codelineno-110-54></a><a href=#__codelineno-110-54><span class=linenos data-linenos="54 "></span></a>    Projections: name=p.name, tech_connections=COUNT(DISTINCT friend)
</span><span id=__span-110-55><a id=__codelineno-110-55 name=__codelineno-110-55></a><a href=#__codelineno-110-55><span class=linenos data-linenos="55 "></span></a>    Filter: (c.industry EQ &#39;Technology&#39;)
</span><span id=__span-110-56><a id=__codelineno-110-56 name=__codelineno-110-56></a><a href=#__codelineno-110-56><span class=linenos data-linenos="56 "></span></a>*
</span><span id=__span-110-57><a id=__codelineno-110-57 name=__codelineno-110-57></a><a href=#__codelineno-110-57><span class=linenos data-linenos="57 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=38-inline-property-filter-on-source-node>38. Inline property filter on source node<a class=headerlink href=#38-inline-property-filter-on-source-node title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Inline filters (source node)</p> <details class=note> <summary>Notes</summary> <p>Inline property filter {name: 'Alice'} applied on source node.</p> <p>EQUIVALENT TO: MATCH (p:Person)-[:KNOWS]-&gt;(f:Person) WHERE p.name = 'Alice' RETURN p.name, f.name</p> <p>SYNTAX: More compact and readable - filter is part of the pattern.</p> <p>SQL PATTERN: FROM (SELECT ... FROM Person WHERE name = 'Alice') AS p JOIN Knows ON p.id = person_id JOIN Person AS f ON f.id = friend_id</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-111-1><a id=__codelineno-111-1 name=__codelineno-111-1></a><a href=#__codelineno-111-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=w> </span><span class=p>{</span><span class=n>name</span><span class=p>:</span><span class=w> </span><span class=s>&#39;Alice&#39;</span><span class=p>})</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>f</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-111-2><a id=__codelineno-111-2 name=__codelineno-111-2></a><a href=#__codelineno-111-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>name</span>
</span><span id=__span-111-3><a id=__codelineno-111-3 name=__codelineno-111-3></a><a href=#__codelineno-111-3><span class=linenos data-linenos="3 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=m>20</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-112-1><a id=__codelineno-112-1 name=__codelineno-112-1></a><a href=#__codelineno-112-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-112-2><a id=__codelineno-112-2 name=__codelineno-112-2></a><a href=#__codelineno-112-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-112-3><a id=__codelineno-112-3 name=__codelineno-112-3></a><a href=#__codelineno-112-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-112-4><a id=__codelineno-112-4 name=__codelineno-112-4></a><a href=#__codelineno-112-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-112-5><a id=__codelineno-112-5 name=__codelineno-112-5></a><a href=#__codelineno-112-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-112-6><a id=__codelineno-112-6 name=__codelineno-112-6></a><a href=#__codelineno-112-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-112-7><a id=__codelineno-112-7 name=__codelineno-112-7></a><a href=#__codelineno-112-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-112-8><a id=__codelineno-112-8 name=__codelineno-112-8></a><a href=#__codelineno-112-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-112-9><a id=__codelineno-112-9 name=__codelineno-112-9></a><a href=#__codelineno-112-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-112-10><a id=__codelineno-112-10 name=__codelineno-112-10></a><a href=#__codelineno-112-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-112-11><a id=__codelineno-112-11 name=__codelineno-112-11></a><a href=#__codelineno-112-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-112-12><a id=__codelineno-112-12 name=__codelineno-112-12></a><a href=#__codelineno-112-12><span class=linenos data-linenos="12 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-112-13><a id=__codelineno-112-13 name=__codelineno-112-13></a><a href=#__codelineno-112-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-112-14><a id=__codelineno-112-14 name=__codelineno-112-14></a><a href=#__codelineno-112-14><span class=linenos data-linenos="14 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-112-15><a id=__codelineno-112-15 name=__codelineno-112-15></a><a href=#__codelineno-112-15><span class=linenos data-linenos="15 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-112-16><a id=__codelineno-112-16 name=__codelineno-112-16></a><a href=#__codelineno-112-16><span class=linenos data-linenos="16 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-112-17><a id=__codelineno-112-17 name=__codelineno-112-17></a><a href=#__codelineno-112-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-112-18><a id=__codelineno-112-18 name=__codelineno-112-18></a><a href=#__codelineno-112-18><span class=linenos data-linenos="18 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-112-19><a id=__codelineno-112-19 name=__codelineno-112-19></a><a href=#__codelineno-112-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-112-20><a id=__codelineno-112-20 name=__codelineno-112-20></a><a href=#__codelineno-112-20><span class=linenos data-linenos="20 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-112-21><a id=__codelineno-112-21 name=__codelineno-112-21></a><a href=#__codelineno-112-21><span class=linenos data-linenos="21 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-112-22><a id=__codelineno-112-22 name=__codelineno-112-22></a><a href=#__codelineno-112-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-112-23><a id=__codelineno-112-23 name=__codelineno-112-23></a><a href=#__codelineno-112-23><span class=linenos data-linenos="23 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-112-24><a id=__codelineno-112-24 name=__codelineno-112-24></a><a href=#__codelineno-112-24><span class=linenos data-linenos="24 "></span></a><span class=w>      </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Alice&#39;</span><span class=p>))</span>
</span><span id=__span-112-25><a id=__codelineno-112-25 name=__codelineno-112-25></a><a href=#__codelineno-112-25><span class=linenos data-linenos="25 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-112-26><a id=__codelineno-112-26 name=__codelineno-112-26></a><a href=#__codelineno-112-26><span class=linenos data-linenos="26 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-112-27><a id=__codelineno-112-27 name=__codelineno-112-27></a><a href=#__codelineno-112-27><span class=linenos data-linenos="27 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-112-28><a id=__codelineno-112-28 name=__codelineno-112-28></a><a href=#__codelineno-112-28><span class=linenos data-linenos="28 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-112-29><a id=__codelineno-112-29 name=__codelineno-112-29></a><a href=#__codelineno-112-29><span class=linenos data-linenos="29 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-112-30><a id=__codelineno-112-30 name=__codelineno-112-30></a><a href=#__codelineno-112-30><span class=linenos data-linenos="30 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-112-31><a id=__codelineno-112-31 name=__codelineno-112-31></a><a href=#__codelineno-112-31><span class=linenos data-linenos="31 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-112-32><a id=__codelineno-112-32 name=__codelineno-112-32></a><a href=#__codelineno-112-32><span class=linenos data-linenos="32 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-112-33><a id=__codelineno-112-33 name=__codelineno-112-33></a><a href=#__codelineno-112-33><span class=linenos data-linenos="33 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-112-34><a id=__codelineno-112-34 name=__codelineno-112-34></a><a href=#__codelineno-112-34><span class=linenos data-linenos="34 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-112-35><a id=__codelineno-112-35 name=__codelineno-112-35></a><a href=#__codelineno-112-35><span class=linenos data-linenos="35 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-112-36><a id=__codelineno-112-36 name=__codelineno-112-36></a><a href=#__codelineno-112-36><span class=linenos data-linenos="36 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-112-37><a id=__codelineno-112-37 name=__codelineno-112-37></a><a href=#__codelineno-112-37><span class=linenos data-linenos="37 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-112-38><a id=__codelineno-112-38 name=__codelineno-112-38></a><a href=#__codelineno-112-38><span class=linenos data-linenos="38 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-112-39><a id=__codelineno-112-39 name=__codelineno-112-39></a><a href=#__codelineno-112-39><span class=linenos data-linenos="39 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-112-40><a id=__codelineno-112-40 name=__codelineno-112-40></a><a href=#__codelineno-112-40><span class=linenos data-linenos="40 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-112-41><a id=__codelineno-112-41 name=__codelineno-112-41></a><a href=#__codelineno-112-41><span class=linenos data-linenos="41 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-112-42><a id=__codelineno-112-42 name=__codelineno-112-42></a><a href=#__codelineno-112-42><span class=linenos data-linenos="42 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-112-43><a id=__codelineno-112-43 name=__codelineno-112-43></a><a href=#__codelineno-112-43><span class=linenos data-linenos="43 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-112-44><a id=__codelineno-112-44 name=__codelineno-112-44></a><a href=#__codelineno-112-44><span class=linenos data-linenos="44 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=mi>20</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-113-1><a id=__codelineno-113-1 name=__codelineno-113-1></a><a href=#__codelineno-113-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-113-2><a id=__codelineno-113-2 name=__codelineno-113-2></a><a href=#__codelineno-113-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-113-3><a id=__codelineno-113-3 name=__codelineno-113-3></a><a href=#__codelineno-113-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-113-4><a id=__codelineno-113-4 name=__codelineno-113-4></a><a href=#__codelineno-113-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-113-5><a id=__codelineno-113-5 name=__codelineno-113-5></a><a href=#__codelineno-113-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-113-6><a id=__codelineno-113-6 name=__codelineno-113-6></a><a href=#__codelineno-113-6><span class=linenos data-linenos=" 6 "></span></a>    Filter: (p.name EQ &#39;Alice&#39;)
</span><span id=__span-113-7><a id=__codelineno-113-7 name=__codelineno-113-7></a><a href=#__codelineno-113-7><span class=linenos data-linenos=" 7 "></span></a>*
</span><span id=__span-113-8><a id=__codelineno-113-8 name=__codelineno-113-8></a><a href=#__codelineno-113-8><span class=linenos data-linenos=" 8 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-113-9><a id=__codelineno-113-9 name=__codelineno-113-9></a><a href=#__codelineno-113-9><span class=linenos data-linenos=" 9 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-113-10><a id=__codelineno-113-10 name=__codelineno-113-10></a><a href=#__codelineno-113-10><span class=linenos data-linenos="10 "></span></a>    DataSource: [_anon1:KNOWS]-&gt;
</span><span id=__span-113-11><a id=__codelineno-113-11 name=__codelineno-113-11></a><a href=#__codelineno-113-11><span class=linenos data-linenos="11 "></span></a>*
</span><span id=__span-113-12><a id=__codelineno-113-12 name=__codelineno-113-12></a><a href=#__codelineno-113-12><span class=linenos data-linenos="12 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-113-13><a id=__codelineno-113-13 name=__codelineno-113-13></a><a href=#__codelineno-113-13><span class=linenos data-linenos="13 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-113-14><a id=__codelineno-113-14 name=__codelineno-113-14></a><a href=#__codelineno-113-14><span class=linenos data-linenos="14 "></span></a>    DataSource: f:Person
</span><span id=__span-113-15><a id=__codelineno-113-15 name=__codelineno-113-15></a><a href=#__codelineno-113-15><span class=linenos data-linenos="15 "></span></a>*
</span><span id=__span-113-16><a id=__codelineno-113-16 name=__codelineno-113-16></a><a href=#__codelineno-113-16><span class=linenos data-linenos="16 "></span></a>----------------------------------------------------------------------
</span><span id=__span-113-17><a id=__codelineno-113-17 name=__codelineno-113-17></a><a href=#__codelineno-113-17><span class=linenos data-linenos="17 "></span></a>Level 1:
</span><span id=__span-113-18><a id=__codelineno-113-18 name=__codelineno-113-18></a><a href=#__codelineno-113-18><span class=linenos data-linenos="18 "></span></a>----------------------------------------------------------------------
</span><span id=__span-113-19><a id=__codelineno-113-19 name=__codelineno-113-19></a><a href=#__codelineno-113-19><span class=linenos data-linenos="19 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-113-20><a id=__codelineno-113-20 name=__codelineno-113-20></a><a href=#__codelineno-113-20><span class=linenos data-linenos="20 "></span></a>  JoinOperator(id=4)
</span><span id=__span-113-21><a id=__codelineno-113-21 name=__codelineno-113-21></a><a href=#__codelineno-113-21><span class=linenos data-linenos="21 "></span></a>    JoinType: INNER
</span><span id=__span-113-22><a id=__codelineno-113-22 name=__codelineno-113-22></a><a href=#__codelineno-113-22><span class=linenos data-linenos="22 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-113-23><a id=__codelineno-113-23 name=__codelineno-113-23></a><a href=#__codelineno-113-23><span class=linenos data-linenos="23 "></span></a>*
</span><span id=__span-113-24><a id=__codelineno-113-24 name=__codelineno-113-24></a><a href=#__codelineno-113-24><span class=linenos data-linenos="24 "></span></a>----------------------------------------------------------------------
</span><span id=__span-113-25><a id=__codelineno-113-25 name=__codelineno-113-25></a><a href=#__codelineno-113-25><span class=linenos data-linenos="25 "></span></a>Level 2:
</span><span id=__span-113-26><a id=__codelineno-113-26 name=__codelineno-113-26></a><a href=#__codelineno-113-26><span class=linenos data-linenos="26 "></span></a>----------------------------------------------------------------------
</span><span id=__span-113-27><a id=__codelineno-113-27 name=__codelineno-113-27></a><a href=#__codelineno-113-27><span class=linenos data-linenos="27 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=7;
</span><span id=__span-113-28><a id=__codelineno-113-28 name=__codelineno-113-28></a><a href=#__codelineno-113-28><span class=linenos data-linenos="28 "></span></a>  JoinOperator(id=5)
</span><span id=__span-113-29><a id=__codelineno-113-29 name=__codelineno-113-29></a><a href=#__codelineno-113-29><span class=linenos data-linenos="29 "></span></a>    JoinType: INNER
</span><span id=__span-113-30><a id=__codelineno-113-30 name=__codelineno-113-30></a><a href=#__codelineno-113-30><span class=linenos data-linenos="30 "></span></a>    Joins: JoinPair: Node=f RelOrNode=_anon1 Type=SINK
</span><span id=__span-113-31><a id=__codelineno-113-31 name=__codelineno-113-31></a><a href=#__codelineno-113-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-113-32><a id=__codelineno-113-32 name=__codelineno-113-32></a><a href=#__codelineno-113-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span><span id=__span-113-33><a id=__codelineno-113-33 name=__codelineno-113-33></a><a href=#__codelineno-113-33><span class=linenos data-linenos="33 "></span></a>Level 3:
</span><span id=__span-113-34><a id=__codelineno-113-34 name=__codelineno-113-34></a><a href=#__codelineno-113-34><span class=linenos data-linenos="34 "></span></a>----------------------------------------------------------------------
</span><span id=__span-113-35><a id=__codelineno-113-35 name=__codelineno-113-35></a><a href=#__codelineno-113-35><span class=linenos data-linenos="35 "></span></a>OpId=7 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-113-36><a id=__codelineno-113-36 name=__codelineno-113-36></a><a href=#__codelineno-113-36><span class=linenos data-linenos="36 "></span></a>  ProjectionOperator(id=7)
</span><span id=__span-113-37><a id=__codelineno-113-37 name=__codelineno-113-37></a><a href=#__codelineno-113-37><span class=linenos data-linenos="37 "></span></a>    Projections: name=p.name, name=f.name
</span><span id=__span-113-38><a id=__codelineno-113-38 name=__codelineno-113-38></a><a href=#__codelineno-113-38><span class=linenos data-linenos="38 "></span></a>*
</span><span id=__span-113-39><a id=__codelineno-113-39 name=__codelineno-113-39></a><a href=#__codelineno-113-39><span class=linenos data-linenos="39 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=39-inline-property-filter-on-target-node>39. Inline property filter on target node<a class=headerlink href=#39-inline-property-filter-on-target-node title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Inline filters (target node)</p> <details class=note> <summary>Notes</summary> <p>Inline property filter {age: 30} applied on target node.</p> <p>FILTER POSITION: Applied on right-hand side of the pattern.</p> <p>SQL PATTERN: FROM Person AS p JOIN Knows ON p.id = person_id JOIN (SELECT ... FROM Person WHERE age = 30) AS f ON f.id = friend_id</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-114-1><a id=__codelineno-114-1 name=__codelineno-114-1></a><a href=#__codelineno-114-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>f</span><span class=p>:</span><span class=n>Person</span><span class=w> </span><span class=p>{</span><span class=n>age</span><span class=p>:</span><span class=w> </span><span class=m>30</span><span class=p>})</span>
</span><span id=__span-114-2><a id=__codelineno-114-2 name=__codelineno-114-2></a><a href=#__codelineno-114-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>name</span>
</span><span id=__span-114-3><a id=__codelineno-114-3 name=__codelineno-114-3></a><a href=#__codelineno-114-3><span class=linenos data-linenos="3 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=m>20</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-115-1><a id=__codelineno-115-1 name=__codelineno-115-1></a><a href=#__codelineno-115-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-115-2><a id=__codelineno-115-2 name=__codelineno-115-2></a><a href=#__codelineno-115-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-115-3><a id=__codelineno-115-3 name=__codelineno-115-3></a><a href=#__codelineno-115-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-115-4><a id=__codelineno-115-4 name=__codelineno-115-4></a><a href=#__codelineno-115-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-115-5><a id=__codelineno-115-5 name=__codelineno-115-5></a><a href=#__codelineno-115-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-115-6><a id=__codelineno-115-6 name=__codelineno-115-6></a><a href=#__codelineno-115-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-115-7><a id=__codelineno-115-7 name=__codelineno-115-7></a><a href=#__codelineno-115-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-115-8><a id=__codelineno-115-8 name=__codelineno-115-8></a><a href=#__codelineno-115-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-115-9><a id=__codelineno-115-9 name=__codelineno-115-9></a><a href=#__codelineno-115-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-115-10><a id=__codelineno-115-10 name=__codelineno-115-10></a><a href=#__codelineno-115-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-115-11><a id=__codelineno-115-11 name=__codelineno-115-11></a><a href=#__codelineno-115-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-115-12><a id=__codelineno-115-12 name=__codelineno-115-12></a><a href=#__codelineno-115-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_age</span>
</span><span id=__span-115-13><a id=__codelineno-115-13 name=__codelineno-115-13></a><a href=#__codelineno-115-13><span class=linenos data-linenos="13 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-115-14><a id=__codelineno-115-14 name=__codelineno-115-14></a><a href=#__codelineno-115-14><span class=linenos data-linenos="14 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-115-15><a id=__codelineno-115-15 name=__codelineno-115-15></a><a href=#__codelineno-115-15><span class=linenos data-linenos="15 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-115-16><a id=__codelineno-115-16 name=__codelineno-115-16></a><a href=#__codelineno-115-16><span class=linenos data-linenos="16 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-115-17><a id=__codelineno-115-17 name=__codelineno-115-17></a><a href=#__codelineno-115-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-115-18><a id=__codelineno-115-18 name=__codelineno-115-18></a><a href=#__codelineno-115-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-115-19><a id=__codelineno-115-19 name=__codelineno-115-19></a><a href=#__codelineno-115-19><span class=linenos data-linenos="19 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-115-20><a id=__codelineno-115-20 name=__codelineno-115-20></a><a href=#__codelineno-115-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-115-21><a id=__codelineno-115-21 name=__codelineno-115-21></a><a href=#__codelineno-115-21><span class=linenos data-linenos="21 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-115-22><a id=__codelineno-115-22 name=__codelineno-115-22></a><a href=#__codelineno-115-22><span class=linenos data-linenos="22 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-115-23><a id=__codelineno-115-23 name=__codelineno-115-23></a><a href=#__codelineno-115-23><span class=linenos data-linenos="23 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-115-24><a id=__codelineno-115-24 name=__codelineno-115-24></a><a href=#__codelineno-115-24><span class=linenos data-linenos="24 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-115-25><a id=__codelineno-115-25 name=__codelineno-115-25></a><a href=#__codelineno-115-25><span class=linenos data-linenos="25 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-115-26><a id=__codelineno-115-26 name=__codelineno-115-26></a><a href=#__codelineno-115-26><span class=linenos data-linenos="26 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-115-27><a id=__codelineno-115-27 name=__codelineno-115-27></a><a href=#__codelineno-115-27><span class=linenos data-linenos="27 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-115-28><a id=__codelineno-115-28 name=__codelineno-115-28></a><a href=#__codelineno-115-28><span class=linenos data-linenos="28 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-115-29><a id=__codelineno-115-29 name=__codelineno-115-29></a><a href=#__codelineno-115-29><span class=linenos data-linenos="29 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-115-30><a id=__codelineno-115-30 name=__codelineno-115-30></a><a href=#__codelineno-115-30><span class=linenos data-linenos="30 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-115-31><a id=__codelineno-115-31 name=__codelineno-115-31></a><a href=#__codelineno-115-31><span class=linenos data-linenos="31 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-115-32><a id=__codelineno-115-32 name=__codelineno-115-32></a><a href=#__codelineno-115-32><span class=linenos data-linenos="32 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-115-33><a id=__codelineno-115-33 name=__codelineno-115-33></a><a href=#__codelineno-115-33><span class=linenos data-linenos="33 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-115-34><a id=__codelineno-115-34 name=__codelineno-115-34></a><a href=#__codelineno-115-34><span class=linenos data-linenos="34 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-115-35><a id=__codelineno-115-35 name=__codelineno-115-35></a><a href=#__codelineno-115-35><span class=linenos data-linenos="35 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-115-36><a id=__codelineno-115-36 name=__codelineno-115-36></a><a href=#__codelineno-115-36><span class=linenos data-linenos="36 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-115-37><a id=__codelineno-115-37 name=__codelineno-115-37></a><a href=#__codelineno-115-37><span class=linenos data-linenos="37 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-115-38><a id=__codelineno-115-38 name=__codelineno-115-38></a><a href=#__codelineno-115-38><span class=linenos data-linenos="38 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-115-39><a id=__codelineno-115-39 name=__codelineno-115-39></a><a href=#__codelineno-115-39><span class=linenos data-linenos="39 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_age</span>
</span><span id=__span-115-40><a id=__codelineno-115-40 name=__codelineno-115-40></a><a href=#__codelineno-115-40><span class=linenos data-linenos="40 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-115-41><a id=__codelineno-115-41 name=__codelineno-115-41></a><a href=#__codelineno-115-41><span class=linenos data-linenos="41 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-115-42><a id=__codelineno-115-42 name=__codelineno-115-42></a><a href=#__codelineno-115-42><span class=linenos data-linenos="42 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>age</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=mi>30</span><span class=p>))</span>
</span><span id=__span-115-43><a id=__codelineno-115-43 name=__codelineno-115-43></a><a href=#__codelineno-115-43><span class=linenos data-linenos="43 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-115-44><a id=__codelineno-115-44 name=__codelineno-115-44></a><a href=#__codelineno-115-44><span class=linenos data-linenos="44 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-115-45><a id=__codelineno-115-45 name=__codelineno-115-45></a><a href=#__codelineno-115-45><span class=linenos data-linenos="45 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-115-46><a id=__codelineno-115-46 name=__codelineno-115-46></a><a href=#__codelineno-115-46><span class=linenos data-linenos="46 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=mi>20</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-116-1><a id=__codelineno-116-1 name=__codelineno-116-1></a><a href=#__codelineno-116-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-116-2><a id=__codelineno-116-2 name=__codelineno-116-2></a><a href=#__codelineno-116-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-116-3><a id=__codelineno-116-3 name=__codelineno-116-3></a><a href=#__codelineno-116-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-116-4><a id=__codelineno-116-4 name=__codelineno-116-4></a><a href=#__codelineno-116-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-116-5><a id=__codelineno-116-5 name=__codelineno-116-5></a><a href=#__codelineno-116-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-116-6><a id=__codelineno-116-6 name=__codelineno-116-6></a><a href=#__codelineno-116-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-116-7><a id=__codelineno-116-7 name=__codelineno-116-7></a><a href=#__codelineno-116-7><span class=linenos data-linenos=" 7 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-116-8><a id=__codelineno-116-8 name=__codelineno-116-8></a><a href=#__codelineno-116-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-116-9><a id=__codelineno-116-9 name=__codelineno-116-9></a><a href=#__codelineno-116-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: [_anon1:KNOWS]-&gt;
</span><span id=__span-116-10><a id=__codelineno-116-10 name=__codelineno-116-10></a><a href=#__codelineno-116-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-116-11><a id=__codelineno-116-11 name=__codelineno-116-11></a><a href=#__codelineno-116-11><span class=linenos data-linenos="11 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-116-12><a id=__codelineno-116-12 name=__codelineno-116-12></a><a href=#__codelineno-116-12><span class=linenos data-linenos="12 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-116-13><a id=__codelineno-116-13 name=__codelineno-116-13></a><a href=#__codelineno-116-13><span class=linenos data-linenos="13 "></span></a>    DataSource: f:Person
</span><span id=__span-116-14><a id=__codelineno-116-14 name=__codelineno-116-14></a><a href=#__codelineno-116-14><span class=linenos data-linenos="14 "></span></a>    Filter: (f.age EQ 30)
</span><span id=__span-116-15><a id=__codelineno-116-15 name=__codelineno-116-15></a><a href=#__codelineno-116-15><span class=linenos data-linenos="15 "></span></a>*
</span><span id=__span-116-16><a id=__codelineno-116-16 name=__codelineno-116-16></a><a href=#__codelineno-116-16><span class=linenos data-linenos="16 "></span></a>----------------------------------------------------------------------
</span><span id=__span-116-17><a id=__codelineno-116-17 name=__codelineno-116-17></a><a href=#__codelineno-116-17><span class=linenos data-linenos="17 "></span></a>Level 1:
</span><span id=__span-116-18><a id=__codelineno-116-18 name=__codelineno-116-18></a><a href=#__codelineno-116-18><span class=linenos data-linenos="18 "></span></a>----------------------------------------------------------------------
</span><span id=__span-116-19><a id=__codelineno-116-19 name=__codelineno-116-19></a><a href=#__codelineno-116-19><span class=linenos data-linenos="19 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-116-20><a id=__codelineno-116-20 name=__codelineno-116-20></a><a href=#__codelineno-116-20><span class=linenos data-linenos="20 "></span></a>  JoinOperator(id=4)
</span><span id=__span-116-21><a id=__codelineno-116-21 name=__codelineno-116-21></a><a href=#__codelineno-116-21><span class=linenos data-linenos="21 "></span></a>    JoinType: INNER
</span><span id=__span-116-22><a id=__codelineno-116-22 name=__codelineno-116-22></a><a href=#__codelineno-116-22><span class=linenos data-linenos="22 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-116-23><a id=__codelineno-116-23 name=__codelineno-116-23></a><a href=#__codelineno-116-23><span class=linenos data-linenos="23 "></span></a>*
</span><span id=__span-116-24><a id=__codelineno-116-24 name=__codelineno-116-24></a><a href=#__codelineno-116-24><span class=linenos data-linenos="24 "></span></a>----------------------------------------------------------------------
</span><span id=__span-116-25><a id=__codelineno-116-25 name=__codelineno-116-25></a><a href=#__codelineno-116-25><span class=linenos data-linenos="25 "></span></a>Level 2:
</span><span id=__span-116-26><a id=__codelineno-116-26 name=__codelineno-116-26></a><a href=#__codelineno-116-26><span class=linenos data-linenos="26 "></span></a>----------------------------------------------------------------------
</span><span id=__span-116-27><a id=__codelineno-116-27 name=__codelineno-116-27></a><a href=#__codelineno-116-27><span class=linenos data-linenos="27 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=7;
</span><span id=__span-116-28><a id=__codelineno-116-28 name=__codelineno-116-28></a><a href=#__codelineno-116-28><span class=linenos data-linenos="28 "></span></a>  JoinOperator(id=5)
</span><span id=__span-116-29><a id=__codelineno-116-29 name=__codelineno-116-29></a><a href=#__codelineno-116-29><span class=linenos data-linenos="29 "></span></a>    JoinType: INNER
</span><span id=__span-116-30><a id=__codelineno-116-30 name=__codelineno-116-30></a><a href=#__codelineno-116-30><span class=linenos data-linenos="30 "></span></a>    Joins: JoinPair: Node=f RelOrNode=_anon1 Type=SINK
</span><span id=__span-116-31><a id=__codelineno-116-31 name=__codelineno-116-31></a><a href=#__codelineno-116-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-116-32><a id=__codelineno-116-32 name=__codelineno-116-32></a><a href=#__codelineno-116-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span><span id=__span-116-33><a id=__codelineno-116-33 name=__codelineno-116-33></a><a href=#__codelineno-116-33><span class=linenos data-linenos="33 "></span></a>Level 3:
</span><span id=__span-116-34><a id=__codelineno-116-34 name=__codelineno-116-34></a><a href=#__codelineno-116-34><span class=linenos data-linenos="34 "></span></a>----------------------------------------------------------------------
</span><span id=__span-116-35><a id=__codelineno-116-35 name=__codelineno-116-35></a><a href=#__codelineno-116-35><span class=linenos data-linenos="35 "></span></a>OpId=7 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-116-36><a id=__codelineno-116-36 name=__codelineno-116-36></a><a href=#__codelineno-116-36><span class=linenos data-linenos="36 "></span></a>  ProjectionOperator(id=7)
</span><span id=__span-116-37><a id=__codelineno-116-37 name=__codelineno-116-37></a><a href=#__codelineno-116-37><span class=linenos data-linenos="37 "></span></a>    Projections: name=p.name, name=f.name
</span><span id=__span-116-38><a id=__codelineno-116-38 name=__codelineno-116-38></a><a href=#__codelineno-116-38><span class=linenos data-linenos="38 "></span></a>*
</span><span id=__span-116-39><a id=__codelineno-116-39 name=__codelineno-116-39></a><a href=#__codelineno-116-39><span class=linenos data-linenos="39 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=40-inline-property-filter-on-relationship>40. Inline property filter on relationship<a class=headerlink href=#40-inline-property-filter-on-relationship title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Inline filters (relationship)</p> <details class=note> <summary>Notes</summary> <p>Inline property filter {since: 2020} applied on relationship.</p> <p>USE CASE: Filter edges by their properties (timestamps, weights, etc).</p> <p>SQL PATTERN: FROM Person AS p JOIN (SELECT ... FROM Knows WHERE since = 2020) AS e ON p.id = e.person_id JOIN Person AS f ON f.id = e.friend_id</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-117-1><a id=__codelineno-117-1 name=__codelineno-117-1></a><a href=#__codelineno-117-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=w> </span><span class=p>{</span><span class=n>since</span><span class=p>:</span><span class=w> </span><span class=m>2020</span><span class=p>}</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>f</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-117-2><a id=__codelineno-117-2 name=__codelineno-117-2></a><a href=#__codelineno-117-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>name</span>
</span><span id=__span-117-3><a id=__codelineno-117-3 name=__codelineno-117-3></a><a href=#__codelineno-117-3><span class=linenos data-linenos="3 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=m>20</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-118-1><a id=__codelineno-118-1 name=__codelineno-118-1></a><a href=#__codelineno-118-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-118-2><a id=__codelineno-118-2 name=__codelineno-118-2></a><a href=#__codelineno-118-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-118-3><a id=__codelineno-118-3 name=__codelineno-118-3></a><a href=#__codelineno-118-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-118-4><a id=__codelineno-118-4 name=__codelineno-118-4></a><a href=#__codelineno-118-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-118-5><a id=__codelineno-118-5 name=__codelineno-118-5></a><a href=#__codelineno-118-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-118-6><a id=__codelineno-118-6 name=__codelineno-118-6></a><a href=#__codelineno-118-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-118-7><a id=__codelineno-118-7 name=__codelineno-118-7></a><a href=#__codelineno-118-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-118-8><a id=__codelineno-118-8 name=__codelineno-118-8></a><a href=#__codelineno-118-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-118-9><a id=__codelineno-118-9 name=__codelineno-118-9></a><a href=#__codelineno-118-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-118-10><a id=__codelineno-118-10 name=__codelineno-118-10></a><a href=#__codelineno-118-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-118-11><a id=__codelineno-118-11 name=__codelineno-118-11></a><a href=#__codelineno-118-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-118-12><a id=__codelineno-118-12 name=__codelineno-118-12></a><a href=#__codelineno-118-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-118-13><a id=__codelineno-118-13 name=__codelineno-118-13></a><a href=#__codelineno-118-13><span class=linenos data-linenos="13 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-118-14><a id=__codelineno-118-14 name=__codelineno-118-14></a><a href=#__codelineno-118-14><span class=linenos data-linenos="14 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-118-15><a id=__codelineno-118-15 name=__codelineno-118-15></a><a href=#__codelineno-118-15><span class=linenos data-linenos="15 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-118-16><a id=__codelineno-118-16 name=__codelineno-118-16></a><a href=#__codelineno-118-16><span class=linenos data-linenos="16 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-118-17><a id=__codelineno-118-17 name=__codelineno-118-17></a><a href=#__codelineno-118-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-118-18><a id=__codelineno-118-18 name=__codelineno-118-18></a><a href=#__codelineno-118-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-118-19><a id=__codelineno-118-19 name=__codelineno-118-19></a><a href=#__codelineno-118-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-118-20><a id=__codelineno-118-20 name=__codelineno-118-20></a><a href=#__codelineno-118-20><span class=linenos data-linenos="20 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-118-21><a id=__codelineno-118-21 name=__codelineno-118-21></a><a href=#__codelineno-118-21><span class=linenos data-linenos="21 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-118-22><a id=__codelineno-118-22 name=__codelineno-118-22></a><a href=#__codelineno-118-22><span class=linenos data-linenos="22 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-118-23><a id=__codelineno-118-23 name=__codelineno-118-23></a><a href=#__codelineno-118-23><span class=linenos data-linenos="23 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-118-24><a id=__codelineno-118-24 name=__codelineno-118-24></a><a href=#__codelineno-118-24><span class=linenos data-linenos="24 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-118-25><a id=__codelineno-118-25 name=__codelineno-118-25></a><a href=#__codelineno-118-25><span class=linenos data-linenos="25 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-118-26><a id=__codelineno-118-26 name=__codelineno-118-26></a><a href=#__codelineno-118-26><span class=linenos data-linenos="26 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-118-27><a id=__codelineno-118-27 name=__codelineno-118-27></a><a href=#__codelineno-118-27><span class=linenos data-linenos="27 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-118-28><a id=__codelineno-118-28 name=__codelineno-118-28></a><a href=#__codelineno-118-28><span class=linenos data-linenos="28 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-118-29><a id=__codelineno-118-29 name=__codelineno-118-29></a><a href=#__codelineno-118-29><span class=linenos data-linenos="29 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-118-30><a id=__codelineno-118-30 name=__codelineno-118-30></a><a href=#__codelineno-118-30><span class=linenos data-linenos="30 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-118-31><a id=__codelineno-118-31 name=__codelineno-118-31></a><a href=#__codelineno-118-31><span class=linenos data-linenos="31 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-118-32><a id=__codelineno-118-32 name=__codelineno-118-32></a><a href=#__codelineno-118-32><span class=linenos data-linenos="32 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-118-33><a id=__codelineno-118-33 name=__codelineno-118-33></a><a href=#__codelineno-118-33><span class=linenos data-linenos="33 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-118-34><a id=__codelineno-118-34 name=__codelineno-118-34></a><a href=#__codelineno-118-34><span class=linenos data-linenos="34 "></span></a><span class=w>      </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>since</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=mi>2020</span><span class=p>))</span>
</span><span id=__span-118-35><a id=__codelineno-118-35 name=__codelineno-118-35></a><a href=#__codelineno-118-35><span class=linenos data-linenos="35 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-118-36><a id=__codelineno-118-36 name=__codelineno-118-36></a><a href=#__codelineno-118-36><span class=linenos data-linenos="36 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-118-37><a id=__codelineno-118-37 name=__codelineno-118-37></a><a href=#__codelineno-118-37><span class=linenos data-linenos="37 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-118-38><a id=__codelineno-118-38 name=__codelineno-118-38></a><a href=#__codelineno-118-38><span class=linenos data-linenos="38 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-118-39><a id=__codelineno-118-39 name=__codelineno-118-39></a><a href=#__codelineno-118-39><span class=linenos data-linenos="39 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-118-40><a id=__codelineno-118-40 name=__codelineno-118-40></a><a href=#__codelineno-118-40><span class=linenos data-linenos="40 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-118-41><a id=__codelineno-118-41 name=__codelineno-118-41></a><a href=#__codelineno-118-41><span class=linenos data-linenos="41 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-118-42><a id=__codelineno-118-42 name=__codelineno-118-42></a><a href=#__codelineno-118-42><span class=linenos data-linenos="42 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-118-43><a id=__codelineno-118-43 name=__codelineno-118-43></a><a href=#__codelineno-118-43><span class=linenos data-linenos="43 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-118-44><a id=__codelineno-118-44 name=__codelineno-118-44></a><a href=#__codelineno-118-44><span class=linenos data-linenos="44 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-118-45><a id=__codelineno-118-45 name=__codelineno-118-45></a><a href=#__codelineno-118-45><span class=linenos data-linenos="45 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-118-46><a id=__codelineno-118-46 name=__codelineno-118-46></a><a href=#__codelineno-118-46><span class=linenos data-linenos="46 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-118-47><a id=__codelineno-118-47 name=__codelineno-118-47></a><a href=#__codelineno-118-47><span class=linenos data-linenos="47 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=mi>20</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-119-1><a id=__codelineno-119-1 name=__codelineno-119-1></a><a href=#__codelineno-119-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-119-2><a id=__codelineno-119-2 name=__codelineno-119-2></a><a href=#__codelineno-119-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-119-3><a id=__codelineno-119-3 name=__codelineno-119-3></a><a href=#__codelineno-119-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-119-4><a id=__codelineno-119-4 name=__codelineno-119-4></a><a href=#__codelineno-119-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-119-5><a id=__codelineno-119-5 name=__codelineno-119-5></a><a href=#__codelineno-119-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-119-6><a id=__codelineno-119-6 name=__codelineno-119-6></a><a href=#__codelineno-119-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-119-7><a id=__codelineno-119-7 name=__codelineno-119-7></a><a href=#__codelineno-119-7><span class=linenos data-linenos=" 7 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-119-8><a id=__codelineno-119-8 name=__codelineno-119-8></a><a href=#__codelineno-119-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-119-9><a id=__codelineno-119-9 name=__codelineno-119-9></a><a href=#__codelineno-119-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: [_anon1:KNOWS]-&gt;
</span><span id=__span-119-10><a id=__codelineno-119-10 name=__codelineno-119-10></a><a href=#__codelineno-119-10><span class=linenos data-linenos="10 "></span></a>    Filter: (_anon1.since EQ 2020)
</span><span id=__span-119-11><a id=__codelineno-119-11 name=__codelineno-119-11></a><a href=#__codelineno-119-11><span class=linenos data-linenos="11 "></span></a>*
</span><span id=__span-119-12><a id=__codelineno-119-12 name=__codelineno-119-12></a><a href=#__codelineno-119-12><span class=linenos data-linenos="12 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-119-13><a id=__codelineno-119-13 name=__codelineno-119-13></a><a href=#__codelineno-119-13><span class=linenos data-linenos="13 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-119-14><a id=__codelineno-119-14 name=__codelineno-119-14></a><a href=#__codelineno-119-14><span class=linenos data-linenos="14 "></span></a>    DataSource: f:Person
</span><span id=__span-119-15><a id=__codelineno-119-15 name=__codelineno-119-15></a><a href=#__codelineno-119-15><span class=linenos data-linenos="15 "></span></a>*
</span><span id=__span-119-16><a id=__codelineno-119-16 name=__codelineno-119-16></a><a href=#__codelineno-119-16><span class=linenos data-linenos="16 "></span></a>----------------------------------------------------------------------
</span><span id=__span-119-17><a id=__codelineno-119-17 name=__codelineno-119-17></a><a href=#__codelineno-119-17><span class=linenos data-linenos="17 "></span></a>Level 1:
</span><span id=__span-119-18><a id=__codelineno-119-18 name=__codelineno-119-18></a><a href=#__codelineno-119-18><span class=linenos data-linenos="18 "></span></a>----------------------------------------------------------------------
</span><span id=__span-119-19><a id=__codelineno-119-19 name=__codelineno-119-19></a><a href=#__codelineno-119-19><span class=linenos data-linenos="19 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-119-20><a id=__codelineno-119-20 name=__codelineno-119-20></a><a href=#__codelineno-119-20><span class=linenos data-linenos="20 "></span></a>  JoinOperator(id=4)
</span><span id=__span-119-21><a id=__codelineno-119-21 name=__codelineno-119-21></a><a href=#__codelineno-119-21><span class=linenos data-linenos="21 "></span></a>    JoinType: INNER
</span><span id=__span-119-22><a id=__codelineno-119-22 name=__codelineno-119-22></a><a href=#__codelineno-119-22><span class=linenos data-linenos="22 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-119-23><a id=__codelineno-119-23 name=__codelineno-119-23></a><a href=#__codelineno-119-23><span class=linenos data-linenos="23 "></span></a>*
</span><span id=__span-119-24><a id=__codelineno-119-24 name=__codelineno-119-24></a><a href=#__codelineno-119-24><span class=linenos data-linenos="24 "></span></a>----------------------------------------------------------------------
</span><span id=__span-119-25><a id=__codelineno-119-25 name=__codelineno-119-25></a><a href=#__codelineno-119-25><span class=linenos data-linenos="25 "></span></a>Level 2:
</span><span id=__span-119-26><a id=__codelineno-119-26 name=__codelineno-119-26></a><a href=#__codelineno-119-26><span class=linenos data-linenos="26 "></span></a>----------------------------------------------------------------------
</span><span id=__span-119-27><a id=__codelineno-119-27 name=__codelineno-119-27></a><a href=#__codelineno-119-27><span class=linenos data-linenos="27 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=7;
</span><span id=__span-119-28><a id=__codelineno-119-28 name=__codelineno-119-28></a><a href=#__codelineno-119-28><span class=linenos data-linenos="28 "></span></a>  JoinOperator(id=5)
</span><span id=__span-119-29><a id=__codelineno-119-29 name=__codelineno-119-29></a><a href=#__codelineno-119-29><span class=linenos data-linenos="29 "></span></a>    JoinType: INNER
</span><span id=__span-119-30><a id=__codelineno-119-30 name=__codelineno-119-30></a><a href=#__codelineno-119-30><span class=linenos data-linenos="30 "></span></a>    Joins: JoinPair: Node=f RelOrNode=_anon1 Type=SINK
</span><span id=__span-119-31><a id=__codelineno-119-31 name=__codelineno-119-31></a><a href=#__codelineno-119-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-119-32><a id=__codelineno-119-32 name=__codelineno-119-32></a><a href=#__codelineno-119-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span><span id=__span-119-33><a id=__codelineno-119-33 name=__codelineno-119-33></a><a href=#__codelineno-119-33><span class=linenos data-linenos="33 "></span></a>Level 3:
</span><span id=__span-119-34><a id=__codelineno-119-34 name=__codelineno-119-34></a><a href=#__codelineno-119-34><span class=linenos data-linenos="34 "></span></a>----------------------------------------------------------------------
</span><span id=__span-119-35><a id=__codelineno-119-35 name=__codelineno-119-35></a><a href=#__codelineno-119-35><span class=linenos data-linenos="35 "></span></a>OpId=7 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-119-36><a id=__codelineno-119-36 name=__codelineno-119-36></a><a href=#__codelineno-119-36><span class=linenos data-linenos="36 "></span></a>  ProjectionOperator(id=7)
</span><span id=__span-119-37><a id=__codelineno-119-37 name=__codelineno-119-37></a><a href=#__codelineno-119-37><span class=linenos data-linenos="37 "></span></a>    Projections: name=p.name, name=f.name
</span><span id=__span-119-38><a id=__codelineno-119-38 name=__codelineno-119-38></a><a href=#__codelineno-119-38><span class=linenos data-linenos="38 "></span></a>*
</span><span id=__span-119-39><a id=__codelineno-119-39 name=__codelineno-119-39></a><a href=#__codelineno-119-39><span class=linenos data-linenos="39 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=41-multiple-inline-property-filters-on-same-element>41. Multiple inline property filters on same element<a class=headerlink href=#41-multiple-inline-property-filters-on-same-element title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Multiple inline filters</p> <details class=note> <summary>Notes</summary> <p>Multiple inline properties combined with AND automatically.</p> <p>EQUIVALENT TO: WHERE p.name = 'Alice' AND p.age = 30 AND p.active = true</p> <p>READABILITY: All filters for one element are grouped together.</p> <p>SQL PATTERN: FROM ( SELECT ... FROM Person WHERE name = 'Alice' AND age = 30 AND active = true ) AS p</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-120-1><a id=__codelineno-120-1 name=__codelineno-120-1></a><a href=#__codelineno-120-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=w> </span><span class=p>{</span><span class=n>name</span><span class=p>:</span><span class=w> </span><span class=s>&#39;Alice&#39;</span><span class=p>,</span><span class=w> </span><span class=n>age</span><span class=p>:</span><span class=w> </span><span class=m>30</span><span class=p>,</span><span class=w> </span><span class=n>active</span><span class=p>:</span><span class=w> </span><span class=k>true</span><span class=p>})</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>f</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-120-2><a id=__codelineno-120-2 name=__codelineno-120-2></a><a href=#__codelineno-120-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>age</span><span class=p>,</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>name</span>
</span><span id=__span-120-3><a id=__codelineno-120-3 name=__codelineno-120-3></a><a href=#__codelineno-120-3><span class=linenos data-linenos="3 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=m>20</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-121-1><a id=__codelineno-121-1 name=__codelineno-121-1></a><a href=#__codelineno-121-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-121-2><a id=__codelineno-121-2 name=__codelineno-121-2></a><a href=#__codelineno-121-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-121-3><a id=__codelineno-121-3 name=__codelineno-121-3></a><a href=#__codelineno-121-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_p_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>age</span>
</span><span id=__span-121-4><a id=__codelineno-121-4 name=__codelineno-121-4></a><a href=#__codelineno-121-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-121-5><a id=__codelineno-121-5 name=__codelineno-121-5></a><a href=#__codelineno-121-5><span class=linenos data-linenos=" 5 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-121-6><a id=__codelineno-121-6 name=__codelineno-121-6></a><a href=#__codelineno-121-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-121-7><a id=__codelineno-121-7 name=__codelineno-121-7></a><a href=#__codelineno-121-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-121-8><a id=__codelineno-121-8 name=__codelineno-121-8></a><a href=#__codelineno-121-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-121-9><a id=__codelineno-121-9 name=__codelineno-121-9></a><a href=#__codelineno-121-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-121-10><a id=__codelineno-121-10 name=__codelineno-121-10></a><a href=#__codelineno-121-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_active</span>
</span><span id=__span-121-11><a id=__codelineno-121-11 name=__codelineno-121-11></a><a href=#__codelineno-121-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-121-12><a id=__codelineno-121-12 name=__codelineno-121-12></a><a href=#__codelineno-121-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-121-13><a id=__codelineno-121-13 name=__codelineno-121-13></a><a href=#__codelineno-121-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-121-14><a id=__codelineno-121-14 name=__codelineno-121-14></a><a href=#__codelineno-121-14><span class=linenos data-linenos="14 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-121-15><a id=__codelineno-121-15 name=__codelineno-121-15></a><a href=#__codelineno-121-15><span class=linenos data-linenos="15 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-121-16><a id=__codelineno-121-16 name=__codelineno-121-16></a><a href=#__codelineno-121-16><span class=linenos data-linenos="16 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-121-17><a id=__codelineno-121-17 name=__codelineno-121-17></a><a href=#__codelineno-121-17><span class=linenos data-linenos="17 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-121-18><a id=__codelineno-121-18 name=__codelineno-121-18></a><a href=#__codelineno-121-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-121-19><a id=__codelineno-121-19 name=__codelineno-121-19></a><a href=#__codelineno-121-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-121-20><a id=__codelineno-121-20 name=__codelineno-121-20></a><a href=#__codelineno-121-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_active</span>
</span><span id=__span-121-21><a id=__codelineno-121-21 name=__codelineno-121-21></a><a href=#__codelineno-121-21><span class=linenos data-linenos="21 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-121-22><a id=__codelineno-121-22 name=__codelineno-121-22></a><a href=#__codelineno-121-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-121-23><a id=__codelineno-121-23 name=__codelineno-121-23></a><a href=#__codelineno-121-23><span class=linenos data-linenos="23 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-121-24><a id=__codelineno-121-24 name=__codelineno-121-24></a><a href=#__codelineno-121-24><span class=linenos data-linenos="24 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-121-25><a id=__codelineno-121-25 name=__codelineno-121-25></a><a href=#__codelineno-121-25><span class=linenos data-linenos="25 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-121-26><a id=__codelineno-121-26 name=__codelineno-121-26></a><a href=#__codelineno-121-26><span class=linenos data-linenos="26 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-121-27><a id=__codelineno-121-27 name=__codelineno-121-27></a><a href=#__codelineno-121-27><span class=linenos data-linenos="27 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_age</span>
</span><span id=__span-121-28><a id=__codelineno-121-28 name=__codelineno-121-28></a><a href=#__codelineno-121-28><span class=linenos data-linenos="28 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_active</span>
</span><span id=__span-121-29><a id=__codelineno-121-29 name=__codelineno-121-29></a><a href=#__codelineno-121-29><span class=linenos data-linenos="29 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-121-30><a id=__codelineno-121-30 name=__codelineno-121-30></a><a href=#__codelineno-121-30><span class=linenos data-linenos="30 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-121-31><a id=__codelineno-121-31 name=__codelineno-121-31></a><a href=#__codelineno-121-31><span class=linenos data-linenos="31 "></span></a><span class=w>      </span><span class=k>WHERE</span><span class=w> </span><span class=p>((((</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Alice&#39;</span><span class=p>))</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=p>((</span><span class=n>age</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=mi>30</span><span class=p>)))</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=p>((</span><span class=n>active</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=k>TRUE</span><span class=p>)))</span>
</span><span id=__span-121-32><a id=__codelineno-121-32 name=__codelineno-121-32></a><a href=#__codelineno-121-32><span class=linenos data-linenos="32 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-121-33><a id=__codelineno-121-33 name=__codelineno-121-33></a><a href=#__codelineno-121-33><span class=linenos data-linenos="33 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-121-34><a id=__codelineno-121-34 name=__codelineno-121-34></a><a href=#__codelineno-121-34><span class=linenos data-linenos="34 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-121-35><a id=__codelineno-121-35 name=__codelineno-121-35></a><a href=#__codelineno-121-35><span class=linenos data-linenos="35 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-121-36><a id=__codelineno-121-36 name=__codelineno-121-36></a><a href=#__codelineno-121-36><span class=linenos data-linenos="36 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-121-37><a id=__codelineno-121-37 name=__codelineno-121-37></a><a href=#__codelineno-121-37><span class=linenos data-linenos="37 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-121-38><a id=__codelineno-121-38 name=__codelineno-121-38></a><a href=#__codelineno-121-38><span class=linenos data-linenos="38 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-121-39><a id=__codelineno-121-39 name=__codelineno-121-39></a><a href=#__codelineno-121-39><span class=linenos data-linenos="39 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-121-40><a id=__codelineno-121-40 name=__codelineno-121-40></a><a href=#__codelineno-121-40><span class=linenos data-linenos="40 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-121-41><a id=__codelineno-121-41 name=__codelineno-121-41></a><a href=#__codelineno-121-41><span class=linenos data-linenos="41 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-121-42><a id=__codelineno-121-42 name=__codelineno-121-42></a><a href=#__codelineno-121-42><span class=linenos data-linenos="42 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-121-43><a id=__codelineno-121-43 name=__codelineno-121-43></a><a href=#__codelineno-121-43><span class=linenos data-linenos="43 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-121-44><a id=__codelineno-121-44 name=__codelineno-121-44></a><a href=#__codelineno-121-44><span class=linenos data-linenos="44 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-121-45><a id=__codelineno-121-45 name=__codelineno-121-45></a><a href=#__codelineno-121-45><span class=linenos data-linenos="45 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-121-46><a id=__codelineno-121-46 name=__codelineno-121-46></a><a href=#__codelineno-121-46><span class=linenos data-linenos="46 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-121-47><a id=__codelineno-121-47 name=__codelineno-121-47></a><a href=#__codelineno-121-47><span class=linenos data-linenos="47 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-121-48><a id=__codelineno-121-48 name=__codelineno-121-48></a><a href=#__codelineno-121-48><span class=linenos data-linenos="48 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-121-49><a id=__codelineno-121-49 name=__codelineno-121-49></a><a href=#__codelineno-121-49><span class=linenos data-linenos="49 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-121-50><a id=__codelineno-121-50 name=__codelineno-121-50></a><a href=#__codelineno-121-50><span class=linenos data-linenos="50 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-121-51><a id=__codelineno-121-51 name=__codelineno-121-51></a><a href=#__codelineno-121-51><span class=linenos data-linenos="51 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=mi>20</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-122-1><a id=__codelineno-122-1 name=__codelineno-122-1></a><a href=#__codelineno-122-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-122-2><a id=__codelineno-122-2 name=__codelineno-122-2></a><a href=#__codelineno-122-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-122-3><a id=__codelineno-122-3 name=__codelineno-122-3></a><a href=#__codelineno-122-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-122-4><a id=__codelineno-122-4 name=__codelineno-122-4></a><a href=#__codelineno-122-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-122-5><a id=__codelineno-122-5 name=__codelineno-122-5></a><a href=#__codelineno-122-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-122-6><a id=__codelineno-122-6 name=__codelineno-122-6></a><a href=#__codelineno-122-6><span class=linenos data-linenos=" 6 "></span></a>    Filter: (((p.name EQ &#39;Alice&#39;) AND (p.age EQ 30)) AND (p.active EQ true))
</span><span id=__span-122-7><a id=__codelineno-122-7 name=__codelineno-122-7></a><a href=#__codelineno-122-7><span class=linenos data-linenos=" 7 "></span></a>*
</span><span id=__span-122-8><a id=__codelineno-122-8 name=__codelineno-122-8></a><a href=#__codelineno-122-8><span class=linenos data-linenos=" 8 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-122-9><a id=__codelineno-122-9 name=__codelineno-122-9></a><a href=#__codelineno-122-9><span class=linenos data-linenos=" 9 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-122-10><a id=__codelineno-122-10 name=__codelineno-122-10></a><a href=#__codelineno-122-10><span class=linenos data-linenos="10 "></span></a>    DataSource: [_anon1:KNOWS]-&gt;
</span><span id=__span-122-11><a id=__codelineno-122-11 name=__codelineno-122-11></a><a href=#__codelineno-122-11><span class=linenos data-linenos="11 "></span></a>*
</span><span id=__span-122-12><a id=__codelineno-122-12 name=__codelineno-122-12></a><a href=#__codelineno-122-12><span class=linenos data-linenos="12 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-122-13><a id=__codelineno-122-13 name=__codelineno-122-13></a><a href=#__codelineno-122-13><span class=linenos data-linenos="13 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-122-14><a id=__codelineno-122-14 name=__codelineno-122-14></a><a href=#__codelineno-122-14><span class=linenos data-linenos="14 "></span></a>    DataSource: f:Person
</span><span id=__span-122-15><a id=__codelineno-122-15 name=__codelineno-122-15></a><a href=#__codelineno-122-15><span class=linenos data-linenos="15 "></span></a>*
</span><span id=__span-122-16><a id=__codelineno-122-16 name=__codelineno-122-16></a><a href=#__codelineno-122-16><span class=linenos data-linenos="16 "></span></a>----------------------------------------------------------------------
</span><span id=__span-122-17><a id=__codelineno-122-17 name=__codelineno-122-17></a><a href=#__codelineno-122-17><span class=linenos data-linenos="17 "></span></a>Level 1:
</span><span id=__span-122-18><a id=__codelineno-122-18 name=__codelineno-122-18></a><a href=#__codelineno-122-18><span class=linenos data-linenos="18 "></span></a>----------------------------------------------------------------------
</span><span id=__span-122-19><a id=__codelineno-122-19 name=__codelineno-122-19></a><a href=#__codelineno-122-19><span class=linenos data-linenos="19 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-122-20><a id=__codelineno-122-20 name=__codelineno-122-20></a><a href=#__codelineno-122-20><span class=linenos data-linenos="20 "></span></a>  JoinOperator(id=4)
</span><span id=__span-122-21><a id=__codelineno-122-21 name=__codelineno-122-21></a><a href=#__codelineno-122-21><span class=linenos data-linenos="21 "></span></a>    JoinType: INNER
</span><span id=__span-122-22><a id=__codelineno-122-22 name=__codelineno-122-22></a><a href=#__codelineno-122-22><span class=linenos data-linenos="22 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-122-23><a id=__codelineno-122-23 name=__codelineno-122-23></a><a href=#__codelineno-122-23><span class=linenos data-linenos="23 "></span></a>*
</span><span id=__span-122-24><a id=__codelineno-122-24 name=__codelineno-122-24></a><a href=#__codelineno-122-24><span class=linenos data-linenos="24 "></span></a>----------------------------------------------------------------------
</span><span id=__span-122-25><a id=__codelineno-122-25 name=__codelineno-122-25></a><a href=#__codelineno-122-25><span class=linenos data-linenos="25 "></span></a>Level 2:
</span><span id=__span-122-26><a id=__codelineno-122-26 name=__codelineno-122-26></a><a href=#__codelineno-122-26><span class=linenos data-linenos="26 "></span></a>----------------------------------------------------------------------
</span><span id=__span-122-27><a id=__codelineno-122-27 name=__codelineno-122-27></a><a href=#__codelineno-122-27><span class=linenos data-linenos="27 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=7;
</span><span id=__span-122-28><a id=__codelineno-122-28 name=__codelineno-122-28></a><a href=#__codelineno-122-28><span class=linenos data-linenos="28 "></span></a>  JoinOperator(id=5)
</span><span id=__span-122-29><a id=__codelineno-122-29 name=__codelineno-122-29></a><a href=#__codelineno-122-29><span class=linenos data-linenos="29 "></span></a>    JoinType: INNER
</span><span id=__span-122-30><a id=__codelineno-122-30 name=__codelineno-122-30></a><a href=#__codelineno-122-30><span class=linenos data-linenos="30 "></span></a>    Joins: JoinPair: Node=f RelOrNode=_anon1 Type=SINK
</span><span id=__span-122-31><a id=__codelineno-122-31 name=__codelineno-122-31></a><a href=#__codelineno-122-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-122-32><a id=__codelineno-122-32 name=__codelineno-122-32></a><a href=#__codelineno-122-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span><span id=__span-122-33><a id=__codelineno-122-33 name=__codelineno-122-33></a><a href=#__codelineno-122-33><span class=linenos data-linenos="33 "></span></a>Level 3:
</span><span id=__span-122-34><a id=__codelineno-122-34 name=__codelineno-122-34></a><a href=#__codelineno-122-34><span class=linenos data-linenos="34 "></span></a>----------------------------------------------------------------------
</span><span id=__span-122-35><a id=__codelineno-122-35 name=__codelineno-122-35></a><a href=#__codelineno-122-35><span class=linenos data-linenos="35 "></span></a>OpId=7 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-122-36><a id=__codelineno-122-36 name=__codelineno-122-36></a><a href=#__codelineno-122-36><span class=linenos data-linenos="36 "></span></a>  ProjectionOperator(id=7)
</span><span id=__span-122-37><a id=__codelineno-122-37 name=__codelineno-122-37></a><a href=#__codelineno-122-37><span class=linenos data-linenos="37 "></span></a>    Projections: name=p.name, age=p.age, name=f.name
</span><span id=__span-122-38><a id=__codelineno-122-38 name=__codelineno-122-38></a><a href=#__codelineno-122-38><span class=linenos data-linenos="38 "></span></a>*
</span><span id=__span-122-39><a id=__codelineno-122-39 name=__codelineno-122-39></a><a href=#__codelineno-122-39><span class=linenos data-linenos="39 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=42-combined-inline-filters-source-target-and-relationship>42. Combined inline filters - source, target, and relationship<a class=headerlink href=#42-combined-inline-filters-source-target-and-relationship title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Inline filters (combined)</p> <details class=note> <summary>Notes</summary> <p>Inline filters on ALL three elements: source, relationship, target.</p> <p>EQUIVALENT TO: WHERE p.name = 'Alice' AND r.since = 2020 AND f.age = 30</p> <p>READABILITY BENEFIT: Filters are positioned next to the elements they constrain.</p> <p>SQL PATTERN: FROM (SELECT ... FROM Person WHERE name = 'Alice') AS p JOIN (SELECT ... FROM Knows WHERE since = 2020) AS e ON ... JOIN (SELECT ... FROM Person WHERE age = 30) AS f ON ...</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-123-1><a id=__codelineno-123-1 name=__codelineno-123-1></a><a href=#__codelineno-123-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=w> </span><span class=p>{</span><span class=n>name</span><span class=p>:</span><span class=w> </span><span class=s>&#39;Alice&#39;</span><span class=p>})</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=w> </span><span class=p>{</span><span class=n>since</span><span class=p>:</span><span class=w> </span><span class=m>2020</span><span class=p>}</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>f</span><span class=p>:</span><span class=n>Person</span><span class=w> </span><span class=p>{</span><span class=n>age</span><span class=p>:</span><span class=w> </span><span class=m>30</span><span class=p>})</span>
</span><span id=__span-123-2><a id=__codelineno-123-2 name=__codelineno-123-2></a><a href=#__codelineno-123-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>name</span>
</span><span id=__span-123-3><a id=__codelineno-123-3 name=__codelineno-123-3></a><a href=#__codelineno-123-3><span class=linenos data-linenos="3 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=m>20</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-124-1><a id=__codelineno-124-1 name=__codelineno-124-1></a><a href=#__codelineno-124-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-124-2><a id=__codelineno-124-2 name=__codelineno-124-2></a><a href=#__codelineno-124-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-124-3><a id=__codelineno-124-3 name=__codelineno-124-3></a><a href=#__codelineno-124-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-124-4><a id=__codelineno-124-4 name=__codelineno-124-4></a><a href=#__codelineno-124-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-124-5><a id=__codelineno-124-5 name=__codelineno-124-5></a><a href=#__codelineno-124-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-124-6><a id=__codelineno-124-6 name=__codelineno-124-6></a><a href=#__codelineno-124-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-124-7><a id=__codelineno-124-7 name=__codelineno-124-7></a><a href=#__codelineno-124-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-124-8><a id=__codelineno-124-8 name=__codelineno-124-8></a><a href=#__codelineno-124-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-124-9><a id=__codelineno-124-9 name=__codelineno-124-9></a><a href=#__codelineno-124-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-124-10><a id=__codelineno-124-10 name=__codelineno-124-10></a><a href=#__codelineno-124-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-124-11><a id=__codelineno-124-11 name=__codelineno-124-11></a><a href=#__codelineno-124-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-124-12><a id=__codelineno-124-12 name=__codelineno-124-12></a><a href=#__codelineno-124-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-124-13><a id=__codelineno-124-13 name=__codelineno-124-13></a><a href=#__codelineno-124-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_age</span>
</span><span id=__span-124-14><a id=__codelineno-124-14 name=__codelineno-124-14></a><a href=#__codelineno-124-14><span class=linenos data-linenos="14 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-124-15><a id=__codelineno-124-15 name=__codelineno-124-15></a><a href=#__codelineno-124-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-124-16><a id=__codelineno-124-16 name=__codelineno-124-16></a><a href=#__codelineno-124-16><span class=linenos data-linenos="16 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-124-17><a id=__codelineno-124-17 name=__codelineno-124-17></a><a href=#__codelineno-124-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-124-18><a id=__codelineno-124-18 name=__codelineno-124-18></a><a href=#__codelineno-124-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-124-19><a id=__codelineno-124-19 name=__codelineno-124-19></a><a href=#__codelineno-124-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-124-20><a id=__codelineno-124-20 name=__codelineno-124-20></a><a href=#__codelineno-124-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-124-21><a id=__codelineno-124-21 name=__codelineno-124-21></a><a href=#__codelineno-124-21><span class=linenos data-linenos="21 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-124-22><a id=__codelineno-124-22 name=__codelineno-124-22></a><a href=#__codelineno-124-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-124-23><a id=__codelineno-124-23 name=__codelineno-124-23></a><a href=#__codelineno-124-23><span class=linenos data-linenos="23 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-124-24><a id=__codelineno-124-24 name=__codelineno-124-24></a><a href=#__codelineno-124-24><span class=linenos data-linenos="24 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-124-25><a id=__codelineno-124-25 name=__codelineno-124-25></a><a href=#__codelineno-124-25><span class=linenos data-linenos="25 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-124-26><a id=__codelineno-124-26 name=__codelineno-124-26></a><a href=#__codelineno-124-26><span class=linenos data-linenos="26 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-124-27><a id=__codelineno-124-27 name=__codelineno-124-27></a><a href=#__codelineno-124-27><span class=linenos data-linenos="27 "></span></a><span class=w>      </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Alice&#39;</span><span class=p>))</span>
</span><span id=__span-124-28><a id=__codelineno-124-28 name=__codelineno-124-28></a><a href=#__codelineno-124-28><span class=linenos data-linenos="28 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-124-29><a id=__codelineno-124-29 name=__codelineno-124-29></a><a href=#__codelineno-124-29><span class=linenos data-linenos="29 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-124-30><a id=__codelineno-124-30 name=__codelineno-124-30></a><a href=#__codelineno-124-30><span class=linenos data-linenos="30 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-124-31><a id=__codelineno-124-31 name=__codelineno-124-31></a><a href=#__codelineno-124-31><span class=linenos data-linenos="31 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-124-32><a id=__codelineno-124-32 name=__codelineno-124-32></a><a href=#__codelineno-124-32><span class=linenos data-linenos="32 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-124-33><a id=__codelineno-124-33 name=__codelineno-124-33></a><a href=#__codelineno-124-33><span class=linenos data-linenos="33 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>since</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_since</span>
</span><span id=__span-124-34><a id=__codelineno-124-34 name=__codelineno-124-34></a><a href=#__codelineno-124-34><span class=linenos data-linenos="34 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-124-35><a id=__codelineno-124-35 name=__codelineno-124-35></a><a href=#__codelineno-124-35><span class=linenos data-linenos="35 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-124-36><a id=__codelineno-124-36 name=__codelineno-124-36></a><a href=#__codelineno-124-36><span class=linenos data-linenos="36 "></span></a><span class=w>      </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>since</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=mi>2020</span><span class=p>))</span>
</span><span id=__span-124-37><a id=__codelineno-124-37 name=__codelineno-124-37></a><a href=#__codelineno-124-37><span class=linenos data-linenos="37 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-124-38><a id=__codelineno-124-38 name=__codelineno-124-38></a><a href=#__codelineno-124-38><span class=linenos data-linenos="38 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-124-39><a id=__codelineno-124-39 name=__codelineno-124-39></a><a href=#__codelineno-124-39><span class=linenos data-linenos="39 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-124-40><a id=__codelineno-124-40 name=__codelineno-124-40></a><a href=#__codelineno-124-40><span class=linenos data-linenos="40 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-124-41><a id=__codelineno-124-41 name=__codelineno-124-41></a><a href=#__codelineno-124-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-124-42><a id=__codelineno-124-42 name=__codelineno-124-42></a><a href=#__codelineno-124-42><span class=linenos data-linenos="42 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-124-43><a id=__codelineno-124-43 name=__codelineno-124-43></a><a href=#__codelineno-124-43><span class=linenos data-linenos="43 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-124-44><a id=__codelineno-124-44 name=__codelineno-124-44></a><a href=#__codelineno-124-44><span class=linenos data-linenos="44 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_age</span>
</span><span id=__span-124-45><a id=__codelineno-124-45 name=__codelineno-124-45></a><a href=#__codelineno-124-45><span class=linenos data-linenos="45 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-124-46><a id=__codelineno-124-46 name=__codelineno-124-46></a><a href=#__codelineno-124-46><span class=linenos data-linenos="46 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-124-47><a id=__codelineno-124-47 name=__codelineno-124-47></a><a href=#__codelineno-124-47><span class=linenos data-linenos="47 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>age</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=mi>30</span><span class=p>))</span>
</span><span id=__span-124-48><a id=__codelineno-124-48 name=__codelineno-124-48></a><a href=#__codelineno-124-48><span class=linenos data-linenos="48 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-124-49><a id=__codelineno-124-49 name=__codelineno-124-49></a><a href=#__codelineno-124-49><span class=linenos data-linenos="49 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-124-50><a id=__codelineno-124-50 name=__codelineno-124-50></a><a href=#__codelineno-124-50><span class=linenos data-linenos="50 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-124-51><a id=__codelineno-124-51 name=__codelineno-124-51></a><a href=#__codelineno-124-51><span class=linenos data-linenos="51 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=mi>20</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-125-1><a id=__codelineno-125-1 name=__codelineno-125-1></a><a href=#__codelineno-125-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-125-2><a id=__codelineno-125-2 name=__codelineno-125-2></a><a href=#__codelineno-125-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-125-3><a id=__codelineno-125-3 name=__codelineno-125-3></a><a href=#__codelineno-125-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-125-4><a id=__codelineno-125-4 name=__codelineno-125-4></a><a href=#__codelineno-125-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-125-5><a id=__codelineno-125-5 name=__codelineno-125-5></a><a href=#__codelineno-125-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-125-6><a id=__codelineno-125-6 name=__codelineno-125-6></a><a href=#__codelineno-125-6><span class=linenos data-linenos=" 6 "></span></a>    Filter: (p.name EQ &#39;Alice&#39;)
</span><span id=__span-125-7><a id=__codelineno-125-7 name=__codelineno-125-7></a><a href=#__codelineno-125-7><span class=linenos data-linenos=" 7 "></span></a>*
</span><span id=__span-125-8><a id=__codelineno-125-8 name=__codelineno-125-8></a><a href=#__codelineno-125-8><span class=linenos data-linenos=" 8 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-125-9><a id=__codelineno-125-9 name=__codelineno-125-9></a><a href=#__codelineno-125-9><span class=linenos data-linenos=" 9 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-125-10><a id=__codelineno-125-10 name=__codelineno-125-10></a><a href=#__codelineno-125-10><span class=linenos data-linenos="10 "></span></a>    DataSource: [_anon1:KNOWS]-&gt;
</span><span id=__span-125-11><a id=__codelineno-125-11 name=__codelineno-125-11></a><a href=#__codelineno-125-11><span class=linenos data-linenos="11 "></span></a>    Filter: (_anon1.since EQ 2020)
</span><span id=__span-125-12><a id=__codelineno-125-12 name=__codelineno-125-12></a><a href=#__codelineno-125-12><span class=linenos data-linenos="12 "></span></a>*
</span><span id=__span-125-13><a id=__codelineno-125-13 name=__codelineno-125-13></a><a href=#__codelineno-125-13><span class=linenos data-linenos="13 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-125-14><a id=__codelineno-125-14 name=__codelineno-125-14></a><a href=#__codelineno-125-14><span class=linenos data-linenos="14 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-125-15><a id=__codelineno-125-15 name=__codelineno-125-15></a><a href=#__codelineno-125-15><span class=linenos data-linenos="15 "></span></a>    DataSource: f:Person
</span><span id=__span-125-16><a id=__codelineno-125-16 name=__codelineno-125-16></a><a href=#__codelineno-125-16><span class=linenos data-linenos="16 "></span></a>    Filter: (f.age EQ 30)
</span><span id=__span-125-17><a id=__codelineno-125-17 name=__codelineno-125-17></a><a href=#__codelineno-125-17><span class=linenos data-linenos="17 "></span></a>*
</span><span id=__span-125-18><a id=__codelineno-125-18 name=__codelineno-125-18></a><a href=#__codelineno-125-18><span class=linenos data-linenos="18 "></span></a>----------------------------------------------------------------------
</span><span id=__span-125-19><a id=__codelineno-125-19 name=__codelineno-125-19></a><a href=#__codelineno-125-19><span class=linenos data-linenos="19 "></span></a>Level 1:
</span><span id=__span-125-20><a id=__codelineno-125-20 name=__codelineno-125-20></a><a href=#__codelineno-125-20><span class=linenos data-linenos="20 "></span></a>----------------------------------------------------------------------
</span><span id=__span-125-21><a id=__codelineno-125-21 name=__codelineno-125-21></a><a href=#__codelineno-125-21><span class=linenos data-linenos="21 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-125-22><a id=__codelineno-125-22 name=__codelineno-125-22></a><a href=#__codelineno-125-22><span class=linenos data-linenos="22 "></span></a>  JoinOperator(id=4)
</span><span id=__span-125-23><a id=__codelineno-125-23 name=__codelineno-125-23></a><a href=#__codelineno-125-23><span class=linenos data-linenos="23 "></span></a>    JoinType: INNER
</span><span id=__span-125-24><a id=__codelineno-125-24 name=__codelineno-125-24></a><a href=#__codelineno-125-24><span class=linenos data-linenos="24 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-125-25><a id=__codelineno-125-25 name=__codelineno-125-25></a><a href=#__codelineno-125-25><span class=linenos data-linenos="25 "></span></a>*
</span><span id=__span-125-26><a id=__codelineno-125-26 name=__codelineno-125-26></a><a href=#__codelineno-125-26><span class=linenos data-linenos="26 "></span></a>----------------------------------------------------------------------
</span><span id=__span-125-27><a id=__codelineno-125-27 name=__codelineno-125-27></a><a href=#__codelineno-125-27><span class=linenos data-linenos="27 "></span></a>Level 2:
</span><span id=__span-125-28><a id=__codelineno-125-28 name=__codelineno-125-28></a><a href=#__codelineno-125-28><span class=linenos data-linenos="28 "></span></a>----------------------------------------------------------------------
</span><span id=__span-125-29><a id=__codelineno-125-29 name=__codelineno-125-29></a><a href=#__codelineno-125-29><span class=linenos data-linenos="29 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=7;
</span><span id=__span-125-30><a id=__codelineno-125-30 name=__codelineno-125-30></a><a href=#__codelineno-125-30><span class=linenos data-linenos="30 "></span></a>  JoinOperator(id=5)
</span><span id=__span-125-31><a id=__codelineno-125-31 name=__codelineno-125-31></a><a href=#__codelineno-125-31><span class=linenos data-linenos="31 "></span></a>    JoinType: INNER
</span><span id=__span-125-32><a id=__codelineno-125-32 name=__codelineno-125-32></a><a href=#__codelineno-125-32><span class=linenos data-linenos="32 "></span></a>    Joins: JoinPair: Node=f RelOrNode=_anon1 Type=SINK
</span><span id=__span-125-33><a id=__codelineno-125-33 name=__codelineno-125-33></a><a href=#__codelineno-125-33><span class=linenos data-linenos="33 "></span></a>*
</span><span id=__span-125-34><a id=__codelineno-125-34 name=__codelineno-125-34></a><a href=#__codelineno-125-34><span class=linenos data-linenos="34 "></span></a>----------------------------------------------------------------------
</span><span id=__span-125-35><a id=__codelineno-125-35 name=__codelineno-125-35></a><a href=#__codelineno-125-35><span class=linenos data-linenos="35 "></span></a>Level 3:
</span><span id=__span-125-36><a id=__codelineno-125-36 name=__codelineno-125-36></a><a href=#__codelineno-125-36><span class=linenos data-linenos="36 "></span></a>----------------------------------------------------------------------
</span><span id=__span-125-37><a id=__codelineno-125-37 name=__codelineno-125-37></a><a href=#__codelineno-125-37><span class=linenos data-linenos="37 "></span></a>OpId=7 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-125-38><a id=__codelineno-125-38 name=__codelineno-125-38></a><a href=#__codelineno-125-38><span class=linenos data-linenos="38 "></span></a>  ProjectionOperator(id=7)
</span><span id=__span-125-39><a id=__codelineno-125-39 name=__codelineno-125-39></a><a href=#__codelineno-125-39><span class=linenos data-linenos="39 "></span></a>    Projections: name=p.name, name=f.name
</span><span id=__span-125-40><a id=__codelineno-125-40 name=__codelineno-125-40></a><a href=#__codelineno-125-40><span class=linenos data-linenos="40 "></span></a>*
</span><span id=__span-125-41><a id=__codelineno-125-41 name=__codelineno-125-41></a><a href=#__codelineno-125-41><span class=linenos data-linenos="41 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=43-inline-filter-combined-with-explicit-where-clause>43. Inline filter combined with explicit WHERE clause<a class=headerlink href=#43-inline-filter-combined-with-explicit-where-clause title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Inline + WHERE</p> <details class=note> <summary>Notes</summary> <p>Inline filters can be combined with explicit WHERE clause.</p> <p>COMBINED AS: (p.name = 'Alice') AND (f.age &gt; 25)</p> <p>BEST PRACTICE: - Use inline for equality filters (property = value) - Use WHERE for complex predicates (&gt;, &lt;, BETWEEN, etc.)</p> <p>SQL PATTERN: FROM (SELECT ... FROM Person WHERE name = 'Alice') AS p JOIN Knows ON ... JOIN Person AS f ON ... WHERE f.age &gt; 25</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-126-1><a id=__codelineno-126-1 name=__codelineno-126-1></a><a href=#__codelineno-126-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=w> </span><span class=p>{</span><span class=n>name</span><span class=p>:</span><span class=w> </span><span class=s>&#39;Alice&#39;</span><span class=p>})</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>f</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-126-2><a id=__codelineno-126-2 name=__codelineno-126-2></a><a href=#__codelineno-126-2><span class=linenos data-linenos="2 "></span></a><span class=k>WHERE</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=p>&gt;</span><span class=w> </span><span class=m>25</span>
</span><span id=__span-126-3><a id=__codelineno-126-3 name=__codelineno-126-3></a><a href=#__codelineno-126-3><span class=linenos data-linenos="3 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>name</span>
</span><span id=__span-126-4><a id=__codelineno-126-4 name=__codelineno-126-4></a><a href=#__codelineno-126-4><span class=linenos data-linenos="4 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=m>20</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-127-1><a id=__codelineno-127-1 name=__codelineno-127-1></a><a href=#__codelineno-127-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-127-2><a id=__codelineno-127-2 name=__codelineno-127-2></a><a href=#__codelineno-127-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-127-3><a id=__codelineno-127-3 name=__codelineno-127-3></a><a href=#__codelineno-127-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-127-4><a id=__codelineno-127-4 name=__codelineno-127-4></a><a href=#__codelineno-127-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-127-5><a id=__codelineno-127-5 name=__codelineno-127-5></a><a href=#__codelineno-127-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-127-6><a id=__codelineno-127-6 name=__codelineno-127-6></a><a href=#__codelineno-127-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-127-7><a id=__codelineno-127-7 name=__codelineno-127-7></a><a href=#__codelineno-127-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-127-8><a id=__codelineno-127-8 name=__codelineno-127-8></a><a href=#__codelineno-127-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-127-9><a id=__codelineno-127-9 name=__codelineno-127-9></a><a href=#__codelineno-127-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-127-10><a id=__codelineno-127-10 name=__codelineno-127-10></a><a href=#__codelineno-127-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-127-11><a id=__codelineno-127-11 name=__codelineno-127-11></a><a href=#__codelineno-127-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-127-12><a id=__codelineno-127-12 name=__codelineno-127-12></a><a href=#__codelineno-127-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_age</span>
</span><span id=__span-127-13><a id=__codelineno-127-13 name=__codelineno-127-13></a><a href=#__codelineno-127-13><span class=linenos data-linenos="13 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-127-14><a id=__codelineno-127-14 name=__codelineno-127-14></a><a href=#__codelineno-127-14><span class=linenos data-linenos="14 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-127-15><a id=__codelineno-127-15 name=__codelineno-127-15></a><a href=#__codelineno-127-15><span class=linenos data-linenos="15 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-127-16><a id=__codelineno-127-16 name=__codelineno-127-16></a><a href=#__codelineno-127-16><span class=linenos data-linenos="16 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-127-17><a id=__codelineno-127-17 name=__codelineno-127-17></a><a href=#__codelineno-127-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-127-18><a id=__codelineno-127-18 name=__codelineno-127-18></a><a href=#__codelineno-127-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-127-19><a id=__codelineno-127-19 name=__codelineno-127-19></a><a href=#__codelineno-127-19><span class=linenos data-linenos="19 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-127-20><a id=__codelineno-127-20 name=__codelineno-127-20></a><a href=#__codelineno-127-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-127-21><a id=__codelineno-127-21 name=__codelineno-127-21></a><a href=#__codelineno-127-21><span class=linenos data-linenos="21 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-127-22><a id=__codelineno-127-22 name=__codelineno-127-22></a><a href=#__codelineno-127-22><span class=linenos data-linenos="22 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-127-23><a id=__codelineno-127-23 name=__codelineno-127-23></a><a href=#__codelineno-127-23><span class=linenos data-linenos="23 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-127-24><a id=__codelineno-127-24 name=__codelineno-127-24></a><a href=#__codelineno-127-24><span class=linenos data-linenos="24 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-127-25><a id=__codelineno-127-25 name=__codelineno-127-25></a><a href=#__codelineno-127-25><span class=linenos data-linenos="25 "></span></a><span class=w>      </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Alice&#39;</span><span class=p>))</span>
</span><span id=__span-127-26><a id=__codelineno-127-26 name=__codelineno-127-26></a><a href=#__codelineno-127-26><span class=linenos data-linenos="26 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-127-27><a id=__codelineno-127-27 name=__codelineno-127-27></a><a href=#__codelineno-127-27><span class=linenos data-linenos="27 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-127-28><a id=__codelineno-127-28 name=__codelineno-127-28></a><a href=#__codelineno-127-28><span class=linenos data-linenos="28 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-127-29><a id=__codelineno-127-29 name=__codelineno-127-29></a><a href=#__codelineno-127-29><span class=linenos data-linenos="29 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-127-30><a id=__codelineno-127-30 name=__codelineno-127-30></a><a href=#__codelineno-127-30><span class=linenos data-linenos="30 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-127-31><a id=__codelineno-127-31 name=__codelineno-127-31></a><a href=#__codelineno-127-31><span class=linenos data-linenos="31 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-127-32><a id=__codelineno-127-32 name=__codelineno-127-32></a><a href=#__codelineno-127-32><span class=linenos data-linenos="32 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-127-33><a id=__codelineno-127-33 name=__codelineno-127-33></a><a href=#__codelineno-127-33><span class=linenos data-linenos="33 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-127-34><a id=__codelineno-127-34 name=__codelineno-127-34></a><a href=#__codelineno-127-34><span class=linenos data-linenos="34 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-127-35><a id=__codelineno-127-35 name=__codelineno-127-35></a><a href=#__codelineno-127-35><span class=linenos data-linenos="35 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-127-36><a id=__codelineno-127-36 name=__codelineno-127-36></a><a href=#__codelineno-127-36><span class=linenos data-linenos="36 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-127-37><a id=__codelineno-127-37 name=__codelineno-127-37></a><a href=#__codelineno-127-37><span class=linenos data-linenos="37 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-127-38><a id=__codelineno-127-38 name=__codelineno-127-38></a><a href=#__codelineno-127-38><span class=linenos data-linenos="38 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-127-39><a id=__codelineno-127-39 name=__codelineno-127-39></a><a href=#__codelineno-127-39><span class=linenos data-linenos="39 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-127-40><a id=__codelineno-127-40 name=__codelineno-127-40></a><a href=#__codelineno-127-40><span class=linenos data-linenos="40 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_age</span>
</span><span id=__span-127-41><a id=__codelineno-127-41 name=__codelineno-127-41></a><a href=#__codelineno-127-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-127-42><a id=__codelineno-127-42 name=__codelineno-127-42></a><a href=#__codelineno-127-42><span class=linenos data-linenos="42 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-127-43><a id=__codelineno-127-43 name=__codelineno-127-43></a><a href=#__codelineno-127-43><span class=linenos data-linenos="43 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>age</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=mi>25</span><span class=p>))</span>
</span><span id=__span-127-44><a id=__codelineno-127-44 name=__codelineno-127-44></a><a href=#__codelineno-127-44><span class=linenos data-linenos="44 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-127-45><a id=__codelineno-127-45 name=__codelineno-127-45></a><a href=#__codelineno-127-45><span class=linenos data-linenos="45 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-127-46><a id=__codelineno-127-46 name=__codelineno-127-46></a><a href=#__codelineno-127-46><span class=linenos data-linenos="46 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-127-47><a id=__codelineno-127-47 name=__codelineno-127-47></a><a href=#__codelineno-127-47><span class=linenos data-linenos="47 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=mi>20</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-128-1><a id=__codelineno-128-1 name=__codelineno-128-1></a><a href=#__codelineno-128-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-128-2><a id=__codelineno-128-2 name=__codelineno-128-2></a><a href=#__codelineno-128-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-128-3><a id=__codelineno-128-3 name=__codelineno-128-3></a><a href=#__codelineno-128-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-128-4><a id=__codelineno-128-4 name=__codelineno-128-4></a><a href=#__codelineno-128-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-128-5><a id=__codelineno-128-5 name=__codelineno-128-5></a><a href=#__codelineno-128-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-128-6><a id=__codelineno-128-6 name=__codelineno-128-6></a><a href=#__codelineno-128-6><span class=linenos data-linenos=" 6 "></span></a>    Filter: (p.name EQ &#39;Alice&#39;)
</span><span id=__span-128-7><a id=__codelineno-128-7 name=__codelineno-128-7></a><a href=#__codelineno-128-7><span class=linenos data-linenos=" 7 "></span></a>*
</span><span id=__span-128-8><a id=__codelineno-128-8 name=__codelineno-128-8></a><a href=#__codelineno-128-8><span class=linenos data-linenos=" 8 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-128-9><a id=__codelineno-128-9 name=__codelineno-128-9></a><a href=#__codelineno-128-9><span class=linenos data-linenos=" 9 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-128-10><a id=__codelineno-128-10 name=__codelineno-128-10></a><a href=#__codelineno-128-10><span class=linenos data-linenos="10 "></span></a>    DataSource: [_anon1:KNOWS]-&gt;
</span><span id=__span-128-11><a id=__codelineno-128-11 name=__codelineno-128-11></a><a href=#__codelineno-128-11><span class=linenos data-linenos="11 "></span></a>*
</span><span id=__span-128-12><a id=__codelineno-128-12 name=__codelineno-128-12></a><a href=#__codelineno-128-12><span class=linenos data-linenos="12 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-128-13><a id=__codelineno-128-13 name=__codelineno-128-13></a><a href=#__codelineno-128-13><span class=linenos data-linenos="13 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-128-14><a id=__codelineno-128-14 name=__codelineno-128-14></a><a href=#__codelineno-128-14><span class=linenos data-linenos="14 "></span></a>    DataSource: f:Person
</span><span id=__span-128-15><a id=__codelineno-128-15 name=__codelineno-128-15></a><a href=#__codelineno-128-15><span class=linenos data-linenos="15 "></span></a>    Filter: (f.age GT 25)
</span><span id=__span-128-16><a id=__codelineno-128-16 name=__codelineno-128-16></a><a href=#__codelineno-128-16><span class=linenos data-linenos="16 "></span></a>*
</span><span id=__span-128-17><a id=__codelineno-128-17 name=__codelineno-128-17></a><a href=#__codelineno-128-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-128-18><a id=__codelineno-128-18 name=__codelineno-128-18></a><a href=#__codelineno-128-18><span class=linenos data-linenos="18 "></span></a>Level 1:
</span><span id=__span-128-19><a id=__codelineno-128-19 name=__codelineno-128-19></a><a href=#__codelineno-128-19><span class=linenos data-linenos="19 "></span></a>----------------------------------------------------------------------
</span><span id=__span-128-20><a id=__codelineno-128-20 name=__codelineno-128-20></a><a href=#__codelineno-128-20><span class=linenos data-linenos="20 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-128-21><a id=__codelineno-128-21 name=__codelineno-128-21></a><a href=#__codelineno-128-21><span class=linenos data-linenos="21 "></span></a>  JoinOperator(id=4)
</span><span id=__span-128-22><a id=__codelineno-128-22 name=__codelineno-128-22></a><a href=#__codelineno-128-22><span class=linenos data-linenos="22 "></span></a>    JoinType: INNER
</span><span id=__span-128-23><a id=__codelineno-128-23 name=__codelineno-128-23></a><a href=#__codelineno-128-23><span class=linenos data-linenos="23 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-128-24><a id=__codelineno-128-24 name=__codelineno-128-24></a><a href=#__codelineno-128-24><span class=linenos data-linenos="24 "></span></a>*
</span><span id=__span-128-25><a id=__codelineno-128-25 name=__codelineno-128-25></a><a href=#__codelineno-128-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-128-26><a id=__codelineno-128-26 name=__codelineno-128-26></a><a href=#__codelineno-128-26><span class=linenos data-linenos="26 "></span></a>Level 2:
</span><span id=__span-128-27><a id=__codelineno-128-27 name=__codelineno-128-27></a><a href=#__codelineno-128-27><span class=linenos data-linenos="27 "></span></a>----------------------------------------------------------------------
</span><span id=__span-128-28><a id=__codelineno-128-28 name=__codelineno-128-28></a><a href=#__codelineno-128-28><span class=linenos data-linenos="28 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=7;
</span><span id=__span-128-29><a id=__codelineno-128-29 name=__codelineno-128-29></a><a href=#__codelineno-128-29><span class=linenos data-linenos="29 "></span></a>  JoinOperator(id=5)
</span><span id=__span-128-30><a id=__codelineno-128-30 name=__codelineno-128-30></a><a href=#__codelineno-128-30><span class=linenos data-linenos="30 "></span></a>    JoinType: INNER
</span><span id=__span-128-31><a id=__codelineno-128-31 name=__codelineno-128-31></a><a href=#__codelineno-128-31><span class=linenos data-linenos="31 "></span></a>    Joins: JoinPair: Node=f RelOrNode=_anon1 Type=SINK
</span><span id=__span-128-32><a id=__codelineno-128-32 name=__codelineno-128-32></a><a href=#__codelineno-128-32><span class=linenos data-linenos="32 "></span></a>*
</span><span id=__span-128-33><a id=__codelineno-128-33 name=__codelineno-128-33></a><a href=#__codelineno-128-33><span class=linenos data-linenos="33 "></span></a>----------------------------------------------------------------------
</span><span id=__span-128-34><a id=__codelineno-128-34 name=__codelineno-128-34></a><a href=#__codelineno-128-34><span class=linenos data-linenos="34 "></span></a>Level 3:
</span><span id=__span-128-35><a id=__codelineno-128-35 name=__codelineno-128-35></a><a href=#__codelineno-128-35><span class=linenos data-linenos="35 "></span></a>----------------------------------------------------------------------
</span><span id=__span-128-36><a id=__codelineno-128-36 name=__codelineno-128-36></a><a href=#__codelineno-128-36><span class=linenos data-linenos="36 "></span></a>OpId=7 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-128-37><a id=__codelineno-128-37 name=__codelineno-128-37></a><a href=#__codelineno-128-37><span class=linenos data-linenos="37 "></span></a>  ProjectionOperator(id=7)
</span><span id=__span-128-38><a id=__codelineno-128-38 name=__codelineno-128-38></a><a href=#__codelineno-128-38><span class=linenos data-linenos="38 "></span></a>    Projections: name=p.name, name=f.name
</span><span id=__span-128-39><a id=__codelineno-128-39 name=__codelineno-128-39></a><a href=#__codelineno-128-39><span class=linenos data-linenos="39 "></span></a>*
</span><span id=__span-128-40><a id=__codelineno-128-40 name=__codelineno-128-40></a><a href=#__codelineno-128-40><span class=linenos data-linenos="40 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=44-bfs-with-inline-source-filter-critical-optimization>44. BFS with inline source filter (CRITICAL OPTIMIZATION)<a class=headerlink href=#44-bfs-with-inline-source-filter-critical-optimization title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Inline filters (BFS optimization)</p> <details class=note> <summary>Notes</summary> <p>CRITICAL OPTIMIZATION for variable-length paths!</p> <p>Inline filter on SOURCE node {name: 'Alice'} is pushed to the BASE CASE of the recursive CTE, so BFS starts ONLY from Alice, not from all nodes in the graph.</p> <p>PERFORMANCE IMPACT: - Without filter: O(N * E^k) - starts from ALL N nodes - With inline filter: O(1 * E^k) - starts from 1 node only - For large graphs, this is the difference between seconds and hours!</p> <p>EQUIVALENT TO: MATCH path = (a:Person)-[:KNOWS*1..3]-&gt;(b:Person) WHERE a.name = 'Alice'</p> <p>SQL PATTERN: WITH RECURSIVE bfs AS ( -- BASE CASE: Filter applied HERE (before traversal) SELECT e.src, e.dst, 1 AS depth FROM Knows e JOIN Person src ON src.id = e.src WHERE (src.name) = ('Alice')  INLINE FILTER OPTIMIZATION</p> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span class=linenos data-linenos="1 "></span>UNION ALL
<span class=linenos data-linenos="2 "></span>
<span class=linenos data-linenos="3 "></span>-- RECURSIVE CASE: No source filter (only depth check)
<span class=linenos data-linenos="4 "></span>SELECT e.src, e.dst, depth + 1
<span class=linenos data-linenos="5 "></span>FROM bfs b
<span class=linenos data-linenos="6 "></span>JOIN Knows e ON b.dst = e.src
<span class=linenos data-linenos="7 "></span>WHERE depth &lt; 3
</code></pre></div> <p>)</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-129-1><a id=__codelineno-129-1 name=__codelineno-129-1></a><a href=#__codelineno-129-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=n>path</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=p>:</span><span class=n>Person</span><span class=w> </span><span class=p>{</span><span class=n>name</span><span class=p>:</span><span class=w> </span><span class=s>&#39;Alice&#39;</span><span class=p>})</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=p>*</span><span class=m>1</span><span class=p>..</span><span class=m>3</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>b</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-129-2><a id=__codelineno-129-2 name=__codelineno-129-2></a><a href=#__codelineno-129-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>length</span><span class=p>(</span><span class=n>path</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>hops</span>
</span><span id=__span-129-3><a id=__codelineno-129-3 name=__codelineno-129-3></a><a href=#__codelineno-129-3><span class=linenos data-linenos="3 "></span></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>hops</span>
</span><span id=__span-129-4><a id=__codelineno-129-4 name=__codelineno-129-4></a><a href=#__codelineno-129-4><span class=linenos data-linenos="4 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=m>50</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-130-1><a id=__codelineno-130-1 name=__codelineno-130-1></a><a href=#__codelineno-130-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span>
</span><span id=__span-130-2><a id=__codelineno-130-2 name=__codelineno-130-2></a><a href=#__codelineno-130-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>  </span><span class=n>paths_1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-130-3><a id=__codelineno-130-3 name=__codelineno-130-3></a><a href=#__codelineno-130-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>    </span><span class=c1>-- Base case: direct edges (depth = 1)</span>
</span><span id=__span-130-4><a id=__codelineno-130-4 name=__codelineno-130-4></a><a href=#__codelineno-130-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-130-5><a id=__codelineno-130-5 name=__codelineno-130-5></a><a href=#__codelineno-130-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-130-6><a id=__codelineno-130-6 name=__codelineno-130-6></a><a href=#__codelineno-130-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-130-7><a id=__codelineno-130-7 name=__codelineno-130-7></a><a href=#__codelineno-130-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>      </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-130-8><a id=__codelineno-130-8 name=__codelineno-130-8></a><a href=#__codelineno-130-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-130-9><a id=__codelineno-130-9 name=__codelineno-130-9></a><a href=#__codelineno-130-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>NAMED_STRUCT</span><span class=p>(</span><span class=s1>&#39;person_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;friend_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;since&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>since</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;strength&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>strength</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path_edges</span><span class=p>,</span>
</span><span id=__span-130-10><a id=__codelineno-130-10 name=__codelineno-130-10></a><a href=#__codelineno-130-10><span class=linenos data-linenos="10 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-130-11><a id=__codelineno-130-11 name=__codelineno-130-11></a><a href=#__codelineno-130-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-130-12><a id=__codelineno-130-12 name=__codelineno-130-12></a><a href=#__codelineno-130-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=n>src</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>src</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span>
</span><span id=__span-130-13><a id=__codelineno-130-13 name=__codelineno-130-13></a><a href=#__codelineno-130-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=p>(</span><span class=n>src</span><span class=p>.</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Alice&#39;</span><span class=p>)</span>
</span><span id=__span-130-14><a id=__codelineno-130-14 name=__codelineno-130-14></a><a href=#__codelineno-130-14><span class=linenos data-linenos="14 "></span></a>
</span><span id=__span-130-15><a id=__codelineno-130-15 name=__codelineno-130-15></a><a href=#__codelineno-130-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-130-16><a id=__codelineno-130-16 name=__codelineno-130-16></a><a href=#__codelineno-130-16><span class=linenos data-linenos="16 "></span></a>
</span><span id=__span-130-17><a id=__codelineno-130-17 name=__codelineno-130-17></a><a href=#__codelineno-130-17><span class=linenos data-linenos="17 "></span></a><span class=w>    </span><span class=c1>-- Recursive case: extend paths</span>
</span><span id=__span-130-18><a id=__codelineno-130-18 name=__codelineno-130-18></a><a href=#__codelineno-130-18><span class=linenos data-linenos="18 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-130-19><a id=__codelineno-130-19 name=__codelineno-130-19></a><a href=#__codelineno-130-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-130-20><a id=__codelineno-130-20 name=__codelineno-130-20></a><a href=#__codelineno-130-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-130-21><a id=__codelineno-130-21 name=__codelineno-130-21></a><a href=#__codelineno-130-21><span class=linenos data-linenos="21 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-130-22><a id=__codelineno-130-22 name=__codelineno-130-22></a><a href=#__codelineno-130-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-130-23><a id=__codelineno-130-23 name=__codelineno-130-23></a><a href=#__codelineno-130-23><span class=linenos data-linenos="23 "></span></a><span class=w>      </span><span class=n>ARRAY_APPEND</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path_edges</span><span class=p>,</span><span class=w> </span><span class=n>NAMED_STRUCT</span><span class=p>(</span><span class=s1>&#39;person_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;friend_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;since&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>since</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;strength&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>strength</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path_edges</span><span class=p>,</span>
</span><span id=__span-130-24><a id=__codelineno-130-24 name=__codelineno-130-24></a><a href=#__codelineno-130-24><span class=linenos data-linenos="24 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-130-25><a id=__codelineno-130-25 name=__codelineno-130-25></a><a href=#__codelineno-130-25><span class=linenos data-linenos="25 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-130-26><a id=__codelineno-130-26 name=__codelineno-130-26></a><a href=#__codelineno-130-26><span class=linenos data-linenos="26 "></span></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-130-27><a id=__codelineno-130-27 name=__codelineno-130-27></a><a href=#__codelineno-130-27><span class=linenos data-linenos="27 "></span></a><span class=w>      </span><span class=k>ON</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span>
</span><span id=__span-130-28><a id=__codelineno-130-28 name=__codelineno-130-28></a><a href=#__codelineno-130-28><span class=linenos data-linenos="28 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>3</span>
</span><span id=__span-130-29><a id=__codelineno-130-29 name=__codelineno-130-29></a><a href=#__codelineno-130-29><span class=linenos data-linenos="29 "></span></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=n>ARRAY_CONTAINS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span>
</span><span id=__span-130-30><a id=__codelineno-130-30 name=__codelineno-130-30></a><a href=#__codelineno-130-30><span class=linenos data-linenos="30 "></span></a><span class=w>  </span><span class=p>)</span>
</span><span id=__span-130-31><a id=__codelineno-130-31 name=__codelineno-130-31></a><a href=#__codelineno-130-31><span class=linenos data-linenos="31 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-130-32><a id=__codelineno-130-32 name=__codelineno-130-32></a><a href=#__codelineno-130-32><span class=linenos data-linenos="32 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_b_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-130-33><a id=__codelineno-130-33 name=__codelineno-130-33></a><a href=#__codelineno-130-33><span class=linenos data-linenos="33 "></span></a><span class=w>  </span><span class=p>,(</span><span class=k>SIZE</span><span class=p>(</span><span class=n>_gsql2rsql_path_id</span><span class=p>)</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>hops</span>
</span><span id=__span-130-34><a id=__codelineno-130-34 name=__codelineno-130-34></a><a href=#__codelineno-130-34><span class=linenos data-linenos="34 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-130-35><a id=__codelineno-130-35 name=__codelineno-130-35></a><a href=#__codelineno-130-35><span class=linenos data-linenos="35 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-130-36><a id=__codelineno-130-36 name=__codelineno-130-36></a><a href=#__codelineno-130-36><span class=linenos data-linenos="36 "></span></a><span class=w>     </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_id</span>
</span><span id=__span-130-37><a id=__codelineno-130-37 name=__codelineno-130-37></a><a href=#__codelineno-130-37><span class=linenos data-linenos="37 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_name</span>
</span><span id=__span-130-38><a id=__codelineno-130-38 name=__codelineno-130-38></a><a href=#__codelineno-130-38><span class=linenos data-linenos="38 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_age</span>
</span><span id=__span-130-39><a id=__codelineno-130-39 name=__codelineno-130-39></a><a href=#__codelineno-130-39><span class=linenos data-linenos="39 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_nickname</span>
</span><span id=__span-130-40><a id=__codelineno-130-40 name=__codelineno-130-40></a><a href=#__codelineno-130-40><span class=linenos data-linenos="40 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_salary</span>
</span><span id=__span-130-41><a id=__codelineno-130-41 name=__codelineno-130-41></a><a href=#__codelineno-130-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_active</span>
</span><span id=__span-130-42><a id=__codelineno-130-42 name=__codelineno-130-42></a><a href=#__codelineno-130-42><span class=linenos data-linenos="42 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-130-43><a id=__codelineno-130-43 name=__codelineno-130-43></a><a href=#__codelineno-130-43><span class=linenos data-linenos="43 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-130-44><a id=__codelineno-130-44 name=__codelineno-130-44></a><a href=#__codelineno-130-44><span class=linenos data-linenos="44 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_age</span>
</span><span id=__span-130-45><a id=__codelineno-130-45 name=__codelineno-130-45></a><a href=#__codelineno-130-45><span class=linenos data-linenos="45 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_nickname</span>
</span><span id=__span-130-46><a id=__codelineno-130-46 name=__codelineno-130-46></a><a href=#__codelineno-130-46><span class=linenos data-linenos="46 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_salary</span>
</span><span id=__span-130-47><a id=__codelineno-130-47 name=__codelineno-130-47></a><a href=#__codelineno-130-47><span class=linenos data-linenos="47 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_active</span>
</span><span id=__span-130-48><a id=__codelineno-130-48 name=__codelineno-130-48></a><a href=#__codelineno-130-48><span class=linenos data-linenos="48 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-130-49><a id=__codelineno-130-49 name=__codelineno-130-49></a><a href=#__codelineno-130-49><span class=linenos data-linenos="49 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-130-50><a id=__codelineno-130-50 name=__codelineno-130-50></a><a href=#__codelineno-130-50><span class=linenos data-linenos="50 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>depth</span>
</span><span id=__span-130-51><a id=__codelineno-130-51 name=__codelineno-130-51></a><a href=#__codelineno-130-51><span class=linenos data-linenos="51 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_path_id</span>
</span><span id=__span-130-52><a id=__codelineno-130-52 name=__codelineno-130-52></a><a href=#__codelineno-130-52><span class=linenos data-linenos="52 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>path_edges</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_path_edges</span>
</span><span id=__span-130-53><a id=__codelineno-130-53 name=__codelineno-130-53></a><a href=#__codelineno-130-53><span class=linenos data-linenos="53 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-130-54><a id=__codelineno-130-54 name=__codelineno-130-54></a><a href=#__codelineno-130-54><span class=linenos data-linenos="54 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=n>sink</span>
</span><span id=__span-130-55><a id=__codelineno-130-55 name=__codelineno-130-55></a><a href=#__codelineno-130-55><span class=linenos data-linenos="55 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-130-56><a id=__codelineno-130-56 name=__codelineno-130-56></a><a href=#__codelineno-130-56><span class=linenos data-linenos="56 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=k>source</span>
</span><span id=__span-130-57><a id=__codelineno-130-57 name=__codelineno-130-57></a><a href=#__codelineno-130-57><span class=linenos data-linenos="57 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-130-58><a id=__codelineno-130-58 name=__codelineno-130-58></a><a href=#__codelineno-130-58><span class=linenos data-linenos="58 "></span></a><span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>3</span>
</span><span id=__span-130-59><a id=__codelineno-130-59 name=__codelineno-130-59></a><a href=#__codelineno-130-59><span class=linenos data-linenos="59 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-130-60><a id=__codelineno-130-60 name=__codelineno-130-60></a><a href=#__codelineno-130-60><span class=linenos data-linenos="60 "></span></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>hops</span><span class=w> </span><span class=k>ASC</span>
</span><span id=__span-130-61><a id=__codelineno-130-61 name=__codelineno-130-61></a><a href=#__codelineno-130-61><span class=linenos data-linenos="61 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=mi>50</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-131-1><a id=__codelineno-131-1 name=__codelineno-131-1></a><a href=#__codelineno-131-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-131-2><a id=__codelineno-131-2 name=__codelineno-131-2></a><a href=#__codelineno-131-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-131-3><a id=__codelineno-131-3 name=__codelineno-131-3></a><a href=#__codelineno-131-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=2;
</span><span id=__span-131-4><a id=__codelineno-131-4 name=__codelineno-131-4></a><a href=#__codelineno-131-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-131-5><a id=__codelineno-131-5 name=__codelineno-131-5></a><a href=#__codelineno-131-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: a:Person
</span><span id=__span-131-6><a id=__codelineno-131-6 name=__codelineno-131-6></a><a href=#__codelineno-131-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-131-7><a id=__codelineno-131-7 name=__codelineno-131-7></a><a href=#__codelineno-131-7><span class=linenos data-linenos=" 7 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-131-8><a id=__codelineno-131-8 name=__codelineno-131-8></a><a href=#__codelineno-131-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-131-9><a id=__codelineno-131-9 name=__codelineno-131-9></a><a href=#__codelineno-131-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: b:Person
</span><span id=__span-131-10><a id=__codelineno-131-10 name=__codelineno-131-10></a><a href=#__codelineno-131-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-131-11><a id=__codelineno-131-11 name=__codelineno-131-11></a><a href=#__codelineno-131-11><span class=linenos data-linenos="11 "></span></a>----------------------------------------------------------------------
</span><span id=__span-131-12><a id=__codelineno-131-12 name=__codelineno-131-12></a><a href=#__codelineno-131-12><span class=linenos data-linenos="12 "></span></a>Level 1:
</span><span id=__span-131-13><a id=__codelineno-131-13 name=__codelineno-131-13></a><a href=#__codelineno-131-13><span class=linenos data-linenos="13 "></span></a>----------------------------------------------------------------------
</span><span id=__span-131-14><a id=__codelineno-131-14 name=__codelineno-131-14></a><a href=#__codelineno-131-14><span class=linenos data-linenos="14 "></span></a>OpId=2 Op=RecursiveTraversalOperator; InOpIds=1; OutOpIds=4;
</span><span id=__span-131-15><a id=__codelineno-131-15 name=__codelineno-131-15></a><a href=#__codelineno-131-15><span class=linenos data-linenos="15 "></span></a>  RecursiveTraversal(KNOWS*1..3, path=path)
</span><span id=__span-131-16><a id=__codelineno-131-16 name=__codelineno-131-16></a><a href=#__codelineno-131-16><span class=linenos data-linenos="16 "></span></a>*
</span><span id=__span-131-17><a id=__codelineno-131-17 name=__codelineno-131-17></a><a href=#__codelineno-131-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-131-18><a id=__codelineno-131-18 name=__codelineno-131-18></a><a href=#__codelineno-131-18><span class=linenos data-linenos="18 "></span></a>Level 2:
</span><span id=__span-131-19><a id=__codelineno-131-19 name=__codelineno-131-19></a><a href=#__codelineno-131-19><span class=linenos data-linenos="19 "></span></a>----------------------------------------------------------------------
</span><span id=__span-131-20><a id=__codelineno-131-20 name=__codelineno-131-20></a><a href=#__codelineno-131-20><span class=linenos data-linenos="20 "></span></a>OpId=4 Op=JoinOperator; InOpIds=2,3; OutOpIds=5;
</span><span id=__span-131-21><a id=__codelineno-131-21 name=__codelineno-131-21></a><a href=#__codelineno-131-21><span class=linenos data-linenos="21 "></span></a>  JoinOperator(id=4)
</span><span id=__span-131-22><a id=__codelineno-131-22 name=__codelineno-131-22></a><a href=#__codelineno-131-22><span class=linenos data-linenos="22 "></span></a>    JoinType: INNER
</span><span id=__span-131-23><a id=__codelineno-131-23 name=__codelineno-131-23></a><a href=#__codelineno-131-23><span class=linenos data-linenos="23 "></span></a>    Joins: JoinPair: Node=b RelOrNode=paths__anon1 Type=SINK
</span><span id=__span-131-24><a id=__codelineno-131-24 name=__codelineno-131-24></a><a href=#__codelineno-131-24><span class=linenos data-linenos="24 "></span></a>*
</span><span id=__span-131-25><a id=__codelineno-131-25 name=__codelineno-131-25></a><a href=#__codelineno-131-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-131-26><a id=__codelineno-131-26 name=__codelineno-131-26></a><a href=#__codelineno-131-26><span class=linenos data-linenos="26 "></span></a>Level 3:
</span><span id=__span-131-27><a id=__codelineno-131-27 name=__codelineno-131-27></a><a href=#__codelineno-131-27><span class=linenos data-linenos="27 "></span></a>----------------------------------------------------------------------
</span><span id=__span-131-28><a id=__codelineno-131-28 name=__codelineno-131-28></a><a href=#__codelineno-131-28><span class=linenos data-linenos="28 "></span></a>OpId=5 Op=ProjectionOperator; InOpIds=4; OutOpIds=;
</span><span id=__span-131-29><a id=__codelineno-131-29 name=__codelineno-131-29></a><a href=#__codelineno-131-29><span class=linenos data-linenos="29 "></span></a>  ProjectionOperator(id=5)
</span><span id=__span-131-30><a id=__codelineno-131-30 name=__codelineno-131-30></a><a href=#__codelineno-131-30><span class=linenos data-linenos="30 "></span></a>    Projections: name=b.name, hops=LENGTH(path)
</span><span id=__span-131-31><a id=__codelineno-131-31 name=__codelineno-131-31></a><a href=#__codelineno-131-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-131-32><a id=__codelineno-131-32 name=__codelineno-131-32></a><a href=#__codelineno-131-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=45-bfs-with-inline-filter-on-target-node>45. BFS with inline filter on target node<a class=headerlink href=#45-bfs-with-inline-filter-on-target-node title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Inline filters (target in BFS)</p> <details class=note> <summary>Notes</summary> <p>Inline filter on TARGET node {active: true} is applied AFTER traversal.</p> <p>DIFFERENCE FROM SOURCE FILTER: - Source filter: Applied in BASE CASE (optimizes starting point) - Target filter: Applied in FINAL WHERE (filters results)</p> <p>BFS BEHAVIOR: 1. Traverse graph from ALL source nodes (no starting point filter) 2. Follow KNOWS edges for 1-3 hops 3. Filter final results where b.active = true</p> <p>SQL PATTERN: WITH RECURSIVE bfs AS (...) -- Full traversal SELECT a.name, b.name, depth AS hops FROM bfs JOIN Person b ON b.id = bfs.dst WHERE (b.active) = (true)  TARGET FILTER (post-traversal)</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-132-1><a id=__codelineno-132-1 name=__codelineno-132-1></a><a href=#__codelineno-132-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=n>path</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=p>*</span><span class=m>1</span><span class=p>..</span><span class=m>3</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>b</span><span class=p>:</span><span class=n>Person</span><span class=w> </span><span class=p>{</span><span class=n>active</span><span class=p>:</span><span class=w> </span><span class=k>true</span><span class=p>})</span>
</span><span id=__span-132-2><a id=__codelineno-132-2 name=__codelineno-132-2></a><a href=#__codelineno-132-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>length</span><span class=p>(</span><span class=n>path</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>hops</span>
</span><span id=__span-132-3><a id=__codelineno-132-3 name=__codelineno-132-3></a><a href=#__codelineno-132-3><span class=linenos data-linenos="3 "></span></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>hops</span>
</span><span id=__span-132-4><a id=__codelineno-132-4 name=__codelineno-132-4></a><a href=#__codelineno-132-4><span class=linenos data-linenos="4 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=m>50</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-133-1><a id=__codelineno-133-1 name=__codelineno-133-1></a><a href=#__codelineno-133-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span>
</span><span id=__span-133-2><a id=__codelineno-133-2 name=__codelineno-133-2></a><a href=#__codelineno-133-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>  </span><span class=n>paths_1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-133-3><a id=__codelineno-133-3 name=__codelineno-133-3></a><a href=#__codelineno-133-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>    </span><span class=c1>-- Base case: direct edges (depth = 1)</span>
</span><span id=__span-133-4><a id=__codelineno-133-4 name=__codelineno-133-4></a><a href=#__codelineno-133-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-133-5><a id=__codelineno-133-5 name=__codelineno-133-5></a><a href=#__codelineno-133-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-133-6><a id=__codelineno-133-6 name=__codelineno-133-6></a><a href=#__codelineno-133-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-133-7><a id=__codelineno-133-7 name=__codelineno-133-7></a><a href=#__codelineno-133-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>      </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-133-8><a id=__codelineno-133-8 name=__codelineno-133-8></a><a href=#__codelineno-133-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-133-9><a id=__codelineno-133-9 name=__codelineno-133-9></a><a href=#__codelineno-133-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>NAMED_STRUCT</span><span class=p>(</span><span class=s1>&#39;person_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;friend_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;since&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>since</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;strength&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>strength</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path_edges</span><span class=p>,</span>
</span><span id=__span-133-10><a id=__codelineno-133-10 name=__codelineno-133-10></a><a href=#__codelineno-133-10><span class=linenos data-linenos="10 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-133-11><a id=__codelineno-133-11 name=__codelineno-133-11></a><a href=#__codelineno-133-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-133-12><a id=__codelineno-133-12 name=__codelineno-133-12></a><a href=#__codelineno-133-12><span class=linenos data-linenos="12 "></span></a>
</span><span id=__span-133-13><a id=__codelineno-133-13 name=__codelineno-133-13></a><a href=#__codelineno-133-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-133-14><a id=__codelineno-133-14 name=__codelineno-133-14></a><a href=#__codelineno-133-14><span class=linenos data-linenos="14 "></span></a>
</span><span id=__span-133-15><a id=__codelineno-133-15 name=__codelineno-133-15></a><a href=#__codelineno-133-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=c1>-- Recursive case: extend paths</span>
</span><span id=__span-133-16><a id=__codelineno-133-16 name=__codelineno-133-16></a><a href=#__codelineno-133-16><span class=linenos data-linenos="16 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-133-17><a id=__codelineno-133-17 name=__codelineno-133-17></a><a href=#__codelineno-133-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-133-18><a id=__codelineno-133-18 name=__codelineno-133-18></a><a href=#__codelineno-133-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-133-19><a id=__codelineno-133-19 name=__codelineno-133-19></a><a href=#__codelineno-133-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-133-20><a id=__codelineno-133-20 name=__codelineno-133-20></a><a href=#__codelineno-133-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-133-21><a id=__codelineno-133-21 name=__codelineno-133-21></a><a href=#__codelineno-133-21><span class=linenos data-linenos="21 "></span></a><span class=w>      </span><span class=n>ARRAY_APPEND</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path_edges</span><span class=p>,</span><span class=w> </span><span class=n>NAMED_STRUCT</span><span class=p>(</span><span class=s1>&#39;person_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;friend_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;since&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>since</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;strength&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>strength</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path_edges</span><span class=p>,</span>
</span><span id=__span-133-22><a id=__codelineno-133-22 name=__codelineno-133-22></a><a href=#__codelineno-133-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-133-23><a id=__codelineno-133-23 name=__codelineno-133-23></a><a href=#__codelineno-133-23><span class=linenos data-linenos="23 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-133-24><a id=__codelineno-133-24 name=__codelineno-133-24></a><a href=#__codelineno-133-24><span class=linenos data-linenos="24 "></span></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-133-25><a id=__codelineno-133-25 name=__codelineno-133-25></a><a href=#__codelineno-133-25><span class=linenos data-linenos="25 "></span></a><span class=w>      </span><span class=k>ON</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span>
</span><span id=__span-133-26><a id=__codelineno-133-26 name=__codelineno-133-26></a><a href=#__codelineno-133-26><span class=linenos data-linenos="26 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>3</span>
</span><span id=__span-133-27><a id=__codelineno-133-27 name=__codelineno-133-27></a><a href=#__codelineno-133-27><span class=linenos data-linenos="27 "></span></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=n>ARRAY_CONTAINS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span>
</span><span id=__span-133-28><a id=__codelineno-133-28 name=__codelineno-133-28></a><a href=#__codelineno-133-28><span class=linenos data-linenos="28 "></span></a><span class=w>  </span><span class=p>)</span>
</span><span id=__span-133-29><a id=__codelineno-133-29 name=__codelineno-133-29></a><a href=#__codelineno-133-29><span class=linenos data-linenos="29 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-133-30><a id=__codelineno-133-30 name=__codelineno-133-30></a><a href=#__codelineno-133-30><span class=linenos data-linenos="30 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_a_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-133-31><a id=__codelineno-133-31 name=__codelineno-133-31></a><a href=#__codelineno-133-31><span class=linenos data-linenos="31 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_b_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-133-32><a id=__codelineno-133-32 name=__codelineno-133-32></a><a href=#__codelineno-133-32><span class=linenos data-linenos="32 "></span></a><span class=w>  </span><span class=p>,(</span><span class=k>SIZE</span><span class=p>(</span><span class=n>_gsql2rsql_path_id</span><span class=p>)</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>hops</span>
</span><span id=__span-133-33><a id=__codelineno-133-33 name=__codelineno-133-33></a><a href=#__codelineno-133-33><span class=linenos data-linenos="33 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-133-34><a id=__codelineno-133-34 name=__codelineno-133-34></a><a href=#__codelineno-133-34><span class=linenos data-linenos="34 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-133-35><a id=__codelineno-133-35 name=__codelineno-133-35></a><a href=#__codelineno-133-35><span class=linenos data-linenos="35 "></span></a><span class=w>     </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_id</span>
</span><span id=__span-133-36><a id=__codelineno-133-36 name=__codelineno-133-36></a><a href=#__codelineno-133-36><span class=linenos data-linenos="36 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_name</span>
</span><span id=__span-133-37><a id=__codelineno-133-37 name=__codelineno-133-37></a><a href=#__codelineno-133-37><span class=linenos data-linenos="37 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_age</span>
</span><span id=__span-133-38><a id=__codelineno-133-38 name=__codelineno-133-38></a><a href=#__codelineno-133-38><span class=linenos data-linenos="38 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_nickname</span>
</span><span id=__span-133-39><a id=__codelineno-133-39 name=__codelineno-133-39></a><a href=#__codelineno-133-39><span class=linenos data-linenos="39 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_salary</span>
</span><span id=__span-133-40><a id=__codelineno-133-40 name=__codelineno-133-40></a><a href=#__codelineno-133-40><span class=linenos data-linenos="40 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_active</span>
</span><span id=__span-133-41><a id=__codelineno-133-41 name=__codelineno-133-41></a><a href=#__codelineno-133-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-133-42><a id=__codelineno-133-42 name=__codelineno-133-42></a><a href=#__codelineno-133-42><span class=linenos data-linenos="42 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-133-43><a id=__codelineno-133-43 name=__codelineno-133-43></a><a href=#__codelineno-133-43><span class=linenos data-linenos="43 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_age</span>
</span><span id=__span-133-44><a id=__codelineno-133-44 name=__codelineno-133-44></a><a href=#__codelineno-133-44><span class=linenos data-linenos="44 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_nickname</span>
</span><span id=__span-133-45><a id=__codelineno-133-45 name=__codelineno-133-45></a><a href=#__codelineno-133-45><span class=linenos data-linenos="45 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_salary</span>
</span><span id=__span-133-46><a id=__codelineno-133-46 name=__codelineno-133-46></a><a href=#__codelineno-133-46><span class=linenos data-linenos="46 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_active</span>
</span><span id=__span-133-47><a id=__codelineno-133-47 name=__codelineno-133-47></a><a href=#__codelineno-133-47><span class=linenos data-linenos="47 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-133-48><a id=__codelineno-133-48 name=__codelineno-133-48></a><a href=#__codelineno-133-48><span class=linenos data-linenos="48 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-133-49><a id=__codelineno-133-49 name=__codelineno-133-49></a><a href=#__codelineno-133-49><span class=linenos data-linenos="49 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>depth</span>
</span><span id=__span-133-50><a id=__codelineno-133-50 name=__codelineno-133-50></a><a href=#__codelineno-133-50><span class=linenos data-linenos="50 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_path_id</span>
</span><span id=__span-133-51><a id=__codelineno-133-51 name=__codelineno-133-51></a><a href=#__codelineno-133-51><span class=linenos data-linenos="51 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>path_edges</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_path_edges</span>
</span><span id=__span-133-52><a id=__codelineno-133-52 name=__codelineno-133-52></a><a href=#__codelineno-133-52><span class=linenos data-linenos="52 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-133-53><a id=__codelineno-133-53 name=__codelineno-133-53></a><a href=#__codelineno-133-53><span class=linenos data-linenos="53 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=n>sink</span>
</span><span id=__span-133-54><a id=__codelineno-133-54 name=__codelineno-133-54></a><a href=#__codelineno-133-54><span class=linenos data-linenos="54 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-133-55><a id=__codelineno-133-55 name=__codelineno-133-55></a><a href=#__codelineno-133-55><span class=linenos data-linenos="55 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=k>source</span>
</span><span id=__span-133-56><a id=__codelineno-133-56 name=__codelineno-133-56></a><a href=#__codelineno-133-56><span class=linenos data-linenos="56 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-133-57><a id=__codelineno-133-57 name=__codelineno-133-57></a><a href=#__codelineno-133-57><span class=linenos data-linenos="57 "></span></a><span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=n>sink</span><span class=p>.</span><span class=n>active</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=k>TRUE</span><span class=p>)</span>
</span><span id=__span-133-58><a id=__codelineno-133-58 name=__codelineno-133-58></a><a href=#__codelineno-133-58><span class=linenos data-linenos="58 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-133-59><a id=__codelineno-133-59 name=__codelineno-133-59></a><a href=#__codelineno-133-59><span class=linenos data-linenos="59 "></span></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>hops</span><span class=w> </span><span class=k>ASC</span>
</span><span id=__span-133-60><a id=__codelineno-133-60 name=__codelineno-133-60></a><a href=#__codelineno-133-60><span class=linenos data-linenos="60 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=mi>50</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-134-1><a id=__codelineno-134-1 name=__codelineno-134-1></a><a href=#__codelineno-134-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-134-2><a id=__codelineno-134-2 name=__codelineno-134-2></a><a href=#__codelineno-134-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-134-3><a id=__codelineno-134-3 name=__codelineno-134-3></a><a href=#__codelineno-134-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=2;
</span><span id=__span-134-4><a id=__codelineno-134-4 name=__codelineno-134-4></a><a href=#__codelineno-134-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-134-5><a id=__codelineno-134-5 name=__codelineno-134-5></a><a href=#__codelineno-134-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: a:Person
</span><span id=__span-134-6><a id=__codelineno-134-6 name=__codelineno-134-6></a><a href=#__codelineno-134-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-134-7><a id=__codelineno-134-7 name=__codelineno-134-7></a><a href=#__codelineno-134-7><span class=linenos data-linenos=" 7 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-134-8><a id=__codelineno-134-8 name=__codelineno-134-8></a><a href=#__codelineno-134-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-134-9><a id=__codelineno-134-9 name=__codelineno-134-9></a><a href=#__codelineno-134-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: b:Person
</span><span id=__span-134-10><a id=__codelineno-134-10 name=__codelineno-134-10></a><a href=#__codelineno-134-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-134-11><a id=__codelineno-134-11 name=__codelineno-134-11></a><a href=#__codelineno-134-11><span class=linenos data-linenos="11 "></span></a>----------------------------------------------------------------------
</span><span id=__span-134-12><a id=__codelineno-134-12 name=__codelineno-134-12></a><a href=#__codelineno-134-12><span class=linenos data-linenos="12 "></span></a>Level 1:
</span><span id=__span-134-13><a id=__codelineno-134-13 name=__codelineno-134-13></a><a href=#__codelineno-134-13><span class=linenos data-linenos="13 "></span></a>----------------------------------------------------------------------
</span><span id=__span-134-14><a id=__codelineno-134-14 name=__codelineno-134-14></a><a href=#__codelineno-134-14><span class=linenos data-linenos="14 "></span></a>OpId=2 Op=RecursiveTraversalOperator; InOpIds=1; OutOpIds=4;
</span><span id=__span-134-15><a id=__codelineno-134-15 name=__codelineno-134-15></a><a href=#__codelineno-134-15><span class=linenos data-linenos="15 "></span></a>  RecursiveTraversal(KNOWS*1..3, path=path)
</span><span id=__span-134-16><a id=__codelineno-134-16 name=__codelineno-134-16></a><a href=#__codelineno-134-16><span class=linenos data-linenos="16 "></span></a>*
</span><span id=__span-134-17><a id=__codelineno-134-17 name=__codelineno-134-17></a><a href=#__codelineno-134-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-134-18><a id=__codelineno-134-18 name=__codelineno-134-18></a><a href=#__codelineno-134-18><span class=linenos data-linenos="18 "></span></a>Level 2:
</span><span id=__span-134-19><a id=__codelineno-134-19 name=__codelineno-134-19></a><a href=#__codelineno-134-19><span class=linenos data-linenos="19 "></span></a>----------------------------------------------------------------------
</span><span id=__span-134-20><a id=__codelineno-134-20 name=__codelineno-134-20></a><a href=#__codelineno-134-20><span class=linenos data-linenos="20 "></span></a>OpId=4 Op=JoinOperator; InOpIds=2,3; OutOpIds=5;
</span><span id=__span-134-21><a id=__codelineno-134-21 name=__codelineno-134-21></a><a href=#__codelineno-134-21><span class=linenos data-linenos="21 "></span></a>  JoinOperator(id=4)
</span><span id=__span-134-22><a id=__codelineno-134-22 name=__codelineno-134-22></a><a href=#__codelineno-134-22><span class=linenos data-linenos="22 "></span></a>    JoinType: INNER
</span><span id=__span-134-23><a id=__codelineno-134-23 name=__codelineno-134-23></a><a href=#__codelineno-134-23><span class=linenos data-linenos="23 "></span></a>    Joins: JoinPair: Node=b RelOrNode=paths__anon1 Type=SINK
</span><span id=__span-134-24><a id=__codelineno-134-24 name=__codelineno-134-24></a><a href=#__codelineno-134-24><span class=linenos data-linenos="24 "></span></a>*
</span><span id=__span-134-25><a id=__codelineno-134-25 name=__codelineno-134-25></a><a href=#__codelineno-134-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-134-26><a id=__codelineno-134-26 name=__codelineno-134-26></a><a href=#__codelineno-134-26><span class=linenos data-linenos="26 "></span></a>Level 3:
</span><span id=__span-134-27><a id=__codelineno-134-27 name=__codelineno-134-27></a><a href=#__codelineno-134-27><span class=linenos data-linenos="27 "></span></a>----------------------------------------------------------------------
</span><span id=__span-134-28><a id=__codelineno-134-28 name=__codelineno-134-28></a><a href=#__codelineno-134-28><span class=linenos data-linenos="28 "></span></a>OpId=5 Op=ProjectionOperator; InOpIds=4; OutOpIds=;
</span><span id=__span-134-29><a id=__codelineno-134-29 name=__codelineno-134-29></a><a href=#__codelineno-134-29><span class=linenos data-linenos="29 "></span></a>  ProjectionOperator(id=5)
</span><span id=__span-134-30><a id=__codelineno-134-30 name=__codelineno-134-30></a><a href=#__codelineno-134-30><span class=linenos data-linenos="30 "></span></a>    Projections: name=a.name, name=b.name, hops=LENGTH(path)
</span><span id=__span-134-31><a id=__codelineno-134-31 name=__codelineno-134-31></a><a href=#__codelineno-134-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-134-32><a id=__codelineno-134-32 name=__codelineno-134-32></a><a href=#__codelineno-134-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=46-anonymous-node-with-inline-filter>46. Anonymous node with inline filter<a class=headerlink href=#46-anonymous-node-with-inline-filter title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Inline filters (anonymous nodes)</p> <details class=note> <summary>Notes</summary> <p>Inline filters work on anonymous nodes (nodes without variables).</p> <p>USE CASE: Filter starting/ending nodes that aren't returned.</p> <p>TRANSPILER HANDLING: 1. Auto-assign alias: (:Person {name: 'Alice'})  (_anon1:Person) 2. Convert filter: _anon1.name = 'Alice' 3. Push to DataSource</p> <p>SQL PATTERN: FROM (SELECT ... FROM Person WHERE name = 'Alice') AS _anon1 JOIN Knows ON _anon1.id = person_id JOIN Person AS f ON f.id = friend_id</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-135-1><a id=__codelineno-135-1 name=__codelineno-135-1></a><a href=#__codelineno-135-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(:</span><span class=n>Person</span><span class=w> </span><span class=p>{</span><span class=n>name</span><span class=p>:</span><span class=w> </span><span class=s>&#39;Alice&#39;</span><span class=p>})</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>f</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-135-2><a id=__codelineno-135-2 name=__codelineno-135-2></a><a href=#__codelineno-135-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>name</span>
</span><span id=__span-135-3><a id=__codelineno-135-3 name=__codelineno-135-3></a><a href=#__codelineno-135-3><span class=linenos data-linenos="3 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=m>20</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-136-1><a id=__codelineno-136-1 name=__codelineno-136-1></a><a href=#__codelineno-136-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-136-2><a id=__codelineno-136-2 name=__codelineno-136-2></a><a href=#__codelineno-136-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-136-3><a id=__codelineno-136-3 name=__codelineno-136-3></a><a href=#__codelineno-136-3><span class=linenos data-linenos=" 3 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-136-4><a id=__codelineno-136-4 name=__codelineno-136-4></a><a href=#__codelineno-136-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-136-5><a id=__codelineno-136-5 name=__codelineno-136-5></a><a href=#__codelineno-136-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_id</span>
</span><span id=__span-136-6><a id=__codelineno-136-6 name=__codelineno-136-6></a><a href=#__codelineno-136-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_name</span>
</span><span id=__span-136-7><a id=__codelineno-136-7 name=__codelineno-136-7></a><a href=#__codelineno-136-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_person_id</span>
</span><span id=__span-136-8><a id=__codelineno-136-8 name=__codelineno-136-8></a><a href=#__codelineno-136-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_friend_id</span>
</span><span id=__span-136-9><a id=__codelineno-136-9 name=__codelineno-136-9></a><a href=#__codelineno-136-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-136-10><a id=__codelineno-136-10 name=__codelineno-136-10></a><a href=#__codelineno-136-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-136-11><a id=__codelineno-136-11 name=__codelineno-136-11></a><a href=#__codelineno-136-11><span class=linenos data-linenos="11 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-136-12><a id=__codelineno-136-12 name=__codelineno-136-12></a><a href=#__codelineno-136-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-136-13><a id=__codelineno-136-13 name=__codelineno-136-13></a><a href=#__codelineno-136-13><span class=linenos data-linenos="13 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_id</span>
</span><span id=__span-136-14><a id=__codelineno-136-14 name=__codelineno-136-14></a><a href=#__codelineno-136-14><span class=linenos data-linenos="14 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_name</span>
</span><span id=__span-136-15><a id=__codelineno-136-15 name=__codelineno-136-15></a><a href=#__codelineno-136-15><span class=linenos data-linenos="15 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_person_id</span>
</span><span id=__span-136-16><a id=__codelineno-136-16 name=__codelineno-136-16></a><a href=#__codelineno-136-16><span class=linenos data-linenos="16 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_friend_id</span>
</span><span id=__span-136-17><a id=__codelineno-136-17 name=__codelineno-136-17></a><a href=#__codelineno-136-17><span class=linenos data-linenos="17 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-136-18><a id=__codelineno-136-18 name=__codelineno-136-18></a><a href=#__codelineno-136-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-136-19><a id=__codelineno-136-19 name=__codelineno-136-19></a><a href=#__codelineno-136-19><span class=linenos data-linenos="19 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_id</span>
</span><span id=__span-136-20><a id=__codelineno-136-20 name=__codelineno-136-20></a><a href=#__codelineno-136-20><span class=linenos data-linenos="20 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_name</span>
</span><span id=__span-136-21><a id=__codelineno-136-21 name=__codelineno-136-21></a><a href=#__codelineno-136-21><span class=linenos data-linenos="21 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-136-22><a id=__codelineno-136-22 name=__codelineno-136-22></a><a href=#__codelineno-136-22><span class=linenos data-linenos="22 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-136-23><a id=__codelineno-136-23 name=__codelineno-136-23></a><a href=#__codelineno-136-23><span class=linenos data-linenos="23 "></span></a><span class=w>      </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Alice&#39;</span><span class=p>))</span>
</span><span id=__span-136-24><a id=__codelineno-136-24 name=__codelineno-136-24></a><a href=#__codelineno-136-24><span class=linenos data-linenos="24 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-136-25><a id=__codelineno-136-25 name=__codelineno-136-25></a><a href=#__codelineno-136-25><span class=linenos data-linenos="25 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-136-26><a id=__codelineno-136-26 name=__codelineno-136-26></a><a href=#__codelineno-136-26><span class=linenos data-linenos="26 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-136-27><a id=__codelineno-136-27 name=__codelineno-136-27></a><a href=#__codelineno-136-27><span class=linenos data-linenos="27 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_person_id</span>
</span><span id=__span-136-28><a id=__codelineno-136-28 name=__codelineno-136-28></a><a href=#__codelineno-136-28><span class=linenos data-linenos="28 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon2_friend_id</span>
</span><span id=__span-136-29><a id=__codelineno-136-29 name=__codelineno-136-29></a><a href=#__codelineno-136-29><span class=linenos data-linenos="29 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-136-30><a id=__codelineno-136-30 name=__codelineno-136-30></a><a href=#__codelineno-136-30><span class=linenos data-linenos="30 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-136-31><a id=__codelineno-136-31 name=__codelineno-136-31></a><a href=#__codelineno-136-31><span class=linenos data-linenos="31 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-136-32><a id=__codelineno-136-32 name=__codelineno-136-32></a><a href=#__codelineno-136-32><span class=linenos data-linenos="32 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_person_id</span>
</span><span id=__span-136-33><a id=__codelineno-136-33 name=__codelineno-136-33></a><a href=#__codelineno-136-33><span class=linenos data-linenos="33 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-136-34><a id=__codelineno-136-34 name=__codelineno-136-34></a><a href=#__codelineno-136-34><span class=linenos data-linenos="34 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-136-35><a id=__codelineno-136-35 name=__codelineno-136-35></a><a href=#__codelineno-136-35><span class=linenos data-linenos="35 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-136-36><a id=__codelineno-136-36 name=__codelineno-136-36></a><a href=#__codelineno-136-36><span class=linenos data-linenos="36 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-136-37><a id=__codelineno-136-37 name=__codelineno-136-37></a><a href=#__codelineno-136-37><span class=linenos data-linenos="37 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_name</span>
</span><span id=__span-136-38><a id=__codelineno-136-38 name=__codelineno-136-38></a><a href=#__codelineno-136-38><span class=linenos data-linenos="38 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-136-39><a id=__codelineno-136-39 name=__codelineno-136-39></a><a href=#__codelineno-136-39><span class=linenos data-linenos="39 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-136-40><a id=__codelineno-136-40 name=__codelineno-136-40></a><a href=#__codelineno-136-40><span class=linenos data-linenos="40 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-136-41><a id=__codelineno-136-41 name=__codelineno-136-41></a><a href=#__codelineno-136-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon2_friend_id</span>
</span><span id=__span-136-42><a id=__codelineno-136-42 name=__codelineno-136-42></a><a href=#__codelineno-136-42><span class=linenos data-linenos="42 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-136-43><a id=__codelineno-136-43 name=__codelineno-136-43></a><a href=#__codelineno-136-43><span class=linenos data-linenos="43 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=mi>20</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-137-1><a id=__codelineno-137-1 name=__codelineno-137-1></a><a href=#__codelineno-137-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-137-2><a id=__codelineno-137-2 name=__codelineno-137-2></a><a href=#__codelineno-137-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-137-3><a id=__codelineno-137-3 name=__codelineno-137-3></a><a href=#__codelineno-137-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-137-4><a id=__codelineno-137-4 name=__codelineno-137-4></a><a href=#__codelineno-137-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-137-5><a id=__codelineno-137-5 name=__codelineno-137-5></a><a href=#__codelineno-137-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: _anon1:Person
</span><span id=__span-137-6><a id=__codelineno-137-6 name=__codelineno-137-6></a><a href=#__codelineno-137-6><span class=linenos data-linenos=" 6 "></span></a>    Filter: (_anon1.name EQ &#39;Alice&#39;)
</span><span id=__span-137-7><a id=__codelineno-137-7 name=__codelineno-137-7></a><a href=#__codelineno-137-7><span class=linenos data-linenos=" 7 "></span></a>*
</span><span id=__span-137-8><a id=__codelineno-137-8 name=__codelineno-137-8></a><a href=#__codelineno-137-8><span class=linenos data-linenos=" 8 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-137-9><a id=__codelineno-137-9 name=__codelineno-137-9></a><a href=#__codelineno-137-9><span class=linenos data-linenos=" 9 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-137-10><a id=__codelineno-137-10 name=__codelineno-137-10></a><a href=#__codelineno-137-10><span class=linenos data-linenos="10 "></span></a>    DataSource: [_anon2:KNOWS]-&gt;
</span><span id=__span-137-11><a id=__codelineno-137-11 name=__codelineno-137-11></a><a href=#__codelineno-137-11><span class=linenos data-linenos="11 "></span></a>*
</span><span id=__span-137-12><a id=__codelineno-137-12 name=__codelineno-137-12></a><a href=#__codelineno-137-12><span class=linenos data-linenos="12 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-137-13><a id=__codelineno-137-13 name=__codelineno-137-13></a><a href=#__codelineno-137-13><span class=linenos data-linenos="13 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-137-14><a id=__codelineno-137-14 name=__codelineno-137-14></a><a href=#__codelineno-137-14><span class=linenos data-linenos="14 "></span></a>    DataSource: f:Person
</span><span id=__span-137-15><a id=__codelineno-137-15 name=__codelineno-137-15></a><a href=#__codelineno-137-15><span class=linenos data-linenos="15 "></span></a>*
</span><span id=__span-137-16><a id=__codelineno-137-16 name=__codelineno-137-16></a><a href=#__codelineno-137-16><span class=linenos data-linenos="16 "></span></a>----------------------------------------------------------------------
</span><span id=__span-137-17><a id=__codelineno-137-17 name=__codelineno-137-17></a><a href=#__codelineno-137-17><span class=linenos data-linenos="17 "></span></a>Level 1:
</span><span id=__span-137-18><a id=__codelineno-137-18 name=__codelineno-137-18></a><a href=#__codelineno-137-18><span class=linenos data-linenos="18 "></span></a>----------------------------------------------------------------------
</span><span id=__span-137-19><a id=__codelineno-137-19 name=__codelineno-137-19></a><a href=#__codelineno-137-19><span class=linenos data-linenos="19 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-137-20><a id=__codelineno-137-20 name=__codelineno-137-20></a><a href=#__codelineno-137-20><span class=linenos data-linenos="20 "></span></a>  JoinOperator(id=4)
</span><span id=__span-137-21><a id=__codelineno-137-21 name=__codelineno-137-21></a><a href=#__codelineno-137-21><span class=linenos data-linenos="21 "></span></a>    JoinType: INNER
</span><span id=__span-137-22><a id=__codelineno-137-22 name=__codelineno-137-22></a><a href=#__codelineno-137-22><span class=linenos data-linenos="22 "></span></a>    Joins: JoinPair: Node=_anon1 RelOrNode=_anon2 Type=SOURCE
</span><span id=__span-137-23><a id=__codelineno-137-23 name=__codelineno-137-23></a><a href=#__codelineno-137-23><span class=linenos data-linenos="23 "></span></a>*
</span><span id=__span-137-24><a id=__codelineno-137-24 name=__codelineno-137-24></a><a href=#__codelineno-137-24><span class=linenos data-linenos="24 "></span></a>----------------------------------------------------------------------
</span><span id=__span-137-25><a id=__codelineno-137-25 name=__codelineno-137-25></a><a href=#__codelineno-137-25><span class=linenos data-linenos="25 "></span></a>Level 2:
</span><span id=__span-137-26><a id=__codelineno-137-26 name=__codelineno-137-26></a><a href=#__codelineno-137-26><span class=linenos data-linenos="26 "></span></a>----------------------------------------------------------------------
</span><span id=__span-137-27><a id=__codelineno-137-27 name=__codelineno-137-27></a><a href=#__codelineno-137-27><span class=linenos data-linenos="27 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=7;
</span><span id=__span-137-28><a id=__codelineno-137-28 name=__codelineno-137-28></a><a href=#__codelineno-137-28><span class=linenos data-linenos="28 "></span></a>  JoinOperator(id=5)
</span><span id=__span-137-29><a id=__codelineno-137-29 name=__codelineno-137-29></a><a href=#__codelineno-137-29><span class=linenos data-linenos="29 "></span></a>    JoinType: INNER
</span><span id=__span-137-30><a id=__codelineno-137-30 name=__codelineno-137-30></a><a href=#__codelineno-137-30><span class=linenos data-linenos="30 "></span></a>    Joins: JoinPair: Node=f RelOrNode=_anon2 Type=SINK
</span><span id=__span-137-31><a id=__codelineno-137-31 name=__codelineno-137-31></a><a href=#__codelineno-137-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-137-32><a id=__codelineno-137-32 name=__codelineno-137-32></a><a href=#__codelineno-137-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span><span id=__span-137-33><a id=__codelineno-137-33 name=__codelineno-137-33></a><a href=#__codelineno-137-33><span class=linenos data-linenos="33 "></span></a>Level 3:
</span><span id=__span-137-34><a id=__codelineno-137-34 name=__codelineno-137-34></a><a href=#__codelineno-137-34><span class=linenos data-linenos="34 "></span></a>----------------------------------------------------------------------
</span><span id=__span-137-35><a id=__codelineno-137-35 name=__codelineno-137-35></a><a href=#__codelineno-137-35><span class=linenos data-linenos="35 "></span></a>OpId=7 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-137-36><a id=__codelineno-137-36 name=__codelineno-137-36></a><a href=#__codelineno-137-36><span class=linenos data-linenos="36 "></span></a>  ProjectionOperator(id=7)
</span><span id=__span-137-37><a id=__codelineno-137-37 name=__codelineno-137-37></a><a href=#__codelineno-137-37><span class=linenos data-linenos="37 "></span></a>    Projections: name=f.name
</span><span id=__span-137-38><a id=__codelineno-137-38 name=__codelineno-137-38></a><a href=#__codelineno-137-38><span class=linenos data-linenos="38 "></span></a>*
</span><span id=__span-137-39><a id=__codelineno-137-39 name=__codelineno-137-39></a><a href=#__codelineno-137-39><span class=linenos data-linenos="39 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=47-inline-filter-comparison-with-where-semantics>47. Inline filter comparison with WHERE (semantics)<a class=headerlink href=#47-inline-filter-comparison-with-where-semantics title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: Inline vs WHERE semantics</p> <details class=note> <summary>Notes</summary> <p>SEMANTIC EQUIVALENCE: Inline filters generate identical SQL to WHERE.</p> <p>COMPARE WITH: MATCH (p:Person)-[:KNOWS]-&gt;(f:Person) WHERE p.name = 'Alice' RETURN COUNT(*)</p> <p>Both queries produce the SAME SQL and SAME results.</p> <p>WHEN TO USE INLINE:  Equality filters (property = literal_value)  Structural constraints (part of the pattern)  BFS/DFS source filters (visual clarity of optimization)</p> <p>WHEN TO USE WHERE:  Complex predicates (&gt;, &lt;, BETWEEN, LIKE, IN)  Cross-variable filters (p.age &gt; f.age)  Dynamic values (property = $parameter)</p> <p>CURRENT LIMITATION:  Inline filters only support LITERAL values  Variable references not supported yet Example that doesn't work: {id: $param}</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-138-1><a id=__codelineno-138-1 name=__codelineno-138-1></a><a href=#__codelineno-138-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=w> </span><span class=p>{</span><span class=n>name</span><span class=p>:</span><span class=w> </span><span class=s>&#39;Alice&#39;</span><span class=p>})</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>f</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-138-2><a id=__codelineno-138-2 name=__codelineno-138-2></a><a href=#__codelineno-138-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>COUNT</span><span class=p>(*)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>count_inline</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-139-1><a id=__codelineno-139-1 name=__codelineno-139-1></a><a href=#__codelineno-139-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-139-2><a id=__codelineno-139-2 name=__codelineno-139-2></a><a href=#__codelineno-139-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>count_inline</span>
</span><span id=__span-139-3><a id=__codelineno-139-3 name=__codelineno-139-3></a><a href=#__codelineno-139-3><span class=linenos data-linenos=" 3 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-139-4><a id=__codelineno-139-4 name=__codelineno-139-4></a><a href=#__codelineno-139-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-139-5><a id=__codelineno-139-5 name=__codelineno-139-5></a><a href=#__codelineno-139-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-139-6><a id=__codelineno-139-6 name=__codelineno-139-6></a><a href=#__codelineno-139-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-139-7><a id=__codelineno-139-7 name=__codelineno-139-7></a><a href=#__codelineno-139-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-139-8><a id=__codelineno-139-8 name=__codelineno-139-8></a><a href=#__codelineno-139-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-139-9><a id=__codelineno-139-9 name=__codelineno-139-9></a><a href=#__codelineno-139-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-139-10><a id=__codelineno-139-10 name=__codelineno-139-10></a><a href=#__codelineno-139-10><span class=linenos data-linenos="10 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-139-11><a id=__codelineno-139-11 name=__codelineno-139-11></a><a href=#__codelineno-139-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-139-12><a id=__codelineno-139-12 name=__codelineno-139-12></a><a href=#__codelineno-139-12><span class=linenos data-linenos="12 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-139-13><a id=__codelineno-139-13 name=__codelineno-139-13></a><a href=#__codelineno-139-13><span class=linenos data-linenos="13 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-139-14><a id=__codelineno-139-14 name=__codelineno-139-14></a><a href=#__codelineno-139-14><span class=linenos data-linenos="14 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-139-15><a id=__codelineno-139-15 name=__codelineno-139-15></a><a href=#__codelineno-139-15><span class=linenos data-linenos="15 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-139-16><a id=__codelineno-139-16 name=__codelineno-139-16></a><a href=#__codelineno-139-16><span class=linenos data-linenos="16 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-139-17><a id=__codelineno-139-17 name=__codelineno-139-17></a><a href=#__codelineno-139-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-139-18><a id=__codelineno-139-18 name=__codelineno-139-18></a><a href=#__codelineno-139-18><span class=linenos data-linenos="18 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-139-19><a id=__codelineno-139-19 name=__codelineno-139-19></a><a href=#__codelineno-139-19><span class=linenos data-linenos="19 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-139-20><a id=__codelineno-139-20 name=__codelineno-139-20></a><a href=#__codelineno-139-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-139-21><a id=__codelineno-139-21 name=__codelineno-139-21></a><a href=#__codelineno-139-21><span class=linenos data-linenos="21 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-139-22><a id=__codelineno-139-22 name=__codelineno-139-22></a><a href=#__codelineno-139-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=k>WHERE</span><span class=w> </span><span class=p>((</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Alice&#39;</span><span class=p>))</span>
</span><span id=__span-139-23><a id=__codelineno-139-23 name=__codelineno-139-23></a><a href=#__codelineno-139-23><span class=linenos data-linenos="23 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-139-24><a id=__codelineno-139-24 name=__codelineno-139-24></a><a href=#__codelineno-139-24><span class=linenos data-linenos="24 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-139-25><a id=__codelineno-139-25 name=__codelineno-139-25></a><a href=#__codelineno-139-25><span class=linenos data-linenos="25 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-139-26><a id=__codelineno-139-26 name=__codelineno-139-26></a><a href=#__codelineno-139-26><span class=linenos data-linenos="26 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-139-27><a id=__codelineno-139-27 name=__codelineno-139-27></a><a href=#__codelineno-139-27><span class=linenos data-linenos="27 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-139-28><a id=__codelineno-139-28 name=__codelineno-139-28></a><a href=#__codelineno-139-28><span class=linenos data-linenos="28 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-139-29><a id=__codelineno-139-29 name=__codelineno-139-29></a><a href=#__codelineno-139-29><span class=linenos data-linenos="29 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-139-30><a id=__codelineno-139-30 name=__codelineno-139-30></a><a href=#__codelineno-139-30><span class=linenos data-linenos="30 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-139-31><a id=__codelineno-139-31 name=__codelineno-139-31></a><a href=#__codelineno-139-31><span class=linenos data-linenos="31 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-139-32><a id=__codelineno-139-32 name=__codelineno-139-32></a><a href=#__codelineno-139-32><span class=linenos data-linenos="32 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-139-33><a id=__codelineno-139-33 name=__codelineno-139-33></a><a href=#__codelineno-139-33><span class=linenos data-linenos="33 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-139-34><a id=__codelineno-139-34 name=__codelineno-139-34></a><a href=#__codelineno-139-34><span class=linenos data-linenos="34 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-139-35><a id=__codelineno-139-35 name=__codelineno-139-35></a><a href=#__codelineno-139-35><span class=linenos data-linenos="35 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_f_id</span>
</span><span id=__span-139-36><a id=__codelineno-139-36 name=__codelineno-139-36></a><a href=#__codelineno-139-36><span class=linenos data-linenos="36 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-139-37><a id=__codelineno-139-37 name=__codelineno-139-37></a><a href=#__codelineno-139-37><span class=linenos data-linenos="37 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-139-38><a id=__codelineno-139-38 name=__codelineno-139-38></a><a href=#__codelineno-139-38><span class=linenos data-linenos="38 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-139-39><a id=__codelineno-139-39 name=__codelineno-139-39></a><a href=#__codelineno-139-39><span class=linenos data-linenos="39 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_f_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-139-40><a id=__codelineno-139-40 name=__codelineno-139-40></a><a href=#__codelineno-139-40><span class=linenos data-linenos="40 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-140-1><a id=__codelineno-140-1 name=__codelineno-140-1></a><a href=#__codelineno-140-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-140-2><a id=__codelineno-140-2 name=__codelineno-140-2></a><a href=#__codelineno-140-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-140-3><a id=__codelineno-140-3 name=__codelineno-140-3></a><a href=#__codelineno-140-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-140-4><a id=__codelineno-140-4 name=__codelineno-140-4></a><a href=#__codelineno-140-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-140-5><a id=__codelineno-140-5 name=__codelineno-140-5></a><a href=#__codelineno-140-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-140-6><a id=__codelineno-140-6 name=__codelineno-140-6></a><a href=#__codelineno-140-6><span class=linenos data-linenos=" 6 "></span></a>    Filter: (p.name EQ &#39;Alice&#39;)
</span><span id=__span-140-7><a id=__codelineno-140-7 name=__codelineno-140-7></a><a href=#__codelineno-140-7><span class=linenos data-linenos=" 7 "></span></a>*
</span><span id=__span-140-8><a id=__codelineno-140-8 name=__codelineno-140-8></a><a href=#__codelineno-140-8><span class=linenos data-linenos=" 8 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-140-9><a id=__codelineno-140-9 name=__codelineno-140-9></a><a href=#__codelineno-140-9><span class=linenos data-linenos=" 9 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-140-10><a id=__codelineno-140-10 name=__codelineno-140-10></a><a href=#__codelineno-140-10><span class=linenos data-linenos="10 "></span></a>    DataSource: [_anon1:KNOWS]-&gt;
</span><span id=__span-140-11><a id=__codelineno-140-11 name=__codelineno-140-11></a><a href=#__codelineno-140-11><span class=linenos data-linenos="11 "></span></a>*
</span><span id=__span-140-12><a id=__codelineno-140-12 name=__codelineno-140-12></a><a href=#__codelineno-140-12><span class=linenos data-linenos="12 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-140-13><a id=__codelineno-140-13 name=__codelineno-140-13></a><a href=#__codelineno-140-13><span class=linenos data-linenos="13 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-140-14><a id=__codelineno-140-14 name=__codelineno-140-14></a><a href=#__codelineno-140-14><span class=linenos data-linenos="14 "></span></a>    DataSource: f:Person
</span><span id=__span-140-15><a id=__codelineno-140-15 name=__codelineno-140-15></a><a href=#__codelineno-140-15><span class=linenos data-linenos="15 "></span></a>*
</span><span id=__span-140-16><a id=__codelineno-140-16 name=__codelineno-140-16></a><a href=#__codelineno-140-16><span class=linenos data-linenos="16 "></span></a>----------------------------------------------------------------------
</span><span id=__span-140-17><a id=__codelineno-140-17 name=__codelineno-140-17></a><a href=#__codelineno-140-17><span class=linenos data-linenos="17 "></span></a>Level 1:
</span><span id=__span-140-18><a id=__codelineno-140-18 name=__codelineno-140-18></a><a href=#__codelineno-140-18><span class=linenos data-linenos="18 "></span></a>----------------------------------------------------------------------
</span><span id=__span-140-19><a id=__codelineno-140-19 name=__codelineno-140-19></a><a href=#__codelineno-140-19><span class=linenos data-linenos="19 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-140-20><a id=__codelineno-140-20 name=__codelineno-140-20></a><a href=#__codelineno-140-20><span class=linenos data-linenos="20 "></span></a>  JoinOperator(id=4)
</span><span id=__span-140-21><a id=__codelineno-140-21 name=__codelineno-140-21></a><a href=#__codelineno-140-21><span class=linenos data-linenos="21 "></span></a>    JoinType: INNER
</span><span id=__span-140-22><a id=__codelineno-140-22 name=__codelineno-140-22></a><a href=#__codelineno-140-22><span class=linenos data-linenos="22 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-140-23><a id=__codelineno-140-23 name=__codelineno-140-23></a><a href=#__codelineno-140-23><span class=linenos data-linenos="23 "></span></a>*
</span><span id=__span-140-24><a id=__codelineno-140-24 name=__codelineno-140-24></a><a href=#__codelineno-140-24><span class=linenos data-linenos="24 "></span></a>----------------------------------------------------------------------
</span><span id=__span-140-25><a id=__codelineno-140-25 name=__codelineno-140-25></a><a href=#__codelineno-140-25><span class=linenos data-linenos="25 "></span></a>Level 2:
</span><span id=__span-140-26><a id=__codelineno-140-26 name=__codelineno-140-26></a><a href=#__codelineno-140-26><span class=linenos data-linenos="26 "></span></a>----------------------------------------------------------------------
</span><span id=__span-140-27><a id=__codelineno-140-27 name=__codelineno-140-27></a><a href=#__codelineno-140-27><span class=linenos data-linenos="27 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=7;
</span><span id=__span-140-28><a id=__codelineno-140-28 name=__codelineno-140-28></a><a href=#__codelineno-140-28><span class=linenos data-linenos="28 "></span></a>  JoinOperator(id=5)
</span><span id=__span-140-29><a id=__codelineno-140-29 name=__codelineno-140-29></a><a href=#__codelineno-140-29><span class=linenos data-linenos="29 "></span></a>    JoinType: INNER
</span><span id=__span-140-30><a id=__codelineno-140-30 name=__codelineno-140-30></a><a href=#__codelineno-140-30><span class=linenos data-linenos="30 "></span></a>    Joins: JoinPair: Node=f RelOrNode=_anon1 Type=SINK
</span><span id=__span-140-31><a id=__codelineno-140-31 name=__codelineno-140-31></a><a href=#__codelineno-140-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-140-32><a id=__codelineno-140-32 name=__codelineno-140-32></a><a href=#__codelineno-140-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span><span id=__span-140-33><a id=__codelineno-140-33 name=__codelineno-140-33></a><a href=#__codelineno-140-33><span class=linenos data-linenos="33 "></span></a>Level 3:
</span><span id=__span-140-34><a id=__codelineno-140-34 name=__codelineno-140-34></a><a href=#__codelineno-140-34><span class=linenos data-linenos="34 "></span></a>----------------------------------------------------------------------
</span><span id=__span-140-35><a id=__codelineno-140-35 name=__codelineno-140-35></a><a href=#__codelineno-140-35><span class=linenos data-linenos="35 "></span></a>OpId=7 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-140-36><a id=__codelineno-140-36 name=__codelineno-140-36></a><a href=#__codelineno-140-36><span class=linenos data-linenos="36 "></span></a>  ProjectionOperator(id=7)
</span><span id=__span-140-37><a id=__codelineno-140-37 name=__codelineno-140-37></a><a href=#__codelineno-140-37><span class=linenos data-linenos="37 "></span></a>    Projections: count_inline=COUNT(*)
</span><span id=__span-140-38><a id=__codelineno-140-38 name=__codelineno-140-38></a><a href=#__codelineno-140-38><span class=linenos data-linenos="38 "></span></a>*
</span><span id=__span-140-39><a id=__codelineno-140-39 name=__codelineno-140-39></a><a href=#__codelineno-140-39><span class=linenos data-linenos="39 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=48-no-label-source-node-without-label>48. NO LABEL: Source node without label<a class=headerlink href=#48-no-label-source-node-without-label title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: No-label source node</p> <details class=note> <summary>Notes</summary> <p>Source node 'a' has no label - matches ANY node type.</p> <p>OPENCYPHER STANDARD: Unlabeled nodes match all node types.</p> <p>SQL PATTERN: FROM nodes AS a -- NO type filter for 'a' JOIN edges ON a.id = edges.src JOIN (SELECT ... FROM Company) AS c ON edges.dst = c.id WHERE edges.relationship_type = 'WORKS_AT'</p> <p>USE CASE: Find all entities that work at companies (could be Person, Bot, etc).</p> <p>PERFORMANCE: Full table scan on source. Use labels when possible for filtering.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-141-1><a id=__codelineno-141-1 name=__codelineno-141-1></a><a href=#__codelineno-141-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>WORKS_AT</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>c</span><span class=p>:</span><span class=n>Company</span><span class=p>)</span>
</span><span id=__span-141-2><a id=__codelineno-141-2 name=__codelineno-141-2></a><a href=#__codelineno-141-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>.</span><span class=n>name</span>
</span><span id=__span-141-3><a id=__codelineno-141-3 name=__codelineno-141-3></a><a href=#__codelineno-141-3><span class=linenos data-linenos="3 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=m>20</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-142-1><a id=__codelineno-142-1 name=__codelineno-142-1></a><a href=#__codelineno-142-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-142-2><a id=__codelineno-142-2 name=__codelineno-142-2></a><a href=#__codelineno-142-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_a_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-142-3><a id=__codelineno-142-3 name=__codelineno-142-3></a><a href=#__codelineno-142-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_c_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-142-4><a id=__codelineno-142-4 name=__codelineno-142-4></a><a href=#__codelineno-142-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-142-5><a id=__codelineno-142-5 name=__codelineno-142-5></a><a href=#__codelineno-142-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-142-6><a id=__codelineno-142-6 name=__codelineno-142-6></a><a href=#__codelineno-142-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_a_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-142-7><a id=__codelineno-142-7 name=__codelineno-142-7></a><a href=#__codelineno-142-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_a_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-142-8><a id=__codelineno-142-8 name=__codelineno-142-8></a><a href=#__codelineno-142-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-142-9><a id=__codelineno-142-9 name=__codelineno-142-9></a><a href=#__codelineno-142-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_company_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_company_id</span>
</span><span id=__span-142-10><a id=__codelineno-142-10 name=__codelineno-142-10></a><a href=#__codelineno-142-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-142-11><a id=__codelineno-142-11 name=__codelineno-142-11></a><a href=#__codelineno-142-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span><span id=__span-142-12><a id=__codelineno-142-12 name=__codelineno-142-12></a><a href=#__codelineno-142-12><span class=linenos data-linenos="12 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-142-13><a id=__codelineno-142-13 name=__codelineno-142-13></a><a href=#__codelineno-142-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-142-14><a id=__codelineno-142-14 name=__codelineno-142-14></a><a href=#__codelineno-142-14><span class=linenos data-linenos="14 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_a_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-142-15><a id=__codelineno-142-15 name=__codelineno-142-15></a><a href=#__codelineno-142-15><span class=linenos data-linenos="15 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_a_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-142-16><a id=__codelineno-142-16 name=__codelineno-142-16></a><a href=#__codelineno-142-16><span class=linenos data-linenos="16 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-142-17><a id=__codelineno-142-17 name=__codelineno-142-17></a><a href=#__codelineno-142-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_company_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_company_id</span>
</span><span id=__span-142-18><a id=__codelineno-142-18 name=__codelineno-142-18></a><a href=#__codelineno-142-18><span class=linenos data-linenos="18 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-142-19><a id=__codelineno-142-19 name=__codelineno-142-19></a><a href=#__codelineno-142-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-142-20><a id=__codelineno-142-20 name=__codelineno-142-20></a><a href=#__codelineno-142-20><span class=linenos data-linenos="20 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-142-21><a id=__codelineno-142-21 name=__codelineno-142-21></a><a href=#__codelineno-142-21><span class=linenos data-linenos="21 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-142-22><a id=__codelineno-142-22 name=__codelineno-142-22></a><a href=#__codelineno-142-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-142-23><a id=__codelineno-142-23 name=__codelineno-142-23></a><a href=#__codelineno-142-23><span class=linenos data-linenos="23 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>AllNodes</span>
</span><span id=__span-142-24><a id=__codelineno-142-24 name=__codelineno-142-24></a><a href=#__codelineno-142-24><span class=linenos data-linenos="24 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-142-25><a id=__codelineno-142-25 name=__codelineno-142-25></a><a href=#__codelineno-142-25><span class=linenos data-linenos="25 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-142-26><a id=__codelineno-142-26 name=__codelineno-142-26></a><a href=#__codelineno-142-26><span class=linenos data-linenos="26 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-142-27><a id=__codelineno-142-27 name=__codelineno-142-27></a><a href=#__codelineno-142-27><span class=linenos data-linenos="27 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-142-28><a id=__codelineno-142-28 name=__codelineno-142-28></a><a href=#__codelineno-142-28><span class=linenos data-linenos="28 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>company_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_company_id</span>
</span><span id=__span-142-29><a id=__codelineno-142-29 name=__codelineno-142-29></a><a href=#__codelineno-142-29><span class=linenos data-linenos="29 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-142-30><a id=__codelineno-142-30 name=__codelineno-142-30></a><a href=#__codelineno-142-30><span class=linenos data-linenos="30 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>WorksAt</span>
</span><span id=__span-142-31><a id=__codelineno-142-31 name=__codelineno-142-31></a><a href=#__codelineno-142-31><span class=linenos data-linenos="31 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-142-32><a id=__codelineno-142-32 name=__codelineno-142-32></a><a href=#__codelineno-142-32><span class=linenos data-linenos="32 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_a_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-142-33><a id=__codelineno-142-33 name=__codelineno-142-33></a><a href=#__codelineno-142-33><span class=linenos data-linenos="33 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-142-34><a id=__codelineno-142-34 name=__codelineno-142-34></a><a href=#__codelineno-142-34><span class=linenos data-linenos="34 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-142-35><a id=__codelineno-142-35 name=__codelineno-142-35></a><a href=#__codelineno-142-35><span class=linenos data-linenos="35 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-142-36><a id=__codelineno-142-36 name=__codelineno-142-36></a><a href=#__codelineno-142-36><span class=linenos data-linenos="36 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-142-37><a id=__codelineno-142-37 name=__codelineno-142-37></a><a href=#__codelineno-142-37><span class=linenos data-linenos="37 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_name</span>
</span><span id=__span-142-38><a id=__codelineno-142-38 name=__codelineno-142-38></a><a href=#__codelineno-142-38><span class=linenos data-linenos="38 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-142-39><a id=__codelineno-142-39 name=__codelineno-142-39></a><a href=#__codelineno-142-39><span class=linenos data-linenos="39 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Company</span>
</span><span id=__span-142-40><a id=__codelineno-142-40 name=__codelineno-142-40></a><a href=#__codelineno-142-40><span class=linenos data-linenos="40 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-142-41><a id=__codelineno-142-41 name=__codelineno-142-41></a><a href=#__codelineno-142-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_company_id</span>
</span><span id=__span-142-42><a id=__codelineno-142-42 name=__codelineno-142-42></a><a href=#__codelineno-142-42><span class=linenos data-linenos="42 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-142-43><a id=__codelineno-142-43 name=__codelineno-142-43></a><a href=#__codelineno-142-43><span class=linenos data-linenos="43 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=mi>20</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-143-1><a id=__codelineno-143-1 name=__codelineno-143-1></a><a href=#__codelineno-143-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-143-2><a id=__codelineno-143-2 name=__codelineno-143-2></a><a href=#__codelineno-143-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-143-3><a id=__codelineno-143-3 name=__codelineno-143-3></a><a href=#__codelineno-143-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-143-4><a id=__codelineno-143-4 name=__codelineno-143-4></a><a href=#__codelineno-143-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-143-5><a id=__codelineno-143-5 name=__codelineno-143-5></a><a href=#__codelineno-143-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: a:
</span><span id=__span-143-6><a id=__codelineno-143-6 name=__codelineno-143-6></a><a href=#__codelineno-143-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-143-7><a id=__codelineno-143-7 name=__codelineno-143-7></a><a href=#__codelineno-143-7><span class=linenos data-linenos=" 7 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-143-8><a id=__codelineno-143-8 name=__codelineno-143-8></a><a href=#__codelineno-143-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-143-9><a id=__codelineno-143-9 name=__codelineno-143-9></a><a href=#__codelineno-143-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: [_anon1:WORKS_AT]-&gt;
</span><span id=__span-143-10><a id=__codelineno-143-10 name=__codelineno-143-10></a><a href=#__codelineno-143-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-143-11><a id=__codelineno-143-11 name=__codelineno-143-11></a><a href=#__codelineno-143-11><span class=linenos data-linenos="11 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-143-12><a id=__codelineno-143-12 name=__codelineno-143-12></a><a href=#__codelineno-143-12><span class=linenos data-linenos="12 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-143-13><a id=__codelineno-143-13 name=__codelineno-143-13></a><a href=#__codelineno-143-13><span class=linenos data-linenos="13 "></span></a>    DataSource: c:Company
</span><span id=__span-143-14><a id=__codelineno-143-14 name=__codelineno-143-14></a><a href=#__codelineno-143-14><span class=linenos data-linenos="14 "></span></a>*
</span><span id=__span-143-15><a id=__codelineno-143-15 name=__codelineno-143-15></a><a href=#__codelineno-143-15><span class=linenos data-linenos="15 "></span></a>----------------------------------------------------------------------
</span><span id=__span-143-16><a id=__codelineno-143-16 name=__codelineno-143-16></a><a href=#__codelineno-143-16><span class=linenos data-linenos="16 "></span></a>Level 1:
</span><span id=__span-143-17><a id=__codelineno-143-17 name=__codelineno-143-17></a><a href=#__codelineno-143-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-143-18><a id=__codelineno-143-18 name=__codelineno-143-18></a><a href=#__codelineno-143-18><span class=linenos data-linenos="18 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-143-19><a id=__codelineno-143-19 name=__codelineno-143-19></a><a href=#__codelineno-143-19><span class=linenos data-linenos="19 "></span></a>  JoinOperator(id=4)
</span><span id=__span-143-20><a id=__codelineno-143-20 name=__codelineno-143-20></a><a href=#__codelineno-143-20><span class=linenos data-linenos="20 "></span></a>    JoinType: INNER
</span><span id=__span-143-21><a id=__codelineno-143-21 name=__codelineno-143-21></a><a href=#__codelineno-143-21><span class=linenos data-linenos="21 "></span></a>    Joins: JoinPair: Node=a RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-143-22><a id=__codelineno-143-22 name=__codelineno-143-22></a><a href=#__codelineno-143-22><span class=linenos data-linenos="22 "></span></a>*
</span><span id=__span-143-23><a id=__codelineno-143-23 name=__codelineno-143-23></a><a href=#__codelineno-143-23><span class=linenos data-linenos="23 "></span></a>----------------------------------------------------------------------
</span><span id=__span-143-24><a id=__codelineno-143-24 name=__codelineno-143-24></a><a href=#__codelineno-143-24><span class=linenos data-linenos="24 "></span></a>Level 2:
</span><span id=__span-143-25><a id=__codelineno-143-25 name=__codelineno-143-25></a><a href=#__codelineno-143-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-143-26><a id=__codelineno-143-26 name=__codelineno-143-26></a><a href=#__codelineno-143-26><span class=linenos data-linenos="26 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=6;
</span><span id=__span-143-27><a id=__codelineno-143-27 name=__codelineno-143-27></a><a href=#__codelineno-143-27><span class=linenos data-linenos="27 "></span></a>  JoinOperator(id=5)
</span><span id=__span-143-28><a id=__codelineno-143-28 name=__codelineno-143-28></a><a href=#__codelineno-143-28><span class=linenos data-linenos="28 "></span></a>    JoinType: INNER
</span><span id=__span-143-29><a id=__codelineno-143-29 name=__codelineno-143-29></a><a href=#__codelineno-143-29><span class=linenos data-linenos="29 "></span></a>    Joins: JoinPair: Node=c RelOrNode=_anon1 Type=SINK
</span><span id=__span-143-30><a id=__codelineno-143-30 name=__codelineno-143-30></a><a href=#__codelineno-143-30><span class=linenos data-linenos="30 "></span></a>*
</span><span id=__span-143-31><a id=__codelineno-143-31 name=__codelineno-143-31></a><a href=#__codelineno-143-31><span class=linenos data-linenos="31 "></span></a>----------------------------------------------------------------------
</span><span id=__span-143-32><a id=__codelineno-143-32 name=__codelineno-143-32></a><a href=#__codelineno-143-32><span class=linenos data-linenos="32 "></span></a>Level 3:
</span><span id=__span-143-33><a id=__codelineno-143-33 name=__codelineno-143-33></a><a href=#__codelineno-143-33><span class=linenos data-linenos="33 "></span></a>----------------------------------------------------------------------
</span><span id=__span-143-34><a id=__codelineno-143-34 name=__codelineno-143-34></a><a href=#__codelineno-143-34><span class=linenos data-linenos="34 "></span></a>OpId=6 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-143-35><a id=__codelineno-143-35 name=__codelineno-143-35></a><a href=#__codelineno-143-35><span class=linenos data-linenos="35 "></span></a>  ProjectionOperator(id=6)
</span><span id=__span-143-36><a id=__codelineno-143-36 name=__codelineno-143-36></a><a href=#__codelineno-143-36><span class=linenos data-linenos="36 "></span></a>    Projections: name=a.name, name=c.name
</span><span id=__span-143-37><a id=__codelineno-143-37 name=__codelineno-143-37></a><a href=#__codelineno-143-37><span class=linenos data-linenos="37 "></span></a>*
</span><span id=__span-143-38><a id=__codelineno-143-38 name=__codelineno-143-38></a><a href=#__codelineno-143-38><span class=linenos data-linenos="38 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=49-no-label-target-node-without-label>49. NO LABEL: Target node without label<a class=headerlink href=#49-no-label-target-node-without-label title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: No-label target node</p> <details class=note> <summary>Notes</summary> <p>Target node 'target' has no label - matches ANY node type.</p> <p>USE CASE: Find all connections of a person regardless of type.</p> <p>SQL PATTERN: FROM (SELECT ... FROM Person) AS p JOIN edges ON p.id = edges.src JOIN nodes AS target ON edges.dst = target.id -- NO type filter WHERE edges.relationship_type = 'KNOWS'</p> <p>BENEFIT: Explore graph structure without knowing all node types.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-144-1><a id=__codelineno-144-1 name=__codelineno-144-1></a><a href=#__codelineno-144-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>p</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span><span id=__span-144-2><a id=__codelineno-144-2 name=__codelineno-144-2></a><a href=#__codelineno-144-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>target</span><span class=p>.</span><span class=n>name</span>
</span><span id=__span-144-3><a id=__codelineno-144-3 name=__codelineno-144-3></a><a href=#__codelineno-144-3><span class=linenos data-linenos="3 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=m>20</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-145-1><a id=__codelineno-145-1 name=__codelineno-145-1></a><a href=#__codelineno-145-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-145-2><a id=__codelineno-145-2 name=__codelineno-145-2></a><a href=#__codelineno-145-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-145-3><a id=__codelineno-145-3 name=__codelineno-145-3></a><a href=#__codelineno-145-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_target_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-145-4><a id=__codelineno-145-4 name=__codelineno-145-4></a><a href=#__codelineno-145-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-145-5><a id=__codelineno-145-5 name=__codelineno-145-5></a><a href=#__codelineno-145-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-145-6><a id=__codelineno-145-6 name=__codelineno-145-6></a><a href=#__codelineno-145-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-145-7><a id=__codelineno-145-7 name=__codelineno-145-7></a><a href=#__codelineno-145-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-145-8><a id=__codelineno-145-8 name=__codelineno-145-8></a><a href=#__codelineno-145-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-145-9><a id=__codelineno-145-9 name=__codelineno-145-9></a><a href=#__codelineno-145-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-145-10><a id=__codelineno-145-10 name=__codelineno-145-10></a><a href=#__codelineno-145-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_target_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_target_id</span>
</span><span id=__span-145-11><a id=__codelineno-145-11 name=__codelineno-145-11></a><a href=#__codelineno-145-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_target_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_target_name</span>
</span><span id=__span-145-12><a id=__codelineno-145-12 name=__codelineno-145-12></a><a href=#__codelineno-145-12><span class=linenos data-linenos="12 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-145-13><a id=__codelineno-145-13 name=__codelineno-145-13></a><a href=#__codelineno-145-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-145-14><a id=__codelineno-145-14 name=__codelineno-145-14></a><a href=#__codelineno-145-14><span class=linenos data-linenos="14 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-145-15><a id=__codelineno-145-15 name=__codelineno-145-15></a><a href=#__codelineno-145-15><span class=linenos data-linenos="15 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-145-16><a id=__codelineno-145-16 name=__codelineno-145-16></a><a href=#__codelineno-145-16><span class=linenos data-linenos="16 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-145-17><a id=__codelineno-145-17 name=__codelineno-145-17></a><a href=#__codelineno-145-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-145-18><a id=__codelineno-145-18 name=__codelineno-145-18></a><a href=#__codelineno-145-18><span class=linenos data-linenos="18 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-145-19><a id=__codelineno-145-19 name=__codelineno-145-19></a><a href=#__codelineno-145-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-145-20><a id=__codelineno-145-20 name=__codelineno-145-20></a><a href=#__codelineno-145-20><span class=linenos data-linenos="20 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_id</span>
</span><span id=__span-145-21><a id=__codelineno-145-21 name=__codelineno-145-21></a><a href=#__codelineno-145-21><span class=linenos data-linenos="21 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_p_name</span>
</span><span id=__span-145-22><a id=__codelineno-145-22 name=__codelineno-145-22></a><a href=#__codelineno-145-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-145-23><a id=__codelineno-145-23 name=__codelineno-145-23></a><a href=#__codelineno-145-23><span class=linenos data-linenos="23 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-145-24><a id=__codelineno-145-24 name=__codelineno-145-24></a><a href=#__codelineno-145-24><span class=linenos data-linenos="24 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-145-25><a id=__codelineno-145-25 name=__codelineno-145-25></a><a href=#__codelineno-145-25><span class=linenos data-linenos="25 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-145-26><a id=__codelineno-145-26 name=__codelineno-145-26></a><a href=#__codelineno-145-26><span class=linenos data-linenos="26 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-145-27><a id=__codelineno-145-27 name=__codelineno-145-27></a><a href=#__codelineno-145-27><span class=linenos data-linenos="27 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-145-28><a id=__codelineno-145-28 name=__codelineno-145-28></a><a href=#__codelineno-145-28><span class=linenos data-linenos="28 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-145-29><a id=__codelineno-145-29 name=__codelineno-145-29></a><a href=#__codelineno-145-29><span class=linenos data-linenos="29 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-145-30><a id=__codelineno-145-30 name=__codelineno-145-30></a><a href=#__codelineno-145-30><span class=linenos data-linenos="30 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-145-31><a id=__codelineno-145-31 name=__codelineno-145-31></a><a href=#__codelineno-145-31><span class=linenos data-linenos="31 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-145-32><a id=__codelineno-145-32 name=__codelineno-145-32></a><a href=#__codelineno-145-32><span class=linenos data-linenos="32 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_p_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-145-33><a id=__codelineno-145-33 name=__codelineno-145-33></a><a href=#__codelineno-145-33><span class=linenos data-linenos="33 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-145-34><a id=__codelineno-145-34 name=__codelineno-145-34></a><a href=#__codelineno-145-34><span class=linenos data-linenos="34 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-145-35><a id=__codelineno-145-35 name=__codelineno-145-35></a><a href=#__codelineno-145-35><span class=linenos data-linenos="35 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-145-36><a id=__codelineno-145-36 name=__codelineno-145-36></a><a href=#__codelineno-145-36><span class=linenos data-linenos="36 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_target_id</span>
</span><span id=__span-145-37><a id=__codelineno-145-37 name=__codelineno-145-37></a><a href=#__codelineno-145-37><span class=linenos data-linenos="37 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_target_name</span>
</span><span id=__span-145-38><a id=__codelineno-145-38 name=__codelineno-145-38></a><a href=#__codelineno-145-38><span class=linenos data-linenos="38 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-145-39><a id=__codelineno-145-39 name=__codelineno-145-39></a><a href=#__codelineno-145-39><span class=linenos data-linenos="39 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>AllNodes</span>
</span><span id=__span-145-40><a id=__codelineno-145-40 name=__codelineno-145-40></a><a href=#__codelineno-145-40><span class=linenos data-linenos="40 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-145-41><a id=__codelineno-145-41 name=__codelineno-145-41></a><a href=#__codelineno-145-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_target_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-145-42><a id=__codelineno-145-42 name=__codelineno-145-42></a><a href=#__codelineno-145-42><span class=linenos data-linenos="42 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-145-43><a id=__codelineno-145-43 name=__codelineno-145-43></a><a href=#__codelineno-145-43><span class=linenos data-linenos="43 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=mi>20</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-146-1><a id=__codelineno-146-1 name=__codelineno-146-1></a><a href=#__codelineno-146-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-146-2><a id=__codelineno-146-2 name=__codelineno-146-2></a><a href=#__codelineno-146-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-146-3><a id=__codelineno-146-3 name=__codelineno-146-3></a><a href=#__codelineno-146-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-146-4><a id=__codelineno-146-4 name=__codelineno-146-4></a><a href=#__codelineno-146-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-146-5><a id=__codelineno-146-5 name=__codelineno-146-5></a><a href=#__codelineno-146-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: p:Person
</span><span id=__span-146-6><a id=__codelineno-146-6 name=__codelineno-146-6></a><a href=#__codelineno-146-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-146-7><a id=__codelineno-146-7 name=__codelineno-146-7></a><a href=#__codelineno-146-7><span class=linenos data-linenos=" 7 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-146-8><a id=__codelineno-146-8 name=__codelineno-146-8></a><a href=#__codelineno-146-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-146-9><a id=__codelineno-146-9 name=__codelineno-146-9></a><a href=#__codelineno-146-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: [_anon1:KNOWS]-&gt;
</span><span id=__span-146-10><a id=__codelineno-146-10 name=__codelineno-146-10></a><a href=#__codelineno-146-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-146-11><a id=__codelineno-146-11 name=__codelineno-146-11></a><a href=#__codelineno-146-11><span class=linenos data-linenos="11 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-146-12><a id=__codelineno-146-12 name=__codelineno-146-12></a><a href=#__codelineno-146-12><span class=linenos data-linenos="12 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-146-13><a id=__codelineno-146-13 name=__codelineno-146-13></a><a href=#__codelineno-146-13><span class=linenos data-linenos="13 "></span></a>    DataSource: target:
</span><span id=__span-146-14><a id=__codelineno-146-14 name=__codelineno-146-14></a><a href=#__codelineno-146-14><span class=linenos data-linenos="14 "></span></a>*
</span><span id=__span-146-15><a id=__codelineno-146-15 name=__codelineno-146-15></a><a href=#__codelineno-146-15><span class=linenos data-linenos="15 "></span></a>----------------------------------------------------------------------
</span><span id=__span-146-16><a id=__codelineno-146-16 name=__codelineno-146-16></a><a href=#__codelineno-146-16><span class=linenos data-linenos="16 "></span></a>Level 1:
</span><span id=__span-146-17><a id=__codelineno-146-17 name=__codelineno-146-17></a><a href=#__codelineno-146-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-146-18><a id=__codelineno-146-18 name=__codelineno-146-18></a><a href=#__codelineno-146-18><span class=linenos data-linenos="18 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-146-19><a id=__codelineno-146-19 name=__codelineno-146-19></a><a href=#__codelineno-146-19><span class=linenos data-linenos="19 "></span></a>  JoinOperator(id=4)
</span><span id=__span-146-20><a id=__codelineno-146-20 name=__codelineno-146-20></a><a href=#__codelineno-146-20><span class=linenos data-linenos="20 "></span></a>    JoinType: INNER
</span><span id=__span-146-21><a id=__codelineno-146-21 name=__codelineno-146-21></a><a href=#__codelineno-146-21><span class=linenos data-linenos="21 "></span></a>    Joins: JoinPair: Node=p RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-146-22><a id=__codelineno-146-22 name=__codelineno-146-22></a><a href=#__codelineno-146-22><span class=linenos data-linenos="22 "></span></a>*
</span><span id=__span-146-23><a id=__codelineno-146-23 name=__codelineno-146-23></a><a href=#__codelineno-146-23><span class=linenos data-linenos="23 "></span></a>----------------------------------------------------------------------
</span><span id=__span-146-24><a id=__codelineno-146-24 name=__codelineno-146-24></a><a href=#__codelineno-146-24><span class=linenos data-linenos="24 "></span></a>Level 2:
</span><span id=__span-146-25><a id=__codelineno-146-25 name=__codelineno-146-25></a><a href=#__codelineno-146-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-146-26><a id=__codelineno-146-26 name=__codelineno-146-26></a><a href=#__codelineno-146-26><span class=linenos data-linenos="26 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=6;
</span><span id=__span-146-27><a id=__codelineno-146-27 name=__codelineno-146-27></a><a href=#__codelineno-146-27><span class=linenos data-linenos="27 "></span></a>  JoinOperator(id=5)
</span><span id=__span-146-28><a id=__codelineno-146-28 name=__codelineno-146-28></a><a href=#__codelineno-146-28><span class=linenos data-linenos="28 "></span></a>    JoinType: INNER
</span><span id=__span-146-29><a id=__codelineno-146-29 name=__codelineno-146-29></a><a href=#__codelineno-146-29><span class=linenos data-linenos="29 "></span></a>    Joins: JoinPair: Node=target RelOrNode=_anon1 Type=SINK
</span><span id=__span-146-30><a id=__codelineno-146-30 name=__codelineno-146-30></a><a href=#__codelineno-146-30><span class=linenos data-linenos="30 "></span></a>*
</span><span id=__span-146-31><a id=__codelineno-146-31 name=__codelineno-146-31></a><a href=#__codelineno-146-31><span class=linenos data-linenos="31 "></span></a>----------------------------------------------------------------------
</span><span id=__span-146-32><a id=__codelineno-146-32 name=__codelineno-146-32></a><a href=#__codelineno-146-32><span class=linenos data-linenos="32 "></span></a>Level 3:
</span><span id=__span-146-33><a id=__codelineno-146-33 name=__codelineno-146-33></a><a href=#__codelineno-146-33><span class=linenos data-linenos="33 "></span></a>----------------------------------------------------------------------
</span><span id=__span-146-34><a id=__codelineno-146-34 name=__codelineno-146-34></a><a href=#__codelineno-146-34><span class=linenos data-linenos="34 "></span></a>OpId=6 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-146-35><a id=__codelineno-146-35 name=__codelineno-146-35></a><a href=#__codelineno-146-35><span class=linenos data-linenos="35 "></span></a>  ProjectionOperator(id=6)
</span><span id=__span-146-36><a id=__codelineno-146-36 name=__codelineno-146-36></a><a href=#__codelineno-146-36><span class=linenos data-linenos="36 "></span></a>    Projections: name=p.name, name=target.name
</span><span id=__span-146-37><a id=__codelineno-146-37 name=__codelineno-146-37></a><a href=#__codelineno-146-37><span class=linenos data-linenos="37 "></span></a>*
</span><span id=__span-146-38><a id=__codelineno-146-38 name=__codelineno-146-38></a><a href=#__codelineno-146-38><span class=linenos data-linenos="38 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=50-no-label-both-endpoints-without-labels>50. NO LABEL: Both endpoints without labels<a class=headerlink href=#50-no-label-both-endpoints-without-labels title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: No-label both nodes</p> <details class=note> <summary>Notes</summary> <p>Both nodes 'a' and 'b' have no labels - match ANY node types.</p> <p>SQL PATTERN: FROM nodes AS a JOIN edges ON a.id = edges.src JOIN nodes AS b ON edges.dst = b.id WHERE edges.relationship_type = 'KNOWS'</p> <p>USE CASE: Explore all KNOWS relationships regardless of node types.</p> <p>WARNING: Can be expensive on large graphs - no type filtering applied!</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-147-1><a id=__codelineno-147-1 name=__codelineno-147-1></a><a href=#__codelineno-147-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span><span id=__span-147-2><a id=__codelineno-147-2 name=__codelineno-147-2></a><a href=#__codelineno-147-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>name</span>
</span><span id=__span-147-3><a id=__codelineno-147-3 name=__codelineno-147-3></a><a href=#__codelineno-147-3><span class=linenos data-linenos="3 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=m>20</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-148-1><a id=__codelineno-148-1 name=__codelineno-148-1></a><a href=#__codelineno-148-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-148-2><a id=__codelineno-148-2 name=__codelineno-148-2></a><a href=#__codelineno-148-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_a_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-148-3><a id=__codelineno-148-3 name=__codelineno-148-3></a><a href=#__codelineno-148-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_b_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-148-4><a id=__codelineno-148-4 name=__codelineno-148-4></a><a href=#__codelineno-148-4><span class=linenos data-linenos=" 4 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-148-5><a id=__codelineno-148-5 name=__codelineno-148-5></a><a href=#__codelineno-148-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-148-6><a id=__codelineno-148-6 name=__codelineno-148-6></a><a href=#__codelineno-148-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_a_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-148-7><a id=__codelineno-148-7 name=__codelineno-148-7></a><a href=#__codelineno-148-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_a_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-148-8><a id=__codelineno-148-8 name=__codelineno-148-8></a><a href=#__codelineno-148-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-148-9><a id=__codelineno-148-9 name=__codelineno-148-9></a><a href=#__codelineno-148-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-148-10><a id=__codelineno-148-10 name=__codelineno-148-10></a><a href=#__codelineno-148-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_b_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_id</span>
</span><span id=__span-148-11><a id=__codelineno-148-11 name=__codelineno-148-11></a><a href=#__codelineno-148-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_b_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_name</span>
</span><span id=__span-148-12><a id=__codelineno-148-12 name=__codelineno-148-12></a><a href=#__codelineno-148-12><span class=linenos data-linenos="12 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-148-13><a id=__codelineno-148-13 name=__codelineno-148-13></a><a href=#__codelineno-148-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-148-14><a id=__codelineno-148-14 name=__codelineno-148-14></a><a href=#__codelineno-148-14><span class=linenos data-linenos="14 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_a_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-148-15><a id=__codelineno-148-15 name=__codelineno-148-15></a><a href=#__codelineno-148-15><span class=linenos data-linenos="15 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_a_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-148-16><a id=__codelineno-148-16 name=__codelineno-148-16></a><a href=#__codelineno-148-16><span class=linenos data-linenos="16 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-148-17><a id=__codelineno-148-17 name=__codelineno-148-17></a><a href=#__codelineno-148-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-148-18><a id=__codelineno-148-18 name=__codelineno-148-18></a><a href=#__codelineno-148-18><span class=linenos data-linenos="18 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-148-19><a id=__codelineno-148-19 name=__codelineno-148-19></a><a href=#__codelineno-148-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-148-20><a id=__codelineno-148-20 name=__codelineno-148-20></a><a href=#__codelineno-148-20><span class=linenos data-linenos="20 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-148-21><a id=__codelineno-148-21 name=__codelineno-148-21></a><a href=#__codelineno-148-21><span class=linenos data-linenos="21 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-148-22><a id=__codelineno-148-22 name=__codelineno-148-22></a><a href=#__codelineno-148-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-148-23><a id=__codelineno-148-23 name=__codelineno-148-23></a><a href=#__codelineno-148-23><span class=linenos data-linenos="23 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>AllNodes</span>
</span><span id=__span-148-24><a id=__codelineno-148-24 name=__codelineno-148-24></a><a href=#__codelineno-148-24><span class=linenos data-linenos="24 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-148-25><a id=__codelineno-148-25 name=__codelineno-148-25></a><a href=#__codelineno-148-25><span class=linenos data-linenos="25 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-148-26><a id=__codelineno-148-26 name=__codelineno-148-26></a><a href=#__codelineno-148-26><span class=linenos data-linenos="26 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-148-27><a id=__codelineno-148-27 name=__codelineno-148-27></a><a href=#__codelineno-148-27><span class=linenos data-linenos="27 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-148-28><a id=__codelineno-148-28 name=__codelineno-148-28></a><a href=#__codelineno-148-28><span class=linenos data-linenos="28 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-148-29><a id=__codelineno-148-29 name=__codelineno-148-29></a><a href=#__codelineno-148-29><span class=linenos data-linenos="29 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-148-30><a id=__codelineno-148-30 name=__codelineno-148-30></a><a href=#__codelineno-148-30><span class=linenos data-linenos="30 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-148-31><a id=__codelineno-148-31 name=__codelineno-148-31></a><a href=#__codelineno-148-31><span class=linenos data-linenos="31 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-148-32><a id=__codelineno-148-32 name=__codelineno-148-32></a><a href=#__codelineno-148-32><span class=linenos data-linenos="32 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_a_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-148-33><a id=__codelineno-148-33 name=__codelineno-148-33></a><a href=#__codelineno-148-33><span class=linenos data-linenos="33 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-148-34><a id=__codelineno-148-34 name=__codelineno-148-34></a><a href=#__codelineno-148-34><span class=linenos data-linenos="34 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-148-35><a id=__codelineno-148-35 name=__codelineno-148-35></a><a href=#__codelineno-148-35><span class=linenos data-linenos="35 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-148-36><a id=__codelineno-148-36 name=__codelineno-148-36></a><a href=#__codelineno-148-36><span class=linenos data-linenos="36 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_id</span>
</span><span id=__span-148-37><a id=__codelineno-148-37 name=__codelineno-148-37></a><a href=#__codelineno-148-37><span class=linenos data-linenos="37 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_name</span>
</span><span id=__span-148-38><a id=__codelineno-148-38 name=__codelineno-148-38></a><a href=#__codelineno-148-38><span class=linenos data-linenos="38 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-148-39><a id=__codelineno-148-39 name=__codelineno-148-39></a><a href=#__codelineno-148-39><span class=linenos data-linenos="39 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>AllNodes</span>
</span><span id=__span-148-40><a id=__codelineno-148-40 name=__codelineno-148-40></a><a href=#__codelineno-148-40><span class=linenos data-linenos="40 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-148-41><a id=__codelineno-148-41 name=__codelineno-148-41></a><a href=#__codelineno-148-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_b_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-148-42><a id=__codelineno-148-42 name=__codelineno-148-42></a><a href=#__codelineno-148-42><span class=linenos data-linenos="42 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-148-43><a id=__codelineno-148-43 name=__codelineno-148-43></a><a href=#__codelineno-148-43><span class=linenos data-linenos="43 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=mi>20</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-149-1><a id=__codelineno-149-1 name=__codelineno-149-1></a><a href=#__codelineno-149-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-149-2><a id=__codelineno-149-2 name=__codelineno-149-2></a><a href=#__codelineno-149-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-149-3><a id=__codelineno-149-3 name=__codelineno-149-3></a><a href=#__codelineno-149-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-149-4><a id=__codelineno-149-4 name=__codelineno-149-4></a><a href=#__codelineno-149-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-149-5><a id=__codelineno-149-5 name=__codelineno-149-5></a><a href=#__codelineno-149-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: a:
</span><span id=__span-149-6><a id=__codelineno-149-6 name=__codelineno-149-6></a><a href=#__codelineno-149-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-149-7><a id=__codelineno-149-7 name=__codelineno-149-7></a><a href=#__codelineno-149-7><span class=linenos data-linenos=" 7 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-149-8><a id=__codelineno-149-8 name=__codelineno-149-8></a><a href=#__codelineno-149-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-149-9><a id=__codelineno-149-9 name=__codelineno-149-9></a><a href=#__codelineno-149-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: [_anon1:KNOWS]-&gt;
</span><span id=__span-149-10><a id=__codelineno-149-10 name=__codelineno-149-10></a><a href=#__codelineno-149-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-149-11><a id=__codelineno-149-11 name=__codelineno-149-11></a><a href=#__codelineno-149-11><span class=linenos data-linenos="11 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-149-12><a id=__codelineno-149-12 name=__codelineno-149-12></a><a href=#__codelineno-149-12><span class=linenos data-linenos="12 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-149-13><a id=__codelineno-149-13 name=__codelineno-149-13></a><a href=#__codelineno-149-13><span class=linenos data-linenos="13 "></span></a>    DataSource: b:
</span><span id=__span-149-14><a id=__codelineno-149-14 name=__codelineno-149-14></a><a href=#__codelineno-149-14><span class=linenos data-linenos="14 "></span></a>*
</span><span id=__span-149-15><a id=__codelineno-149-15 name=__codelineno-149-15></a><a href=#__codelineno-149-15><span class=linenos data-linenos="15 "></span></a>----------------------------------------------------------------------
</span><span id=__span-149-16><a id=__codelineno-149-16 name=__codelineno-149-16></a><a href=#__codelineno-149-16><span class=linenos data-linenos="16 "></span></a>Level 1:
</span><span id=__span-149-17><a id=__codelineno-149-17 name=__codelineno-149-17></a><a href=#__codelineno-149-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-149-18><a id=__codelineno-149-18 name=__codelineno-149-18></a><a href=#__codelineno-149-18><span class=linenos data-linenos="18 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-149-19><a id=__codelineno-149-19 name=__codelineno-149-19></a><a href=#__codelineno-149-19><span class=linenos data-linenos="19 "></span></a>  JoinOperator(id=4)
</span><span id=__span-149-20><a id=__codelineno-149-20 name=__codelineno-149-20></a><a href=#__codelineno-149-20><span class=linenos data-linenos="20 "></span></a>    JoinType: INNER
</span><span id=__span-149-21><a id=__codelineno-149-21 name=__codelineno-149-21></a><a href=#__codelineno-149-21><span class=linenos data-linenos="21 "></span></a>    Joins: JoinPair: Node=a RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-149-22><a id=__codelineno-149-22 name=__codelineno-149-22></a><a href=#__codelineno-149-22><span class=linenos data-linenos="22 "></span></a>*
</span><span id=__span-149-23><a id=__codelineno-149-23 name=__codelineno-149-23></a><a href=#__codelineno-149-23><span class=linenos data-linenos="23 "></span></a>----------------------------------------------------------------------
</span><span id=__span-149-24><a id=__codelineno-149-24 name=__codelineno-149-24></a><a href=#__codelineno-149-24><span class=linenos data-linenos="24 "></span></a>Level 2:
</span><span id=__span-149-25><a id=__codelineno-149-25 name=__codelineno-149-25></a><a href=#__codelineno-149-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-149-26><a id=__codelineno-149-26 name=__codelineno-149-26></a><a href=#__codelineno-149-26><span class=linenos data-linenos="26 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=6;
</span><span id=__span-149-27><a id=__codelineno-149-27 name=__codelineno-149-27></a><a href=#__codelineno-149-27><span class=linenos data-linenos="27 "></span></a>  JoinOperator(id=5)
</span><span id=__span-149-28><a id=__codelineno-149-28 name=__codelineno-149-28></a><a href=#__codelineno-149-28><span class=linenos data-linenos="28 "></span></a>    JoinType: INNER
</span><span id=__span-149-29><a id=__codelineno-149-29 name=__codelineno-149-29></a><a href=#__codelineno-149-29><span class=linenos data-linenos="29 "></span></a>    Joins: JoinPair: Node=b RelOrNode=_anon1 Type=SINK
</span><span id=__span-149-30><a id=__codelineno-149-30 name=__codelineno-149-30></a><a href=#__codelineno-149-30><span class=linenos data-linenos="30 "></span></a>*
</span><span id=__span-149-31><a id=__codelineno-149-31 name=__codelineno-149-31></a><a href=#__codelineno-149-31><span class=linenos data-linenos="31 "></span></a>----------------------------------------------------------------------
</span><span id=__span-149-32><a id=__codelineno-149-32 name=__codelineno-149-32></a><a href=#__codelineno-149-32><span class=linenos data-linenos="32 "></span></a>Level 3:
</span><span id=__span-149-33><a id=__codelineno-149-33 name=__codelineno-149-33></a><a href=#__codelineno-149-33><span class=linenos data-linenos="33 "></span></a>----------------------------------------------------------------------
</span><span id=__span-149-34><a id=__codelineno-149-34 name=__codelineno-149-34></a><a href=#__codelineno-149-34><span class=linenos data-linenos="34 "></span></a>OpId=6 Op=ProjectionOperator; InOpIds=5; OutOpIds=;
</span><span id=__span-149-35><a id=__codelineno-149-35 name=__codelineno-149-35></a><a href=#__codelineno-149-35><span class=linenos data-linenos="35 "></span></a>  ProjectionOperator(id=6)
</span><span id=__span-149-36><a id=__codelineno-149-36 name=__codelineno-149-36></a><a href=#__codelineno-149-36><span class=linenos data-linenos="36 "></span></a>    Projections: name=a.name, name=b.name
</span><span id=__span-149-37><a id=__codelineno-149-37 name=__codelineno-149-37></a><a href=#__codelineno-149-37><span class=linenos data-linenos="37 "></span></a>*
</span><span id=__span-149-38><a id=__codelineno-149-38 name=__codelineno-149-38></a><a href=#__codelineno-149-38><span class=linenos data-linenos="38 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=51-no-label-variable-length-path-without-labels>51. NO LABEL: Variable-length path without labels<a class=headerlink href=#51-no-label-variable-length-path-without-labels title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: No-label VLP</p> <details class=note> <summary>Notes</summary> <p>Variable-length path where both endpoints have no labels.</p> <p>SQL PATTERN (WITH RECURSIVE): WITH RECURSIVE paths AS ( -- Base case: no type filters on source UNION ALL -- Recursive case: traverses any matching edge ) SELECT ... FROM paths JOIN nodes AS a ON ... -- No type filter JOIN nodes AS b ON ... -- No type filter</p> <p>USE CASE: Generic graph traversal - find all paths of any type.</p> <p>COMPLEXITY: O(k^d) where k=avg degree, d=max depth WARNING: Expensive without labels. Use sparingly on large graphs.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-150-1><a id=__codelineno-150-1 name=__codelineno-150-1></a><a href=#__codelineno-150-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=n>path</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=p>*</span><span class=m>1</span><span class=p>..</span><span class=m>2</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span><span id=__span-150-2><a id=__codelineno-150-2 name=__codelineno-150-2></a><a href=#__codelineno-150-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>length</span><span class=p>(</span><span class=n>path</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>hops</span>
</span><span id=__span-150-3><a id=__codelineno-150-3 name=__codelineno-150-3></a><a href=#__codelineno-150-3><span class=linenos data-linenos="3 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=m>50</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-151-1><a id=__codelineno-151-1 name=__codelineno-151-1></a><a href=#__codelineno-151-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span>
</span><span id=__span-151-2><a id=__codelineno-151-2 name=__codelineno-151-2></a><a href=#__codelineno-151-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>  </span><span class=n>paths_1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-151-3><a id=__codelineno-151-3 name=__codelineno-151-3></a><a href=#__codelineno-151-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>    </span><span class=c1>-- Base case: direct edges (depth = 1)</span>
</span><span id=__span-151-4><a id=__codelineno-151-4 name=__codelineno-151-4></a><a href=#__codelineno-151-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-151-5><a id=__codelineno-151-5 name=__codelineno-151-5></a><a href=#__codelineno-151-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-151-6><a id=__codelineno-151-6 name=__codelineno-151-6></a><a href=#__codelineno-151-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-151-7><a id=__codelineno-151-7 name=__codelineno-151-7></a><a href=#__codelineno-151-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>      </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-151-8><a id=__codelineno-151-8 name=__codelineno-151-8></a><a href=#__codelineno-151-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-151-9><a id=__codelineno-151-9 name=__codelineno-151-9></a><a href=#__codelineno-151-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>NAMED_STRUCT</span><span class=p>(</span><span class=s1>&#39;person_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;friend_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;since&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>since</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;strength&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>strength</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path_edges</span><span class=p>,</span>
</span><span id=__span-151-10><a id=__codelineno-151-10 name=__codelineno-151-10></a><a href=#__codelineno-151-10><span class=linenos data-linenos="10 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-151-11><a id=__codelineno-151-11 name=__codelineno-151-11></a><a href=#__codelineno-151-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-151-12><a id=__codelineno-151-12 name=__codelineno-151-12></a><a href=#__codelineno-151-12><span class=linenos data-linenos="12 "></span></a>
</span><span id=__span-151-13><a id=__codelineno-151-13 name=__codelineno-151-13></a><a href=#__codelineno-151-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-151-14><a id=__codelineno-151-14 name=__codelineno-151-14></a><a href=#__codelineno-151-14><span class=linenos data-linenos="14 "></span></a>
</span><span id=__span-151-15><a id=__codelineno-151-15 name=__codelineno-151-15></a><a href=#__codelineno-151-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=c1>-- Recursive case: extend paths</span>
</span><span id=__span-151-16><a id=__codelineno-151-16 name=__codelineno-151-16></a><a href=#__codelineno-151-16><span class=linenos data-linenos="16 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-151-17><a id=__codelineno-151-17 name=__codelineno-151-17></a><a href=#__codelineno-151-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-151-18><a id=__codelineno-151-18 name=__codelineno-151-18></a><a href=#__codelineno-151-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-151-19><a id=__codelineno-151-19 name=__codelineno-151-19></a><a href=#__codelineno-151-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-151-20><a id=__codelineno-151-20 name=__codelineno-151-20></a><a href=#__codelineno-151-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-151-21><a id=__codelineno-151-21 name=__codelineno-151-21></a><a href=#__codelineno-151-21><span class=linenos data-linenos="21 "></span></a><span class=w>      </span><span class=n>ARRAY_APPEND</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path_edges</span><span class=p>,</span><span class=w> </span><span class=n>NAMED_STRUCT</span><span class=p>(</span><span class=s1>&#39;person_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;friend_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;since&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>since</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;strength&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>strength</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path_edges</span><span class=p>,</span>
</span><span id=__span-151-22><a id=__codelineno-151-22 name=__codelineno-151-22></a><a href=#__codelineno-151-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-151-23><a id=__codelineno-151-23 name=__codelineno-151-23></a><a href=#__codelineno-151-23><span class=linenos data-linenos="23 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-151-24><a id=__codelineno-151-24 name=__codelineno-151-24></a><a href=#__codelineno-151-24><span class=linenos data-linenos="24 "></span></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-151-25><a id=__codelineno-151-25 name=__codelineno-151-25></a><a href=#__codelineno-151-25><span class=linenos data-linenos="25 "></span></a><span class=w>      </span><span class=k>ON</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span>
</span><span id=__span-151-26><a id=__codelineno-151-26 name=__codelineno-151-26></a><a href=#__codelineno-151-26><span class=linenos data-linenos="26 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>2</span>
</span><span id=__span-151-27><a id=__codelineno-151-27 name=__codelineno-151-27></a><a href=#__codelineno-151-27><span class=linenos data-linenos="27 "></span></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=n>ARRAY_CONTAINS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span>
</span><span id=__span-151-28><a id=__codelineno-151-28 name=__codelineno-151-28></a><a href=#__codelineno-151-28><span class=linenos data-linenos="28 "></span></a><span class=w>  </span><span class=p>)</span>
</span><span id=__span-151-29><a id=__codelineno-151-29 name=__codelineno-151-29></a><a href=#__codelineno-151-29><span class=linenos data-linenos="29 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-151-30><a id=__codelineno-151-30 name=__codelineno-151-30></a><a href=#__codelineno-151-30><span class=linenos data-linenos="30 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_a_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>id</span>
</span><span id=__span-151-31><a id=__codelineno-151-31 name=__codelineno-151-31></a><a href=#__codelineno-151-31><span class=linenos data-linenos="31 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_b_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>id</span>
</span><span id=__span-151-32><a id=__codelineno-151-32 name=__codelineno-151-32></a><a href=#__codelineno-151-32><span class=linenos data-linenos="32 "></span></a><span class=w>  </span><span class=p>,(</span><span class=k>SIZE</span><span class=p>(</span><span class=n>_gsql2rsql_path_id</span><span class=p>)</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>hops</span>
</span><span id=__span-151-33><a id=__codelineno-151-33 name=__codelineno-151-33></a><a href=#__codelineno-151-33><span class=linenos data-linenos="33 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-151-34><a id=__codelineno-151-34 name=__codelineno-151-34></a><a href=#__codelineno-151-34><span class=linenos data-linenos="34 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-151-35><a id=__codelineno-151-35 name=__codelineno-151-35></a><a href=#__codelineno-151-35><span class=linenos data-linenos="35 "></span></a><span class=w>     </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_id</span>
</span><span id=__span-151-36><a id=__codelineno-151-36 name=__codelineno-151-36></a><a href=#__codelineno-151-36><span class=linenos data-linenos="36 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_name</span>
</span><span id=__span-151-37><a id=__codelineno-151-37 name=__codelineno-151-37></a><a href=#__codelineno-151-37><span class=linenos data-linenos="37 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_age</span>
</span><span id=__span-151-38><a id=__codelineno-151-38 name=__codelineno-151-38></a><a href=#__codelineno-151-38><span class=linenos data-linenos="38 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_nickname</span>
</span><span id=__span-151-39><a id=__codelineno-151-39 name=__codelineno-151-39></a><a href=#__codelineno-151-39><span class=linenos data-linenos="39 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_salary</span>
</span><span id=__span-151-40><a id=__codelineno-151-40 name=__codelineno-151-40></a><a href=#__codelineno-151-40><span class=linenos data-linenos="40 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_active</span>
</span><span id=__span-151-41><a id=__codelineno-151-41 name=__codelineno-151-41></a><a href=#__codelineno-151-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>population</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_population</span>
</span><span id=__span-151-42><a id=__codelineno-151-42 name=__codelineno-151-42></a><a href=#__codelineno-151-42><span class=linenos data-linenos="42 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>country</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_country</span>
</span><span id=__span-151-43><a id=__codelineno-151-43 name=__codelineno-151-43></a><a href=#__codelineno-151-43><span class=linenos data-linenos="43 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>title</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_title</span>
</span><span id=__span-151-44><a id=__codelineno-151-44 name=__codelineno-151-44></a><a href=#__codelineno-151-44><span class=linenos data-linenos="44 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_year</span>
</span><span id=__span-151-45><a id=__codelineno-151-45 name=__codelineno-151-45></a><a href=#__codelineno-151-45><span class=linenos data-linenos="45 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>genre</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_genre</span>
</span><span id=__span-151-46><a id=__codelineno-151-46 name=__codelineno-151-46></a><a href=#__codelineno-151-46><span class=linenos data-linenos="46 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>rating</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_rating</span>
</span><span id=__span-151-47><a id=__codelineno-151-47 name=__codelineno-151-47></a><a href=#__codelineno-151-47><span class=linenos data-linenos="47 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>industry</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_industry</span>
</span><span id=__span-151-48><a id=__codelineno-151-48 name=__codelineno-151-48></a><a href=#__codelineno-151-48><span class=linenos data-linenos="48 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-151-49><a id=__codelineno-151-49 name=__codelineno-151-49></a><a href=#__codelineno-151-49><span class=linenos data-linenos="49 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-151-50><a id=__codelineno-151-50 name=__codelineno-151-50></a><a href=#__codelineno-151-50><span class=linenos data-linenos="50 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_age</span>
</span><span id=__span-151-51><a id=__codelineno-151-51 name=__codelineno-151-51></a><a href=#__codelineno-151-51><span class=linenos data-linenos="51 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_nickname</span>
</span><span id=__span-151-52><a id=__codelineno-151-52 name=__codelineno-151-52></a><a href=#__codelineno-151-52><span class=linenos data-linenos="52 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_salary</span>
</span><span id=__span-151-53><a id=__codelineno-151-53 name=__codelineno-151-53></a><a href=#__codelineno-151-53><span class=linenos data-linenos="53 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_active</span>
</span><span id=__span-151-54><a id=__codelineno-151-54 name=__codelineno-151-54></a><a href=#__codelineno-151-54><span class=linenos data-linenos="54 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>population</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_population</span>
</span><span id=__span-151-55><a id=__codelineno-151-55 name=__codelineno-151-55></a><a href=#__codelineno-151-55><span class=linenos data-linenos="55 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>country</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_country</span>
</span><span id=__span-151-56><a id=__codelineno-151-56 name=__codelineno-151-56></a><a href=#__codelineno-151-56><span class=linenos data-linenos="56 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>title</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_title</span>
</span><span id=__span-151-57><a id=__codelineno-151-57 name=__codelineno-151-57></a><a href=#__codelineno-151-57><span class=linenos data-linenos="57 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_year</span>
</span><span id=__span-151-58><a id=__codelineno-151-58 name=__codelineno-151-58></a><a href=#__codelineno-151-58><span class=linenos data-linenos="58 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>genre</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_genre</span>
</span><span id=__span-151-59><a id=__codelineno-151-59 name=__codelineno-151-59></a><a href=#__codelineno-151-59><span class=linenos data-linenos="59 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>rating</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_rating</span>
</span><span id=__span-151-60><a id=__codelineno-151-60 name=__codelineno-151-60></a><a href=#__codelineno-151-60><span class=linenos data-linenos="60 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>industry</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_industry</span>
</span><span id=__span-151-61><a id=__codelineno-151-61 name=__codelineno-151-61></a><a href=#__codelineno-151-61><span class=linenos data-linenos="61 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-151-62><a id=__codelineno-151-62 name=__codelineno-151-62></a><a href=#__codelineno-151-62><span class=linenos data-linenos="62 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-151-63><a id=__codelineno-151-63 name=__codelineno-151-63></a><a href=#__codelineno-151-63><span class=linenos data-linenos="63 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>depth</span>
</span><span id=__span-151-64><a id=__codelineno-151-64 name=__codelineno-151-64></a><a href=#__codelineno-151-64><span class=linenos data-linenos="64 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_path_id</span>
</span><span id=__span-151-65><a id=__codelineno-151-65 name=__codelineno-151-65></a><a href=#__codelineno-151-65><span class=linenos data-linenos="65 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>path_edges</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_path_edges</span>
</span><span id=__span-151-66><a id=__codelineno-151-66 name=__codelineno-151-66></a><a href=#__codelineno-151-66><span class=linenos data-linenos="66 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-151-67><a id=__codelineno-151-67 name=__codelineno-151-67></a><a href=#__codelineno-151-67><span class=linenos data-linenos="67 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>AllNodes</span><span class=w> </span><span class=n>sink</span>
</span><span id=__span-151-68><a id=__codelineno-151-68 name=__codelineno-151-68></a><a href=#__codelineno-151-68><span class=linenos data-linenos="68 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-151-69><a id=__codelineno-151-69 name=__codelineno-151-69></a><a href=#__codelineno-151-69><span class=linenos data-linenos="69 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>AllNodes</span><span class=w> </span><span class=k>source</span>
</span><span id=__span-151-70><a id=__codelineno-151-70 name=__codelineno-151-70></a><a href=#__codelineno-151-70><span class=linenos data-linenos="70 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-151-71><a id=__codelineno-151-71 name=__codelineno-151-71></a><a href=#__codelineno-151-71><span class=linenos data-linenos="71 "></span></a><span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>2</span>
</span><span id=__span-151-72><a id=__codelineno-151-72 name=__codelineno-151-72></a><a href=#__codelineno-151-72><span class=linenos data-linenos="72 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-151-73><a id=__codelineno-151-73 name=__codelineno-151-73></a><a href=#__codelineno-151-73><span class=linenos data-linenos="73 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=mi>50</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-152-1><a id=__codelineno-152-1 name=__codelineno-152-1></a><a href=#__codelineno-152-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-152-2><a id=__codelineno-152-2 name=__codelineno-152-2></a><a href=#__codelineno-152-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-152-3><a id=__codelineno-152-3 name=__codelineno-152-3></a><a href=#__codelineno-152-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=2;
</span><span id=__span-152-4><a id=__codelineno-152-4 name=__codelineno-152-4></a><a href=#__codelineno-152-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-152-5><a id=__codelineno-152-5 name=__codelineno-152-5></a><a href=#__codelineno-152-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: a:
</span><span id=__span-152-6><a id=__codelineno-152-6 name=__codelineno-152-6></a><a href=#__codelineno-152-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-152-7><a id=__codelineno-152-7 name=__codelineno-152-7></a><a href=#__codelineno-152-7><span class=linenos data-linenos=" 7 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-152-8><a id=__codelineno-152-8 name=__codelineno-152-8></a><a href=#__codelineno-152-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-152-9><a id=__codelineno-152-9 name=__codelineno-152-9></a><a href=#__codelineno-152-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: b:
</span><span id=__span-152-10><a id=__codelineno-152-10 name=__codelineno-152-10></a><a href=#__codelineno-152-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-152-11><a id=__codelineno-152-11 name=__codelineno-152-11></a><a href=#__codelineno-152-11><span class=linenos data-linenos="11 "></span></a>----------------------------------------------------------------------
</span><span id=__span-152-12><a id=__codelineno-152-12 name=__codelineno-152-12></a><a href=#__codelineno-152-12><span class=linenos data-linenos="12 "></span></a>Level 1:
</span><span id=__span-152-13><a id=__codelineno-152-13 name=__codelineno-152-13></a><a href=#__codelineno-152-13><span class=linenos data-linenos="13 "></span></a>----------------------------------------------------------------------
</span><span id=__span-152-14><a id=__codelineno-152-14 name=__codelineno-152-14></a><a href=#__codelineno-152-14><span class=linenos data-linenos="14 "></span></a>OpId=2 Op=RecursiveTraversalOperator; InOpIds=1; OutOpIds=4;
</span><span id=__span-152-15><a id=__codelineno-152-15 name=__codelineno-152-15></a><a href=#__codelineno-152-15><span class=linenos data-linenos="15 "></span></a>  RecursiveTraversal(KNOWS*1..2, path=path)
</span><span id=__span-152-16><a id=__codelineno-152-16 name=__codelineno-152-16></a><a href=#__codelineno-152-16><span class=linenos data-linenos="16 "></span></a>*
</span><span id=__span-152-17><a id=__codelineno-152-17 name=__codelineno-152-17></a><a href=#__codelineno-152-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-152-18><a id=__codelineno-152-18 name=__codelineno-152-18></a><a href=#__codelineno-152-18><span class=linenos data-linenos="18 "></span></a>Level 2:
</span><span id=__span-152-19><a id=__codelineno-152-19 name=__codelineno-152-19></a><a href=#__codelineno-152-19><span class=linenos data-linenos="19 "></span></a>----------------------------------------------------------------------
</span><span id=__span-152-20><a id=__codelineno-152-20 name=__codelineno-152-20></a><a href=#__codelineno-152-20><span class=linenos data-linenos="20 "></span></a>OpId=4 Op=JoinOperator; InOpIds=2,3; OutOpIds=5;
</span><span id=__span-152-21><a id=__codelineno-152-21 name=__codelineno-152-21></a><a href=#__codelineno-152-21><span class=linenos data-linenos="21 "></span></a>  JoinOperator(id=4)
</span><span id=__span-152-22><a id=__codelineno-152-22 name=__codelineno-152-22></a><a href=#__codelineno-152-22><span class=linenos data-linenos="22 "></span></a>    JoinType: INNER
</span><span id=__span-152-23><a id=__codelineno-152-23 name=__codelineno-152-23></a><a href=#__codelineno-152-23><span class=linenos data-linenos="23 "></span></a>    Joins: JoinPair: Node=b RelOrNode=paths__anon1 Type=SINK
</span><span id=__span-152-24><a id=__codelineno-152-24 name=__codelineno-152-24></a><a href=#__codelineno-152-24><span class=linenos data-linenos="24 "></span></a>*
</span><span id=__span-152-25><a id=__codelineno-152-25 name=__codelineno-152-25></a><a href=#__codelineno-152-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-152-26><a id=__codelineno-152-26 name=__codelineno-152-26></a><a href=#__codelineno-152-26><span class=linenos data-linenos="26 "></span></a>Level 3:
</span><span id=__span-152-27><a id=__codelineno-152-27 name=__codelineno-152-27></a><a href=#__codelineno-152-27><span class=linenos data-linenos="27 "></span></a>----------------------------------------------------------------------
</span><span id=__span-152-28><a id=__codelineno-152-28 name=__codelineno-152-28></a><a href=#__codelineno-152-28><span class=linenos data-linenos="28 "></span></a>OpId=5 Op=ProjectionOperator; InOpIds=4; OutOpIds=;
</span><span id=__span-152-29><a id=__codelineno-152-29 name=__codelineno-152-29></a><a href=#__codelineno-152-29><span class=linenos data-linenos="29 "></span></a>  ProjectionOperator(id=5)
</span><span id=__span-152-30><a id=__codelineno-152-30 name=__codelineno-152-30></a><a href=#__codelineno-152-30><span class=linenos data-linenos="30 "></span></a>    Projections: id=a.id, id=b.id, hops=LENGTH(path)
</span><span id=__span-152-31><a id=__codelineno-152-31 name=__codelineno-152-31></a><a href=#__codelineno-152-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-152-32><a id=__codelineno-152-32 name=__codelineno-152-32></a><a href=#__codelineno-152-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=52-no-label-vlp-with-labeled-source-unlabeled-target>52. NO LABEL: VLP with labeled source, unlabeled target<a class=headerlink href=#52-no-label-vlp-with-labeled-source-unlabeled-target title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: No-label VLP (partial)</p> <details class=note> <summary>Notes</summary> <p>Variable-length path: source has label, target has no label.</p> <p>SOURCE FILTER: a:Person adds WHERE node_type = 'Person' to base case TARGET: No filter applied - matches any node type</p> <p>SQL PATTERN: WITH RECURSIVE paths AS ( -- Base case: source filter applied SELECT ... FROM edges JOIN (SELECT ... FROM Person) AS src ON ... WHERE ...</p> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span class=linenos data-linenos="1 "></span>UNION ALL
<span class=linenos data-linenos="2 "></span>...
</code></pre></div> <p>) SELECT ... FROM paths JOIN nodes AS b ON ... -- No type filter for target</p> <p>USE CASE: "Find everything a Person can reach via KNOWS relationships"</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-153-1><a id=__codelineno-153-1 name=__codelineno-153-1></a><a href=#__codelineno-153-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=n>path</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=p>*</span><span class=m>1</span><span class=p>..</span><span class=m>2</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span><span id=__span-153-2><a id=__codelineno-153-2 name=__codelineno-153-2></a><a href=#__codelineno-153-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>length</span><span class=p>(</span><span class=n>path</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>hops</span>
</span><span id=__span-153-3><a id=__codelineno-153-3 name=__codelineno-153-3></a><a href=#__codelineno-153-3><span class=linenos data-linenos="3 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=m>50</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-154-1><a id=__codelineno-154-1 name=__codelineno-154-1></a><a href=#__codelineno-154-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span>
</span><span id=__span-154-2><a id=__codelineno-154-2 name=__codelineno-154-2></a><a href=#__codelineno-154-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>  </span><span class=n>paths_1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-154-3><a id=__codelineno-154-3 name=__codelineno-154-3></a><a href=#__codelineno-154-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>    </span><span class=c1>-- Base case: direct edges (depth = 1)</span>
</span><span id=__span-154-4><a id=__codelineno-154-4 name=__codelineno-154-4></a><a href=#__codelineno-154-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-154-5><a id=__codelineno-154-5 name=__codelineno-154-5></a><a href=#__codelineno-154-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-154-6><a id=__codelineno-154-6 name=__codelineno-154-6></a><a href=#__codelineno-154-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-154-7><a id=__codelineno-154-7 name=__codelineno-154-7></a><a href=#__codelineno-154-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>      </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-154-8><a id=__codelineno-154-8 name=__codelineno-154-8></a><a href=#__codelineno-154-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-154-9><a id=__codelineno-154-9 name=__codelineno-154-9></a><a href=#__codelineno-154-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>NAMED_STRUCT</span><span class=p>(</span><span class=s1>&#39;person_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;friend_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;since&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>since</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;strength&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>strength</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path_edges</span><span class=p>,</span>
</span><span id=__span-154-10><a id=__codelineno-154-10 name=__codelineno-154-10></a><a href=#__codelineno-154-10><span class=linenos data-linenos="10 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-154-11><a id=__codelineno-154-11 name=__codelineno-154-11></a><a href=#__codelineno-154-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-154-12><a id=__codelineno-154-12 name=__codelineno-154-12></a><a href=#__codelineno-154-12><span class=linenos data-linenos="12 "></span></a>
</span><span id=__span-154-13><a id=__codelineno-154-13 name=__codelineno-154-13></a><a href=#__codelineno-154-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-154-14><a id=__codelineno-154-14 name=__codelineno-154-14></a><a href=#__codelineno-154-14><span class=linenos data-linenos="14 "></span></a>
</span><span id=__span-154-15><a id=__codelineno-154-15 name=__codelineno-154-15></a><a href=#__codelineno-154-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=c1>-- Recursive case: extend paths</span>
</span><span id=__span-154-16><a id=__codelineno-154-16 name=__codelineno-154-16></a><a href=#__codelineno-154-16><span class=linenos data-linenos="16 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-154-17><a id=__codelineno-154-17 name=__codelineno-154-17></a><a href=#__codelineno-154-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-154-18><a id=__codelineno-154-18 name=__codelineno-154-18></a><a href=#__codelineno-154-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-154-19><a id=__codelineno-154-19 name=__codelineno-154-19></a><a href=#__codelineno-154-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-154-20><a id=__codelineno-154-20 name=__codelineno-154-20></a><a href=#__codelineno-154-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-154-21><a id=__codelineno-154-21 name=__codelineno-154-21></a><a href=#__codelineno-154-21><span class=linenos data-linenos="21 "></span></a><span class=w>      </span><span class=n>ARRAY_APPEND</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path_edges</span><span class=p>,</span><span class=w> </span><span class=n>NAMED_STRUCT</span><span class=p>(</span><span class=s1>&#39;person_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;friend_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;since&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>since</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;strength&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>strength</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path_edges</span><span class=p>,</span>
</span><span id=__span-154-22><a id=__codelineno-154-22 name=__codelineno-154-22></a><a href=#__codelineno-154-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-154-23><a id=__codelineno-154-23 name=__codelineno-154-23></a><a href=#__codelineno-154-23><span class=linenos data-linenos="23 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-154-24><a id=__codelineno-154-24 name=__codelineno-154-24></a><a href=#__codelineno-154-24><span class=linenos data-linenos="24 "></span></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-154-25><a id=__codelineno-154-25 name=__codelineno-154-25></a><a href=#__codelineno-154-25><span class=linenos data-linenos="25 "></span></a><span class=w>      </span><span class=k>ON</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span>
</span><span id=__span-154-26><a id=__codelineno-154-26 name=__codelineno-154-26></a><a href=#__codelineno-154-26><span class=linenos data-linenos="26 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>2</span>
</span><span id=__span-154-27><a id=__codelineno-154-27 name=__codelineno-154-27></a><a href=#__codelineno-154-27><span class=linenos data-linenos="27 "></span></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=n>ARRAY_CONTAINS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span>
</span><span id=__span-154-28><a id=__codelineno-154-28 name=__codelineno-154-28></a><a href=#__codelineno-154-28><span class=linenos data-linenos="28 "></span></a><span class=w>  </span><span class=p>)</span>
</span><span id=__span-154-29><a id=__codelineno-154-29 name=__codelineno-154-29></a><a href=#__codelineno-154-29><span class=linenos data-linenos="29 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-154-30><a id=__codelineno-154-30 name=__codelineno-154-30></a><a href=#__codelineno-154-30><span class=linenos data-linenos="30 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_a_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-154-31><a id=__codelineno-154-31 name=__codelineno-154-31></a><a href=#__codelineno-154-31><span class=linenos data-linenos="31 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_b_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>id</span>
</span><span id=__span-154-32><a id=__codelineno-154-32 name=__codelineno-154-32></a><a href=#__codelineno-154-32><span class=linenos data-linenos="32 "></span></a><span class=w>  </span><span class=p>,(</span><span class=k>SIZE</span><span class=p>(</span><span class=n>_gsql2rsql_path_id</span><span class=p>)</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>hops</span>
</span><span id=__span-154-33><a id=__codelineno-154-33 name=__codelineno-154-33></a><a href=#__codelineno-154-33><span class=linenos data-linenos="33 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-154-34><a id=__codelineno-154-34 name=__codelineno-154-34></a><a href=#__codelineno-154-34><span class=linenos data-linenos="34 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-154-35><a id=__codelineno-154-35 name=__codelineno-154-35></a><a href=#__codelineno-154-35><span class=linenos data-linenos="35 "></span></a><span class=w>     </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_id</span>
</span><span id=__span-154-36><a id=__codelineno-154-36 name=__codelineno-154-36></a><a href=#__codelineno-154-36><span class=linenos data-linenos="36 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_name</span>
</span><span id=__span-154-37><a id=__codelineno-154-37 name=__codelineno-154-37></a><a href=#__codelineno-154-37><span class=linenos data-linenos="37 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_age</span>
</span><span id=__span-154-38><a id=__codelineno-154-38 name=__codelineno-154-38></a><a href=#__codelineno-154-38><span class=linenos data-linenos="38 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_nickname</span>
</span><span id=__span-154-39><a id=__codelineno-154-39 name=__codelineno-154-39></a><a href=#__codelineno-154-39><span class=linenos data-linenos="39 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_salary</span>
</span><span id=__span-154-40><a id=__codelineno-154-40 name=__codelineno-154-40></a><a href=#__codelineno-154-40><span class=linenos data-linenos="40 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_active</span>
</span><span id=__span-154-41><a id=__codelineno-154-41 name=__codelineno-154-41></a><a href=#__codelineno-154-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>population</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_population</span>
</span><span id=__span-154-42><a id=__codelineno-154-42 name=__codelineno-154-42></a><a href=#__codelineno-154-42><span class=linenos data-linenos="42 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>country</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_country</span>
</span><span id=__span-154-43><a id=__codelineno-154-43 name=__codelineno-154-43></a><a href=#__codelineno-154-43><span class=linenos data-linenos="43 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>title</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_title</span>
</span><span id=__span-154-44><a id=__codelineno-154-44 name=__codelineno-154-44></a><a href=#__codelineno-154-44><span class=linenos data-linenos="44 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_year</span>
</span><span id=__span-154-45><a id=__codelineno-154-45 name=__codelineno-154-45></a><a href=#__codelineno-154-45><span class=linenos data-linenos="45 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>genre</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_genre</span>
</span><span id=__span-154-46><a id=__codelineno-154-46 name=__codelineno-154-46></a><a href=#__codelineno-154-46><span class=linenos data-linenos="46 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>rating</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_rating</span>
</span><span id=__span-154-47><a id=__codelineno-154-47 name=__codelineno-154-47></a><a href=#__codelineno-154-47><span class=linenos data-linenos="47 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>industry</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_industry</span>
</span><span id=__span-154-48><a id=__codelineno-154-48 name=__codelineno-154-48></a><a href=#__codelineno-154-48><span class=linenos data-linenos="48 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-154-49><a id=__codelineno-154-49 name=__codelineno-154-49></a><a href=#__codelineno-154-49><span class=linenos data-linenos="49 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-154-50><a id=__codelineno-154-50 name=__codelineno-154-50></a><a href=#__codelineno-154-50><span class=linenos data-linenos="50 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_age</span>
</span><span id=__span-154-51><a id=__codelineno-154-51 name=__codelineno-154-51></a><a href=#__codelineno-154-51><span class=linenos data-linenos="51 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_nickname</span>
</span><span id=__span-154-52><a id=__codelineno-154-52 name=__codelineno-154-52></a><a href=#__codelineno-154-52><span class=linenos data-linenos="52 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_salary</span>
</span><span id=__span-154-53><a id=__codelineno-154-53 name=__codelineno-154-53></a><a href=#__codelineno-154-53><span class=linenos data-linenos="53 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_active</span>
</span><span id=__span-154-54><a id=__codelineno-154-54 name=__codelineno-154-54></a><a href=#__codelineno-154-54><span class=linenos data-linenos="54 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-154-55><a id=__codelineno-154-55 name=__codelineno-154-55></a><a href=#__codelineno-154-55><span class=linenos data-linenos="55 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-154-56><a id=__codelineno-154-56 name=__codelineno-154-56></a><a href=#__codelineno-154-56><span class=linenos data-linenos="56 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>depth</span>
</span><span id=__span-154-57><a id=__codelineno-154-57 name=__codelineno-154-57></a><a href=#__codelineno-154-57><span class=linenos data-linenos="57 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_path_id</span>
</span><span id=__span-154-58><a id=__codelineno-154-58 name=__codelineno-154-58></a><a href=#__codelineno-154-58><span class=linenos data-linenos="58 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>path_edges</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_path_edges</span>
</span><span id=__span-154-59><a id=__codelineno-154-59 name=__codelineno-154-59></a><a href=#__codelineno-154-59><span class=linenos data-linenos="59 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-154-60><a id=__codelineno-154-60 name=__codelineno-154-60></a><a href=#__codelineno-154-60><span class=linenos data-linenos="60 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>AllNodes</span><span class=w> </span><span class=n>sink</span>
</span><span id=__span-154-61><a id=__codelineno-154-61 name=__codelineno-154-61></a><a href=#__codelineno-154-61><span class=linenos data-linenos="61 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-154-62><a id=__codelineno-154-62 name=__codelineno-154-62></a><a href=#__codelineno-154-62><span class=linenos data-linenos="62 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=k>source</span>
</span><span id=__span-154-63><a id=__codelineno-154-63 name=__codelineno-154-63></a><a href=#__codelineno-154-63><span class=linenos data-linenos="63 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-154-64><a id=__codelineno-154-64 name=__codelineno-154-64></a><a href=#__codelineno-154-64><span class=linenos data-linenos="64 "></span></a><span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>2</span>
</span><span id=__span-154-65><a id=__codelineno-154-65 name=__codelineno-154-65></a><a href=#__codelineno-154-65><span class=linenos data-linenos="65 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-154-66><a id=__codelineno-154-66 name=__codelineno-154-66></a><a href=#__codelineno-154-66><span class=linenos data-linenos="66 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=mi>50</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-155-1><a id=__codelineno-155-1 name=__codelineno-155-1></a><a href=#__codelineno-155-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-155-2><a id=__codelineno-155-2 name=__codelineno-155-2></a><a href=#__codelineno-155-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-155-3><a id=__codelineno-155-3 name=__codelineno-155-3></a><a href=#__codelineno-155-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=2;
</span><span id=__span-155-4><a id=__codelineno-155-4 name=__codelineno-155-4></a><a href=#__codelineno-155-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-155-5><a id=__codelineno-155-5 name=__codelineno-155-5></a><a href=#__codelineno-155-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: a:Person
</span><span id=__span-155-6><a id=__codelineno-155-6 name=__codelineno-155-6></a><a href=#__codelineno-155-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-155-7><a id=__codelineno-155-7 name=__codelineno-155-7></a><a href=#__codelineno-155-7><span class=linenos data-linenos=" 7 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-155-8><a id=__codelineno-155-8 name=__codelineno-155-8></a><a href=#__codelineno-155-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-155-9><a id=__codelineno-155-9 name=__codelineno-155-9></a><a href=#__codelineno-155-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: b:
</span><span id=__span-155-10><a id=__codelineno-155-10 name=__codelineno-155-10></a><a href=#__codelineno-155-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-155-11><a id=__codelineno-155-11 name=__codelineno-155-11></a><a href=#__codelineno-155-11><span class=linenos data-linenos="11 "></span></a>----------------------------------------------------------------------
</span><span id=__span-155-12><a id=__codelineno-155-12 name=__codelineno-155-12></a><a href=#__codelineno-155-12><span class=linenos data-linenos="12 "></span></a>Level 1:
</span><span id=__span-155-13><a id=__codelineno-155-13 name=__codelineno-155-13></a><a href=#__codelineno-155-13><span class=linenos data-linenos="13 "></span></a>----------------------------------------------------------------------
</span><span id=__span-155-14><a id=__codelineno-155-14 name=__codelineno-155-14></a><a href=#__codelineno-155-14><span class=linenos data-linenos="14 "></span></a>OpId=2 Op=RecursiveTraversalOperator; InOpIds=1; OutOpIds=4;
</span><span id=__span-155-15><a id=__codelineno-155-15 name=__codelineno-155-15></a><a href=#__codelineno-155-15><span class=linenos data-linenos="15 "></span></a>  RecursiveTraversal(KNOWS*1..2, path=path)
</span><span id=__span-155-16><a id=__codelineno-155-16 name=__codelineno-155-16></a><a href=#__codelineno-155-16><span class=linenos data-linenos="16 "></span></a>*
</span><span id=__span-155-17><a id=__codelineno-155-17 name=__codelineno-155-17></a><a href=#__codelineno-155-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-155-18><a id=__codelineno-155-18 name=__codelineno-155-18></a><a href=#__codelineno-155-18><span class=linenos data-linenos="18 "></span></a>Level 2:
</span><span id=__span-155-19><a id=__codelineno-155-19 name=__codelineno-155-19></a><a href=#__codelineno-155-19><span class=linenos data-linenos="19 "></span></a>----------------------------------------------------------------------
</span><span id=__span-155-20><a id=__codelineno-155-20 name=__codelineno-155-20></a><a href=#__codelineno-155-20><span class=linenos data-linenos="20 "></span></a>OpId=4 Op=JoinOperator; InOpIds=2,3; OutOpIds=5;
</span><span id=__span-155-21><a id=__codelineno-155-21 name=__codelineno-155-21></a><a href=#__codelineno-155-21><span class=linenos data-linenos="21 "></span></a>  JoinOperator(id=4)
</span><span id=__span-155-22><a id=__codelineno-155-22 name=__codelineno-155-22></a><a href=#__codelineno-155-22><span class=linenos data-linenos="22 "></span></a>    JoinType: INNER
</span><span id=__span-155-23><a id=__codelineno-155-23 name=__codelineno-155-23></a><a href=#__codelineno-155-23><span class=linenos data-linenos="23 "></span></a>    Joins: JoinPair: Node=b RelOrNode=paths__anon1 Type=SINK
</span><span id=__span-155-24><a id=__codelineno-155-24 name=__codelineno-155-24></a><a href=#__codelineno-155-24><span class=linenos data-linenos="24 "></span></a>*
</span><span id=__span-155-25><a id=__codelineno-155-25 name=__codelineno-155-25></a><a href=#__codelineno-155-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-155-26><a id=__codelineno-155-26 name=__codelineno-155-26></a><a href=#__codelineno-155-26><span class=linenos data-linenos="26 "></span></a>Level 3:
</span><span id=__span-155-27><a id=__codelineno-155-27 name=__codelineno-155-27></a><a href=#__codelineno-155-27><span class=linenos data-linenos="27 "></span></a>----------------------------------------------------------------------
</span><span id=__span-155-28><a id=__codelineno-155-28 name=__codelineno-155-28></a><a href=#__codelineno-155-28><span class=linenos data-linenos="28 "></span></a>OpId=5 Op=ProjectionOperator; InOpIds=4; OutOpIds=;
</span><span id=__span-155-29><a id=__codelineno-155-29 name=__codelineno-155-29></a><a href=#__codelineno-155-29><span class=linenos data-linenos="29 "></span></a>  ProjectionOperator(id=5)
</span><span id=__span-155-30><a id=__codelineno-155-30 name=__codelineno-155-30></a><a href=#__codelineno-155-30><span class=linenos data-linenos="30 "></span></a>    Projections: name=a.name, id=b.id, hops=LENGTH(path)
</span><span id=__span-155-31><a id=__codelineno-155-31 name=__codelineno-155-31></a><a href=#__codelineno-155-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-155-32><a id=__codelineno-155-32 name=__codelineno-155-32></a><a href=#__codelineno-155-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=53-no-label-vlp-with-unlabeled-source-labeled-target>53. NO LABEL: VLP with unlabeled source, labeled target<a class=headerlink href=#53-no-label-vlp-with-unlabeled-source-labeled-target title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: No-label VLP (reverse partial)</p> <details class=note> <summary>Notes</summary> <p>Variable-length path: source has no label, target has label.</p> <p>SOURCE: No filter - starts from any node type TARGET FILTER: b:Person applied in final join</p> <p>SQL PATTERN: WITH RECURSIVE paths AS ( -- Base case: no source filter (all nodes) UNION ALL ... ) SELECT ... FROM paths JOIN (SELECT ... FROM Person) AS b ON ... -- Target filter</p> <p>USE CASE: "Find all paths ending at a Person, regardless of start"</p> <p>NOTE: VLP type filter rendering for labeled nodes may be a pre-existing gap in some cases - but binding and SQL generation work correctly.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-156-1><a id=__codelineno-156-1 name=__codelineno-156-1></a><a href=#__codelineno-156-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=n>path</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=p>*</span><span class=m>1</span><span class=p>..</span><span class=m>2</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>b</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-156-2><a id=__codelineno-156-2 name=__codelineno-156-2></a><a href=#__codelineno-156-2><span class=linenos data-linenos="2 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>length</span><span class=p>(</span><span class=n>path</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>hops</span>
</span><span id=__span-156-3><a id=__codelineno-156-3 name=__codelineno-156-3></a><a href=#__codelineno-156-3><span class=linenos data-linenos="3 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=m>50</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-157-1><a id=__codelineno-157-1 name=__codelineno-157-1></a><a href=#__codelineno-157-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span>
</span><span id=__span-157-2><a id=__codelineno-157-2 name=__codelineno-157-2></a><a href=#__codelineno-157-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>  </span><span class=n>paths_1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-157-3><a id=__codelineno-157-3 name=__codelineno-157-3></a><a href=#__codelineno-157-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>    </span><span class=c1>-- Base case: direct edges (depth = 1)</span>
</span><span id=__span-157-4><a id=__codelineno-157-4 name=__codelineno-157-4></a><a href=#__codelineno-157-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-157-5><a id=__codelineno-157-5 name=__codelineno-157-5></a><a href=#__codelineno-157-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-157-6><a id=__codelineno-157-6 name=__codelineno-157-6></a><a href=#__codelineno-157-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-157-7><a id=__codelineno-157-7 name=__codelineno-157-7></a><a href=#__codelineno-157-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>      </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-157-8><a id=__codelineno-157-8 name=__codelineno-157-8></a><a href=#__codelineno-157-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-157-9><a id=__codelineno-157-9 name=__codelineno-157-9></a><a href=#__codelineno-157-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>NAMED_STRUCT</span><span class=p>(</span><span class=s1>&#39;person_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;friend_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;since&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>since</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;strength&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>strength</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path_edges</span><span class=p>,</span>
</span><span id=__span-157-10><a id=__codelineno-157-10 name=__codelineno-157-10></a><a href=#__codelineno-157-10><span class=linenos data-linenos="10 "></span></a><span class=w>      </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-157-11><a id=__codelineno-157-11 name=__codelineno-157-11></a><a href=#__codelineno-157-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-157-12><a id=__codelineno-157-12 name=__codelineno-157-12></a><a href=#__codelineno-157-12><span class=linenos data-linenos="12 "></span></a>
</span><span id=__span-157-13><a id=__codelineno-157-13 name=__codelineno-157-13></a><a href=#__codelineno-157-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-157-14><a id=__codelineno-157-14 name=__codelineno-157-14></a><a href=#__codelineno-157-14><span class=linenos data-linenos="14 "></span></a>
</span><span id=__span-157-15><a id=__codelineno-157-15 name=__codelineno-157-15></a><a href=#__codelineno-157-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=c1>-- Recursive case: extend paths</span>
</span><span id=__span-157-16><a id=__codelineno-157-16 name=__codelineno-157-16></a><a href=#__codelineno-157-16><span class=linenos data-linenos="16 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-157-17><a id=__codelineno-157-17 name=__codelineno-157-17></a><a href=#__codelineno-157-17><span class=linenos data-linenos="17 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span><span class=p>,</span>
</span><span id=__span-157-18><a id=__codelineno-157-18 name=__codelineno-157-18></a><a href=#__codelineno-157-18><span class=linenos data-linenos="18 "></span></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>end_node</span><span class=p>,</span>
</span><span id=__span-157-19><a id=__codelineno-157-19 name=__codelineno-157-19></a><a href=#__codelineno-157-19><span class=linenos data-linenos="19 "></span></a><span class=w>      </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>depth</span><span class=p>,</span>
</span><span id=__span-157-20><a id=__codelineno-157-20 name=__codelineno-157-20></a><a href=#__codelineno-157-20><span class=linenos data-linenos="20 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-157-21><a id=__codelineno-157-21 name=__codelineno-157-21></a><a href=#__codelineno-157-21><span class=linenos data-linenos="21 "></span></a><span class=w>      </span><span class=n>ARRAY_APPEND</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>path_edges</span><span class=p>,</span><span class=w> </span><span class=n>NAMED_STRUCT</span><span class=p>(</span><span class=s1>&#39;person_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;friend_id&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;since&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>since</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;strength&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>strength</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path_edges</span><span class=p>,</span>
</span><span id=__span-157-22><a id=__codelineno-157-22 name=__codelineno-157-22></a><a href=#__codelineno-157-22><span class=linenos data-linenos="22 "></span></a><span class=w>      </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visited</span>
</span><span id=__span-157-23><a id=__codelineno-157-23 name=__codelineno-157-23></a><a href=#__codelineno-157-23><span class=linenos data-linenos="23 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-157-24><a id=__codelineno-157-24 name=__codelineno-157-24></a><a href=#__codelineno-157-24><span class=linenos data-linenos="24 "></span></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-157-25><a id=__codelineno-157-25 name=__codelineno-157-25></a><a href=#__codelineno-157-25><span class=linenos data-linenos="25 "></span></a><span class=w>      </span><span class=k>ON</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>person_id</span>
</span><span id=__span-157-26><a id=__codelineno-157-26 name=__codelineno-157-26></a><a href=#__codelineno-157-26><span class=linenos data-linenos="26 "></span></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>2</span>
</span><span id=__span-157-27><a id=__codelineno-157-27 name=__codelineno-157-27></a><a href=#__codelineno-157-27><span class=linenos data-linenos="27 "></span></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=n>ARRAY_CONTAINS</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>visited</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>friend_id</span><span class=p>)</span>
</span><span id=__span-157-28><a id=__codelineno-157-28 name=__codelineno-157-28></a><a href=#__codelineno-157-28><span class=linenos data-linenos="28 "></span></a><span class=w>  </span><span class=p>)</span>
</span><span id=__span-157-29><a id=__codelineno-157-29 name=__codelineno-157-29></a><a href=#__codelineno-157-29><span class=linenos data-linenos="29 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-157-30><a id=__codelineno-157-30 name=__codelineno-157-30></a><a href=#__codelineno-157-30><span class=linenos data-linenos="30 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_a_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>id</span>
</span><span id=__span-157-31><a id=__codelineno-157-31 name=__codelineno-157-31></a><a href=#__codelineno-157-31><span class=linenos data-linenos="31 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_b_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-157-32><a id=__codelineno-157-32 name=__codelineno-157-32></a><a href=#__codelineno-157-32><span class=linenos data-linenos="32 "></span></a><span class=w>  </span><span class=p>,(</span><span class=k>SIZE</span><span class=p>(</span><span class=n>_gsql2rsql_path_id</span><span class=p>)</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>hops</span>
</span><span id=__span-157-33><a id=__codelineno-157-33 name=__codelineno-157-33></a><a href=#__codelineno-157-33><span class=linenos data-linenos="33 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-157-34><a id=__codelineno-157-34 name=__codelineno-157-34></a><a href=#__codelineno-157-34><span class=linenos data-linenos="34 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-157-35><a id=__codelineno-157-35 name=__codelineno-157-35></a><a href=#__codelineno-157-35><span class=linenos data-linenos="35 "></span></a><span class=w>     </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_id</span>
</span><span id=__span-157-36><a id=__codelineno-157-36 name=__codelineno-157-36></a><a href=#__codelineno-157-36><span class=linenos data-linenos="36 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_name</span>
</span><span id=__span-157-37><a id=__codelineno-157-37 name=__codelineno-157-37></a><a href=#__codelineno-157-37><span class=linenos data-linenos="37 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_age</span>
</span><span id=__span-157-38><a id=__codelineno-157-38 name=__codelineno-157-38></a><a href=#__codelineno-157-38><span class=linenos data-linenos="38 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_nickname</span>
</span><span id=__span-157-39><a id=__codelineno-157-39 name=__codelineno-157-39></a><a href=#__codelineno-157-39><span class=linenos data-linenos="39 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_salary</span>
</span><span id=__span-157-40><a id=__codelineno-157-40 name=__codelineno-157-40></a><a href=#__codelineno-157-40><span class=linenos data-linenos="40 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>sink</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_b_active</span>
</span><span id=__span-157-41><a id=__codelineno-157-41 name=__codelineno-157-41></a><a href=#__codelineno-157-41><span class=linenos data-linenos="41 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-157-42><a id=__codelineno-157-42 name=__codelineno-157-42></a><a href=#__codelineno-157-42><span class=linenos data-linenos="42 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-157-43><a id=__codelineno-157-43 name=__codelineno-157-43></a><a href=#__codelineno-157-43><span class=linenos data-linenos="43 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_age</span>
</span><span id=__span-157-44><a id=__codelineno-157-44 name=__codelineno-157-44></a><a href=#__codelineno-157-44><span class=linenos data-linenos="44 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>nickname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_nickname</span>
</span><span id=__span-157-45><a id=__codelineno-157-45 name=__codelineno-157-45></a><a href=#__codelineno-157-45><span class=linenos data-linenos="45 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_salary</span>
</span><span id=__span-157-46><a id=__codelineno-157-46 name=__codelineno-157-46></a><a href=#__codelineno-157-46><span class=linenos data-linenos="46 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_active</span>
</span><span id=__span-157-47><a id=__codelineno-157-47 name=__codelineno-157-47></a><a href=#__codelineno-157-47><span class=linenos data-linenos="47 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>population</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_population</span>
</span><span id=__span-157-48><a id=__codelineno-157-48 name=__codelineno-157-48></a><a href=#__codelineno-157-48><span class=linenos data-linenos="48 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>country</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_country</span>
</span><span id=__span-157-49><a id=__codelineno-157-49 name=__codelineno-157-49></a><a href=#__codelineno-157-49><span class=linenos data-linenos="49 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>title</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_title</span>
</span><span id=__span-157-50><a id=__codelineno-157-50 name=__codelineno-157-50></a><a href=#__codelineno-157-50><span class=linenos data-linenos="50 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_year</span>
</span><span id=__span-157-51><a id=__codelineno-157-51 name=__codelineno-157-51></a><a href=#__codelineno-157-51><span class=linenos data-linenos="51 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>genre</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_genre</span>
</span><span id=__span-157-52><a id=__codelineno-157-52 name=__codelineno-157-52></a><a href=#__codelineno-157-52><span class=linenos data-linenos="52 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>rating</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_rating</span>
</span><span id=__span-157-53><a id=__codelineno-157-53 name=__codelineno-157-53></a><a href=#__codelineno-157-53><span class=linenos data-linenos="53 "></span></a><span class=w>    </span><span class=p>,</span><span class=k>source</span><span class=p>.</span><span class=n>industry</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_industry</span>
</span><span id=__span-157-54><a id=__codelineno-157-54 name=__codelineno-157-54></a><a href=#__codelineno-157-54><span class=linenos data-linenos="54 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-157-55><a id=__codelineno-157-55 name=__codelineno-157-55></a><a href=#__codelineno-157-55><span class=linenos data-linenos="55 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-157-56><a id=__codelineno-157-56 name=__codelineno-157-56></a><a href=#__codelineno-157-56><span class=linenos data-linenos="56 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>depth</span>
</span><span id=__span-157-57><a id=__codelineno-157-57 name=__codelineno-157-57></a><a href=#__codelineno-157-57><span class=linenos data-linenos="57 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>path</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_path_id</span>
</span><span id=__span-157-58><a id=__codelineno-157-58 name=__codelineno-157-58></a><a href=#__codelineno-157-58><span class=linenos data-linenos="58 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>p</span><span class=p>.</span><span class=n>path_edges</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_path_edges</span>
</span><span id=__span-157-59><a id=__codelineno-157-59 name=__codelineno-157-59></a><a href=#__codelineno-157-59><span class=linenos data-linenos="59 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=n>paths_1</span><span class=w> </span><span class=n>p</span>
</span><span id=__span-157-60><a id=__codelineno-157-60 name=__codelineno-157-60></a><a href=#__codelineno-157-60><span class=linenos data-linenos="60 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span><span class=w> </span><span class=n>sink</span>
</span><span id=__span-157-61><a id=__codelineno-157-61 name=__codelineno-157-61></a><a href=#__codelineno-157-61><span class=linenos data-linenos="61 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=n>sink</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>end_node</span>
</span><span id=__span-157-62><a id=__codelineno-157-62 name=__codelineno-157-62></a><a href=#__codelineno-157-62><span class=linenos data-linenos="62 "></span></a><span class=w>  </span><span class=k>JOIN</span><span class=w> </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>AllNodes</span><span class=w> </span><span class=k>source</span>
</span><span id=__span-157-63><a id=__codelineno-157-63 name=__codelineno-157-63></a><a href=#__codelineno-157-63><span class=linenos data-linenos="63 "></span></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>start_node</span>
</span><span id=__span-157-64><a id=__codelineno-157-64 name=__codelineno-157-64></a><a href=#__codelineno-157-64><span class=linenos data-linenos="64 "></span></a><span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>depth</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>2</span>
</span><span id=__span-157-65><a id=__codelineno-157-65 name=__codelineno-157-65></a><a href=#__codelineno-157-65><span class=linenos data-linenos="65 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-157-66><a id=__codelineno-157-66 name=__codelineno-157-66></a><a href=#__codelineno-157-66><span class=linenos data-linenos="66 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=mi>50</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-158-1><a id=__codelineno-158-1 name=__codelineno-158-1></a><a href=#__codelineno-158-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-158-2><a id=__codelineno-158-2 name=__codelineno-158-2></a><a href=#__codelineno-158-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-158-3><a id=__codelineno-158-3 name=__codelineno-158-3></a><a href=#__codelineno-158-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=2;
</span><span id=__span-158-4><a id=__codelineno-158-4 name=__codelineno-158-4></a><a href=#__codelineno-158-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-158-5><a id=__codelineno-158-5 name=__codelineno-158-5></a><a href=#__codelineno-158-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: a:
</span><span id=__span-158-6><a id=__codelineno-158-6 name=__codelineno-158-6></a><a href=#__codelineno-158-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-158-7><a id=__codelineno-158-7 name=__codelineno-158-7></a><a href=#__codelineno-158-7><span class=linenos data-linenos=" 7 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-158-8><a id=__codelineno-158-8 name=__codelineno-158-8></a><a href=#__codelineno-158-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-158-9><a id=__codelineno-158-9 name=__codelineno-158-9></a><a href=#__codelineno-158-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: b:Person
</span><span id=__span-158-10><a id=__codelineno-158-10 name=__codelineno-158-10></a><a href=#__codelineno-158-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-158-11><a id=__codelineno-158-11 name=__codelineno-158-11></a><a href=#__codelineno-158-11><span class=linenos data-linenos="11 "></span></a>----------------------------------------------------------------------
</span><span id=__span-158-12><a id=__codelineno-158-12 name=__codelineno-158-12></a><a href=#__codelineno-158-12><span class=linenos data-linenos="12 "></span></a>Level 1:
</span><span id=__span-158-13><a id=__codelineno-158-13 name=__codelineno-158-13></a><a href=#__codelineno-158-13><span class=linenos data-linenos="13 "></span></a>----------------------------------------------------------------------
</span><span id=__span-158-14><a id=__codelineno-158-14 name=__codelineno-158-14></a><a href=#__codelineno-158-14><span class=linenos data-linenos="14 "></span></a>OpId=2 Op=RecursiveTraversalOperator; InOpIds=1; OutOpIds=4;
</span><span id=__span-158-15><a id=__codelineno-158-15 name=__codelineno-158-15></a><a href=#__codelineno-158-15><span class=linenos data-linenos="15 "></span></a>  RecursiveTraversal(KNOWS*1..2, path=path)
</span><span id=__span-158-16><a id=__codelineno-158-16 name=__codelineno-158-16></a><a href=#__codelineno-158-16><span class=linenos data-linenos="16 "></span></a>*
</span><span id=__span-158-17><a id=__codelineno-158-17 name=__codelineno-158-17></a><a href=#__codelineno-158-17><span class=linenos data-linenos="17 "></span></a>----------------------------------------------------------------------
</span><span id=__span-158-18><a id=__codelineno-158-18 name=__codelineno-158-18></a><a href=#__codelineno-158-18><span class=linenos data-linenos="18 "></span></a>Level 2:
</span><span id=__span-158-19><a id=__codelineno-158-19 name=__codelineno-158-19></a><a href=#__codelineno-158-19><span class=linenos data-linenos="19 "></span></a>----------------------------------------------------------------------
</span><span id=__span-158-20><a id=__codelineno-158-20 name=__codelineno-158-20></a><a href=#__codelineno-158-20><span class=linenos data-linenos="20 "></span></a>OpId=4 Op=JoinOperator; InOpIds=2,3; OutOpIds=5;
</span><span id=__span-158-21><a id=__codelineno-158-21 name=__codelineno-158-21></a><a href=#__codelineno-158-21><span class=linenos data-linenos="21 "></span></a>  JoinOperator(id=4)
</span><span id=__span-158-22><a id=__codelineno-158-22 name=__codelineno-158-22></a><a href=#__codelineno-158-22><span class=linenos data-linenos="22 "></span></a>    JoinType: INNER
</span><span id=__span-158-23><a id=__codelineno-158-23 name=__codelineno-158-23></a><a href=#__codelineno-158-23><span class=linenos data-linenos="23 "></span></a>    Joins: JoinPair: Node=b RelOrNode=paths__anon1 Type=SINK
</span><span id=__span-158-24><a id=__codelineno-158-24 name=__codelineno-158-24></a><a href=#__codelineno-158-24><span class=linenos data-linenos="24 "></span></a>*
</span><span id=__span-158-25><a id=__codelineno-158-25 name=__codelineno-158-25></a><a href=#__codelineno-158-25><span class=linenos data-linenos="25 "></span></a>----------------------------------------------------------------------
</span><span id=__span-158-26><a id=__codelineno-158-26 name=__codelineno-158-26></a><a href=#__codelineno-158-26><span class=linenos data-linenos="26 "></span></a>Level 3:
</span><span id=__span-158-27><a id=__codelineno-158-27 name=__codelineno-158-27></a><a href=#__codelineno-158-27><span class=linenos data-linenos="27 "></span></a>----------------------------------------------------------------------
</span><span id=__span-158-28><a id=__codelineno-158-28 name=__codelineno-158-28></a><a href=#__codelineno-158-28><span class=linenos data-linenos="28 "></span></a>OpId=5 Op=ProjectionOperator; InOpIds=4; OutOpIds=;
</span><span id=__span-158-29><a id=__codelineno-158-29 name=__codelineno-158-29></a><a href=#__codelineno-158-29><span class=linenos data-linenos="29 "></span></a>  ProjectionOperator(id=5)
</span><span id=__span-158-30><a id=__codelineno-158-30 name=__codelineno-158-30></a><a href=#__codelineno-158-30><span class=linenos data-linenos="30 "></span></a>    Projections: id=a.id, name=b.name, hops=LENGTH(path)
</span><span id=__span-158-31><a id=__codelineno-158-31 name=__codelineno-158-31></a><a href=#__codelineno-158-31><span class=linenos data-linenos="31 "></span></a>*
</span><span id=__span-158-32><a id=__codelineno-158-32 name=__codelineno-158-32></a><a href=#__codelineno-158-32><span class=linenos data-linenos="32 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <h2 id=54-no-label-node-reused-after-with-type-already-bound>54. NO LABEL: Node reused after WITH (type already bound)<a class=headerlink href=#54-no-label-node-reused-after-with-type-already-bound title="Link to this section">&para;</a></h2> <p><strong>Application</strong>: Features: No-label after WITH</p> <details class=note> <summary>Notes</summary> <p>Node 'a' has no label in second MATCH, but type was already bound in first MATCH.</p> <p>BEHAVIOR: - First MATCH: 'a' is bound to Person (label specified) - WITH: 'a' is passed through with its type - Second MATCH: 'a' reuses existing binding (no label needed)</p> <p>SQL PATTERN: WITH first_match AS ( SELECT a.*, COUNT(c.id) AS company_count FROM Person AS a JOIN ... Company AS c GROUP BY a.id ) SELECT ... FROM first_match JOIN edges ON ... JOIN Person AS friend ON ...</p> <p>USE CASE: Multi-stage queries where type is established early.</p> </details> <details class=note open=open> <summary>OpenCypher Query</summary> <div class="language-cypher highlight"><span class=filename>Cypher</span><pre><span></span><code><span id=__span-159-1><a id=__codelineno-159-1 name=__codelineno-159-1></a><a href=#__codelineno-159-1><span class=linenos data-linenos="1 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>WORKS_AT</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>c</span><span class=p>:</span><span class=n>Company</span><span class=p>)</span>
</span><span id=__span-159-2><a id=__codelineno-159-2 name=__codelineno-159-2></a><a href=#__codelineno-159-2><span class=linenos data-linenos="2 "></span></a><span class=k>WITH</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>COUNT</span><span class=p>(</span><span class=n>c</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>company_count</span>
</span><span id=__span-159-3><a id=__codelineno-159-3 name=__codelineno-159-3></a><a href=#__codelineno-159-3><span class=linenos data-linenos="3 "></span></a><span class=k>MATCH</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=p>)</span><span class=o>-[</span><span class=p>:</span><span class=n>KNOWS</span><span class=o>]-&gt;</span><span class=p>(</span><span class=n>friend</span><span class=p>:</span><span class=n>Person</span><span class=p>)</span>
</span><span id=__span-159-4><a id=__codelineno-159-4 name=__codelineno-159-4></a><a href=#__codelineno-159-4><span class=linenos data-linenos="4 "></span></a><span class=k>RETURN</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>company_count</span><span class=p>,</span><span class=w> </span><span class=n>friend</span><span class=p>.</span><span class=n>name</span>
</span><span id=__span-159-5><a id=__codelineno-159-5 name=__codelineno-159-5></a><a href=#__codelineno-159-5><span class=linenos data-linenos="5 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=m>20</span>
</span></code></pre></div> </details> <details class=example> <summary>Generated SQL</summary> <div class="language-sql highlight"><span class=filename>SQL</span><pre><span></span><code><span id=__span-160-1><a id=__codelineno-160-1 name=__codelineno-160-1></a><a href=#__codelineno-160-1><span class=linenos data-linenos="  1 "></span></a><span class=k>WITH</span>
</span><span id=__span-160-2><a id=__codelineno-160-2 name=__codelineno-160-2></a><a href=#__codelineno-160-2><span class=linenos data-linenos="  2 "></span></a><span class=n>agg_boundary_1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-160-3><a id=__codelineno-160-3 name=__codelineno-160-3></a><a href=#__codelineno-160-3><span class=linenos data-linenos="  3 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-160-4><a id=__codelineno-160-4 name=__codelineno-160-4></a><a href=#__codelineno-160-4><span class=linenos data-linenos="  4 "></span></a><span class=w>    </span><span class=n>_gsql2rsql_a_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=o>`</span><span class=n>a</span><span class=o>`</span><span class=p>,</span>
</span><span id=__span-160-5><a id=__codelineno-160-5 name=__codelineno-160-5></a><a href=#__codelineno-160-5><span class=linenos data-linenos="  5 "></span></a><span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=n>_gsql2rsql_c_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=o>`</span><span class=n>company_count</span><span class=o>`</span>
</span><span id=__span-160-6><a id=__codelineno-160-6 name=__codelineno-160-6></a><a href=#__codelineno-160-6><span class=linenos data-linenos="  6 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-160-7><a id=__codelineno-160-7 name=__codelineno-160-7></a><a href=#__codelineno-160-7><span class=linenos data-linenos="  7 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-160-8><a id=__codelineno-160-8 name=__codelineno-160-8></a><a href=#__codelineno-160-8><span class=linenos data-linenos="  8 "></span></a><span class=w>     </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_a_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-160-9><a id=__codelineno-160-9 name=__codelineno-160-9></a><a href=#__codelineno-160-9><span class=linenos data-linenos="  9 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql_a_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-160-10><a id=__codelineno-160-10 name=__codelineno-160-10></a><a href=#__codelineno-160-10><span class=linenos data-linenos=" 10 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-160-11><a id=__codelineno-160-11 name=__codelineno-160-11></a><a href=#__codelineno-160-11><span class=linenos data-linenos=" 11 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_company_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_company_id</span>
</span><span id=__span-160-12><a id=__codelineno-160-12 name=__codelineno-160-12></a><a href=#__codelineno-160-12><span class=linenos data-linenos=" 12 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-160-13><a id=__codelineno-160-13 name=__codelineno-160-13></a><a href=#__codelineno-160-13><span class=linenos data-linenos=" 13 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-160-14><a id=__codelineno-160-14 name=__codelineno-160-14></a><a href=#__codelineno-160-14><span class=linenos data-linenos=" 14 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-160-15><a id=__codelineno-160-15 name=__codelineno-160-15></a><a href=#__codelineno-160-15><span class=linenos data-linenos=" 15 "></span></a><span class=w>       </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_a_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-160-16><a id=__codelineno-160-16 name=__codelineno-160-16></a><a href=#__codelineno-160-16><span class=linenos data-linenos=" 16 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_a_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-160-17><a id=__codelineno-160-17 name=__codelineno-160-17></a><a href=#__codelineno-160-17><span class=linenos data-linenos=" 17 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-160-18><a id=__codelineno-160-18 name=__codelineno-160-18></a><a href=#__codelineno-160-18><span class=linenos data-linenos=" 18 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_company_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_company_id</span>
</span><span id=__span-160-19><a id=__codelineno-160-19 name=__codelineno-160-19></a><a href=#__codelineno-160-19><span class=linenos data-linenos=" 19 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-160-20><a id=__codelineno-160-20 name=__codelineno-160-20></a><a href=#__codelineno-160-20><span class=linenos data-linenos=" 20 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-160-21><a id=__codelineno-160-21 name=__codelineno-160-21></a><a href=#__codelineno-160-21><span class=linenos data-linenos=" 21 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-160-22><a id=__codelineno-160-22 name=__codelineno-160-22></a><a href=#__codelineno-160-22><span class=linenos data-linenos=" 22 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-160-23><a id=__codelineno-160-23 name=__codelineno-160-23></a><a href=#__codelineno-160-23><span class=linenos data-linenos=" 23 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-160-24><a id=__codelineno-160-24 name=__codelineno-160-24></a><a href=#__codelineno-160-24><span class=linenos data-linenos=" 24 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-160-25><a id=__codelineno-160-25 name=__codelineno-160-25></a><a href=#__codelineno-160-25><span class=linenos data-linenos=" 25 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_1</span>
</span><span id=__span-160-26><a id=__codelineno-160-26 name=__codelineno-160-26></a><a href=#__codelineno-160-26><span class=linenos data-linenos=" 26 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-160-27><a id=__codelineno-160-27 name=__codelineno-160-27></a><a href=#__codelineno-160-27><span class=linenos data-linenos=" 27 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-160-28><a id=__codelineno-160-28 name=__codelineno-160-28></a><a href=#__codelineno-160-28><span class=linenos data-linenos=" 28 "></span></a><span class=w>         </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-160-29><a id=__codelineno-160-29 name=__codelineno-160-29></a><a href=#__codelineno-160-29><span class=linenos data-linenos=" 29 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>company_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_company_id</span>
</span><span id=__span-160-30><a id=__codelineno-160-30 name=__codelineno-160-30></a><a href=#__codelineno-160-30><span class=linenos data-linenos=" 30 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-160-31><a id=__codelineno-160-31 name=__codelineno-160-31></a><a href=#__codelineno-160-31><span class=linenos data-linenos=" 31 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>WorksAt</span>
</span><span id=__span-160-32><a id=__codelineno-160-32 name=__codelineno-160-32></a><a href=#__codelineno-160-32><span class=linenos data-linenos=" 32 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_1</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-160-33><a id=__codelineno-160-33 name=__codelineno-160-33></a><a href=#__codelineno-160-33><span class=linenos data-linenos=" 33 "></span></a><span class=w>      </span><span class=n>_left_1</span><span class=p>.</span><span class=n>_gsql2rsql_a_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_1</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-160-34><a id=__codelineno-160-34 name=__codelineno-160-34></a><a href=#__codelineno-160-34><span class=linenos data-linenos=" 34 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_0</span>
</span><span id=__span-160-35><a id=__codelineno-160-35 name=__codelineno-160-35></a><a href=#__codelineno-160-35><span class=linenos data-linenos=" 35 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-160-36><a id=__codelineno-160-36 name=__codelineno-160-36></a><a href=#__codelineno-160-36><span class=linenos data-linenos=" 36 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-160-37><a id=__codelineno-160-37 name=__codelineno-160-37></a><a href=#__codelineno-160-37><span class=linenos data-linenos=" 37 "></span></a><span class=w>       </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_c_id</span>
</span><span id=__span-160-38><a id=__codelineno-160-38 name=__codelineno-160-38></a><a href=#__codelineno-160-38><span class=linenos data-linenos=" 38 "></span></a><span class=w>    </span><span class=k>FROM</span>
</span><span id=__span-160-39><a id=__codelineno-160-39 name=__codelineno-160-39></a><a href=#__codelineno-160-39><span class=linenos data-linenos=" 39 "></span></a><span class=w>      </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Company</span>
</span><span id=__span-160-40><a id=__codelineno-160-40 name=__codelineno-160-40></a><a href=#__codelineno-160-40><span class=linenos data-linenos=" 40 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_0</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-160-41><a id=__codelineno-160-41 name=__codelineno-160-41></a><a href=#__codelineno-160-41><span class=linenos data-linenos=" 41 "></span></a><span class=w>    </span><span class=n>_right_0</span><span class=p>.</span><span class=n>_gsql2rsql_c_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_0</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_company_id</span>
</span><span id=__span-160-42><a id=__codelineno-160-42 name=__codelineno-160-42></a><a href=#__codelineno-160-42><span class=linenos data-linenos=" 42 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_agg_input</span>
</span><span id=__span-160-43><a id=__codelineno-160-43 name=__codelineno-160-43></a><a href=#__codelineno-160-43><span class=linenos data-linenos=" 43 "></span></a><span class=w>  </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-160-44><a id=__codelineno-160-44 name=__codelineno-160-44></a><a href=#__codelineno-160-44><span class=linenos data-linenos=" 44 "></span></a><span class=p>)</span>
</span><span id=__span-160-45><a id=__codelineno-160-45 name=__codelineno-160-45></a><a href=#__codelineno-160-45><span class=linenos data-linenos=" 45 "></span></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-160-46><a id=__codelineno-160-46 name=__codelineno-160-46></a><a href=#__codelineno-160-46><span class=linenos data-linenos=" 46 "></span></a><span class=w>   </span><span class=n>_gsql2rsql_a_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-160-47><a id=__codelineno-160-47 name=__codelineno-160-47></a><a href=#__codelineno-160-47><span class=linenos data-linenos=" 47 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>company_count</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>company_count</span>
</span><span id=__span-160-48><a id=__codelineno-160-48 name=__codelineno-160-48></a><a href=#__codelineno-160-48><span class=linenos data-linenos=" 48 "></span></a><span class=w>  </span><span class=p>,</span><span class=n>_gsql2rsql_friend_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span>
</span><span id=__span-160-49><a id=__codelineno-160-49 name=__codelineno-160-49></a><a href=#__codelineno-160-49><span class=linenos data-linenos=" 49 "></span></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-160-50><a id=__codelineno-160-50 name=__codelineno-160-50></a><a href=#__codelineno-160-50><span class=linenos data-linenos=" 50 "></span></a><span class=w>  </span><span class=k>SELECT</span>
</span><span id=__span-160-51><a id=__codelineno-160-51 name=__codelineno-160-51></a><a href=#__codelineno-160-51><span class=linenos data-linenos=" 51 "></span></a><span class=w>     </span><span class=n>_left_3</span><span class=p>.</span><span class=o>`</span><span class=n>a</span><span class=o>`</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=o>`</span><span class=n>a</span><span class=o>`</span>
</span><span id=__span-160-52><a id=__codelineno-160-52 name=__codelineno-160-52></a><a href=#__codelineno-160-52><span class=linenos data-linenos=" 52 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_left_3</span><span class=p>.</span><span class=o>`</span><span class=n>company_count</span><span class=o>`</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=o>`</span><span class=n>company_count</span><span class=o>`</span>
</span><span id=__span-160-53><a id=__codelineno-160-53 name=__codelineno-160-53></a><a href=#__codelineno-160-53><span class=linenos data-linenos=" 53 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_3</span><span class=p>.</span><span class=n>_gsql2rsql_a_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-160-54><a id=__codelineno-160-54 name=__codelineno-160-54></a><a href=#__codelineno-160-54><span class=linenos data-linenos=" 54 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_3</span><span class=p>.</span><span class=n>_gsql2rsql_friend_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_friend_name</span>
</span><span id=__span-160-55><a id=__codelineno-160-55 name=__codelineno-160-55></a><a href=#__codelineno-160-55><span class=linenos data-linenos=" 55 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_3</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-160-56><a id=__codelineno-160-56 name=__codelineno-160-56></a><a href=#__codelineno-160-56><span class=linenos data-linenos=" 56 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_3</span><span class=p>.</span><span class=n>_gsql2rsql_a_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-160-57><a id=__codelineno-160-57 name=__codelineno-160-57></a><a href=#__codelineno-160-57><span class=linenos data-linenos=" 57 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_3</span><span class=p>.</span><span class=n>_gsql2rsql_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_friend_id</span>
</span><span id=__span-160-58><a id=__codelineno-160-58 name=__codelineno-160-58></a><a href=#__codelineno-160-58><span class=linenos data-linenos=" 58 "></span></a><span class=w>    </span><span class=p>,</span><span class=n>_right_3</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-160-59><a id=__codelineno-160-59 name=__codelineno-160-59></a><a href=#__codelineno-160-59><span class=linenos data-linenos=" 59 "></span></a><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-160-60><a id=__codelineno-160-60 name=__codelineno-160-60></a><a href=#__codelineno-160-60><span class=linenos data-linenos=" 60 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-160-61><a id=__codelineno-160-61 name=__codelineno-160-61></a><a href=#__codelineno-160-61><span class=linenos data-linenos=" 61 "></span></a><span class=w>       </span><span class=o>`</span><span class=n>a</span><span class=o>`</span>
</span><span id=__span-160-62><a id=__codelineno-160-62 name=__codelineno-160-62></a><a href=#__codelineno-160-62><span class=linenos data-linenos=" 62 "></span></a><span class=w>      </span><span class=p>,</span><span class=o>`</span><span class=n>company_count</span><span class=o>`</span>
</span><span id=__span-160-63><a id=__codelineno-160-63 name=__codelineno-160-63></a><a href=#__codelineno-160-63><span class=linenos data-linenos=" 63 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>agg_boundary_1</span>
</span><span id=__span-160-64><a id=__codelineno-160-64 name=__codelineno-160-64></a><a href=#__codelineno-160-64><span class=linenos data-linenos=" 64 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_3</span>
</span><span id=__span-160-65><a id=__codelineno-160-65 name=__codelineno-160-65></a><a href=#__codelineno-160-65><span class=linenos data-linenos=" 65 "></span></a><span class=w>  </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-160-66><a id=__codelineno-160-66 name=__codelineno-160-66></a><a href=#__codelineno-160-66><span class=linenos data-linenos=" 66 "></span></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-160-67><a id=__codelineno-160-67 name=__codelineno-160-67></a><a href=#__codelineno-160-67><span class=linenos data-linenos=" 67 "></span></a><span class=w>       </span><span class=n>_left_4</span><span class=p>.</span><span class=n>_gsql2rsql_a_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-160-68><a id=__codelineno-160-68 name=__codelineno-160-68></a><a href=#__codelineno-160-68><span class=linenos data-linenos=" 68 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_4</span><span class=p>.</span><span class=n>_gsql2rsql_a_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-160-69><a id=__codelineno-160-69 name=__codelineno-160-69></a><a href=#__codelineno-160-69><span class=linenos data-linenos=" 69 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_4</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-160-70><a id=__codelineno-160-70 name=__codelineno-160-70></a><a href=#__codelineno-160-70><span class=linenos data-linenos=" 70 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_left_4</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-160-71><a id=__codelineno-160-71 name=__codelineno-160-71></a><a href=#__codelineno-160-71><span class=linenos data-linenos=" 71 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_4</span><span class=p>.</span><span class=n>_gsql2rsql_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_friend_id</span>
</span><span id=__span-160-72><a id=__codelineno-160-72 name=__codelineno-160-72></a><a href=#__codelineno-160-72><span class=linenos data-linenos=" 72 "></span></a><span class=w>      </span><span class=p>,</span><span class=n>_right_4</span><span class=p>.</span><span class=n>_gsql2rsql_friend_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_friend_name</span>
</span><span id=__span-160-73><a id=__codelineno-160-73 name=__codelineno-160-73></a><a href=#__codelineno-160-73><span class=linenos data-linenos=" 73 "></span></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-160-74><a id=__codelineno-160-74 name=__codelineno-160-74></a><a href=#__codelineno-160-74><span class=linenos data-linenos=" 74 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-160-75><a id=__codelineno-160-75 name=__codelineno-160-75></a><a href=#__codelineno-160-75><span class=linenos data-linenos=" 75 "></span></a><span class=w>         </span><span class=n>_left_5</span><span class=p>.</span><span class=n>_gsql2rsql_a_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-160-76><a id=__codelineno-160-76 name=__codelineno-160-76></a><a href=#__codelineno-160-76><span class=linenos data-linenos=" 76 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_left_5</span><span class=p>.</span><span class=n>_gsql2rsql_a_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-160-77><a id=__codelineno-160-77 name=__codelineno-160-77></a><a href=#__codelineno-160-77><span class=linenos data-linenos=" 77 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_right_5</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-160-78><a id=__codelineno-160-78 name=__codelineno-160-78></a><a href=#__codelineno-160-78><span class=linenos data-linenos=" 78 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>_right_5</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-160-79><a id=__codelineno-160-79 name=__codelineno-160-79></a><a href=#__codelineno-160-79><span class=linenos data-linenos=" 79 "></span></a><span class=w>      </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-160-80><a id=__codelineno-160-80 name=__codelineno-160-80></a><a href=#__codelineno-160-80><span class=linenos data-linenos=" 80 "></span></a><span class=w>        </span><span class=k>SELECT</span>
</span><span id=__span-160-81><a id=__codelineno-160-81 name=__codelineno-160-81></a><a href=#__codelineno-160-81><span class=linenos data-linenos=" 81 "></span></a><span class=w>           </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-160-82><a id=__codelineno-160-82 name=__codelineno-160-82></a><a href=#__codelineno-160-82><span class=linenos data-linenos=" 82 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_a_name</span>
</span><span id=__span-160-83><a id=__codelineno-160-83 name=__codelineno-160-83></a><a href=#__codelineno-160-83><span class=linenos data-linenos=" 83 "></span></a><span class=w>        </span><span class=k>FROM</span>
</span><span id=__span-160-84><a id=__codelineno-160-84 name=__codelineno-160-84></a><a href=#__codelineno-160-84><span class=linenos data-linenos=" 84 "></span></a><span class=w>          </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-160-85><a id=__codelineno-160-85 name=__codelineno-160-85></a><a href=#__codelineno-160-85><span class=linenos data-linenos=" 85 "></span></a><span class=w>      </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_5</span>
</span><span id=__span-160-86><a id=__codelineno-160-86 name=__codelineno-160-86></a><a href=#__codelineno-160-86><span class=linenos data-linenos=" 86 "></span></a><span class=w>      </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-160-87><a id=__codelineno-160-87 name=__codelineno-160-87></a><a href=#__codelineno-160-87><span class=linenos data-linenos=" 87 "></span></a><span class=w>        </span><span class=k>SELECT</span>
</span><span id=__span-160-88><a id=__codelineno-160-88 name=__codelineno-160-88></a><a href=#__codelineno-160-88><span class=linenos data-linenos=" 88 "></span></a><span class=w>           </span><span class=n>person_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-160-89><a id=__codelineno-160-89 name=__codelineno-160-89></a><a href=#__codelineno-160-89><span class=linenos data-linenos=" 89 "></span></a><span class=w>          </span><span class=p>,</span><span class=n>friend_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-160-90><a id=__codelineno-160-90 name=__codelineno-160-90></a><a href=#__codelineno-160-90><span class=linenos data-linenos=" 90 "></span></a><span class=w>        </span><span class=k>FROM</span>
</span><span id=__span-160-91><a id=__codelineno-160-91 name=__codelineno-160-91></a><a href=#__codelineno-160-91><span class=linenos data-linenos=" 91 "></span></a><span class=w>          </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Knows</span>
</span><span id=__span-160-92><a id=__codelineno-160-92 name=__codelineno-160-92></a><a href=#__codelineno-160-92><span class=linenos data-linenos=" 92 "></span></a><span class=w>      </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_5</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-160-93><a id=__codelineno-160-93 name=__codelineno-160-93></a><a href=#__codelineno-160-93><span class=linenos data-linenos=" 93 "></span></a><span class=w>        </span><span class=n>_left_5</span><span class=p>.</span><span class=n>_gsql2rsql_a_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_5</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_person_id</span>
</span><span id=__span-160-94><a id=__codelineno-160-94 name=__codelineno-160-94></a><a href=#__codelineno-160-94><span class=linenos data-linenos=" 94 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_left_4</span>
</span><span id=__span-160-95><a id=__codelineno-160-95 name=__codelineno-160-95></a><a href=#__codelineno-160-95><span class=linenos data-linenos=" 95 "></span></a><span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-160-96><a id=__codelineno-160-96 name=__codelineno-160-96></a><a href=#__codelineno-160-96><span class=linenos data-linenos=" 96 "></span></a><span class=w>      </span><span class=k>SELECT</span>
</span><span id=__span-160-97><a id=__codelineno-160-97 name=__codelineno-160-97></a><a href=#__codelineno-160-97><span class=linenos data-linenos=" 97 "></span></a><span class=w>         </span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_friend_id</span>
</span><span id=__span-160-98><a id=__codelineno-160-98 name=__codelineno-160-98></a><a href=#__codelineno-160-98><span class=linenos data-linenos=" 98 "></span></a><span class=w>        </span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_gsql2rsql_friend_name</span>
</span><span id=__span-160-99><a id=__codelineno-160-99 name=__codelineno-160-99></a><a href=#__codelineno-160-99><span class=linenos data-linenos=" 99 "></span></a><span class=w>      </span><span class=k>FROM</span>
</span><span id=__span-160-100><a id=__codelineno-160-100 name=__codelineno-160-100></a><a href=#__codelineno-160-100><span class=linenos data-linenos="100 "></span></a><span class=w>        </span><span class=k>catalog</span><span class=p>.</span><span class=n>demo</span><span class=p>.</span><span class=n>Person</span>
</span><span id=__span-160-101><a id=__codelineno-160-101 name=__codelineno-160-101></a><a href=#__codelineno-160-101><span class=linenos data-linenos="101 "></span></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_4</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-160-102><a id=__codelineno-160-102 name=__codelineno-160-102></a><a href=#__codelineno-160-102><span class=linenos data-linenos="102 "></span></a><span class=w>      </span><span class=n>_right_4</span><span class=p>.</span><span class=n>_gsql2rsql_friend_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_left_4</span><span class=p>.</span><span class=n>_gsql2rsql__anon1_friend_id</span>
</span><span id=__span-160-103><a id=__codelineno-160-103 name=__codelineno-160-103></a><a href=#__codelineno-160-103><span class=linenos data-linenos="103 "></span></a><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_right_3</span><span class=w> </span><span class=k>ON</span>
</span><span id=__span-160-104><a id=__codelineno-160-104 name=__codelineno-160-104></a><a href=#__codelineno-160-104><span class=linenos data-linenos="104 "></span></a><span class=w>    </span><span class=n>_left_3</span><span class=p>.</span><span class=o>`</span><span class=n>a</span><span class=o>`</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_right_3</span><span class=p>.</span><span class=n>_gsql2rsql_a_id</span>
</span><span id=__span-160-105><a id=__codelineno-160-105 name=__codelineno-160-105></a><a href=#__codelineno-160-105><span class=linenos data-linenos="105 "></span></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>_proj</span>
</span><span id=__span-160-106><a id=__codelineno-160-106 name=__codelineno-160-106></a><a href=#__codelineno-160-106><span class=linenos data-linenos="106 "></span></a><span class=k>LIMIT</span><span class=w> </span><span class=mi>20</span>
</span></code></pre></div> </details> <details class=info> <summary>Logical Plan</summary> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-161-1><a id=__codelineno-161-1 name=__codelineno-161-1></a><a href=#__codelineno-161-1><span class=linenos data-linenos=" 1 "></span></a>Level 0:
</span><span id=__span-161-2><a id=__codelineno-161-2 name=__codelineno-161-2></a><a href=#__codelineno-161-2><span class=linenos data-linenos=" 2 "></span></a>----------------------------------------------------------------------
</span><span id=__span-161-3><a id=__codelineno-161-3 name=__codelineno-161-3></a><a href=#__codelineno-161-3><span class=linenos data-linenos=" 3 "></span></a>OpId=1 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-161-4><a id=__codelineno-161-4 name=__codelineno-161-4></a><a href=#__codelineno-161-4><span class=linenos data-linenos=" 4 "></span></a>  DataSourceOperator(id=1)
</span><span id=__span-161-5><a id=__codelineno-161-5 name=__codelineno-161-5></a><a href=#__codelineno-161-5><span class=linenos data-linenos=" 5 "></span></a>    DataSource: a:Person
</span><span id=__span-161-6><a id=__codelineno-161-6 name=__codelineno-161-6></a><a href=#__codelineno-161-6><span class=linenos data-linenos=" 6 "></span></a>*
</span><span id=__span-161-7><a id=__codelineno-161-7 name=__codelineno-161-7></a><a href=#__codelineno-161-7><span class=linenos data-linenos=" 7 "></span></a>OpId=2 Op=DataSourceOperator; InOpIds=; OutOpIds=4;
</span><span id=__span-161-8><a id=__codelineno-161-8 name=__codelineno-161-8></a><a href=#__codelineno-161-8><span class=linenos data-linenos=" 8 "></span></a>  DataSourceOperator(id=2)
</span><span id=__span-161-9><a id=__codelineno-161-9 name=__codelineno-161-9></a><a href=#__codelineno-161-9><span class=linenos data-linenos=" 9 "></span></a>    DataSource: [_anon1:WORKS_AT]-&gt;
</span><span id=__span-161-10><a id=__codelineno-161-10 name=__codelineno-161-10></a><a href=#__codelineno-161-10><span class=linenos data-linenos="10 "></span></a>*
</span><span id=__span-161-11><a id=__codelineno-161-11 name=__codelineno-161-11></a><a href=#__codelineno-161-11><span class=linenos data-linenos="11 "></span></a>OpId=3 Op=DataSourceOperator; InOpIds=; OutOpIds=5;
</span><span id=__span-161-12><a id=__codelineno-161-12 name=__codelineno-161-12></a><a href=#__codelineno-161-12><span class=linenos data-linenos="12 "></span></a>  DataSourceOperator(id=3)
</span><span id=__span-161-13><a id=__codelineno-161-13 name=__codelineno-161-13></a><a href=#__codelineno-161-13><span class=linenos data-linenos="13 "></span></a>    DataSource: c:Company
</span><span id=__span-161-14><a id=__codelineno-161-14 name=__codelineno-161-14></a><a href=#__codelineno-161-14><span class=linenos data-linenos="14 "></span></a>*
</span><span id=__span-161-15><a id=__codelineno-161-15 name=__codelineno-161-15></a><a href=#__codelineno-161-15><span class=linenos data-linenos="15 "></span></a>OpId=7 Op=DataSourceOperator; InOpIds=; OutOpIds=10;
</span><span id=__span-161-16><a id=__codelineno-161-16 name=__codelineno-161-16></a><a href=#__codelineno-161-16><span class=linenos data-linenos="16 "></span></a>  DataSourceOperator(id=7)
</span><span id=__span-161-17><a id=__codelineno-161-17 name=__codelineno-161-17></a><a href=#__codelineno-161-17><span class=linenos data-linenos="17 "></span></a>    DataSource: a:Person
</span><span id=__span-161-18><a id=__codelineno-161-18 name=__codelineno-161-18></a><a href=#__codelineno-161-18><span class=linenos data-linenos="18 "></span></a>*
</span><span id=__span-161-19><a id=__codelineno-161-19 name=__codelineno-161-19></a><a href=#__codelineno-161-19><span class=linenos data-linenos="19 "></span></a>OpId=8 Op=DataSourceOperator; InOpIds=; OutOpIds=10;
</span><span id=__span-161-20><a id=__codelineno-161-20 name=__codelineno-161-20></a><a href=#__codelineno-161-20><span class=linenos data-linenos="20 "></span></a>  DataSourceOperator(id=8)
</span><span id=__span-161-21><a id=__codelineno-161-21 name=__codelineno-161-21></a><a href=#__codelineno-161-21><span class=linenos data-linenos="21 "></span></a>    DataSource: [_anon1:KNOWS]-&gt;
</span><span id=__span-161-22><a id=__codelineno-161-22 name=__codelineno-161-22></a><a href=#__codelineno-161-22><span class=linenos data-linenos="22 "></span></a>*
</span><span id=__span-161-23><a id=__codelineno-161-23 name=__codelineno-161-23></a><a href=#__codelineno-161-23><span class=linenos data-linenos="23 "></span></a>OpId=9 Op=DataSourceOperator; InOpIds=; OutOpIds=11;
</span><span id=__span-161-24><a id=__codelineno-161-24 name=__codelineno-161-24></a><a href=#__codelineno-161-24><span class=linenos data-linenos="24 "></span></a>  DataSourceOperator(id=9)
</span><span id=__span-161-25><a id=__codelineno-161-25 name=__codelineno-161-25></a><a href=#__codelineno-161-25><span class=linenos data-linenos="25 "></span></a>    DataSource: friend:Person
</span><span id=__span-161-26><a id=__codelineno-161-26 name=__codelineno-161-26></a><a href=#__codelineno-161-26><span class=linenos data-linenos="26 "></span></a>*
</span><span id=__span-161-27><a id=__codelineno-161-27 name=__codelineno-161-27></a><a href=#__codelineno-161-27><span class=linenos data-linenos="27 "></span></a>----------------------------------------------------------------------
</span><span id=__span-161-28><a id=__codelineno-161-28 name=__codelineno-161-28></a><a href=#__codelineno-161-28><span class=linenos data-linenos="28 "></span></a>Level 1:
</span><span id=__span-161-29><a id=__codelineno-161-29 name=__codelineno-161-29></a><a href=#__codelineno-161-29><span class=linenos data-linenos="29 "></span></a>----------------------------------------------------------------------
</span><span id=__span-161-30><a id=__codelineno-161-30 name=__codelineno-161-30></a><a href=#__codelineno-161-30><span class=linenos data-linenos="30 "></span></a>OpId=4 Op=JoinOperator; InOpIds=1,2; OutOpIds=5;
</span><span id=__span-161-31><a id=__codelineno-161-31 name=__codelineno-161-31></a><a href=#__codelineno-161-31><span class=linenos data-linenos="31 "></span></a>  JoinOperator(id=4)
</span><span id=__span-161-32><a id=__codelineno-161-32 name=__codelineno-161-32></a><a href=#__codelineno-161-32><span class=linenos data-linenos="32 "></span></a>    JoinType: INNER
</span><span id=__span-161-33><a id=__codelineno-161-33 name=__codelineno-161-33></a><a href=#__codelineno-161-33><span class=linenos data-linenos="33 "></span></a>    Joins: JoinPair: Node=a RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-161-34><a id=__codelineno-161-34 name=__codelineno-161-34></a><a href=#__codelineno-161-34><span class=linenos data-linenos="34 "></span></a>*
</span><span id=__span-161-35><a id=__codelineno-161-35 name=__codelineno-161-35></a><a href=#__codelineno-161-35><span class=linenos data-linenos="35 "></span></a>OpId=10 Op=JoinOperator; InOpIds=7,8; OutOpIds=11;
</span><span id=__span-161-36><a id=__codelineno-161-36 name=__codelineno-161-36></a><a href=#__codelineno-161-36><span class=linenos data-linenos="36 "></span></a>  JoinOperator(id=10)
</span><span id=__span-161-37><a id=__codelineno-161-37 name=__codelineno-161-37></a><a href=#__codelineno-161-37><span class=linenos data-linenos="37 "></span></a>    JoinType: INNER
</span><span id=__span-161-38><a id=__codelineno-161-38 name=__codelineno-161-38></a><a href=#__codelineno-161-38><span class=linenos data-linenos="38 "></span></a>    Joins: JoinPair: Node=a RelOrNode=_anon1 Type=SOURCE
</span><span id=__span-161-39><a id=__codelineno-161-39 name=__codelineno-161-39></a><a href=#__codelineno-161-39><span class=linenos data-linenos="39 "></span></a>*
</span><span id=__span-161-40><a id=__codelineno-161-40 name=__codelineno-161-40></a><a href=#__codelineno-161-40><span class=linenos data-linenos="40 "></span></a>----------------------------------------------------------------------
</span><span id=__span-161-41><a id=__codelineno-161-41 name=__codelineno-161-41></a><a href=#__codelineno-161-41><span class=linenos data-linenos="41 "></span></a>Level 2:
</span><span id=__span-161-42><a id=__codelineno-161-42 name=__codelineno-161-42></a><a href=#__codelineno-161-42><span class=linenos data-linenos="42 "></span></a>----------------------------------------------------------------------
</span><span id=__span-161-43><a id=__codelineno-161-43 name=__codelineno-161-43></a><a href=#__codelineno-161-43><span class=linenos data-linenos="43 "></span></a>OpId=5 Op=JoinOperator; InOpIds=4,3; OutOpIds=6;
</span><span id=__span-161-44><a id=__codelineno-161-44 name=__codelineno-161-44></a><a href=#__codelineno-161-44><span class=linenos data-linenos="44 "></span></a>  JoinOperator(id=5)
</span><span id=__span-161-45><a id=__codelineno-161-45 name=__codelineno-161-45></a><a href=#__codelineno-161-45><span class=linenos data-linenos="45 "></span></a>    JoinType: INNER
</span><span id=__span-161-46><a id=__codelineno-161-46 name=__codelineno-161-46></a><a href=#__codelineno-161-46><span class=linenos data-linenos="46 "></span></a>    Joins: JoinPair: Node=c RelOrNode=_anon1 Type=SINK
</span><span id=__span-161-47><a id=__codelineno-161-47 name=__codelineno-161-47></a><a href=#__codelineno-161-47><span class=linenos data-linenos="47 "></span></a>*
</span><span id=__span-161-48><a id=__codelineno-161-48 name=__codelineno-161-48></a><a href=#__codelineno-161-48><span class=linenos data-linenos="48 "></span></a>OpId=11 Op=JoinOperator; InOpIds=10,9; OutOpIds=12;
</span><span id=__span-161-49><a id=__codelineno-161-49 name=__codelineno-161-49></a><a href=#__codelineno-161-49><span class=linenos data-linenos="49 "></span></a>  JoinOperator(id=11)
</span><span id=__span-161-50><a id=__codelineno-161-50 name=__codelineno-161-50></a><a href=#__codelineno-161-50><span class=linenos data-linenos="50 "></span></a>    JoinType: INNER
</span><span id=__span-161-51><a id=__codelineno-161-51 name=__codelineno-161-51></a><a href=#__codelineno-161-51><span class=linenos data-linenos="51 "></span></a>    Joins: JoinPair: Node=friend RelOrNode=_anon1 Type=SINK
</span><span id=__span-161-52><a id=__codelineno-161-52 name=__codelineno-161-52></a><a href=#__codelineno-161-52><span class=linenos data-linenos="52 "></span></a>*
</span><span id=__span-161-53><a id=__codelineno-161-53 name=__codelineno-161-53></a><a href=#__codelineno-161-53><span class=linenos data-linenos="53 "></span></a>----------------------------------------------------------------------
</span><span id=__span-161-54><a id=__codelineno-161-54 name=__codelineno-161-54></a><a href=#__codelineno-161-54><span class=linenos data-linenos="54 "></span></a>Level 3:
</span><span id=__span-161-55><a id=__codelineno-161-55 name=__codelineno-161-55></a><a href=#__codelineno-161-55><span class=linenos data-linenos="55 "></span></a>----------------------------------------------------------------------
</span><span id=__span-161-56><a id=__codelineno-161-56 name=__codelineno-161-56></a><a href=#__codelineno-161-56><span class=linenos data-linenos="56 "></span></a>OpId=6 Op=AggregationBoundaryOperator; InOpIds=5; OutOpIds=12;
</span><span id=__span-161-57><a id=__codelineno-161-57 name=__codelineno-161-57></a><a href=#__codelineno-161-57><span class=linenos data-linenos="57 "></span></a>  AggregationBoundaryOperator(id=6)
</span><span id=__span-161-58><a id=__codelineno-161-58 name=__codelineno-161-58></a><a href=#__codelineno-161-58><span class=linenos data-linenos="58 "></span></a>    GroupBy: [a]
</span><span id=__span-161-59><a id=__codelineno-161-59 name=__codelineno-161-59></a><a href=#__codelineno-161-59><span class=linenos data-linenos="59 "></span></a>    Aggregates: [company_count]
</span><span id=__span-161-60><a id=__codelineno-161-60 name=__codelineno-161-60></a><a href=#__codelineno-161-60><span class=linenos data-linenos="60 "></span></a>*
</span><span id=__span-161-61><a id=__codelineno-161-61 name=__codelineno-161-61></a><a href=#__codelineno-161-61><span class=linenos data-linenos="61 "></span></a>----------------------------------------------------------------------
</span><span id=__span-161-62><a id=__codelineno-161-62 name=__codelineno-161-62></a><a href=#__codelineno-161-62><span class=linenos data-linenos="62 "></span></a>Level 4:
</span><span id=__span-161-63><a id=__codelineno-161-63 name=__codelineno-161-63></a><a href=#__codelineno-161-63><span class=linenos data-linenos="63 "></span></a>----------------------------------------------------------------------
</span><span id=__span-161-64><a id=__codelineno-161-64 name=__codelineno-161-64></a><a href=#__codelineno-161-64><span class=linenos data-linenos="64 "></span></a>OpId=12 Op=JoinOperator; InOpIds=6,11; OutOpIds=13;
</span><span id=__span-161-65><a id=__codelineno-161-65 name=__codelineno-161-65></a><a href=#__codelineno-161-65><span class=linenos data-linenos="65 "></span></a>  JoinOperator(id=12)
</span><span id=__span-161-66><a id=__codelineno-161-66 name=__codelineno-161-66></a><a href=#__codelineno-161-66><span class=linenos data-linenos="66 "></span></a>    JoinType: INNER
</span><span id=__span-161-67><a id=__codelineno-161-67 name=__codelineno-161-67></a><a href=#__codelineno-161-67><span class=linenos data-linenos="67 "></span></a>    Joins: JoinPair: Node=a RelOrNode=agg_boundary_1 Type=NODE_ID
</span><span id=__span-161-68><a id=__codelineno-161-68 name=__codelineno-161-68></a><a href=#__codelineno-161-68><span class=linenos data-linenos="68 "></span></a>*
</span><span id=__span-161-69><a id=__codelineno-161-69 name=__codelineno-161-69></a><a href=#__codelineno-161-69><span class=linenos data-linenos="69 "></span></a>----------------------------------------------------------------------
</span><span id=__span-161-70><a id=__codelineno-161-70 name=__codelineno-161-70></a><a href=#__codelineno-161-70><span class=linenos data-linenos="70 "></span></a>Level 5:
</span><span id=__span-161-71><a id=__codelineno-161-71 name=__codelineno-161-71></a><a href=#__codelineno-161-71><span class=linenos data-linenos="71 "></span></a>----------------------------------------------------------------------
</span><span id=__span-161-72><a id=__codelineno-161-72 name=__codelineno-161-72></a><a href=#__codelineno-161-72><span class=linenos data-linenos="72 "></span></a>OpId=13 Op=ProjectionOperator; InOpIds=12; OutOpIds=;
</span><span id=__span-161-73><a id=__codelineno-161-73 name=__codelineno-161-73></a><a href=#__codelineno-161-73><span class=linenos data-linenos="73 "></span></a>  ProjectionOperator(id=13)
</span><span id=__span-161-74><a id=__codelineno-161-74 name=__codelineno-161-74></a><a href=#__codelineno-161-74><span class=linenos data-linenos="74 "></span></a>    Projections: name=a.name, company_count=company_count, name=friend.name
</span><span id=__span-161-75><a id=__codelineno-161-75 name=__codelineno-161-75></a><a href=#__codelineno-161-75><span class=linenos data-linenos="75 "></span></a>*
</span><span id=__span-161-76><a id=__codelineno-161-76 name=__codelineno-161-76></a><a href=#__codelineno-161-76><span class=linenos data-linenos="76 "></span></a>----------------------------------------------------------------------
</span></code></pre></div> </details> <hr> <form class=md-feedback name=feedback hidden> <fieldset> <legend class=md-feedback__title> Was this page helpful? </legend> <div class=md-feedback__inner> <div class=md-feedback__list> <button class="md-feedback__icon md-icon" type=submit title="This page was helpful" data-md-value=1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg> </button> <button class="md-feedback__icon md-icon" type=submit title="This page could be improved" data-md-value=0> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg> </button> </div> <div class=md-feedback__note> <div data-md-value=1 hidden> Thanks for your feedback! </div> <div data-md-value=0 hidden> Thanks for your feedback! Help us improve by <a href=https://github.com/devmessias/gsql2rsql/issues/new target=_blank rel=noopener>filing an issue</a>. </div> </div> </div> </fieldset> </form> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024-2026 gsql2rsql Contributors </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/devmessias/gsql2rsql target=_blank rel=noopener title="GitHub Repository" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://pypi.org/project/gsql2rsql/ target=_blank rel=noopener title="PyPI Package" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.indexes", "navigation.top", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.annotate", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> <script src=../../javascripts/extra.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> </body> </html>